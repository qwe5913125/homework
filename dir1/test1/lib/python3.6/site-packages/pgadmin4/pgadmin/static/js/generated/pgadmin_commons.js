(self.webpackChunk=self.webpackChunk||[]).push([[196],{26953:(e,t,i)=>{"use strict";var n,a;i(68309),i(24812),i(32564),i(57327),i(5735),i(83753),i(69600),i(69826),n=[i(91669),i(81311),i(19755),i(72316),i(95283),i(83879),i(58307),i(88941),i(44092),i(81989)],void 0===(a=function(e,t,i,n,a,l,s,o,r){var d=o.Model.extend({idAttribute:"privilege_type",defaults:{privilege_type:void 0,privilege:!1,with_grant:!1},validate:function(){return null}}),c=o.PrivilegeRoleModel=o.Model.extend({idAttribute:"grantee",defaults:{grantee:void 0,grantor:void 0,privileges:void 0},keys:["grantee","grantor"],privileges:[],schema:[{id:"grantee",label:e("Grantee"),type:"text",group:null,editable:!0,cellHeaderClasses:"width_percent_40",node:"role",options_cached:!1,disabled:function(e){return e instanceof n.Model&&!(e.top&&e.top.node_info&&e.top.node_info.server.user.name==e.get("grantor"))},transform:function(){var e=l.Extension.NodeListByNameCell.prototype.defaults.transform.apply(this,arguments);return e.unshift({label:"PUBLIC",value:"PUBLIC"}),e},cell:l.Extension.NodeListByNameCell.extend({initialize:function(e){var t=this,i=!0;e&&e.column&&e.column instanceof n.Model&&e.column.get("options_cached")&&(i=!1),l.Extension.NodeListByNameCell.prototype.initialize.apply(t,arguments),i&&(e=t.column.get("options"),t.column.set("options",t.omit_selected_roles.bind(t,e)));var a=function(e){var t=this;"grantee"in e.changed&&this.model.cid!=e.cid&&setTimeout((function(){t.render()}),50)}.bind(this);this.listenTo(t.model.collection,"change",a,this),this.listenTo(t.model.collection,"remove",a,this)},omit_selected_roles:function(e,i){var n=e(i),a={},l=i.model,s=l.cid,o=(t.has(l.top,"node_info")&&!t.isUndefined(l.top.node_info)?l.top.node_info:l.handler.top.node_info).server.user.name;return l.collection.each((function(e){var i=e.get("grantee");e.cid==s||t.isUndefined(i)||o!=e.get("grantor")||(a[i]=e.cid)})),n=t.filter(n,(function(e){return!(e.value in a)}))}})},{id:"privileges",label:e("Privileges"),type:"collection",model:d,group:null,cell:"privilege",control:"text",cellHeaderClasses:"width_percent_40",disabled:function(e){return!(e instanceof n.Collection)&&!(this.node_info&&this.node_info.server.user.name==e.get("grantor")||this.attributes.node_info.server.user.name==e.get("grantor"))}},{id:"grantor",label:e("Grantor"),type:"text",readonly:!0,cell:"node-list-by-name",node:"role"}],initialize:function(e,i){o.Model.prototype.initialize.apply(this,arguments),t.isNull(e)&&this.set("grantor",i&&i.top&&i.top.node_info&&i.top.node_info.server.user.name,{silent:!0});var n=this,a=n.get("privileges"),l=this.get("privileges")||{};t.isArray(l)&&(l=new o.Collection(a,{model:d,top:this.top||this,handler:this,silent:!0,parse:!1}),this.set("privileges",l,{silent:!0}));var s={};return t.each(n.privileges,(function(e){s[e]={privilege_type:e,privilege:!1,with_grant:!1}})),l.each((function(e){delete s[e.get("privilege_type")]})),t.each(s,(function(e){l.add(e,{silent:!0})})),n.on("change:grantee",n.granteeChanged),l.on("change",(function(){n.trigger("change:privileges",n)})),n},granteeChanged:function(){var e=this.get("privileges");"PUBLIC"==this.get("grantee")&&e.each((function(e){e.set("with_grant",!1,{silent:!0})}))},toJSON:function(){var e=[];return this.attributes&&!this.attributes.privileges?null:(this.attributes.privileges.each((function(t){t.get("privilege")&&e.push(t.toJSON())})),{grantee:this.get("grantee"),grantor:this.get("grantor"),privileges:e})},validate:function(){var i,n=null;if(t.isUndefined(this.get("grantee"))?(i=e("A grantee must be selected."),this.errorModel.set("grantee",i),n=i):this.errorModel.unset("grantee"),this.attributes&&this.attributes.privileges){var a=!1;this.attributes.privileges.each((function(e){e.get("privilege")&&(a=!0)})),a?this.errorModel.unset("privileges"):(i=e("At least one privilege should be selected."),this.errorModel.set("privileges",i),n=n||i)}return n}}),u=l.Extension.PrivilegeCellEditor=l.CellEditor.extend({tagName:"div",Labels:{C:"CREATE",T:"TEMPORARY",c:"CONNECT",a:"INSERT",r:"SELECT",w:"UPDATE",d:"DELETE",D:"TRUNCATE",x:"REFERENCES",t:"TRIGGER",U:"USAGE",X:"EXECUTE"},template:t.template(['<tr class="<%= header ? "header" : "" %>">',' <td class="renderable">','  <div class="custom-control custom-checkbox privilege-checkbox">','    <input tabindex="0" type="checkbox" class="custom-control-input" id="<%= checkbox_id %>" name="privilege" privilege="<%- privilege_type %>" target="<%- target %>" <%= privilege ? \'checked\' : "" %>/>','    <label class="custom-control-label" for="<%= checkbox_id %>">',"      <%- privilege_label %>","    </label>","  </div>"," </td>",' <td class="renderable">','  <div class="custom-control custom-checkbox privilege-checkbox">','    <input tabindex="0" type="checkbox" class="custom-control-input" id="wgo_<%= checkbox_id %>" name="with_grant" privilege="<%- privilege_type %>" target="<%- target %>" <%= with_grant ? \'checked\' : "" %> <%= enable_with_grant ? "" : \'disabled\'%>/>','    <label class="custom-control-label" for="wgo_<%= checkbox_id %>">',"      WITH GRANT OPTION","    </label>","  </div>"," </td>","</tr>"].join(" "),null,{variable:null}),events:{change:"privilegeChanged",blur:"lostFocus",keydown:"lostFocus"},render:function(){this.$el.empty(),this.$el.attr("tabindex","1"),this.$el.attr("target",this.elId);var e=this.model.get(this.column.get("name")),n=i("<table aria-label="+this.column.get("label")+"></table>").appendTo(this.$el),a=this,l=!0,s=!0,o=t.uniqueId();return e.each((function(e){var i=e.toJSON();l=l&&i.privilege,s=s&&l&&i.with_grant,t.extend(i,{target:a.cid,header:!1,privilege_label:a.Labels[i.privilege_type],with_grant:"PUBLIC"!=a.model.get("grantee")&&i.with_grant,enable_with_grant:"PUBLIC"!=a.model.get("grantee")&&i.privilege,checkbox_id:i.privilege_type+""+o}),l=l&&i.privilege,s=s&&l&&i.with_grant,n.append(a.template(i))})),e.length>1&&n.prepend(a.template({target:a.cid,privilege_label:"ALL",privilege_type:"ALL",privilege:l,with_grant:"PUBLIC"!=a.model.get("grantee")&&s,enable_with_grant:"PUBLIC"!=a.model.get("grantee")&&l,header:!0,checkbox_id:"all"+o})),a.$el.find("input[type=checkbox]").first().trigger("focus"),i(a.$el.find("input[type=checkbox]")).on("blur",(function(){a.$el.trigger("blur")})),i(a.$el).pgMakeVisible("backform-tab"),a.delegateEvents(),this},privilegeChanged:function(t){if(t&&t.target){var n,a,l,s=i(t.target),o=s.attr("privilege"),r=s.attr("name"),d=s.prop("checked"),c=s.closest("tr"),u=c.closest("table"),p=this.model.get("privileges"),h=this.model.get("grantee");if(this.undelegateEvents(),"ALL"==o){var f,m;l=c.find("input[name=with_grant]"),a=u.find("input[name=privilege][privilege!='ALL']"),n=u.find("input[name=with_grant][privilege!='ALL']"),"privilege"==r?(f=d,m=!1,d?(a.prop("checked",!0),"PUBLIC"==h?(n.prop("disabled",!0),l.prop("disabled",!0)):(n.prop("disabled",!1),l.prop("disabled",!1))):(a.prop("checked",!1),l.prop("checked",!1),n.prop("checked",!1),l.prop("disabled",!0),n.prop("disabled",!0))):(f=!0,m=d,n.prop("checked",d)),p.each((function(e){e.set({privilege:f,with_grant:m})}))}else{var g={};a=(u=c.closest("table")).find("input[name=privilege][privilege='ALL']"),n=u.find("input[name=with_grant][privilege='ALL']"),g[r]=d,"privilege"==r?(l=s.closest("tr").find("input[name=with_grant]"),d?"PUBLIC"!=h&&l.prop("disabled",!1):(g.with_grant=!1,l.prop("checked",!1).prop("disabled",!0),a.prop("checked",!1),n.prop("disabled",!0),n.prop("checked",!1))):d||n.prop("checked",!1),p.get(o).set(g),d&&(a=u.find("input[name=privilege][privilege!='ALL']:checked")).length>1&&a.length==p.models.length&&(a.prop("checked",!0),"with_grant"==r?(n=u.find("input[name=with_grant][privilege!='ALL']:checked")).length==p.models.length&&(n.prop("disabled",!1),n.prop("checked",!0)):"PUBLIC"!=h&&n.prop("disabled",!1))}this.model.trigger("change",this.model);var v=!1,b=null;p.each((function(e){v=v||e.get("privilege")})),v?(this.model.errorModel.unset("privileges"),this.model.errorModel.has("grantee")&&(b=this.model.errorModel.get("grantee"))):(this.model.errorModel.set("privileges",e("At least one privilege should be selected.")),b=e("At least one privilege should be selected.")),b?this.model.collection.trigger("pgadmin-session:model:invalid",b,this.model):this.model.collection.trigger("pgadmin-session:model:valid",this.model)}this.delegateEvents()},lostFocus:function(e){var t=this,n=this.model,a=this.column,s=new l.Command(e),o=this.model.get(this.column.get("name"));return"Tab"==e.key&&r.handleKeyNavigation(event),s.moveUp()||s.moveDown()||s.save()||s.cancel()||s.moveLeft()&&"privilege"===e.target.name&&"ALL"===i(e.target).attr("privilege")||s.moveRight()&&o.last().get("privilege_type")===i(e.target).attr("privilege")&&("privilege"===e.target.name&&!e.target.checked||"with_grant"===i(e.target).attr("name"))?(e.stopPropagation(),void n.trigger("backgrid:edited",n,a,s)):void setTimeout((function(){if(("DIV"==document.activeElement.tagName||"BUTTON"==document.activeElement.tagName)&&t.$el[0]!=document.activeElement&&!function(e,t){for(var i=t.parentNode;null!=i;){if(i==e)return!0;i=i.parentNode}return!1}(t.$el[0],document.activeElement)){var i=t.model;i.trigger("backgrid:edited",i,t.column,new l.Command(e))}}),10)}}),p=l.Extension.PrivilegeCellFormatter=function(){};return t.extend(p.prototype,{notation:{CREATE:"C",TEMPORARY:"T",CONNECT:"c",INSERT:"a",SELECT:"r",UPDATE:"w",DELETE:"d",TRUNCATE:"D",REFERENCES:"x",TRIGGER:"t",USAGE:"U",EXECUTE:"X"},fromRaw:function(e){var t="";return e instanceof n.Collection&&e.each((function(e){e.get("privilege")&&(t+=e.get("privilege_type"),e.get("with_grant")&&(t+="*"))})),t}}),l.Extension.PrivilegeCell=l.Cell.extend({className:"edit-cell",formatter:p,editor:u,initialize:function(){var e=this;l.Cell.prototype.initialize.apply(this,arguments),e.model.on("change:grantee",(function(){e.$el.hasClass("editor")||setTimeout((function(){e.render()}),10)}))},events:{click:"enterEditMode",keydown:"saveOrCancel"},saveOrCancel:function(e){var t=this.model,i=this.column,n=new l.Command(e);n.moveUp()||n.moveDown()||n.moveLeft()||n.moveRight()||n.save()?(e.preventDefault(),e.stopPropagation(),t.trigger("backgrid:edited",t,i,n)):n.cancel()&&(e.stopPropagation(),t.trigger("backgrid:edited",t,i,n))}}),c}.apply(t,n))||(e.exports=a)},72726:(e,t,i)=>{"use strict";var n,a;i(91058),i(54678),i(32564),i(82772),i(68309),i(5735),i(83753),i(74916),i(15306),i(69600),i(69826),i(5212),n=[i(91669),i(81311),i(19755),i(72316),i(95283),i(83879),i(58307),i(55112),i(88941),i(81989)],void 0===(a=function(e,t,i,n,a,l,s,o,r){var d=l.Row.extend({modelDuplicateClass:"bg-model-duplicate",initialize:function(){l.Row.prototype.initialize.apply(this,arguments);var e=this;e.model.on("change:name",(function(){setTimeout((function(){e.columns.each((function(t){if("value"==t.get("name")){e.model.set({value:void 0},{silent:!0});var i=e.columns.indexOf(t),n=new(t.get("cellFunction").apply(t,[e.model]))({column:t,model:e.model});e.cells[i].remove(),e.cells[i]=n,e.render()}}))}),10)})),e.listenTo(e.model,"pgadmin-session:model:duplicate",e.modelDuplicate),e.listenTo(e.model,"pgadmin-session:model:unique",e.modelUnique)},modelDuplicate:function(){i(this.el).removeClass("new"),i(this.el).addClass(this.modelDuplicateClass)},modelUnique:function(){i(this.el).removeClass(this.modelDuplicateClass)}}),c=r.VariableModel=r.Model.extend({keys:["name"],defaults:{name:void 0,value:void 0,role:null,database:null},schema:[{id:"name",label:e("Name"),type:"text",cellHeaderClasses:"width_percent_30",editable:function(e){return e instanceof n.Collection||e.isNew()},cell:l.Extension.NodeAjaxOptionsCell.extend({initialize:function(){l.Extension.NodeAjaxOptionsCell.prototype.initialize.apply(this,arguments);var e=t.clone(this.optionValues||(t.isFunction(this.column.get("options"))?this.column.get("options")(this):this.column.get("options")));this.column.set("options",e)}}),url:"vopts",select2:{allowClear:!1},transform:function(e,i){var n=[],a={};return t.each(e,(function(e){n.push({value:e.name,image:void 0,label:e.name}),a[e.name]=e})),i.column.set("availVariables",a),n}},{id:"value",label:e("Value"),type:"text",editable:!0,cellFunction:function(e){var i=e.get("name"),n={};this.collection.each((function(e){"name"==e.get("name")&&(n=e.get("availVariables"))}));var a=i?n[i]:void 0,s=e.get("value");switch(a&&a.vartype){case"bool":return e.set("value",!!e.get("value"),{silent:!0}),l.Extension.SwitchCell;case"enum":e.set({value:s},{silent:!0});var o=[],r=a&&a.enumvals;return t.each(r,(function(e){o.push([e,e])})),l.Extension.Select2Cell.extend({optionValues:o});case"integer":return t.isNaN(parseInt(s))?e.set({value:void 0},{silent:!0}):e.set({value:parseInt(s)},{silent:!0}),l.IntegerCell;case"real":return t.isNaN(parseFloat(s))?e.set({value:void 0},{silent:!0}):e.set({value:parseFloat(s)},{silent:!0}),l.NumberCell.extend({decimals:0});case"string":return l.StringCell;default:return e.set({value:void 0},{silent:!0}),l.Cell}},cellHeaderClasses:"width_percent_40"},{id:"database",label:e("Database"),type:"text",editable:!0,node:"database",cell:l.Extension.NodeListByNameCell},{id:"role",label:e("Role"),type:"text",editable:!0,node:"role",cell:l.Extension.NodeListByNameCell}],toJSON:function(){var e=n.Model.prototype.toJSON.apply(this);return(t.isUndefined(e.database)||t.isNull(e.database))&&delete e.database,(t.isUndefined(e.role)||t.isNull(e.role))&&delete e.role,e},validate:function(){var i=null;return t.isUndefined(this.get("name"))||t.isNull(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(i=e("Please select a parameter name."),this.errorModel.set("name",i)):t.isUndefined(this.get("value"))||t.isNull(this.get("value"))||""==String(this.get("value")).replace(/^\s+|\s+$/g,"")?(i=e("Please enter a value for the parameter."),this.errorModel.set("value",i),this.errorModel.unset("name")):(this.errorModel.unset("name"),this.errorModel.unset("value")),i}});return a.VariableCollectionControl=a.UniqueColCollectionControl.extend({hasDatabase:!1,hasRole:!1,initialize:function(e){var t=this,i=["name"];t.hasDatabase=e.field.get("hasDatabase"),t.hasRole=e.field.get("hasRole"),t.hasDatabase?i.push("database"):t.hasRole&&i.push("role"),e&&e.field&&(e.field instanceof a.Field?e.field.set({model:r.VariableModel.extend({keys:i})},{silent:!0}):e.field.extend({model:r.VariableModel.extend({keys:i})})),a.UniqueColCollectionControl.prototype.initialize.apply(t,arguments),t.availVariables={};var n=["name","value"];t.hasDatabase&&n.push("database"),t.hasRole&&n.push("role"),t.gridSchema=a.generateGridColumnsFromModel(t.field.get("node_info"),c.extend({keys:i}),"edit",n,t.field.get("schema_node")),t.getVariables()},getVariables:function(){var e=this,n=this.field.get("url"),a=e.model;if(this.field.get("version_compatible")&&n&&!a.isNew()){var l,s=e.field.get("node"),o=e.field.get("node_data"),r=e.field.get("node_info"),d=s.generate_url.apply(s,[null,n,o,!0,r]),c=e.collection.trackChanges;c&&e.collection.stopSession(),a.trigger("pgadmin-view:fetching",a,e.field),i.ajax({async:!1,url:d}).done((function(e){l=e.data})).fail((function(){a.trigger("pgadmin-view:fetch:error",a,e.field)})),a.trigger("pgadmin-view:fetched",a,e.field),l&&t.isArray(l)&&e.collection.reset(l,{silent:!0}),c&&e.collection.startNewSession()}},showGridControl:function(n){var a=this,s=t.template(["<div class='subnode-header'>","<span class='control-label'><%-label%></span>","<button class='btn btn-sm-sq btn-primary-icon add fa fa-plus' title='"+e("Add new row")+"' <%=canAdd ? '' : 'disabled=\"disabled\"'%>><span class=\"sr-only\">"+e("Add new row")+"</span></button>","</div>"].join("\n")),o=i("<div class='pgadmin-control-group backgrid form-group col-12 object subnode'></div>").append(s(n));a.grid&&a.grid.remove();var r=t.clone(this.gridSchema);t.each(r.columns,(function(e){"value"==e.name&&(e.availVariables=a.availVariables)})),0==n.disabled&&n.canDelete&&r.columns.unshift({name:"pg-backform-delete width_percent_5",label:"",cell:l.Extension.DeleteCell,editable:!1,cell_priority:-1}),a.collection.each((function(e){var t,i=e.get("name");if(i in a.availVariables)switch(a.availVariables[i].vartype){case"real":t=parseFloat(e.get("value")),e.set("value",isNaN(t)?void 0:t,{silent:!0});break;case"integer":t=parseInt(e.get("value")),e.set("value",isNaN(t)?void 0:t,{silent:!0})}}));var c=a.grid=new l.Grid({columns:r.columns,collection:a.collection,row:d,className:"backgrid table presentation table-bordered table-noouter-border table-hover"});return a.$grid=c.render().$el,o.append(a.$grid),n.disabled||0==n.canAdd||o.find("button.add").first().on("click",(function(e){if(e.preventDefault(),!t.isFunction(n.canAddRow)||n.canAddRow.apply(a,[a.model])){if(!!!a.field.get("allowMultipleEmptyRows")&&a.collection){var l=!1;if(a.collection.each((function(e){var i=[];t.each(e.attributes,(function(e){i.push(e)})),t.some(i,t.identity)||(l=!0)})),l)return!1}i(c.body.$el.find(i("tr.new"))).removeClass("new");var s=new n.model(null,{silent:!0,handler:a.collection,top:a.model.top||a.model,collection:a.collection,node_info:a.model.node_info});a.collection.add(s);var o=a.collection.indexOf(s),r=c.body.rows[o].$el;return r.addClass("new"),i(r).pgMakeVisible("backform-tab"),!1}})),o},addVariable:function(e){e.preventDefault();var t=this,n=new(t.field.get("model"))(t.headerData.toJSON(),{silent:!0,top:t.collection.top,handler:t.collection}),a=t.model.get(t.field.get("name"));a.add(n);var l=a.indexOf(n);if(l>-1){t.$grid.find(".new").removeClass("new");var s=t.grid.body.rows[l].$el;s.addClass("new"),i(s).pgMakeVisible("backform-tab")}return!1}}),c}.apply(t,n))||(e.exports=a)},58894:(e,t,i)=>{"use strict";var n,a,l=i(19755);function s(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i(69070),i(47941),i(82526),i(57327),i(38880),i(89554),i(54747),i(49337),i(33321),i(2707),i(68309),i(69826),i(24812),i(32564),i(82772),i(74916),i(64765),i(91058),i(4723),i(40561),n=[i(79226),i(91669),i(28008),i,i(19755),i(81311),i(43734),i(55112),i(55455),i(20811),i(86620),i(14953),i(68363),i(87789),i(44092),i(1950),i(7361),i(96481),i(35816),i(47337),i(33419),i(2420),i(33240),i(1506),i(94841),i(29908),i(59434),i(7134),i(60240),i(49760),i(88941),i(50159),i(64532),i(90338),i(37294),i(77019),i(1969),i(9049)],void 0===(a=function(e,t,i,n,a,r,d,c,u,p,h,f,m,g,v,b,y){l=window.$=a;var C=window.wcDocker;a=a||l||window.$;var _=p.default,w=c.Browser=c.Browser||{},x=t("Please select an object in the tree view.");g.setPGCSRFToken(c.csrf_token_header,c.csrf_token),y.validate_kerberos_ticket();var k={};k[C.EVENT.VISIBILITY_CHANGED]=function(){if(this.isVisible()){var e=c.Browser,t=e.tree?e.tree.selected():void 0,i=t&&1==t.length?e.tree.itemData(t):void 0;if(i&&e.Nodes[i._type].callbacks.selected&&r.isFunction(e.Nodes[i._type].callbacks.selected))return e.Nodes[i._type].callbacks.selected.apply(e.Nodes[i._type],[t,i,e])}};var N=function(e){var t=JSON.parse(e).data;return t.length&&"column"!==t[0]._type&&"catalog_object_column"!==t[0]._type&&t.sort((function(e,t){return c.natural_sort(e.label,t.label)})),r.each(t,(function(e){e._label=e.label,e.label=r.escape(e.label)})),t},E=c.Browser.initializeBrowserTree=function(e){a("#tree").aciTree({ajax:{url:i("browser.nodes"),converters:{"text json":N}},ajaxHook:function(t,i){if(null!=t){var n=this.itemData(t),a=e.Nodes[n._type];a&&(i.url=a.generate_url(t,"children",n,!0))}},loaderDelay:100,show:{duration:75},hide:{duration:75},view:{duration:75},animateRoot:!0,unanimated:!1,fullRow:!0}),e.tree=a("#tree").aciTree("api"),e.treeMenu.register(a("#tree")),e.treeMenu.registerDraggableType({"collation domain domain_constraints fts_configuration fts_dictionary fts_parser fts_template synonym table partition type sequence package view mview foreign_table edbvar":function(t,i){return v.fully_qualify(e,t,i)},"schema column database cast event_trigger extension language foreign_data_wrapper foreign_server user_mapping compound_trigger index index_constraint primary_key unique_constraint check_constraint exclusion_constraint foreign_key rule":function(e){return v.quote_ident(e._label)},"trigger trigger_function":function(e){return e._label},"edbfunc function edbproc procedure":function(t,i){var n,a=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},t),l="",r={from:0,to:0};if(n=v.parseFuncParams(a._label),a._label=n.func_name,l=v.fully_qualify(e,a,i),n.params.length>0){l+="(",r.from=l.length,l+=n.params[0][0],r.to=l.length;for(var d=1;d<n.params.length;d++)l=l+", "+n.params[d][0];l+=")"}else l+="()",r.from=r.to=l.length+1;return{text:l,cur:r}}})};return r.extend(c.Browser,{URL:i("browser.index"),docker:null,editor:null,tree:null,treeMenu:new e.Tree,scripts:{},stdW:{sm:500,md:700,lg:900,default:500,calc:function(e){var t=window.innerWidth;return t>e?e:t>c.Browser.stdW.lg?c.Browser.stdW.lg:t>c.Browser.stdW.md?c.Browser.stdW.md:t>c.Browser.stdW.sm?c.Browser.stdW.sm:t}},stdH:{sm:200,md:400,lg:550,default:550,calc:function(e){var t=window.innerHeight;return t>e?e:t>c.Browser.stdH.lg?c.Browser.stdH.lg:t>c.Browser.stdH.md?c.Browser.stdH.md:t}},panels:{browser:new c.Browser.Panel({name:"browser",title:t("Browser"),showTitle:!0,isCloseable:!1,isPrivate:!0,icon:"",limit:1,content:'<div id="tree" class="aciTree"></div>',onCreate:function(e){f.initializeToolbar(e,C)}}),properties:new c.Browser.Panel({name:"properties",title:t("Properties"),icon:"",width:500,isCloseable:!1,isPrivate:!0,elContainer:!0,limit:1,content:'<div class="obj_properties container-fluid"><div role="status" class="pg-panel-message">'+x+"</div></div>",events:k,onCreate:function(e,t){t.addClass("pg-no-overflow")}}),statistics:new c.Browser.Panel({name:"statistics",title:t("Statistics"),icon:"",width:500,isCloseable:!0,isPrivate:!1,limit:1,canHide:!0,content:'<div class="negative-space p-2"><div role="status" class="pg-panel-message pg-panel-statistics-message">'+x+'</div><div class="pg-panel-statistics-container d-none"></div></div>',events:k}),sql:new c.Browser.Panel({name:"sql",title:t("SQL"),icon:"",width:500,isCloseable:!1,isPrivate:!0,limit:1,content:'<label for="sql-textarea" class="sr-only">'+t("SQL Code")+'</label><div class="sql_textarea"><textarea id="sql-textarea" name="sql-textarea" title="'+t("SQL Code")+'"></textarea></div>'}),dependencies:new c.Browser.Panel({name:"dependencies",title:t("Dependencies"),icon:"",width:500,isCloseable:!0,isPrivate:!1,canHide:!0,limit:1,content:'<div class="negative-space p-2"><div role="status" class="pg-panel-message pg-panel-depends-message">'+x+'</div><div class="pg-panel-dependencies-container d-none"></div></div>',events:k}),dependents:new c.Browser.Panel({name:"dependents",title:t("Dependents"),icon:"",width:500,isCloseable:!0,isPrivate:!1,limit:1,canHide:!0,content:'<div class="negative-space p-2"><div role="status" class="pg-panel-message pg-panel-depends-message">'+x+'</div><div class="pg-panel-dependents-container d-none"></div></div>',events:k})},frames:{},menus:{context:{},file:{},edit:{},object:{},management:{},tools:{},help:{}},add_panels:function(){var e=JSON.parse(w.panels_items);r.each(e,(function(e){e.isIframe?w.frames[e.name]=new w.Frame({name:e.name,title:e.title,icon:e.icon,width:e.width,height:e.height,showTitle:e.showTitle,isCloseable:e.isCloseable,isPrivate:e.isPrivate,url:e.content}):w.panels[e.name]=new w.Panel({name:e.name,title:e.title,icon:e.icon,width:e.width,height:e.height,showTitle:e.showTitle,isCloseable:e.isCloseable,isPrivate:e.isPrivate,limit:e.limit?e.limit:null,content:e.content?e.content:"",events:e.events?e.events:"",canHide:e.canHide?e.canHide:""})}))},menu_categories:{create:{label:t("Create"),priority:1,above:!1,below:!0,single:!0}},register_script:function(e,t,i){var n=this.scripts;n[e]=r.isArray(n[e])?n[e]:[],n[e].push({name:t,path:i,loaded:!1})},masterpass_callback_queue:[],enable_disable_menus:function(e){var i=this,n=a("#navbar-menu > ul").first().find("li#mnu_obj .dropdown-menu").first(),l=i.tree.itemData(e),s=function t(i){if(i instanceof c.Browser.MenuItem)i.update(l,e);else for(var n in i)t(i[n])};if(f.enable(t("View Data"),!1),f.enable(t("Filtered Rows"),!1),n.empty(),r.each([{m:"file",id:"#mnu_file"},{m:"management",id:"#mnu_management"},{m:"tools",id:"#mnu_tools"},{m:"help",id:"#mnu_help"}],(function(e){r.each(i.menus[e.m],(function(e){s(e)}))})),e&&i.menus.object&&i.menus.object[l._type])c.Browser.MenuCreator(i.Nodes,n,i.menus.object[l._type],i.menu_categories,l,e);else{var o=c.Browser.MenuGroup(i.menu_categories.create,[{$el:a('<li><a class="dropdown-item disabled" href="#" role="menuitem">'+t("No object selected")+"</a></li>"),priority:1,category:"create",update:function(){}}],!1);n.append(o.$el)}},init:function(){var e=this;if(!e.initialized){if(e.initialized=!0,e.cache_preferences(),e.add_panels(),e.docker=new C("#dockerContainer",{allowContextMenu:!0,allowCollapse:!1,loadingClass:"pg-sp-icon",themePath:i("static",{filename:"css"}),theme:"webcabin.overrides.css"}),e.docker){r.each(e.panels,(function(t,i){e.panels[i].load(e.docker)})),r.each(e.frames,(function(t,i){e.frames[i].load(e.docker)}));var n=w.utils.layout;e.restore_layout(e.docker,n,e.buildDefaultLayout.bind(e)),e.docker.on(C.EVENT.LAYOUT_CHANGED,(function(){e.save_current_layout("Browser/Layout",e.docker)}))}e.editor=_.fromTextArea(document.getElementById("sql-textarea"),{lineNumbers:!0,mode:"text/x-pgsql",readOnly:!0,extraKeys:c.Browser.editor_shortcut_keys,screenReaderLabel:t("SQL")});var l=setInterval((function(){e.get_preferences_for_module("sqleditor")&&(clearInterval(l),e.reflectPreferences("sqleditor"))}),500);e.onPreferencesChange("sqleditor",(function(){e.reflectPreferences("sqleditor")})),setTimeout((function(){e.editor.setValue("-- "+x),e.editor.refresh()}),10),E(e),a("#tree").contextMenu({selector:".aciTreeLine",autoHide:!1,build:function(t){var i=e.tree.itemFrom(t),n=e.tree.itemData(i),l=e.menus.context[n._type],s=a("<div></div>"),o={};return c.Browser.MenuCreator(e.Nodes,s,l,e.menu_categories,n,i,o),{autoHide:!1,items:o}},events:{hide:function(){e.keyboardNavigation.bindLeftTree()}}}),a("#tree").on("acitree",(function(t,i,n,a,l){var s,o=n?e.tree.itemData(n):null;if(o&&e.Nodes[o._type]){if(s=e.Nodes[o._type],r.isObject(s.callbacks)&&a in s.callbacks&&"function"==typeof s.callbacks[a]&&!s.callbacks[a].apply(s,[n,o,e,l,a]))return!1;try{s.trigger("browser-node."+a,s,n,o)}catch(e){console.warn(e.stack||e)}}try{e.Events.trigger("pgadmin-browser:tree",a,n,o),e.Events.trigger("pgadmin-browser:tree:"+a,n,o,s)}catch(e){console.warn(e.stack||e)}return!0})),w.utils.registerScripts(this),w.utils.addMenus(e);var s={};s[c.csrf_token_header]=c.csrf_token,setInterval((function(){a.ajax({url:i("misc.cleanup"),type:"POST",headers:s}).done((function(){})).fail((function(){}))}),3e5),e.set_master_password(""),e.check_corrupted_db_file(),e.Events.on("pgadmin:browser:tree:add",e.onAddTreeNode,e),e.Events.on("pgadmin:browser:tree:update",e.onUpdateTreeNode,e),e.Events.on("pgadmin:browser:tree:refresh",e.onRefreshTreeNode,e),e.Events.on("pgadmin-browser:tree:loadfail",e.onLoadFailNode,e),e.bind_beforeunload(),e.log_activity(),e.register_to_activity_listener(document),e.start_inactivity_timeout_daemon()}},check_corrupted_db_file:function(){a.ajax({url:i("browser.check_corrupted_db_file"),type:"GET",dataType:"json",contentType:"application/json"}).done((function(e){e.data.length>0&&u.alert("Warning","pgAdmin detected unrecoverable corruption in it's SQLite configuration database. The database has been backed up and recreated with default settings. It may be possible to recover data such as query history manually from the original/corrupt file using a tool such as DB Browser for SQLite if desired.<br><br>Original file: "+e.data+"<br>Replacement file: "+e.data.substring(0,e.data.length-14)).set({closable:!0,onok:function(){}})})).fail((function(e,t,i){u.alert(i)}))},init_master_password:function(){var e=this;u.dlgMasterPass||u.dialog("dlgMasterPass",(function(){return{main:function(e,t,i){this.set("title",e),this.message=t,this.reset=i},build:function(){u.pgDialogBuild.apply(this)},setup:function(){return{buttons:[{text:"",className:"btn btn-primary-icon pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:t("Master password"),url:i("help.static",{filename:"master_password.html"})}},{text:t("Reset Master Password"),className:"btn btn-secondary fa fa-trash-alt pg-alertify-button pull-left"},{text:t("Cancel"),className:"btn btn-secondary fa fa-times pg-alertify-button",key:27},{text:t("OK"),key:13,className:"btn btn-primary fa fa-check pg-alertify-button"}],focus:{element:"#password",select:!0},options:{modal:!0,resizable:!1,maximizable:!1,pinnable:!1}}},prepare:function(){var e=this;e.setContent(e.message),e.reset?a(e.__internal.buttons[1].element).removeClass("d-none"):a(e.__internal.buttons[1].element).addClass("d-none")},callback:function(i){var n=this;if(3==i.index)e.set_master_password(a("#frmMasterPassword #password").val(),!0,n.set_callback);else if(2==i.index)e.masterpass_callback_queue=[];else if(1==i.index)i.cancel=!0,u.confirm(t("Reset Master Password"),t("This will remove all the saved passwords. This will also remove established connections to the server and you may need to reconnect again. Do you wish to continue?"),(function(){return e.reset_master_password(),n.close(),!0}),(function(){return!0})).set("labels",{ok:t("Yes"),cancel:t("No")});else if(0==i.index)return i.cancel=!0,void e.showHelp(i.button.element.name,i.button.element.getAttribute("url"),null,null)}}}))},check_master_password:function(e){a.ajax({url:i("browser.check_master_password"),type:"GET",contentType:"application/json"}).done((function(t){e&&(t.data?e(!0):e(!1))})).fail((function(e,t,i){u.pgRespErrorNotify(e,i)}))},reset_master_password:function(){var e=this;a.ajax({url:i("browser.set_master_password"),type:"DELETE",contentType:"application/json"}).done((function(t){t.data||e.set_master_password("")})).fail((function(e,t,i){u.pgRespErrorNotify(e,i)}))},set_master_password:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},l=null,s=this;l=JSON.stringify({password:e,button_click:t}),s.masterpass_callback_queue.push(n),a.ajax({url:i("browser.set_master_password"),type:"POST",data:l,dataType:"json",contentType:"application/json"}).done((function(e){e.data.present?setTimeout((function(){for(;s.masterpass_callback_queue.length>0;){s.masterpass_callback_queue.shift()()}}),500):(s.init_master_password(),u.dlgMasterPass(e.data.title,e.data.content,e.data.reset))})).fail((function(e,t,i){u.pgRespErrorNotify(e,i)}))},bind_beforeunload:function(){a(window).on("beforeunload",(function(e){var i=b.default.pgAdmin.Browser,n=w.get_preference("browser","browser_tree_state_save_interval"),a=i.get_preference("browser","confirm_on_refresh_close");if(r.isUndefined(n)||-1===n.value||c.Browser.browserTreeState.save_state(),!r.isUndefined(a)&&a.value){var l=t("Are you sure you want to close the %s browser?",w.utils.app_name);return e.originalEvent.returnValue=l,l}}))},add_menu_category:function(e,t,i,n,a,l,s){this.menu_categories[e]={label:t,priority:i,icon:n,above:!0===a,below:!0===l,single:s}},add_menus:function(e){var t=this,i=this.menus,n=c.Browser.MenuItem;r.each(e,(function(e){r.each(e.applies,(function(l){if(a.inArray(l,["context","file","edit","object","management","tools","help"])>=0){var s;if(!h(t,e.node))return;if(r.has(e,"module")&&!r.isUndefined(e.module)&&!h(t,e.module.type))return;i[l]=i[l]||{},s=r.isString(e.node)?i[l][e.node]=i[l][e.node]||{}:r.isString(e.category)?i[l][e.category]=i[l][e.category]||{}:i[l];var o=function(e){return new n({name:e.name,label:e.label,module:e.module,category:e.category,callback:e.callback,priority:e.priority,data:e.data,url:e.url||"#",target:e.target,icon:e.icon,enable:""==e.enable||(!r.isString(e.enable)||"false"!=e.enable.toLowerCase())&&e.enable,node:e.node,checked:e.checked,below:e.below})};if(!r.has(s,e.name)&&(s[e.name]=o(e),e.menu_items)){for(var d=[],c=0;c<e.menu_items.length;c++)d.push(o(e.menu_items[c]));s[e.name].menu_items=d}}else console.warn("Developer warning: Category '"+l+"' is not supported!\nSupported categories are: context, file, edit, object, tools, management, help")}))}))},create_menus:function(){var e=a("#navbar-menu > ul").first(),i=this;r.each([{menu:"file",id:"#mnu_file"},{menu:"management",id:"#mnu_management"},{menu:"tools",id:"#mnu_tools"},{menu:"help",id:"#mnu_help"}],(function(n){var a=e.children(n.id).first(),l=a.children(".dropdown-menu").first();l.empty(),"help"==n.menu&&(l.append('<div id="quick-search-component"></div>'),l.append('<div class="menu-groups"><span class="fa fa-list" style="font-weight:900 !important;"></span> &nbsp;'+t("SUGGESTED SITES")+"</div>")),c.Browser.MenuCreator(i.Nodes,l,i.menus[n.menu],i.menu_categories)&&a.removeClass("d-none")})),e.children("#mnu_obj").removeClass("d-none"),i.enable_disable_menus()},showHelp:function(e,t,i,n){if("object_help"==e){var l=i.getTreeNodeHierarchy(n).server,s=w.utils.pg_help_path;"ppas"==l.server_type&&(s=w.utils.edbas_help_path);var o=m.getHelpUrl(s,t,l.version,l.server_type);window.open(o,"postgres_help")}else"dialog_help"==e&&(b&&b.default?b.default.open(t,"pgadmin_help"):window.open(t,"pgadmin_help"));a("#live-search-field").focus()},_findTreeChildNode:function(e,t,i){var n=i.t.wasLoad(e),a=function(){for(var n,a,l,s=i.t.children(e),o=0,d=s.length;o<d;o++)if(n=s.eq(o),(a=i.t.itemData(n))._type===t._type){if(!i.hasId||a._id==t._id)return i.i=n,i.d=t,i.pathOfTreeItems.push({coll:!1,item:n,d:t}),void i.success()}else if((l=i.b.Nodes[a._type])&&l.collection_node&&a.nodes&&-1!=r.indexOf(a.nodes,t._type))return i.i=n,i.d=null,i.pathOfTreeItems.push({coll:!0,item:n,d:a}),i.t.isInode(n)||(i.load=!1),void i.b._findTreeChildNode(n,t,i);i.notFound&&"function"==typeof i.notFound&&i.notFound(t)};!n&&i.load?i.t.open(e,{success:a,unanimated:!0,fail:function(){var e=i&&i.o&&i.o.fail;e&&"function"==typeof e&&e.apply(i.t,[])}}):n?a():i.notFound&&"function"==typeof i.notFound&&i.notFound(t)},onAddTreeNode:function(e,t,i){var n={b:this,d:null,hasId:!0,i:null,p:r.toArray(t||{}).sort((function(e,t){return e.priority===t.priority?0:e.priority<t.priority?-1:1})),pathOfTreeItems:[],t:this.tree,o:i},l=function(){var t,i=this;return i.success=l,i.p.length&&(t=i.p.shift(),i.p.length||(t._id=e._pid,i.success=s),i.b._findTreeChildNode(i.i,t,i),e._pid||s.apply(i,arguments)),!0}.bind(n),s=function(){var t=this,i=(t.i||this.t.wasLoad(t.i))&&this.t.first(t.i),n=function(t,i){var n=this;n.success=t,n.notFound=i,n.b._findTreeChildNode(n.i,e,n)}.bind(t),l=function(){this.t.openPath(this.i),this.t.select(this.i),t.o&&t.o.success&&"function"==typeof t.o.success&&t.o.success.apply(t.t,[t.i,e])}.bind(t),s=function(){var t,i=this,n=i.t.children(i.i),l=0,s=n.length-1;if(function(){for(var a,o;s-l>22;){if(t=n.eq(l),"column"===(a=i.t.itemData(t))._type){if(-1!=c.numeric_comparator(a._id,e._id))return!0}else if(-1!=c.natural_sort(a._label,e._label))return!0;t=n.eq(s);var r=void 0;if(1!=(r="column"===(a=i.t.itemData(t))._type?c.numeric_comparator(a._id,e._id):c.natural_sort(a._label,e._label)))return s!=n.length-1?(t=n.eq(s+1),!0):(t=null,!1);if(o=l+Math.round((s-l)/2),t=n.eq(o),0==(r="column"===(a=i.t.itemData(t))._type?c.numeric_comparator(a._id,e._id):c.natural_sort(a._label,e._label)))return!0;-1==r?(l=o+1,s--):(l++,s=o-1)}return function(){for(;s>=l;){t=n.eq(l);var a=i.t.itemData(t);if("column"===a._type){if(1==c.numeric_comparator(a._id,e._id))return!0}else if(1==c.natural_sort(a._label,e._label))return!0;l++}return s!=n.length-1?(t=n.eq(s+1),!0):(t=null,!1)}()}())i.t.before(t,{itemData:e,success:function(){i.o&&i.o.success&&"function"==typeof i.o.success&&i.o.success.apply(i.t,[t,e])},fail:function(){console.warn("Failed to add before...",arguments),i.o&&i.o.fail&&"function"==typeof i.o.fail&&i.o.fail.apply(i.t,[t,e])}});else{var o=function(){var t=this,i=t.t.wasLoad(t.i),n=t.t.itemData(t.i);t.t.append(t.i,{itemData:e,success:function(l,s){var o=a(s.items[0]);i&&n&&n._type.search(e._type)>-1?(t.t.openPath(o),t.t.select(o)):n&&t.t.unload(t.i,{success:function(e){t.t.open(e)}}),t.o&&t.o.success&&"function"==typeof t.o.success&&t.o.success.apply(t.t,[o,e])},fail:function(){console.warn("Failed to append...",arguments),t.o&&t.o.fail&&"function"==typeof t.o.fail&&t.o.fail.apply(t.t,[t.i,e])}})}.bind(i);i.i&&!i.t.isInode(i.i)?i.t.setInode(i.i,{success:o}):o()}}.bind(t);i||!t.t.wasLoad(t.i)?n(l,s):t.t.unload(t.i,{success:function(){n(l,function(){var t=this&&this.o;t&&t.fail&&"function"==typeof t.fail&&t.fail.apply(this.t,[this.i,e])}.bind(this))}.bind(this),fail:function(){var t=this&&this.o;t&&t.fail&&"function"==typeof t.fail&&t.fail.apply(this.t,[this.i,e])}.bind(this)})}.bind(n);n.t.wasInit()&&e&&(e._label=e.label,e.label=r.escape(e.label),l())},onUpdateTreeNode:function(e,t,i,n){var l={b:this,d:null,i:null,hasId:!0,p:r.toArray(i||{}).sort((function(e,t){return e.priority===t.priority?0:e.priority<t.priority?-1:1})),pathOfTreeItems:[],t:this.tree,o:n,load:!0,old:e,new:t,op:null},s=function(){var i=this.o&&this.o.fail;i&&"function"==typeof i&&i.apply(this.t,[this.i,t,e])}.bind(l),o=function(){var e=this,t=this.pathOfTreeItems,i=function(){if(t.length){t.pop();var e=t.length;this.i=e&&t[e-1].item||null,this.d=e&&t[e-1].d||null,e&&t[e-1].coll&&(t.pop(),e=t.length,this.i=e&&t[e-1].item||null,this.d=e&&t[e-1].d||null)}else this.i=null,this.d=null}.bind(this),n=this.i&&this.t.hasParent(this.i)&&this.t.parent(this.i)||null,o=n?this.t.hasParent(n)&&this.t.parent(n):null;if(this.i&&this.d&&this.old._id==this.d._id&&this.old._type==this.d._type){var d=this.t.parent(this.i)||null;if(d&&0==d.length&&"UPDATE"==l.op)u();else{var c=function(){if(!n||o){var t=this.d;return i(),void(this.i?(this.load=!0,this.success=function(){h()}.bind(this),this.notFound=s,this.b._findTreeChildNode(this.i,{_id:this.new._pid,_type:t._type},this)):h())}var l=null,d=this.t.siblings(this.i)||[];if(d.push(this.i[0]),r.each(d,(function(t){var i=e.t.itemData(a(t));i._id==e.new._pid&&(l=t,e.pathOfTreeItems.push({coll:!0,item:l,d:i}))})),l){this.load=!0,this.success=function(){h()}.bind(this),this.notFound=s,l=a(l);var c=function(){e.i=l,e.pathOfTreeItems.push({coll:!1,item:l,d:e.d}),e.success()};!this.t.wasLoad(l)&&e.load?e.t.open(l,{success:c,unanimated:!0,fail:function(){var t=e&&e.o&&e.o.fail;t&&"function"==typeof t&&t.apply(e.t,[])}}):c()}}.bind(this);this.t.remove(this.i,{success:function(){return i(),n&&!o&&d&&0==e.t.children(d).length?e.t.setInode(d,{success:function(){e.t.unload(d,{success:function(){setTimeout(c)}})}}):setTimeout(c),!0}})}}s()}.bind(l),d=function(e){var t=function(){var e=this.pathOfTreeItems;if(e.length){e.pop();var t=e.length;this.i=t&&e[t-1].item||null,this.d=t&&e[t-1].d||null,t&&e[t-1].coll&&(e.pop(),t=e.length,this.i=t&&e[t-1].item||null,this.d=t&&e[t-1].d||null)}else this.i=null,this.d=null}.bind(this);this.i?(this.load=!0,this.success=function(){h()}.bind(this),e._type==this.old._type&&(t(),e=this.d,t()),e=this.new._pid,this.notFound=s,this.b._findTreeChildNode(this.i,e,this)):h()}.bind(l),u=function(){if(this.i&&this.d&&this.new._type==this.d._type){var i=this,n=this.d._id;if(this.new._id!=this.d._id)this.t.itemData(l.i)._id=n=this.new._id;this.new._id==n&&(r.extend(this.d,{_id:this.new._id,_label:this.new._label,label:this.new.label}),this.t.setLabel(l.i,{label:this.new.label}),this.t.addIcon(l.i,{icon:this.new.icon}),this.t.setId(l.i,{id:this.new.id}),this.t.openPath(this.i),this.t.deselect(this.i),setTimeout((function(){i.t.select(i.i)}),10))}var a=this.o&&this.o.success;a&&"function"==typeof a&&a.apply(this.t,[this.i,e,t])}.bind(l),p=function(){var e,t=this;return t.success=p,t.p.length?(e=t.p.shift(),t.p.length||("RECREATE"==t.op?(t.load=!1,t.success=o,t.notFound=d):(t.success=u,t.notFound=s)),t.b._findTreeChildNode(t.i,e,t)):1==t.p.length&&(t.notFound=d),!0}.bind(l),h=function(){var i=this,n=(i.i||this.t.wasLoad(i.i))&&this.t.first(i.i),l=function(e,i){var n=this;n.success=e,n.notFound=i,n.b._findTreeChildNode(n.i,t,n)}.bind(i),s=function(){this.t.openPath(this.i),this.t.select(this.i),i.o&&i.o.success&&"function"==typeof i.o.success&&i.o.success.apply(i.t,[i.i,t])}.bind(i),o=function(){var i,n=this,l=n.t.children(n.i),s=0,o=l.length-1;if(function(){for(;o-s>22;){i=l.eq(s);var e=n.t.itemData(i);if("column"===e._type){if(-1!=c.numeric_comparator(e._id,t._id))return!0}else if(-1!=c.natural_sort(e._label,t._label))return!0;i=l.eq(o);var a=void 0;if(1!=(a="column"===(e=n.t.itemData(i))._type?c.numeric_comparator(e._id,t._id):c.natural_sort(e._label,t._label)))return o!=l.length-1?(i=l.eq(o+1),!0):(i=null,!1);var r=s+Math.round((o-s)/2);if(i=l.eq(r),0==(a="column"===(e=n.t.itemData(i))._type?c.numeric_comparator(e._id,t._id):c.natural_sort(e._label,t._label)))return!0;-1==a?(s=r+1,o--):(s++,o=r-1)}return function(){for(;o>=s;){i=l.eq(s);var e=n.t.itemData(i);if("column"===e._type){if(1==c.numeric_comparator(e._id,t._id))return!0}else if(1==c.natural_sort(e._label,t._label))return!0;s++}return o!=l.length-1?(i=l.eq(o+1),!0):(i=null,!1)}()}())n.t.before(i,{itemData:t,success:function(){var l=a(arguments[1].items[0]);n.t.openPath(l),n.t.select(l),n.o&&n.o.success&&"function"==typeof n.o.success&&n.o.success.apply(n.t,[i,e,t])},fail:function(){console.warn("Failed to add before..",arguments),n.o&&n.o.fail&&"function"==typeof n.o.fail&&n.o.fail.apply(n.t,[i,e,t])}});else{var r=function(){n.t.append(n.i,{itemData:t,success:function(){var i=a(arguments[1].items[0]);n.t.openPath(i),n.t.select(i),n.o&&n.o.success&&"function"==typeof n.o.success&&n.o.success.apply(n.t,[n.i,e,t])},fail:function(){console.warn("Failed to append...",arguments),n.o&&n.o.fail&&"function"==typeof n.o.fail&&n.o.fail.apply(n.t,[n.i,e,t])}})};n.i&&!n.t.isInode(n.i)?n.t.setInode(n.i,{success:r}):r()}}.bind(i);n||!i.t.wasLoad(i.i)?l(s,o):i.t.unload(i.i,{success:function(){l(s,function(){var i=this&&this.o;i&&i.fail&&"function"==typeof i.fail&&i.fail.apply(this.t,[this.i,e,t])}.bind(this))}.bind(this),fail:function(){var i=this&&this.o;i&&i.fail&&"function"==typeof i.fail&&i.fail.apply(this.t,[this.i,e,t])}.bind(this)})}.bind(l);l.t.wasInit()&&t&&e&&(l.pathOfTreeItems.push(e),t._label=t.label,t.label=r.escape(t.label),l.b.Nodes[t._type].is_collection&&"collection_count"in e&&e.collection_count>0&&(t.label=r.escape(t._label)+" <span>("+e.collection_count+")</span>"),"server"==e._type&&"server"==t._type&&(e._pid!=t._pid||e._label!=t._label||e.icon!=t.icon)||e._pid!=t._pid||e._label!=t._label||e._id!=t._id?(l.op="RECREATE",p()):(l.op="UPDATE",p()))},onRefreshTreeNode:function(e,i){var n,l=e&&this.tree.itemData(e),s=l&&l._type&&this.Nodes[l._type],o={b:this,d:l,i:e,p:null,pathOfTreeItems:[],t:this.tree,o:i},d=-1;if(this.Events.trigger("pgadmin-browser:tree:refreshing",e,l,s),s?n=this.tree.isInode(e)&&this.tree.isOpen(e):(e=null,o.i=null,o.d=null),o.branch=o.t.serialize(e,{},(function(e,t,i){if(!++d||i.inode&&i.open)return{_id:i._id,_type:i._type,branch:i.branch,open:i.open}})),s){var c=function(e,i,n){var l=n.getTreeNodeHierarchy(e),s=n.generate_url(e,"nodes",i,!0);a.ajax({url:s,type:"GET",cache:!1,dataType:"json"}).done((function(e){var t=e.result||e.data;t._label=t.label,t.label=r.escape(t.label),o.t.setLabel(o.i,{label:t.label}),o.t.addIcon(o.i,{icon:t.icon}),o.t.setId(o.i,{id:t.id}),t.inode&&o.t.setInode(o.i,{inode:!0});var i=o.t.itemData(o.i);if(r.extend(i,t),!n.can_expand||"function"!=typeof n.can_expand||n.can_expand(i)){o.b._refreshNode(o,o.branch);var a=o.o&&o.o.success||o.success;a&&"function"==typeof a&&a()}else o.t.unload(o.i)})).fail((function(a,s,r){if(!u.pgHandleItemError(a,s,r,{item:e,info:l})){var d=a.getResponseHeader("Content-Type"),p=d&&0==d.indexOf("application/json")&&JSON.parse(a.responseText)||{};if(410==a.status&&0==p.success){var h=o.t.parent(o.i);o.t.remove(o.i,{success:function(){if(h)try{w.Events.trigger("pgadmin:browser:tree:refresh",h)}catch(e){console.warn(e.stack||e)}}})}u.pgNotifier(s,a,t("Error retrieving details for the node."),(function(t){"CRYPTKEY_SET"==t?c(e,i,n):console.warn(arguments)}))}}))}.bind(this);if(s&&s.collection_node){var p=o.i=this.tree.parent(e),h=function(){this.tree.unload(e,{success:function(){e=p,l=o.d=o.t.itemData(o.i),s=o.b.Nodes[l._type],c(e=p,l,s)},fail:function(){console.warn(arguments)}})}.bind(this);this.tree.isInode(e)?h():this.tree.setInode(e,{success:h})}else n?this.tree.unload(e,{success:c.bind(this,e,l,s),fail:function(){console.warn(arguments)}}):!this.tree.isInode(e)&&l.inode?this.tree.setInode(e,{success:c.bind(this,e,l,s),fail:function(){console.warn(arguments)}}):c(e,l,s)}else o.t.destroy({success:function(){E(o.b),o.t=o.b.tree,o.i=null,o.b._refreshNode(o,o.branch)},error:function(){var e=i.o&&i.o.fail||i.fail;"function"==typeof e&&e()}})},onLoadFailNode:function(e){var t=this,i=t.tree.isSelected(e);t.check_master_password((function(n){n||t.set_master_password("",(function(){i&&t.tree.select(e),t.tree.open(e)}))}))},removeChildTreeNodesById:function(e,t,i){var n=w.tree;if(e&&t){var a,l,s=n.children(e),o=0,r=s.length;for(e=null;o<r;o++)if(a=s.eq(o),(l=n.itemData(a))._type==t){e=a;break}}if(e){for(o=0,r=(s=n.children(e)).length;o<r;o++)a=s.eq(o),l=n.itemData(a),-1!=i.indexOf(l._id)&&w.removeTreeNode(a,!1,e);return!0}return!1},removeTreeNode:function(e,t,i){var n=w.tree,a=null;return!!e&&(t&&((a=n.next(e))&&a.length||(a=n.prev(e))&&a.length||(a=i||n.parent(e)),a&&n.select(a)),n.remove(e),!0)},findSiblingTreeNode:function(e,t){for(var i,n,a=w.tree,l=a.parent(e),s=a.children(l),o=0;o<s.length;o++)if(n=s.eq(o),(i=a.itemData(n))&&i._id==t)return n;return null},findParentTreeNodeByType:function(e,t){var i,n=w.tree,a=e;do{if((i=n.itemData(a))&&i._type==t)return a;a=n.hasParent(a)?n.parent(a):null}while(a);return null},findChildCollectionTreeNode:function(e,t){var i,n,a=w.tree,l=0,s=e&&a.children(e);if(!s||!s.length)return null;for(;l<s.length;l++)if(n=s.eq(l),(i=a.itemData(n))&&i._type==t)return n;return null},addChildTreeNodes:function(e,t,i,n,l){var s=i in w.Nodes&&w.Nodes[i],o=n.length&&r.extend({},r.mapObject(e,(function(e){return e.priority-=1,e}))),d=[],c=function e(t){if(n.length){var r,c={_id:n.pop(),_type:i,priority:0};o[i]=c,r=s.generate_url(null,"nodes",c,!0,o),a.ajax({url:r,dataType:"json"}).done((function(t){t.success&&d.push(t.data),e(l)})).fail((function(t,i,n){u.pgRespErrorNotify(t,n),e(l)}))}else t&&t()};s?w.tree.wasLoad(t)||w.tree.isLeaf(t)?c((function(){r.each(d,(function(t){w.Events.trigger("pgadmin:browser:tree:add",t,e)})),l&&l()})):l&&l():console.warn("Developer: Couldn't find the module for the given child: ",r.clone(arguments))},_refreshNode:function(e,t){var i=function(e){for(var t,i,n=this,a=0,l=e.branch&&e.branch.length||0,s=function(e,t,i){setTimeout((function(){i.b._findTreeChildNode(e,t,i)}),0)};a<l;a++){i=e.branch[a];var o=n.b.Nodes[i._type];(t={b:n.b,t:n.t,pathOfTreeItems:[],i:n.i,d:i,select:n.select,hasId:o&&!o.collection_node,o:n.o,load:!0}).success=function(){this.b._refreshNode.call(this.b,this,this.d)}.bind(t),s(n.i,i,t)}}.bind(e,t);t&&t.open&&(e.t.isOpen(e.i)?i():e.t.open(e.i,{unanimated:!0,success:i,fail:function(){}}))},editor_shortcut_keys:{"Ctrl-Space":"autocomplete","Cmd-Space":"autocomplete","Alt-Up":"goLineUp","Alt-Down":"goLineDown","Ctrl-Alt-Left":"goGroupLeft","Cmd-Alt-Left":"goGroupLeft","Ctrl-Alt-Right":"goGroupRight","Cmd-Alt-Right":"goGroupRight","Shift-Tab":"indentLess"},editor_options:{tabSize:parseInt(w.utils.tabSize),wrapCode:w.utils.wrapCode,insert_pair_brackets:w.utils.insertPairBrackets,brace_matching:w.utils.braceMatching,indent_with_tabs:w.utils.is_indent_with_tabs},get_browser:function(){var e,t=navigator.userAgent,i=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(i[1])?{name:"IE",version:(e=/\brv[ :]+(\d+)/g.exec(t)||[])[1]||""}:"Chrome"===i[1]&&null!=(e=t.match(/\bOPR|Edge\/(\d+)/))?{name:e[0],version:e[1]}:(i=i[2]?[i[1],i[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&i.splice(1,1,e[1]),{name:i[0],version:i[1]})}}),delete _.keyMap.emacsy["Ctrl-V"],"True"==w.utils.useSpaces&&(c.Browser.editor_shortcut_keys.Tab="insertSoftTab"),setTimeout((function(){a("#mnu_about").closest("li").before('<li class="dropdown-divider"></li>')}),100),c.Browser}.apply(t,n))||(e.exports=a)},50159:(e,t,i)=>{"use strict";var n,a;i(82772),i(69826),i(24812),i(69600),i(5735),i(83753),i(68309),i(92222),i(89554),i(54747),i(32564),i(40561),i(21249),n=[i(91669),i(19755),i(81311),i(55112),i(72316),i(58307),i(95283),i(83879),i(61329),i(12030),i(71158),i(88941),i(14753)],void 0===(a=function(e,t,i,n,a,l,s,o,r){var d=n.Browser=n.Browser||{};return d.Collection||(d.Collection=function(){},i.extend(d.Collection,i.clone(d.Node),{Init:function(){this.node_initialized||(this.node_initialized=!0,n.Browser.add_menus([{name:"refresh",node:this.type,module:this,applies:["object","context"],callback:"refresh",priority:1,label:e("Refresh..."),icon:"fa fa-sync-alt"}]),n.unsupported_nodes&&-1==i.indexOf(n.unsupported_nodes,this.type)&&("database"==this.type&&this.allowConn||"database"!=this.type)&&(n.Browser.add_menus([{name:"show_query_tool",node:this.type,module:this,applies:["context"],callback:"show_query_tool",priority:998,label:e("Query Tool"),icon:"pg-font-icon icon-query_tool"}]),n.Browser.add_menus([{name:"search_objects",node:this.type,module:this,applies:["context"],callback:"show_search_objects",priority:997,label:e("Search Objects..."),icon:"fa fa-search"}]),n.enable_psql&&n.Browser.add_menus([{name:"show_psql_tool",node:this.type,module:this,applies:["context"],callback:"show_psql_tool",priority:998,label:e("PSQL Tool (Beta)"),icon:"fas fa-terminal"}])))},hasId:!1,is_collection:!0,collection_node:!0,hasCollectiveStatistics:!0,canDrop:!0,canDropCascade:!0,selectParentNodeOnDelete:!1,showProperties:function(a,r,c){var u=this,p=c.$container.find(".obj_properties").first(),h=p.data("obj-view"),f=t("<div></div>").addClass("pg-prop-content col-12 has-pg-prop-btn-group"),m=d.Nodes[u.node],g="",v=this.generate_url(a,"properties",r),b=this.getTreeNodeHierarchy.apply(this,[a]),y=s.generateGridColumnsFromModel(b,m.model,"properties",u.columns),C=function(e,n,a){if(e&&i.isArray(e)&&e.length>0){var l=t('<div class="pg-prop-btn-group"></div>'),s=i.template(['<button tabindex="0" type="<%= type %>" ',"class=\"btn <%=extraClasses.join(' ')%>\"",'<% if (disabled) { %> disabled="disabled"<% } %> title="<%-tooltip%>">','<span class="<%= icon %>" role="img"></span><% if (label != "") { %>&nbsp;<%-label%><% } %><span class="sr-only"><%-tooltip%></span></button>'].join(" "));return"header"==n?l.appendTo(u.header):l.appendTo(u.footer),a&&l.addClass(a),i.each(e,(function(e){e.icon||(e.icon="");var i=t(s(e));l.append(i),e.register(i)})),l}return null}.bind(c);u.collection=new(m.Collection.extend({url:v,model:m.model})),((i.isFunction(u.canDrop)?u.canDrop.apply(u,[r,a]):u.canDrop)||(i.isFunction(u.canDropCascade)?u.canDropCascade.apply(u,[r,a]):u.canDropCascade))&&y.columns.unshift({name:"oid",cell:o.Extension.SelectRowCell.extend({initialize:function(e){this.column=e.column,this.column instanceof o.Column||(this.column=new o.Column(this.column));var t=this.column,i=this.model,n=this.$el;this.listenTo(t,"change:renderable",(function(e,t){n.toggleClass("renderable",t)})),o.callByNeed(t.renderable(),t,i)&&n.addClass("renderable width_percent_3"),this.listenTo(i,"backgrid:select",this.toggleCheckbox)},toggleCheckbox:function(e,t){!1===this.checkbox().prop("disabled")&&this.checkbox().prop("checked",t).change()},render:function(){var t=this.model.toJSON(),n="canDrop"in t&&!1===t.canDrop,a="row-".concat(i.uniqueId(t.oid||t.name));return this.$el.empty().append('\n                  <div class="custom-control custom-checkbox custom-checkbox-no-label">\n                    <input tabindex="-1" type="checkbox" class="custom-control-input" id="'.concat(a,'" ').concat(n?"disabled":"",'/>\n                    <label class="custom-control-label" for="').concat(a,'">\n                      <span class="sr-only">')+e("Select")+"<span>\n                    </label>\n                  </div>\n                "),this.delegateEvents(),this}}),headerCell:o.Extension.SelectAllHeaderCell}),y.columns.forEach((function(e){e.disabled=!0}));var _=[];!i.isUndefined(u.grid)&&"collection"in u.grid&&(_=u.grid.getSelectedModels()),u.grid=new o.Grid({emptyText:e("No data found"),columns:y.columns,collection:u.collection,className:"backgrid table presentation table-bordered table-noouter-border table-hover"});var w={remove:function(){this.grid&&(this.grid.collection&&(this.grid.collection.reset([],{silent:!0}),delete this.grid.collection),delete this.grid,this.grid=null)},grid:u.grid};h&&(t(c).data("node-prop",v),p.data("obj-view",null)),p.empty(),p.data("obj-view",w),g='<div role="status" class="pg-panel-message pg-panel-properties-message">'+e("Retrieving data from the server...")+"</div>",g=t(g).appendTo(p),u.header=t("<div></div>").addClass("pg-prop-header");var x,k=[];k.push({label:"",type:"delete",tooltip:e("Delete/Drop"),extraClasses:["btn-primary-icon m-1","delete_multiple"],icon:"fa fa-trash-alt",disabled:i.isFunction(u.canDrop)?!u.canDrop.apply(self,[r,a]):!u.canDrop,register:function(e){e.on("click",(function(){N("drop")}))}}),k.push({label:"",type:"delete",tooltip:e("Drop Cascade"),extraClasses:["btn-primary-icon m-1","delete_multiple_cascade"],icon:"pg-font-icon icon-drop_cascade",disabled:i.isFunction(u.canDropCascade)?!u.canDropCascade.apply(self,[r,a]):!u.canDropCascade,register:function(e){e.on("click",(function(){N("dropCascade")}))}}),C(k,"header","pg-prop-btn-group-above"),f.append('<div class="pg-prop-coll-container"></div>'),f.find(".pg-prop-coll-container").append(u.grid.render().$el);!function s(){t.ajax({url:v,type:"GET",beforeSend:function(t){t.setRequestHeader(n.csrf_token_header,n.csrf_token),x=setTimeout((function(){"Failed to retrieve data from the server."==!g.text()&&g.text(e("Retrieving data from the server...")),g.removeClass("d-none"),self.grid&&self.grid.remove()}),1e3)}}).done((function(n){clearTimeout(x),i.isUndefined(u.grid)||i.isNull(u.grid)||(u.data=n,u.data.length>0?(g.hasClass("d-none")||g.addClass("d-none"),u.header.appendTo(p),p.append(f),t(".pg-prop-content").on("scroll",u.__loadMoreRows.bind(u)),u.collection.reset(u.data.splice(0,50)),u.collection.on("backgrid:select-all",u.__loadAllRows.bind(u)),_.length>0&&u.collection.each((function(e){for(var t=0;t<_.length;t++)_[t].id==e.id&&e.trigger("backgrid:select",e,!0)}))):(t(".pg-prop-content").off("scroll",u.__loadMoreRows),g.text(e("No properties are available for the selected object."))),_=[])})).fail((function(t,i){d.Events.trigger("pgadmin:node:retrieval:error","properties",t,i.message,a,u),l.pgHandleItemError(t,i.message,{item:a,info:b})||l.pgNotifier(i,t,e("Error retrieving properties - %s",i.message||u.label),(function(e){"CRYPTKEY_SET"===e?s():console.warn(arguments)})),g.text(e("Failed to retrieve data from the server."))}))}();var N=function(i){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=this.grid.getSelectedModels(),s=[],o=d.tree.selected(),r=o?d.tree.itemData(o):null,c=r&&d.Nodes[r._type],u=void 0,p=void 0,h=void 0;if(0!==(s=c&&c.type&&"coll-constraints"==c.type?a.map((function(e){return{id:e.get("oid"),_type:e.get("_type")}})):a.map((function(e){return e.id}))).length){if(c){"dropCascade"===i?(u=c.generate_url(o,"delete"),p=e("Are you sure you want to drop all the selected objects and all the objects that depend on them?"),h=e("DROP CASCADE multiple objects?")):(u=c.generate_url(o,"drop"),p=e("Are you sure you want to drop all the selected objects?"),h=e("DROP multiple objects?"));var f=function(){t.ajax({url:u,type:"DELETE",data:JSON.stringify({ids:s}),contentType:"application/json; charset=utf-8"}).done((function(e){return 0==e.success?d.report_error(e.errormsg,e.info):(t(d.panels.properties.panel).removeData("node-prop"),d.Events.trigger("pgadmin:browser:tree:refresh",o||d.tree.selected(),{success:function(){c.callbacks.selected.apply(c,[o])}})),!0})).fail((function(n,a){l.pgNotifier(a,n,e("Error dropping %s",r._label.toLowerCase()),(function(e){"CRYPTKEY_SET"==e?N(i,!1):(t(d.panels.properties.panel).removeData("node-prop"),d.Events.trigger("pgadmin:browser:tree:refresh",o||d.tree.selected(),{success:function(){c.callbacks.selected.apply(c,[o])}}))}))}))};n?l.confirm(h,p,f,null).show():f()}}else l.alert(e("Drop Multiple"),e("Please select at least one object to delete."))}.bind(u)},__loadMoreRows:function(e){var t=e.currentTarget;t.scrollHeight-10<t.scrollTop+t.offsetHeight&&this.data.length>0&&this.collection.add(this.data.splice(0,50))},__loadAllRows:function(e,t){this.data.length>0&&(this.collection.add(this.data),this.collection.each((function(e){e.trigger("backgrid:select",e,t)})))},generate_url:function(e,t){var i={properties:"obj",children:"nodes",drop:"obj"},a=this,l=this.getTreeNodeHierarchy(e),s=t in i?i[t]:t;return r.generate_url(n.Browser.URL,l,s,a.node,(function(e,t){return t!=a.type}))},show_query_tool:function(){n.DataGrid&&n.DataGrid.show_query_tool("",n.Browser.tree.selected())},show_search_objects:function(){n.SearchObjects&&n.SearchObjects.show_search_objects("",n.Browser.tree.selected())},show_psql_tool:function(e){var t=e||{},i=d.tree,n=t.item||i.selected(),a=n&&1==n.length?i.itemData(n):void 0;d.psql.psql_tool(a,n,!0)}})),d.Collection}.apply(t,n))||(e.exports=a)},87377:(e,t,i)=>{"use strict";var n,a;function l(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,r=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return o=e.done,e},e:function(e){r=!0,l=e},f:function(){try{o||null==i.return||i.return()}finally{if(r)throw l}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}i(82526),i(41817),i(32165),i(78783),i(47042),i(91038),i(79753),i(66992),i(41539),i(33948),i(68309),i(5212),i(83710),i(39714),i(5735),i(83753),i(34553),i(32564),i(69826),i(24603),i(74916),i(40561),i(47941),n=[i(81311),i(55112),i(19755),i(72316),i(44092)],void 0===(a=function(e,t,i,n,a){var s=t.Browser=t.Browser||{};return s.DataModel=n.Model.extend({on_server:!1,parse:function(t){var i=this;t&&e.isObject(t)&&"node"in t&&t.node&&(i.tnode=e.extend({},t.node),delete t.node);return function a(l){l&&e.isArray(l)&&e.each(l,(function(l){var o,r;switch(l.type){case"collection":o=i.get(l.id),r=t[l.id],e.isArray(r)||e.isObject(r)?o&&o instanceof n.Collection?o.reset(r,{silent:!0,parse:!0,on_server:!0}):(o=new s.Node.Collection(r,{model:e.isString(l.model)&&l.model in s.Nodes?s.Nodes[l.model].model:l.model,top:i.top||i,handler:i,parse:!0,silent:!0,attrName:l.id}),i.set(l.id,o,{silent:!0,parse:!0,on_server:!0})):o=null,i.set(l.id,o,{silent:!0}),t[l.id]=o;break;case"model":o=i.get(l.id),r=t[l.id],e.isUndefined(r)||e.isNull(r)?o=null:(o&&o instanceof n.Model||(o=e.isString(l.model)&&l.model in s.Nodes[l.model]?new s.Nodes[l.model].Model(o,{silent:!0,top:i.top||i,handler:i,attrName:l.id}):new l.model(o,{silent:!0,top:i.top||i,handler:i,attrName:l.id})),o.set(r,{parse:!0,silent:!0})),t[l.id]=o;break;case"nested":a(l.schema)}}))}(i.schema),t},isNew:function(){return this.has(this.idAttribute)?!this.has(this.idAttribute):!this.on_server},primary_key:function(){if(this.keys&&e.isArray(this.keys)){var t={},i=this;return e.each(i.keys,(function(e){t[e]=i.attributes[e]})),JSON.stringify(t)}return this.cid},initialize:function(t,i){var a,l=this;l._previous_key_values={},!e.isUndefined(i)&&"on_server"in i&&i.on_server&&(l.on_server=!0),n.Model.prototype.initialize.apply(l,arguments),(e.isUndefined(i)||e.isNull(i))&&(i=t||{}),l.sessAttrs={},l.fieldData={},l.origSessAttrs={},l.objects=[],l.arrays=[],l.attrName=i.attrName,l.top=i.top||l.collection&&l.collection.top||l.collection||l,l.handler=i.handler||l.collection&&l.collection.handler,l.trackChanges=!1,l.errorModel=new n.Model,l.node_info=i.node_info;var o=function t(i){i&&e.isArray(i)&&e.each(i,(function(i){switch(i.type){case"int":case"numeric":l.fieldData[i.id]={id:i.id,label:i.label,type:i.type,min:e.isUndefined(i.min)?void 0:i.min,max:e.isUndefined(i.max)?void 0:i.max};break;default:l.fieldData[i.id]={id:i.id,label:i.label,type:i.type}}switch(i.type){case"array":l.arrays.push(i.id);break;case"collection":if(!((a=l.get(i.id))&&a instanceof s.Node.Collection))if(e.isString(i.model)&&i.model in s.Nodes){var o=s.Nodes[i.model];a=new o.Collection(a,{model:o.model,top:l.top||l,handler:l,attrName:i.id})}else a=new s.Node.Collection(a,{model:i.model,top:l.top||l,handler:l,attrName:i.id});a.name=i.id,l.objects.push(i.id),l.set(i.id,a,{silent:!0});break;case"model":(a=l.get(i.id))&&a instanceof n.Model||(a=e.isString(i.model)&&i.model in s.Nodes[i.model]?new s.Nodes[i.model].Model(a,{top:l.top||l,handler:l,attrName:i.id}):new i.model(a,{top:l.top||l,handler:l,attrName:i.id})),a.name=i.id,l.objects.push(i.id),l.set(i.id,a,{silent:!0});break;case"nested":t(i.schema);break;default:return}}))};return o(l.schema),l.handler&&l.handler.trackChanges&&l.startNewSession(),"keys"in l&&e.isArray(l.keys)&&e.each(l.keys,(function(e){l.on("change:"+e,(function(t){l._previous_key_values[e]=t.previous(e)}))})),l},reset:function(e){var t,i=!(!e||!e.reindex);if(e&&e.stop&&this.stopSession(),i){for(var a in this.objects)(t=this.get(a))&&(t instanceof s.DataModel?t.reset(e):t instanceof n.Model?t.clear(e):t instanceof s.DataCollection?t.reset([],e):t instanceof n.Collection&&(t.each((function(i){i instanceof n.DataModel&&(t.reset(),t.clear(e))})),n.Collection.prototype.reset.call(t,[],e)));n.Collection.prototype.reset.apply(this,arguments)}},sessChanged:function(){var t=this;return e.size(t.sessAttrs)>0||e.some(t.objects,(function(i){var n=t.get(i);return!e.isNull(n)&&!e.isUndefined(n)&&n.sessChanged()}))},sessValid:function(){var t=this;return(!("default_validate"in t)||"function"!=typeof t.default_validate||!e.isString(t.default_validate()))&&!("validate"in t&&e.isFunction(t.validate)&&e.isString(t.validate.apply(t)))},set:function(t,i,a){var l=e.isObject(t)?i:a;this._changing=!0,this._previousAttributes=e.clone(this.attributes),this.changed={};var s=n.Model.prototype.set.call(this,t,i,a);if(this._changing=!1,l&&l.internal||!this.trackChanges)return!0;if(null!=t&&s){var r,d={},c=this,u=function(t,i){if(!(i in c.objects)){d[i]=t;var n=c.origSessAttrs[i]&&t;e.isEqual(c.origSessAttrs[i],t)||null===c.origSessAttrs[i]&&""===t||n&&e.isEqual(c.origSessAttrs[i].toString(),t.toString())?delete c.sessAttrs[i]:c.sessAttrs[i]=t}};return"object"===o(t)?e.each(t,u):u(i,t),c.trigger("pgadmin-session:set",c,d),l&&l.silent||c.trigger("change",c,l),"default_validate"in c&&"function"==typeof c.default_validate&&(r=c.default_validate()),"validate"in c&&"function"==typeof c.validate&&(r||(r=c.validate(e.keys(d)))),0==e.size(c.errorModel.attributes)?c.collection||c.handler?(c.collection||c.handler).trigger("pgadmin-session:model:valid",c,c.collection||c.handler):c.trigger("pgadmin-session:valid",c.sessChanged(),c):(r=r||e.values(c.errorModel.attributes)[0],c.collection||c.handler?(c.collection||c.handler).trigger("pgadmin-session:model:invalid",r,c,c.collection||c.handler):c.trigger("pgadmin-session:invalid",r,c)),s}return s},toJSON:function(t,i){var a,l=this,s=l.isNew();return!(t=void 0!==t&&1==t)||s?a=n.Model.prototype.toJSON.call(this,arguments):((a={})[l.idAttribute||"_id"]=l.get(l.idAttribute||"_id"),a=e.extend(a,l.sessAttrs)),e.each(l.objects,(function(e){var n=l.get(e);t?a[e]instanceof Array?a[e]=JSON.stringify(a[e]):n&&n.sessChanged&&n.sessChanged()||s?(a[e]=n&&n.toJSON(!s),n&&i&&"GET"==i&&(a[e]=JSON.stringify(a[e]))):delete a[e]:a[e]instanceof Array||(a[e]=n&&n.toJSON())})),t&&e.each(l.arrays,(function(e){a[e]&&a[e]instanceof Array&&(a[e]=JSON.stringify(a[e]))})),a},startNewSession:function(){var t=this;t.trackChanges&&(t.trigger("pgadmin-session:stop",t),t.off("pgadmin-session:model:invalid",t.onChildInvalid),t.off("pgadmin-session:model:valid",t.onChildValid),t.off("pgadmin-session:changed",t.onChildChanged),t.off("pgadmin-session:added",t.onChildChanged),t.off("pgadmin-session:removed",t.onChildChanged)),t.trackChanges=!0,t.sessAttrs={},t.origSessAttrs=e.clone(t.attributes),e.each(t.objects,(function(i){var n=t.get(i);e.isUndefined(n)||e.isNull(n)||(delete t.origSessAttrs[i],n&&"startNewSession"in n&&e.isFunction(n.startNewSession)&&n.startNewSession())})),t.trigger("pgadmin-session:start",t),t.on("pgadmin-session:model:invalid",t.onChildInvalid),t.on("pgadmin-session:collection:changed",t.onChildCollectionChanged),t.on("pgadmin-session:model-msg:changed",t.onModelChangedMsg),t.on("pgadmin-session:model:valid",t.onChildValid),t.on("pgadmin-session:changed",t.onChildChanged),t.on("pgadmin-session:added",t.onChildChanged),t.on("pgadmin-session:removed",t.onChildChanged)},onChildInvalid:function(t,i){var n=this;if(n.trackChanges&&i){var a=i.attrName;if(!a){var l=i.primary_key&&"function"==typeof i.primary_key,s=l?i.primary_key():i.cid,o=l?function(e){var t=n.get("k");return!(!t||t.primary_key()!==s)&&(a=e,!0)}:function(e){return n.get(e).cid===s&&(a=e,!0)};e.findIndex(n.objects,o)}a&&(n.errorModel.set(a,t),n.handler?n.handler.trigger("pgadmin-session:model:invalid",t,n,n.handler):n.trigger("pgadmin-session:invalid",t,n))}return this},onChildValid:function(t){var i=this;if(i.trackChanges&&t){var a=t.attrName;if(!a){var l=t.primary_key&&"function"==typeof t.primary_key,s=l?t.primary_key():t.cid,o=l?function(e){var t=i.get("k");return!(!t||t.primary_key()!==s)&&(a=e,!0)}:function(e){var t=i.get("k");return!(!t||t.cid!==s)&&(a=e,!0)};e.findIndex(i.objects,o)}var r=null,d=function(t,i){return"default_validate"in t&&"function"==typeof t.default_validate&&(r=t.default_validate(),e.isString(r))?r:"validate"in t&&"function"==typeof t.validate?r=t.validate(i):null};if(t instanceof n.Collection){for(var c in t.models)if(d(t.models[c]))break}else t instanceof n.Model&&d(t);a&&i.errorModel.has(a)&&(r?i.errorModel.set(a,r):i.errorModel.unset(a)),0!=e.size(i.errorModel.attributes)||d(i,a&&[a])?(r=r||e.values(i.errorModel.attributes)[0],i.handler?(i.handler.trigger("pgadmin-session:model:invalid",r,i,i.handler),i.handler.trigger("pgadmin-session:collection:changed",i,i.handler)):(i.trigger("pgadmin-session:invalid",r,i),i.trigger("pgadmin-session:collection:changed",i))):i.handler?(i.handler.trigger("pgadmin-session:model:valid",i,i.handler),i.handler.trigger("pgadmin-session:collection:changed",i,i.handler)):(i.trigger("pgadmin-session:valid",i.sessChanged(),i),i.trigger("pgadmin-session:collection:changed",i.sessChanged(),i))}},onChildCollectionChanged:function(t,a){var s=this,o=this;setTimeout((function(){var t,r,d,c,u=null,p=o.collection||a;if(p){var h=p.attrName||p.name,f=i(".show.active div."+h);i(f).find(".error-in-grid").removeClass("error-in-grid");e:if(p instanceof n.Collection)for(var m in p.models){var g,v=p.models[m],b=l(v.objects);try{for(b.s();!(g=b.n()).done;){var y=g.value,C=v.attributes[y];if(C&&C.models.length>0)for(var _ in C.models)if(d=C.models[_],c=void 0,"default_validate"in d&&"function"==typeof d.default_validate&&(u=d.default_validate(),e.isString(u))?u:"validate"in d&&"function"==typeof d.validate&&(u=d.validate(c))){t=C.models[_],r=v.parentTr;break e}}}catch(e){b.e(e)}finally{b.f()}}}return u&&t&&(u=u||e.values(t.errorModel.attributes)[0],t.trigger("pgadmin-session:model:invalid",u,t),i(r).addClass("error-in-grid")),s}),120)},onChildChanged:function(e){var t=this;t.trackChanges&&t.collection&&t.collection.trigger("change",t),t.trigger("pgadmin-session:collection:changed",t,e)},stopSession:function(){var t=this;t.trackChanges&&(t.off("pgadmin-session:model:invalid",t.onChildInvalid),t.off("pgadmin-session:model:valid",t.onChildValid),t.off("pgadmin-session:changed",t.onChildChanged),t.off("pgadmin-session:added",t.onChildChanged),t.off("pgadmin-session:removed",t.onChildChanged),t.off("pgadmin-session:collection:changed",t.onChildCollectionChanged)),t.trackChanges=!1,t.sessAttrs={},t.origSessAttrs={},e.each(t.objects,(function(i){var n=t.get(i);e.isUndefined(n)||e.isNull(n)||(t.origSessAttrs[i]=null,delete t.origSessAttrs[i],n&&"stopSession"in n&&e.isFunction(n.stopSession)&&n.stopSession())})),t.trigger("pgadmin-session:stop")},default_validate:function(){for(var t,i,n,a,l=0,s=e.keys(this.attributes),o=s.length;l<o;l++)if(n=this.attributes[s[l]],i=this.fieldData[s[l]],t=null,e.isUndefined(n)||e.isNull(n)||""===String(n))i&&this.errorModel.unset(i.id);else{if(!i)continue;if(!(a=i.type||void 0))continue;switch(a){case"int":t=this.integer_validate(n,i);break;case"numeric":t=this.number_validate(n,i)}if(t)return this.errorModel.set(i.id,t),t;this.errorModel.unset(i.id)}return null},check_min_max:function(i,n){var l=n.label,s=n.min,o=n.max;return!e.isUndefined(s)&&i<s?a.sprintf(t.Browser.messages.MUST_GR_EQ,l,s):!e.isUndefined(o)&&i>o?a.sprintf(t.Browser.messages.MUST_LESS_EQ,l,o):null},number_validate:function(e,i){return new RegExp("^-?[0-9]+(.?[0-9]*)?$").test(e)?this.check_min_max(e,i):a.sprintf(t.Browser.messages.MUST_BE_NUM,i.label)},integer_validate:function(e,i){return new RegExp("^-?[0-9]*$").test(e)?this.check_min_max(e,i):a.sprintf(t.Browser.messages.MUST_BE_INT,i.label)}}),s.DataCollection=n.Collection.extend({initialize:function(e,t){var i=this;return t=t||{},i.sessAttrs={changed:[],added:[],deleted:[],invalid:[]},i.top=t.top||i,i.attrName=t.attrName,i.handler=t.handler,i.trackChanges=!1,i.on("add",i.onModelAdd),i.on("remove",i.onModelRemove),i.on("change",i.onModelChange),i.handler&&i.handler.trackChanges&&i.startNewSession(),i},startNewSession:function(){var t,i=this;i.trackChanges&&(i.trigger("pgadmin-session:stop",i),i.off("pgadmin-session:model:invalid",i.onModelInvalid),i.off("pgadmin-session:model:valid",i.onModelValid)),i.trackChanges=!0,i.sessAttrs={changed:[],added:[],deleted:[],invalid:[]},e.each(i.models,(function(n){"startNewSession"in n&&e.isFunction(n.startNewSession)&&n.startNewSession(),"default_validate"in n&&"function"==typeof n.default_validate&&(t=n.default_validate()),(e.isString(t)||"validate"in n&&"function"==typeof n.validate&&(t=n.validate()))&&(i.sessAttrs.invalid[n.cid]=t)})),i.trigger("pgadmin-session:start",i),i.on("pgadmin-session:model:invalid",i.onModelInvalid),i.on("pgadmin-session:model:valid",i.onModelValid)},onModelInvalid:function(e,t){var i=this,n=i.sessAttrs.invalid;return i.trackChanges&&(n[t.cid]=e,i.handler?i.handler.trigger("pgadmin-session:model:invalid",e,i,i.handler):i.trigger("pgadmin-session:invalid",e,i)),!0},onModelValid:function(e){var t=this,i=t.sessAttrs.invalid;if(t.trackChanges){var n=t.checkDuplicateWithModel(e);n&&e.cid in i&&delete i[e.cid],n&&this.triggerValidationEvent.apply(this)}return!0},stopSession:function(){var t=this;t.trackChanges=!1,t.sessAttrs={changed:[],added:[],deleted:[],invalid:[]},e.each(t.models,(function(t){"stopSession"in t&&e.isFunction(t.stopSession)&&t.stopSession()}))},sessChanged:function(){return this.sessAttrs.changed.length>0||this.sessAttrs.added.length>0||this.sessAttrs.deleted.length>0},toJSON:function(t){var i=this;if(t=void 0!==t&&1==t){var a={added:[]};return e.each(this.sessAttrs.added,(function(e){a.added.push(e.toJSON())})),0==a.added.length&&delete a.added,a.changed=[],e.each(i.sessAttrs.changed,(function(e){a.changed.push(e.toJSON(!0))})),0==a.changed.length&&delete a.changed,a.deleted=[],e.each(i.sessAttrs.deleted,(function(e){a.deleted.push(e.toJSON())})),0==a.deleted.length&&delete a.deleted,0==e.size(a)?null:a}return n.Collection.prototype.toJSON.call(i)},reset:function(e,t){t&&t.stop&&this.stopSession(),this.each((function(e){e&&(e instanceof s.DataModel?e.reset(t):e.clear(t))})),n.Collection.prototype.reset.apply(this,arguments)},objFindInSession:function(t,i){var n=t.primary_key&&"function"==typeof t.primary_key,a=n?t.primary_key():t.cid,l=n?function(e){return e.primary_key()===a}:function(e){return e.cid===a};return e.findIndex(this.sessAttrs[i],l)},onModelAdd:function(t){if(this.trackChanges){var i,n=this,a=n.objFindInSession(t,"deleted");if(a>=0){var l=n.sessAttrs.deleted[a];t.origSessAttrs=e.clone(l.origSessAttrs),t.attributes=e.extend(t.attributes,l.attributes),t.sessAttrs=e.clone(l.sessAttrs),n.sessAttrs.deleted.splice(a,1),"sessChanged"in t&&!t.sessChanged()||n.sessAttrs.changed.push(t),(n.handler||n).trigger("pgadmin-session:added",n,t),"default_validate"in t&&"function"==typeof t.default_validate&&(i=t.default_validate()),(e.isString(i)||"validate"in t&&"function"==typeof t.validate&&(i=t.validate()))&&(n.sessAttrs.invalid[t.cid]=i)}else"default_validate"in t&&"function"==typeof t.default_validate&&(i=t.default_validate()),(e.isString(i)||"validate"in t&&"function"==typeof t.validate&&(i=t.validate()))&&(n.sessAttrs.invalid[t.cid]=i),n.sessAttrs.added.push(t),(n.handler||n).trigger("pgadmin-session:added",n,t);this.triggerValidationEvent.apply(this),n.trigger("pgadmin-session:collection:changed",n)}return!0},onModelRemove:function(t){if(this.trackChanges){t.errorModel.clear();var i=this,n=i.sessAttrs.invalid,a=e.clone(t),l=i.objFindInSession(t,"added");t.cid in n&&delete n[t.cid],l>=0?(i.sessAttrs.added.splice(l,1),(i.handler||i).trigger("pgadmin-session:removed",i,a),i.checkDuplicateWithModel(a),this.triggerValidationEvent.apply(this)):((l=i.objFindInSession(t,"changed"))>=0?(i.sessAttrs.changed.splice(l,1),(i.handler||i).trigger("pgadmin-session:removed",i,a)):(i.handler||i).trigger("pgadmin-session:removed",i,a),t.set(t.origSessAttrs,{silent:!0}),i.sessAttrs.deleted.push(t),i.checkDuplicateWithModel(t),this.triggerValidationEvent.apply(this))}return!0},triggerValidationEvent:function(){var e=this,t=null,i=e.sessAttrs.invalid,n=[];for(var a in i){if(t=i[a])break;n.push(a)}for(a in n)delete i[n[a]];t?e.handler?e.handler.trigger("pgadmin-session:model:invalid",t,e,e.handler):e.trigger("pgadmin-session:invalid",t,e):e.handler?e.handler.trigger("pgadmin-session:model:valid",e,e.handler):e.trigger("pgadmin-session:valid",e.sessChanged(),e)},onModelChange:function(e){var t=this;if(this.trackChanges&&e instanceof s.Node.Model){var i=t.objFindInSession(e,"added");i>=0?(t.handler||t).trigger("pgadmin-session:changed",t,e):(i=t.objFindInSession(e,"changed"),"sessChanged"in e?i>=0?(e.sessChanged()||t.sessAttrs.changed.splice(i,1),(t.handler||t).trigger("pgadmin-session:changed",t,e)):e.sessChanged()&&(t.sessAttrs.changed.push(e),(t.handler||t).trigger("pgadmin-session:changed",t,e)):((t.handler||t).trigger("pgadmin-session:changed",t,e),i<0&&t.sessAttrs.changed.push(e)))}return!0},checkDuplicateWithModel:function(t){if(!("keys"in t)||e.isEmpty(t.keys))return!0;var i=this,n={},a={};e.each(t.keys,(function(e){n[e]=t.get(e),e in t._previous_key_values?a[e]=t._previous_key_values[e]:a[e]=t.previous(e)})),t._previous_key_values={};var l=i.where(a);if(1==l.length){var s=l[0];i.clearInvalidSessionIfModelValid(s)}var o=i.where(n);if(0==o.length)i.clearInvalidSessionIfModelValid(t);else{if(1!=o.length){var r="Duplicate rows.";return setTimeout((function(){e.each(o,(function(e){i.trigger("pgadmin-session:model:invalid",r,e,i.handler),e.trigger("pgadmin-session:model:duplicate",e,r)}))}),10),!1}i.clearInvalidSessionIfModelValid(t),i.clearInvalidSessionIfModelValid(o[0])}return!0},clearInvalidSessionIfModelValid:function(t){var i=t.errorModel.attributes,n=this.sessAttrs.invalid;t.trigger("pgadmin-session:model:unique",t),0==e.size(i)?delete n[t.cid]:n[t.cid]=i[Object.keys(i)[0]]}}),s.Events=e.extend({},n.Events),s}.apply(t,n))||(e.exports=a)},60240:(e,t,i)=>{"use strict";var n,a;n=[i(91669),i(81311),i(58307),i(55112)],void 0===(a=function(e,t,i,n){return n.Browser=n.Browser||{},t.extend(n.Browser,{report_error:function(n,a,l,s){n=t.escape(n),a=t.escape(a),l=t.escape(l);var o='<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true"><div class="panel panel-default"><div class="panel-heading" role="tab" id="headingOne"><h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">'+e("Error message")+'</a></h4></div><div id="collapseOne" class="panel-collapse collapse show" role="tabpanel" aria-labelledby="headingOne"><div class="panel-body" style="overflow: auto;">'+a+"</div></div></div>";null!=l&&""!=l&&(o+='<div class="panel panel-default"><div class="panel-heading" role="tab" id="headingTwo"><h4 class="panel-title"><a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">'+e("Additional info")+'</a></h4></div><div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo"><div class="panel-body" style="overflow: auto;">'+l+"</div></div></div></div>"),o+="</div>",i.alert(n,o).set({closable:!0,onok:function(){s&&s()}})}}),n.Browser.report_error}.apply(t,n))||(e.exports=a)},49760:(e,t,i)=>{"use strict";var n,a;i(68309),i(32564),i(24812),n=[i(81311),i(55112),i(19755),i(35816)],void 0===(a=function(e,t,i){var n=t.Browser=t.Browser||{},a=window.wcDocker,l=window.wcIFrame;return t.Browser.Frame=function(t){e.extend(this,e.pick(t,["name","title","width","height","showTitle","isCloseable","isPrivate","url","icon","onCreate","isLayoutMember"]))},e.extend(t.Browser.Frame.prototype,{name:"",title:"",width:300,height:600,showTitle:!0,isClosable:!0,isRenamable:!1,isPrivate:!1,isLayoutMember:!1,url:"",icon:"",panel:null,frame:null,onCreate:null,load:function(t){var s=this;s.panel||t.registerPanelType(this.name,{title:s.title,isPrivate:s.isPrivate,isLayoutMember:s.isLayoutMember,onCreate:function(t){i(t).data("pgAdminName",s.name),t.initSize(s.width,s.height),0==t.showTitle&&t.title(!1),t.icon(s.icon),t.closeable(!!s.isCloseable),t.renamable(s.isRenamable);var o=i('<div style="position:absolute;top:0 !important;width:100%;height:100%;display:table;z-index:0;">');t.layout().addItem(o),s.panel=t;var r=new l(o,t);i(t).data("frameInitialized",!1),i(t).data("embeddedFrame",r),""!=s.url&&"about:blank"!=s.url?setTimeout((function(){r.openURL(s.url),i(t).data("frameInitialized",!0),n.Events.trigger("pgadmin-browser:frame:urlloaded:"+s.name,r,s.url,self)}),50):(r.openURL("about:blank"),i(t).data("frameInitialized",!0),n.Events.trigger("pgadmin-browser:frame:urlloaded:"+s.name,r,s.url,self)),s.events&&e.isObject(s.events)&&e.each(s.events,(function(i,n){i&&e.isFunction(i)&&t.on(n,i)})),e.each([a.EVENT.UPDATED,a.EVENT.VISIBILITY_CHANGED,a.EVENT.BEGIN_DOCK,a.EVENT.END_DOCK,a.EVENT.GAIN_FOCUS,a.EVENT.LOST_FOCUS,a.EVENT.CLOSED,a.EVENT.BUTTON,a.EVENT.ATTACHED,a.EVENT.DETACHED,a.EVENT.MOVE_STARTED,a.EVENT.MOVE_ENDED,a.EVENT.MOVED,a.EVENT.RESIZE_STARTED,a.EVENT.RESIZE_ENDED,a.EVENT.RESIZED,a.EVENT.SCROLLED],(function(e){t.on(e,s.eventFunc.bind(t,e))})),s.onCreate&&e.isFunction(s.onCreate)&&s.onCreate.apply(s,[t,r])}})},eventFunc:function(e){var t=i(this).data("pgAdminName");try{n.Events.trigger("pgadmin-browser:frame",e,this,arguments),n.Events.trigger("pgadmin-browser:frame:"+e,this,arguments),t&&(n.Events.trigger("pgadmin-browser:frame-"+t,e,this,arguments),n.Events.trigger("pgadmin-browser:frame-"+t+":"+e,this,arguments))}catch(e){console.warn(e.stack||e)}}}),t.Browser.Frame}.apply(t,n))||(e.exports=a)},94841:(e,t,i)=>{"use strict";var n,a;function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}i(82526),i(41817),i(41539),i(32165),i(66992),i(78783),i(33948),i(24812),i(68309),i(69826),i(82772),i(69600),i(2707),n=[i(81311),i(55112),i(19755),i(44092),i(91669)],void 0===(a=function(e,t,i,n,a){t.Browser=t.Browser||{};var s=t.Browser.MenuItem=function(t){e.extend(this,{url:"#",target:"_self",enable:!0},e.pick(t,["name","label","priority","module","callback","data","enable","category","target","url","node","checked","below","menu_items"]))};e.extend(t.Browser.MenuItem.prototype,{$el:null,generate:function(e,t){return this.create_el(e,t),this.context={name:this.label,disabled:this.is_disabled,callback:this.context_menu_callback.bind(this,t)},this.$el},create_el:function(n,a){if(this.menu_items){e.each(this.menu_items,(function(e){e.generate(n,a)}));var l=t.Browser.MenuGroup({label:this.label,id:this.name},this.menu_items);this.$el=l.$el}else{var s=null;null!=this.data&&null!=this.data.data_disabled&&(s=this.data.data_disabled);var o=i("<a></a>",{id:this.name,href:this.url,target:this.target,"data-toggle":"pg-menu",role:"menuitem","data-disabled":s}).data("pgMenu",{module:this.module||t.Browser,cb:this.callback,data:this.data}).addClass("dropdown-item");this.is_disabled=this.disabled(n,a),this.icon?o.append(i("<i></i>",{class:this.icon})):e.isUndefined(this.checked)||o.append(i("<i></i>",{class:"fa fa-check "+(this.checked?"":"visibility-hidden")})),o.addClass(this.is_disabled?" disabled":"");var r=i('<span data-test="menu-item-text"></span>').text("  "+this.label);o.append(r);var d=i("<li/>").append(o);e.isUndefined(this.below)||!0!==this.below||d.append('<li class="dropdown-divider"></li>'),this.$el=d}},update:function(e,t){this.$el&&!this.$el.find(".dropdown-item").hasClass("disabled")&&this.$el.find(".dropdown-item").addClass("disabled"),this.is_disabled=this.disabled(e,t),this.$el&&!this.is_disabled&&this.$el.find(".dropdown-item").removeClass("disabled"),this.context={name:this.label,disabled:this.is_disabled,callback:this.context_menu_callback.bind(this,t)}},context_menu_callback:function(e){var i,a=this;a.module.callbacks&&a.callback in a.module.callbacks?i=a.module.callbacks[a.callback]:a.callback in a.module&&(i=a.module[a.callback]),i?i.apply(a.module,[a.data,e]):t.Browser.report_error(n.sprintf('Developer Warning: Callback - "%s" not found!',a.cb))},disabled:function(t,i){if(null==this.enable)return!1;if(this.node){if(!t)return!0;if(e.isArray(this.node)?-1==e.indexOf(this.node,t):this.node!=t._type)return!0}return e.isBoolean(this.enable)?!this.enable:e.isFunction(this.enable)?!this.enable.apply(this.module,[t,i,this.data]):this.module&&e.isBoolean(this.module[this.enable])?!this.module[this.enable]:!(!this.module||!e.isFunction(this.module[this.enable]))&&!this.module[this.enable].apply(this.module,[t,i,this.data])},change_checked:function(t){e.isUndefined(this.checked)||(this.checked=t,this.checked?this.$el.find(".fa-check").removeClass("visibility-hidden"):this.$el.find(".fa-check").addClass("visibility-hidden"))}}),t.Browser.MenuGroup=function(t,n,a,l){var s,o=e.template(['<% if (above) { %><li class="dropdown-divider"></li><% } %>','<li class="dropdown-submenu" role="menuitem">',' <a href="#" class="dropdown-item">','  <% if (icon) { %><i class="<%= icon %>"></i><% } %>',"  <span><%= label %></span>"," </a>",' <ul class="dropdown-menu">'," </ul>","</li>",'<% if (below) { %><li class="dropdown-divider"></li><% } %>'].join("\n")),r={label:t.label,icon:t.icon,above:t.above&&!a,below:t.below},d=i(o(r)),c=d.find(".dropdown-menu"),u={},p=1;for(var h in l=e.uniqueId(l+"_sub_"),n.sort((function(e,t){return e.label.localeCompare(t.label)})),n.sort((function(e,t){return e.priority-t.priority})),n)s=n[h],c.append(s.$el),s.is_disabled||(u[l+p]=s.context),p++;var f=0==e.size(u);return{$el:d,priority:t.priority||10,label:t.label,above:r.above,below:t.below,is_disabled:f,context:{name:t.label,icon:t.icon,items:u,disabled:f}}},t.Browser.MenuCreator=function(i,n,l,o,r,d,c){var u=!0;if(r&&i[r._type]&&!e.isUndefined(i[r._type].showMenu)&&(u=i[r._type].showMenu(r,d)),u){var p,h={common:[]},f=0,m=e.uniqueId("ctx_"),g=function e(t){if(t instanceof s)t.$el&&(t.$el.remove(),delete t.$el),t.generate(r,d),(h[t.category||"common"]=h[t.category||"common"]||[]).push(t);else for(var i in t)e(t[i])},v=1;for(f in l)g(l[f]);c=c||{},p=h.common,delete h.common;var b=!0;for(var y in h){var C=h[y],_=o[y]||{label:y,single:!1},w=t.Browser.MenuGroup(_,C,b,m);if(C.length<=1&&!_.single)for(f in b=!1,C)p.push(C[f]);else b=C.below,p.push(w)}p.sort((function(e,t){return e.label.localeCompare(t.label)})),p.sort((function(e,t){return e.priority-t.priority}));var x=e.size(p);for(f in p){(d=p[f]).priority=d.priority||10,n.append(d.$el);var k=m+"_"+d.priority+"_"+v;1!=v&&d.above&&!d.is_disabled&&(c[k+"_ma"]="----"),d.is_disabled||(c[k+"_ms"]=d.context),m!=x&&d.below&&!d.is_disabled&&(c[k+"_mz"]="----"),v++}return x>0}(c=c||{})[e.uniqueId("ctx_")+"1_1_ms"]={disabled:!0,name:a("No menu available for this object.")}};var o=function e(t,n){this.$element=i(t),this.options=i.extend({},e.DEFAULTS,n),this.isLoading=!1};function r(e,t){return this.each((function(){var n=i(this),a=n.data("pg.menu"),s="object"==l(e)&&e;a||n.data("pg.menu",a=new o(this,s)),a.toggle(t)}))}o.DEFAULTS={},o.prototype.toggle=function(e){if(this.$element.closest(".dropdown-item").hasClass("disabled"))return e.preventDefault(),!1;var i=this.$element.data("pgMenu");if(i.cb){var n=i.module&&i.module.callbacks&&i.module.callbacks[i.cb]||i.module&&i.module[i.cb];n?(n.apply(i.module,[i.data,t.Browser.tree.selected()]),e.preventDefault()):t.Browser.report_error('Developer Warning: Callback - "'+i.cb+'" not found!')}};var d=i.fn.button;return i.fn.pgmenu=r,i.fn.pgmenu.Constructor=o,i.fn.pgmenu.noConflict=function(){return i.fn.pgmenu=d,this},i(document).on("click.pg.menu.data-api",'[data-toggle^="pg-menu"]',(function(e){var t=i(e.target);t.hasClass("dropdown-item")||(t=t.closest(".dropdown-item")),r.call(t,"toggle",e)})).on("focus.pg.menu.data-api blur.pg.menu.data-api",'[data-toggle^="pg-menu"]',(function(e){i(e.target).closest(".menu").toggleClass("focus",/^focus(in)?$/.test(e.type))})).on("mouseenter",".dropdown-submenu",(function(e){i(e.currentTarget).removeClass("dropdown-submenu-visible").addClass("dropdown-submenu-visible"),i(e.currentTarget).find(".dropdown-menu").first().addClass("show")})).on("mouseleave",".dropdown-submenu",(function(e){i(e.currentTarget).removeClass("dropdown-submenu-visible"),i(e.currentTarget).find(".dropdown-menu").first().removeClass("show")})).on("hidden.bs.dropdown",(function(e){i(e.target).find(".dropdown-submenu.dropdown-submenu-visible").removeClass("dropdown-submenu-visible").find(".dropdown-menu.show").removeClass("show")})),t.Browser.MenuItem}.apply(t,n))||(e.exports=a)},88941:(e,t,i)=>{"use strict";var n,a;i(24812),i(66992),i(41539),i(33948),i(82772),i(69826),i(32564),i(26699),i(32023),i(74916),i(23123),i(69600),i(5735),i(83753),i(3843),i(83710),n=[i(82794),i(28008),i(91669),i(19755),i(81311),i(55112),i(94841),i(72316),i(55455),i(87377),i(95283),i(61329),i(68363),i(44092),i(96481),i(12030)],void 0===(a=function(e,t,i,n,a,l,s,o,r,d,c,u,p,h){var f=window.wcDocker,m=13,g=27,v=112;return d.Node?d.Node:(d.Nodes=d.Nodes||{},d.Node=function(){},d.Node.extend=function(e,t){var i,n=this;if(i=function(){return n.apply(this,arguments)},a.extend(i,n,a.omit(e,"callbacks")),i.callbacks=a.extend({},n.callbacks,e.callbacks),!1===t)return i;for(var l,s=a.keys(i.callbacks),o=0;o<s.length;o++)l=s[o],"function"==typeof i.callbacks[l]&&(i.callbacks[l]=i.callbacks[l].bind(i));return i.Init.apply(i),this.Init.apply(i),i},a.extend(l.Browser.Node,o.Events,{type:void 0,label:"",sqlAlterHelp:"",sqlCreateHelp:"",dialogHelp:"",title:function(e,t){return e.label+(t?" - "+t.label:"")},hasId:!0,Init:function(){var e=this;if(!e.node_initialized){if(e.node_initialized=!0,l.Browser.add_menus([{name:"refresh",node:e.type,module:e,applies:["object","context"],callback:"refresh",priority:1,label:i("Refresh..."),icon:"fa fa-sync-alt"}]),e.canEdit&&l.Browser.add_menus([{name:"show_obj_properties",node:e.type,module:e,applies:["object","context"],callback:"show_obj_properties",priority:999,label:i("Properties..."),data:{action:"edit"},icon:"fa fa-edit",enable:a.isFunction(e.canEdit)?function(){return!!e.canEdit.apply(e,arguments)}:!!e.canEdit}]),e.canDrop&&(l.Browser.add_menus([{name:"delete_object",node:e.type,module:e,applies:["object","context"],callback:"delete_obj",priority:e.dropPriority,label:e.dropAsRemove?i("Remove %s",e.label):i("Delete/Drop"),data:{url:"drop",data_disabled:i("The selected tree node does not support this option.")},icon:"fa fa-trash-alt",enable:a.isFunction(e.canDrop)?function(){return!!e.canDrop.apply(e,arguments)}:!!e.canDrop}]),e.canDropCascade&&l.Browser.add_menus([{name:"delete_object_cascade",node:e.type,module:e,applies:["object","context"],callback:"delete_obj",priority:3,label:i("Drop Cascade"),data:{url:"delete"},icon:"fa fa-trash-alt",enable:a.isFunction(e.canDropCascade)?function(){return e.canDropCascade.apply(e,arguments)}:!!e.canDropCascade}])),-1==a.indexOf(l.unsupported_nodes,e.type)){var t=function(e){return!("database"!=e._type||!e.allowConn)||"database"!=e._type};l.Browser.add_menus([{name:"show_query_tool",node:e.type,module:e,applies:["context"],callback:"show_query_tool",priority:998,label:i("Query Tool"),icon:"pg-font-icon icon-query_tool",enable:t}]),l.Browser.add_menus([{name:"search_objects",node:e.type,module:l.SearchObjects,applies:["context"],callback:"show_search_objects",priority:997,label:i("Search Objects..."),icon:"fa fa-search",enable:t}]),l.enable_psql&&l.Browser.add_menus([{name:"show_psql_tool",node:this.type,module:this,applies:["context"],callback:"show_psql_tool",priority:998,label:i("PSQL Tool (Beta)"),icon:"fas fa-terminal"}])}e.hasScriptTypes&&a.isArray(e.hasScriptTypes)&&e.hasScriptTypes.length>0&&a.each(e.hasScriptTypes,(function(t){var n=i("%s Script",t.toUpperCase());t=t.toLowerCase(),l.Browser.add_menus([{name:"show_script_"+t,node:e.type,module:e,applies:["object","context"],callback:"show_script",priority:4,label:n,category:i("Scripts"),data:{script:t,data_disabled:i("The selected tree node does not support this option.")},icon:"fa fa-pencil-alt",enable:e.check_user_permission}])}))}},check_user_permission:function(e,t,i){if("server_group"==e._type||"server"==e._type)return!1;if("database"==e._type&&!e.allowConn)return!1;var n=d.Nodes[e._type].getTreeNodeHierarchy(t);return-1==a.indexOf(["create","insert","update","delete"],i.script)||(!("role"!=e.type||!n.server.user.can_create_role)||!!(n.server&&(n.server.user.is_superuser||n.server.user.can_create_db)||n.schema&&n.schema.can_create))},getView:function(e,t,l,s,o,u,p,f){var m=this;if(!this.type||""==this.type)return null;if(this.model){var g=this.generate_url(e,t,s,!1,null,m.url_jump_after_node);if(!g)return null;var v={};"create"!==t&&(v[this.model.idAttribute||this.model.prototype.idAttribute||"id"]=s._id);var b=this.getTreeNodeHierarchy.apply(this,[e]),y=new(this.model.extend({urlRoot:g}))(v,{node_info:b}),C=c.generateViewSchema(b,y,t,this,s);if("create"==t||"edit"==t){(u=u&&p?u.bind(p):function(){console.warn("Broke something!!! Why we don't have the callback or the context???")})(!1,!1),y.on("pgadmin-session:valid",(function(e){a.isUndefined(m.statusBar)||m.statusBar.empty().css("visibility","hidden"),u(!1,e)})),y.on("pgadmin-session:invalid",(function(e){var t='\n            <div class="error-in-footer">\n              <div class="d-flex px-2 py-1">\n                <div class="pr-2">\n                  <i class="fa fa-exclamation-triangle text-danger" aria-hidden="true" role="img"></i>\n                </div>\n                <div role="alert" class="alert-text">'.concat(e,'</div>\n                <div class="ml-auto close-error-bar">\n                  <a class="close-error fa fa-times text-danger"></a>\n                </div>\n              </div>\n            </div>');a.isUndefined(m.statusBar)||(m.statusBar.html(t).css("visibility","visible"),m.statusBar.find("a.close-error").bind("click",function(){this.empty().css("visibility","hidden")}.bind(m.statusBar)));var i=!1;return this.sessChanged&&this.sessChanged()&&(i=!0),u(!0,i),!0}))}if(a.size(C)){var _;_="fieldset"==o?new c.Accordian({el:l,model:y,schema:C}):new c.Dialog({el:l,model:y,schema:C});var w=function(){var e=n(l).find(".tab-content:first > .tab-pane.active:first");h.findAndSetFocus(e)};if(y.isNew())_.render(),w(),y.startNewSession();else{var x='<div role="status" class="pg-panel-message pg-panel-properties-message">'+i("Retrieving data from the server...")+"</div>",k=n(x),N=setTimeout((function(e){a.isUndefined(e)||k.appendTo(e)}),1e3,p);!function t(){y.fetch({success:function(){clearTimeout(N),k.addClass("d-none"),_.render(),w(),y.startNewSession()},error:function(n,a,l){var s=m&&e?m.getTreeNodeHierarchy(e)[m.type].label:"";d.Events.trigger("pgadmin:node:retrieval:error","properties",a,l.textStatus,l.errorThrown,e),r.pgHandleItemError(a,l.textStatus,l.errorThrown,{item:e,info:b})||r.pgNotifier(l.textStatus,a,i("Error retrieving properties - %s",l.errorThrown||s),(function(e){"CRYPTKEY_SET"===e?t():console.warn(arguments)})),f&&f()}})}()}}return _}return null},register_node_panel:function(){var e=d.docker.findPanels("node_props");if(!e||1!=e.length){var t={};t[f.EVENT.RESIZE_ENDED]=function(){var e=this.$container.find(".obj_properties").first(),t=e.data("obj-view");t&&t.model&&t.model&&t.model.trigger("pg-browser-resized",{view:t,panel:this,container:e})},(e=new d.Panel({name:"node_props",showTitle:!0,isCloseable:!0,isPrivate:!0,isLayoutMember:!1,canMaximise:!0,elContainer:!0,content:'<div class="obj_properties container-fluid"><div role="status" class="pg-panel-message">'+i("Please wait while we fetch information about the node from the server...")+"</div></div>",onCreate:function(e,t){t.addClass("pg-no-overflow")},events:t})).load(d.docker)}},hasScriptTypes:["create"],canEdit:!0,canDrop:!1,canDropCascade:!1,dropAsRemove:!1,dropPriority:2,selectParentNodeOnDelete:!1,callbacks:{show_obj_properties:function(e,t){var n=d.tree,s=e&&e.item||t||n.selected(),o=s&&1==s.length?n.itemData(s):void 0,c=this,u=c.title.apply(this,[o]);if(d.Node.register_node_panel(),o){var p=this,m=a.isArray(this.parent_type)?function(e){return-1!=a.indexOf(p.parent_type,e._type)}:function(e){return p.parent_type==e._type},g=function(){var e,t,i,n,a=window.document.body,s=document.createElement("div");a.insertBefore(s,a.firstChild),e=screen.width<800?l.toPx(s,"95%","width",!0):(e=l.toPx(s,p.width||d.stdW.default+"px","width",!0))<=d.stdW.sm?d.stdW.sm:e<=d.stdW.md?d.stdW.md:d.stdW.lg,t=screen.height<600?l.toPx(s,"95%","height",!0):(t=l.toPx(s,p.height||d.stdH.default+"px","height",!0))<=d.stdH.sm?d.stdH.sm:t<=d.stdH.md?d.stdH.md:d.stdH.lg,i=(a.offsetWidth-e)/2,n=(a.offsetHeight-t)/4,e>window.innerWidth&&(i=0,e=window.innerWidth),t>window.innerHeight&&(n=0,t=window.innerHeight);var o=d.docker.addPanel("node_props",f.DOCK.FLOAT,void 0,{w:e+"px",h:t+"px",x:i+"px",y:n+"px"});return a.removeChild(s),o};if("create"==e.action){if(p.parent_type&&!m(o))for(;s&&n.hasParent(s);){s=n.parent(s);var v=n.itemData(s);if(m(v)){o=v;break}}if(!o||null!=this.parent_type&&!m(o))return;u=i("Create - %s",this.label),b=g(),setTimeout((function(){c.showProperties(s,o,b,e.action)}),10)}else if(d.Node.panels&&d.Node.panels[o.id]&&d.Node.panels[o.id].$container){var b=d.Node.panels[o.id];if(b.$container.attr("action-mode")){var y=i('Are you sure want to stop editing the properties of %s "%s"?');"edit"==e.action&&(y=i('Are you sure want to reset the current changes and re-open the panel for %s "%s"?')),r.confirm(i("Edit in progress?"),h.sprintf(y,c.label.toLowerCase(),o.label),(function(){setTimeout((function(){c.showProperties(s,o,b,e.action)}),10)}),null).show()}else setTimeout((function(){c.showProperties(s,o,b,e.action)}),10)}else d.Node.panels=d.Node.panels||{},b=d.Node.panels[o.id]=g(),setTimeout((function(){c.showProperties(s,o,b,e.action)}),10);b.title(u),b.icon("icon-"+this.type),b.focus()}},delete_obj:function(e,t){var l=e||{url:"drop"},s=this,o=d.tree,c=l.item||t||o.selected(),u=c&&1==c.length?o.itemData(c):void 0;if(u){s=d.Nodes[u._type];var p,h,f=u.label;if("delete"==l.url){if(p=i('Are you sure you want to drop %s "%s" and all the objects that depend on it?',s.label.toLowerCase(),u.label),h=i("DROP CASCADE %s?",s.label),!(a.isFunction(s.canDropCascade)?s.canDropCascade.apply(s,[u,c]):s.canDropCascade))return void r.error(i('The %s "%s" cannot be dropped.',s.label,u.label),10)}else if(s.dropAsRemove?(p=i('Are you sure you want to remove %s "%s"?',s.label.toLowerCase(),u.label),h=i("Remove %s?",s.label)):(p=i('Are you sure you want to drop %s "%s"?',s.label.toLowerCase(),u.label),h=i("Drop %s?",s.label)),!(a.isFunction(s.canDrop)?s.canDrop.apply(s,[u,c]):s.canDrop))return void r.error(i('The %s "%s" cannot be dropped/removed.',s.label,u.label),10);r.confirm(h,p,(function(){n.ajax({url:s.generate_url(c,l.url,u,!0),type:"DELETE"}).done((function(e){if(0==e.success)d.report_error(e.errormsg,e.info);else{var t=!0;if(s.selectParentNodeOnDelete){var i=o.parent(c);setTimeout((function(){o.select(i)}),10),t=!1}d.removeTreeNode(c,t)}return!0})).fail((function(e){var t=e.responseText;if(417==e.status||410==e.status||500==e.status)try{var n=JSON.parse(e.responseText);t=n.info||n.errormsg}catch(e){console.warn(e.stack||e)}d.report_error(i('Error dropping/removing %s: "%s"',s.label,f),t)}))}),null).set("labels",{ok:i("Yes"),cancel:i("No")}).show()}},show_script:function(e,t){var i,n,a=e.script,s=d.tree,o=t||s.selected(),r=o&&1==o.length?s.itemData(o):void 0;r&&(i=d.Nodes[r._type],n="insert"==a?"insert_sql":"update"==a?"update_sql":"delete"==a?"delete_sql":"select"==a?"select_sql":"exec"==a?"exec_sql":"sql",l.DataGrid.show_query_tool(i.generate_url(o,n,r,!0),o,a))},show_query_tool:function(e,t){var n=d.get_preference("sqleditor","copy_sql_to_query_tool"),a=d.tree,s=t||a.selected(),o=s&&1==s.length?a.itemData(s):void 0;if(o)if(n.value&&!o._type.includes("coll-")){var r={script:o._type.toLowerCase(),data_disabled:i("The selected tree node does not support this option.")};d.Node.callbacks.show_script(r)}else l.DataGrid.show_query_tool("",s)},show_psql_tool:function(e){var t=e||{},i=d.tree,n=t.item||i.selected(),a=n&&1==n.length?i.itemData(n):void 0;d.psql.psql_tool(a,n,!0)},change_server_background:function(e,t){if(e&&t&&t._type&&"server"==t._type){var i=n(e).find("span.aciTreeItem").first()||null,a=t.icon.split(" ")[1]||null,l=t.icon.split(" ")[2]||"";if(a){var s,o=i&&i.parents()[3]||null,r="pga_server_"+t._id+"_bgcolor";s="<style id="+r+" type='text/css'> \n",s+="."+r+" .aciTreeItem {",s+=" border-radius: 3px; margin-bottom: 2px;",s+=" background: "+a+"} \n",l&&(s+="."+r+" .aciTreeText {",s+=" color: "+l+" !important;} \n"),s+="</style>",n("#"+r).remove(),n(s).appendTo("head"),o&&n(o).addClass(r)}}},added:function(e,t,i){var n=(i||d).tree,l=n.parent(e),s=l&&n.itemData(l),o=s&&d.Nodes[s._type];o&&o.is_collection&&("collection_count"in s||(s.collection_count=0),s.collection_count++,n.setLabel(l,{label:a.escape(s._label)+" <span>("+s.collection_count+")</span>"})),d.Events.trigger("pgadmin:browser:tree:expand-from-previous-tree-state",e),d.Node.callbacks.change_server_background(e,t)},selected:function(e,t,i){var n=i||d,a=n.tree,s=t||a.itemData(e);return l.Browser.enable_disable_menus.apply(n,[e]),s&&n&&"properties"in n.panels&&n.panels.properties&&n.panels.properties.panel&&n.panels.properties.panel.isVisible()&&this.showProperties(e,s,n.panels.properties.panel),d.Events.trigger("pgadmin:browser:tree:update-tree-state",e),!0},removed:function(e){var t=this,i=d.tree,n=i.parent(e),l=n&&i.itemData(n),s=l&&d.Nodes[l._type];s&&s.is_collection&&"collection_count"in l&&(l.collection_count--,i.setLabel(n,{label:a.escape(l._label)+" <span>("+l.collection_count+")</span>"})),setTimeout((function(){t.clear_cache.apply(t,e)}),0)},unloaded:function(e){var t=d.tree,i=e&&t.itemData(e);this.is_collection&&i===Object(i)&&"collection_count"in i&&(delete i.collection_count,t.setLabel(e,{label:a.escape(i._label)}))},refresh:function(e,t){var i=this,a=d.tree,l=t&&a.itemData(t);n(d.panels.properties.panel).removeData("node-prop"),d.Events.trigger("pgadmin:browser:tree:refresh",t||d.tree.selected(),{success:function(){i.callbacks.selected.apply(i,[t,l,d])}})},opened:function(e){var t=d.tree,i=d.get_preference("browser","auto_expand_sole_children");d.Events.trigger("pgadmin:browser:tree:update-tree-state",e),i&&1==i.value&&1==t.children(e).length&&t.open(t.first(e))},closed:function(e){d.Events.trigger("pgadmin:browser:tree:remove-from-tree-state",e)}},showProperties:function(e,t,s,o){var c=this,u=l.Browser.tree,h=s.$container.find(".obj_properties").first(),b=h.data("obj-view"),y=n("<div></div>").addClass("pg-prop-content col-12"),C=!0,_=function(e,t){if(!s||"node_props"===s._type)switch(e.which){case g:M(!0);break;case m:if(e.target!==t)return;if(b&&b.model&&b.model.sessChanged()){var i=n(e.target).closest(".obj_properties").find(".pg-prop-btn-group").find("button.btn-primary");D.call(this,b,i)}break;case v:E()}}.bind(s);setTimeout((function(){s.$container.find(".backform-tab").on("keydown",(function(e){_(e,this)}))}),200);var w=function(e){var t=n('<div role="status"></div>').addClass("pg-prop-status-bar").appendTo(h);return t.css("visibility","hidden"),"header"==e?t.appendTo(c.header):t.prependTo(c.footer),c.statusBar=t,t}.bind(s),x=function(e,t,i){if(e&&a.isArray(e)&&e.length>0){var l=n('<div class="pg-prop-btn-group"></div>'),s=a.template(['<button tabindex="0" type="<%= type %>" ',"class=\"btn <%=extraClasses.join(' ')%>\"",'<% if (disabled) { %> disabled="disabled"<% } %> title="<%-tooltip%>"','<% if (label != "") {} else { %> aria-label="<%-tooltip%>"<% } %> >','<span class="<%= icon %>"></span><% if (label != "") { %>&nbsp;<%-label%><% } %></button>'].join(" "));return"header"==t?l.appendTo(c.header):l.appendTo(c.footer),i&&l.addClass(i),a.each(e,(function(e){e.icon||(e.icon="");var t=n(s(e));l.append(t),e.register(t)})),l}return null}.bind(s),k=function(){var l=u.selected(),s=l&&u.itemData(l),o=(l&&s&&d.Nodes[s._type]).getTreeNodeHierarchy(l);if(!a.isEqual(n(this).data("node-prop"),o)){if(n(this).data("node-prop",o),y.hasClass("has-pg-prop-btn-group")||y.addClass("has-pg-prop-btn-group"),b&&(b.remove({data:!0,internal:!0,silent:!0}),b=null,h.data("obj-view",null)),h.empty(),c.header=n("<div></div>").addClass("pg-prop-header").appendTo(h),c.footer=n("<div></div>").addClass("pg-prop-footer").appendTo(h),b=c.getView(e,"properties",y,t,"fieldset",void 0,h)){h.data("obj-view",b);var r=[];r.push({label:i("Edit"),type:"edit",tooltip:i("Edit"),extraClasses:["btn","btn-primary","pull-right","m-1"],icon:"fa fa-sm fa-pencil-alt",disabled:a.isFunction(c.canEdit)?!c.canEdit.apply(c,[s,l]):!c.canEdit,register:function(e){e.on("click",(function(){j()}))}}),r.push({label:"",type:"help",tooltip:i("SQL help for this object type."),extraClasses:["btn-primary-icon","btn-primary-icon","m-1"],icon:"fa fa-info",disabled:""==c.sqlAlterHelp&&""==c.sqlCreateHelp,register:function(e){e.on("click",(function(){N()}))}}),x(r,"header","pg-prop-btn-group-above")}h.append(y)}}.bind(s),N=function(){var t=c.getTreeNodeHierarchy(e).server,i=d.utils.pg_help_path;"ppas"==t.server_type&&(i=d.utils.edbas_help_path);var n="";n=""==c.sqlCreateHelp&&""!=c.sqlAlterHelp?p.getHelpUrl(i,c.sqlAlterHelp,t.version,t.server_type):""!=c.sqlCreateHelp&&""==c.sqlAlterHelp||b.model.isNew()?p.getHelpUrl(i,c.sqlCreateHelp,t.version,t.server_type):p.getHelpUrl(i,c.sqlAlterHelp,t.version,t.server_type),window.open(n,"postgres_help")}.bind(s),E=function(){window.open(c.dialogHelp,"pgadmin_help")}.bind(s),T=function(e,t){var n=this.$container.find(".obj_properties").first(),a=n&&n.data("obj-view"),l=this;return d.get_preferences_for_module("browser").confirm_on_properties_close&&C&&a&&a.model?!a.model.sessChanged()||void r.confirm(i("Warning"),e,(function(){return setTimeout(function(){t()}.bind(l),50),!0}),(function(){return!0})).set("labels",{ok:i("Yes"),cancel:i("No")}).show():(t(),!0)}.bind(s),S=function(e){var t,n=this.$container.find(".obj_properties").first(),l=n&&n.data("obj-view"),s=this;return!l||!l.model||a.isUndefined(l.model.warn_text)||a.isNull(l.model.warn_text)?(e(),!0):(t=i(l.model.warn_text),!l.model.sessChanged()||void r.confirm(i("Warning"),t,(function(){return setTimeout(function(){e()}.bind(s),50),!0}),(function(){return!0})).set("labels",{ok:i("Yes"),cancel:i("No")}).show())}.bind(s),I=function(e){var t=this.$container.find(".obj_properties").first(),n=t&&t.data("obj-view");return n&&n.model&&!a.isUndefined(n.model.inform_text)&&!a.isNull(n.model.inform_text)&&r.alert(i("Warning"),i(n.model.inform_text)),e(),!0}.bind(s),D=function(e,t){var l=e.model,s=l.toJSON(!0),o=setTimeout((function(){n(".obj_properties").addClass("show_progress")}),1e3);t&&n(t).prop("disabled",!0),s&&!a.isEmpty(s)&&l.save({},{attrs:s,validate:!1,cache:!1,wait:!0,success:function(){B.call(),n(".obj_properties").removeClass("show_progress"),clearTimeout(o);var e=d.docker.findPanels("properties")[0],t=d.docker.findPanels("sql")[0],i=d.docker.findPanels("statistics")[0],a=d.docker.findPanels("dependencies")[0],l=d.docker.findPanels("dependents")[0];e&&n(e).removeData("node-prop"),t&&n(t).removeData("node-prop"),i&&n(i).removeData("node-prop"),a&&n(a).removeData("node-prop"),l&&n(l).removeData("node-prop")},error:function(e,a){r.pgNotifier("error",a,i("Error saving properties")),n(".obj_properties").removeClass("show_progress"),clearTimeout(o),t&&n(t).prop("disabled",!1)}})}.bind(s),$=function(){var l=this;o&&"properties"==o&&(o="edit"),l.$container.attr("action-mode",o),b&&(b.remove({data:!0,internal:!0,silent:!0}),b=null,h.data("obj-view",null)),h.empty(),c.header=n("<div></div>").addClass("pg-prop-header").appendTo(h),c.footer=n("<div></div>").addClass("pg-prop-footer").appendTo(h);(b=c.getView(e,o,y,t,"dialog",(function(e,t){var i=this.find(".pg-prop-btn-group"),n=i.find("button.btn-primary"),a=i.find('button.btn-secondary[type="reset"]');e||!t?(n.prop("disabled",!0),n.attr("disabled","disabled")):(n.prop("disabled",!1),n.removeAttr("disabled")),t?(a.prop("disabled",!1),a.removeAttr("disabled")):(a.prop("disabled",!0),a.attr("disabled","disabled"))}),h,O))&&(h.data("obj-view",b),l.icon(a.isFunction(c.node_image)?c.node_image.apply(c,[t,b.model]):c.node_image||"icon-"+c.type),x([{label:"",type:"help",tooltip:i("SQL help for this object type."),extraClasses:["btn-primary-icon","pull-left","mx-1"],icon:"fa fa-info",disabled:""==c.sqlAlterHelp&&""==c.sqlCreateHelp,register:function(e){e.on("click",(function(){N()}))}},{label:"",type:"help",tooltip:i("Help for this dialog."),extraClasses:["btn-primary-icon","pull-left","mx-1"],icon:"fa fa-question",disabled:""==c.dialogHelp,register:function(e){e.on("click",(function(){E()}))}},{label:i("Cancel"),type:"cancel",tooltip:i("Cancel changes to this object."),extraClasses:["btn-secondary","mx-1"],icon:"fa fa-times pg-alertify-button",disabled:!1,register:function(e){e.on("click",(function(){l.$container.removeAttr("action-mode"),O.call(!0)}))}},{label:i("Reset"),type:"reset",tooltip:i("Reset the fields on this dialog."),extraClasses:["btn-secondary","mx-1"],icon:"fa fa-recycle pg-alertify-button",disabled:!0,register:function(e){e.on("click",(function(){T.call(l,i("Changes will be lost. Are you sure you want to reset?"),(function(){setTimeout((function(){$.call()}),0)}))}))}},{label:i("Save"),type:"save",tooltip:i("Save this object."),extraClasses:["btn-primary","mx-1"],icon:"fa fa-save pg-alertify-button",disabled:!0,register:function(e){e.on("click",(function(){S.call(l,(function(){I.call(l,(function(){setTimeout((function(){D.call(this,b,e)}),0)}))}))}))}}],"footer","pg-prop-btn-group-below").on("keydown","button",(function(e){if(!e.shiftKey&&9==e.keyCode&&0==n(this).nextAll("button:not([disabled])").length)return b.$el.closest(".wcFloating").find('[tabindex]:not([tabindex="-1"]').first().focus(),!1;var t=n(l.$container.find(".pg-prop-btn-group")),i=n(t).find("button:first");l.$container.find(".number-cell.editable:last").is(":visible")&&9===e.keyCode&&e.shiftKey&&n(i).is(n(e.target))&&(n(l.$container.find("td.editable:last").trigger("click")),e.preventDefault(),e.stopPropagation())})),setTimeout((function(){d.keyboardNavigation.getDialogTabNavigator(l.pgElContainer)}),200));w("footer"),y.addClass("pg-prop-has-btn-group-below"),h.prepend(y),n(".select2-search__field").attr("aria-label","select2"),b.$el.closest(".wcFloating").find('.wcFrameButtonBar > .wcFrameButton[style!="display: none;"]').on("keydown",(function(e){e.shiftKey&&9===e.keyCode&&(e.stopPropagation(),setTimeout((function(){b.$el.closest(".wcFloating").find('[tabindex]:not([tabindex="-1"]):not([disabled])').last().focus()}),10))}))}.bind(s),M=function(e){a.isUndefined(e)||(C=e),this.close()}.bind(s),A=function(t){var i=this.$container.find(".obj_properties").first().data("obj-view");setTimeout((function(){t.clear_cache.apply(t,e)}),0);try{d.Events.trigger("pgadmin:browser:tree:add",a.clone(i.model.tnode),a.clone(i.model.node_info))}catch(e){console.warn(e.stack||e)}M(!1)}.bind(s,c),O=M,B=function(i){var n=t,l=a.clone(b.model.tnode),s=a.clone(b.model.node_info);setTimeout((function(){i.clear_cache.apply(i,e)}),0),d.Events.trigger("pgadmin:browser:tree:update",n,l,s,{success:function(e,t,i){d.Events.trigger("pgadmin:browser:node:updated",e,t,i),d.Events.trigger("pgadmin:browser:node:"+t._type+":updated",e,t,i)}}),M(!1)}.bind(s,c),j=$.bind(s);if(o?("create"==o&&(B=A),"properties"!=o?$():k()):(k(),j=function(){setTimeout((function(){c.callbacks.show_obj_properties.apply(c,[{action:"edit",item:e}])}),0)}.bind(s)),s.closeable()){s.on(f.EVENT.CLOSING,T.bind(s,i("Changes will be lost. Are you sure you want to close the dialog?"),(function(){s.off(f.EVENT.CLOSING),s.close()})));var q=function(){var e=this.$container.find(".obj_properties").first(),t=e&&e.data("obj-view");t&&t.remove({data:!0,internal:!0,silent:!0})}.bind(s);s.on(f.EVENT.CLOSED,q)}},_find_parent_node:function(e,t,i){if(this.parent_type)if(i=i||e.itemData(t),a.isString(this.parent_type)){if(this.parent_type==i._type)return t;for(;e.hasParent(t);)if(t=e.parent(t),i=e.itemData(t),this.parent_type==i._type)return t}else{if(a.indexOf(this.parent_type,i._type)>=0)return t;for(;e.hasParent(t);)if(t=e.parent(t),i=e.itemData(t),a.indexOf(this.parent_type,i._type)>=0)return t}return null},generate_url:function(e,t,i,n,l,s){var o={create:"obj",drop:"obj",edit:"obj",properties:"obj",statistics:"stats"},r=this,c=-1/0,p=a.isUndefined(e)||a.isNull(e)?l||{}:this.getTreeNodeHierarchy(e),h=t in o?o[t]:t,f=n&&i._type==r.type?encodeURIComponent(i._id):"";if(r.parent_type)if(a.isString(r.parent_type)){var m=p[r.parent_type];m&&(c=m.priority)}else a.each(r.parent_type,(function(e){var t=p[e];t&&c<t.priority&&(c=t.priority)}));var g=c;s&&p[s]&&(g=p[s].priority);return u.generate_url(d.URL,p,h,r.type,(function(e){return e.priority<=g||e.priority==c}),f)},Collection:d.DataCollection,Model:d.DataModel,getTreeNodeHierarchy:e.getTreeNodeHierarchyFromIdentifier.bind(d),cache:function(e,t,i,n){var l=this.cached=this.cached||{},s=e,o=t&&t[i]&&t[i].priority||0;if(t&&a.each(a.sortBy(a.values(a.pick(t,(function(e){return e.priority<=o}))),(function(e){return e.priority})),(function(e){s=h.sprintf("%s/%s",s,encodeURI(e._id))})),a.isUndefined(n)){var r=l[s];return!a.isUndefined(r)&&r.at-Date.now()>3e5&&(r=void 0),r}return r=l[s]={data:n,at:Date.now(),level:i}},clear_cache:function(e){this.cached={};d.Events.trigger("pgadmin:browser:node:"+this.type+":cache_cleared",e,this)},cache_level:function(e,t){if(e){if(t&&this.type in e)return this.type;if(a.isArray(this.parent_type)){for(var i in this.parent_type)if(i in e)return i;return this.type}return this.parent_type}}}),l.Browser.Node)}.apply(t,n))||(e.exports=a)},81989:(e,t,i)=>{"use strict";var n,a;i(69600),i(69826),i(24812),n=[i(91669),i(19755),i(81311),i(55112),i(72316),i(95283),i(58307),i(83879),i(20454),i(88941)],void 0===(a=function(e,t,i,n,a,l,s,o){t.fn.select2.amd.define("select2/selectAllAdapter",["select2/utils","select2/dropdown","select2/dropdown/attachBody"],(function(i,n,a){function l(){}return l.prototype.render=function(n){var a=this,l=n.call(this),s=t(['<button class="btn btn-secondary btn-sm" type="button"',' style="width: 49%;margin: 0 0.5%;">','<i class="fa fa-check-square" role="img"></i>','<span style="padding: 0px 5px;">',e("Select All"),"</span></button>"].join("")),o=t(['<button class="btn btn-secondary btn-sm" type="button"',' style="width: 49%;margin: 0 0.5%;">','<i class="fa fa-square"></i><span style="padding: 0px 5px;" role="img">',e("Unselect All"),"</span></button>"].join("")),r=t('<div class="select2-select-all-adapter-container">').append(s).append(o);return this.$element.prop("multiple")?(l.find(".select2-dropdown").prepend(r),s.on("click",(function(){l.find(".select2-results__option[aria-selected=false]").each((function(){var e=i.GetData(t(this)[0],"data");a.trigger("select",{data:e})})),a.trigger("close")})),o.on("click",(function(){l.find(".select2-results__option[aria-selected=true]").each((function(){var e=i.GetData(t(this)[0],"data");a.trigger("unselect",{data:e})})),a.trigger("close")})),l):l},i.Decorate(i.Decorate(n,a),l)}));var r=l.NodeAjaxOptionsControl=l.Select2Control.extend({defaults:i.extend(l.Select2Control.prototype.defaults,{url:void 0,transform:void 0,url_with_id:!1,select2:{allowClear:!0,placeholder:e("Select an item..."),width:"style"}}),initialize:function(){l.Select2Control.prototype.initialize.apply(this,arguments);var e=this,a=e.field.get("url")||e.defaults.url,s=e.model.top||e.model,o=e.field.get("url_jump_after_node")||null;if(a){var r,d=this.field.get("schema_node"),c=this.field.get("node_info"),u=this.field.get("url_with_id")||!1,p=d.generate_url.apply(d,[null,a,this.field.get("node_data"),u,c,o]),h=this.field.get("cache_node");h=h&&n.Browser.Nodes[h]||d,r=this.field.has("cache_level")?this.field.get("cache_level"):h.cache_level(c,u);var f=h.cache(d.type+"#"+a,c,r);this.field.get("version_compatible")&&(i.isUndefined(f)||i.isNull(f))&&(s.trigger("pgadmin:view:fetching",s,e.field),t.ajax({async:!1,url:p}).done((function(e){f=h.cache(d.type+"#"+a,c,r,e.data)})).fail((function(){s.trigger("pgadmin:view:fetch:error",s,e.field)})),s.trigger("pgadmin:view:fetched",s,e.field)),f=f&&f.data||[];var m=this.field.get("transform")||e.defaults.transform;m&&i.isFunction(m)?e.field.set("options",m.bind(e,f)):e.field.set("options",f)}}}),d=function(e){if(!e.id)return e.text;var i=t(e.element).data("image");return i?t("<span></span>").append(t("<span></span>",{class:"wcTabIcon "+i})).append(t("<span></span>").text(e.text)):e.text},c=l.NodeListByIdControl=r.extend({controlClassName:"pgadmin-node-select form-control",defaults:i.extend({},r.prototype.defaults,{url:"nodes",filter:void 0,transform:function(e){var t=this,n=t.field.get("schema_node"),a=[],l=t.field.get("filter")||function(){return!0};return l=l.bind(t),i.each(e,(function(e){if(l(e)){var s=i.isFunction(n.node_label)?n.node_label.apply(n,[e,t.model,t]):e.label,o=i.isFunction(n.node_image)?n.node_image.apply(n,[e,t.model,t]):n.node_image||"icon-"+n.type;a.push({value:e._id,image:o,label:s})}})),a},select2:{allowClear:!0,placeholder:e("Select an item..."),width:"style",templateResult:d,templateSelection:d}})});l.NodeListByNameControl=c.extend({defaults:i.extend({},c.prototype.defaults,{transform:function(e){var t=this,n=t.field.get("schema_node"),a=[],l=t.field.get("filter")||function(){return!0};return l=l.bind(t),i.each(e,(function(e){if(l(e)){var s=i.isFunction(n.node_label)?n.node_label.apply(n,[e,t.model,t]):e.label,o=i.isFunction(n.node_image)?n.node_image.apply(n,[e,t.model,t]):n.node_image||"icon-"+n.type;a.push({value:e.label,image:o,label:s})}})),a}})}),t.fn.pgMakeVisible=function(e){return this.each((function(){if(this&&t(this.length))for(var i,n,a=t(this);a&&a.length>0;)if(i=a.get(0).offsetTop+a.height(),a=a.parent(),(n=a)&&n.length>0&&n.get(0).scrollHeight>n.height()&&a.scrollTop(i),a.hasClass(e))return}))},t.fn.pgMakeBackgridVisible=function(e){return this.each((function(){if(this&&t(this.length)){var i=t(this),n=t(this).offsetParent().parent(),a=n.offset().top,l=n.height(),s=t(this).closest(e);if(0==s.length)return!1;if(l>s[0].offsetHeight-a){var o=i.get(0).offsetTop+i.height();s.find(".tab-content").scrollTop(o)}return!0}}))};var u=o.Extension.NodeAjaxOptionsCell=o.Extension.Select2Cell.extend({defaults:i.extend({},o.Extension.Select2Cell.prototype.defaults,{url:void 0,transform:void 0,url_with_id:!1,select2:{allowClear:!0,placeholder:e("Select an item..."),width:"style"},opt:{label:null,value:null,image:null,selected:!1}}),template:i.template('<option <% if (image) { %> data-image=<%= image %> <% } %> value="<%- value %>" <%= selected ? \'selected="selected"\' : "" %>><%- label %></option>'),initialize:function(){o.Extension.Select2Cell.prototype.initialize.apply(this,arguments);var e=this.column.get("url")||this.defaults.url,a=i.has(this.column.attributes,"options_cached"),l=a&&this.column.get("options_cached");if(e&&!l){var s,r=this,d=this.model,c=this.column,u=d.top||d,p=c.get("schema_node"),h=c.get("node_info"),f=c.get("url_with_id")||!1,m=this.column.get("url_jump_after_node")||null,g=p.generate_url.apply(p,[null,e,c.get("node_data"),f,h,m]),v=c.get("cache_node");v=v&&n.Browser.Nodes[v]||p,s=c.has("cache_level")?c.get("cache_level"):v.cache_level(h,f);var b=v.cache(p.type+"#"+e,h,s);c.get("version_compatible")&&(i.isUndefined(b)||i.isNull(b))&&(u.trigger("pgadmin:view:fetching",d,c),t.ajax({async:!1,url:g}).done((function(t){b=v.cache(p.type+"#"+e,h,s,t.data)})).fail((function(){u.trigger("pgadmin:view:fetch:error",d,c)})),u.trigger("pgadmin:view:fetched",d,c)),b=b&&b.data||[];var y=c.get("transform")||r.defaults.transform;y&&i.isFunction(y)?c.set("options",y.bind(c,b)):c.set("options",b),a&&c.set("options_cached",!0)}}});return o.Extension.NodeListByIdCell=u.extend({controlClassName:"pgadmin-node-select backgrid-cell",defaults:i.extend({},u.prototype.defaults,{url:"nodes",filter:void 0,transform:function(e,t){var n=t||this,a=n.column.get("schema_node"),l=[],s=n.column.get("filter")||function(){return!0};return s=s.bind(n),i.each(e,(function(e){if(s(e)){var t=i.isFunction(a.node_label)?a.node_label.apply(a,[e,n.model,n]):e.label,o=i.isFunction(a.node_image)?a.node_image.apply(a,[e,n.model,n]):a.node_image||"icon-"+a.type;l.push({value:e._id,image:o,label:t})}})),l},select2:{placeholder:e("Select an item..."),width:"style",templateResult:d,templateSelection:d}})}),o.Extension.NodeListByNameCell=u.extend({controlClassName:"pgadmin-node-select backgrid-cell",defaults:i.extend({},u.prototype.defaults,{url:"nodes",filter:void 0,transform:function(e,t){var n=t||this,a=n.column.get("schema_node"),l=[],s=n.column.get("filter")||function(){return!0};return s=s.bind(n),i.each(e,(function(e){if(s(e)){var t=i.isFunction(a.node_label)?a.node_label.apply(a,[e,n.model,n]):e.label,o=i.isFunction(a.node_image)?a.node_image.apply(a,[e,n.model,n]):a.node_image||"icon-"+a.type;l.push({value:e.label,image:o,label:t})}})),l},select2:{placeholder:e("Select an item..."),width:"style",templateResult:d,templateSelection:d}})}),o.Extension.MultiSelectAjaxCell=o.Extension.NodeAjaxOptionsCell.extend({defaults:i.extend({},u.prototype.defaults,{transform:void 0,url_with_id:!1,select2:{allowClear:!0,placeholder:e("Select an item..."),width:"style",multiple:!0},opt:{label:null,value:null,image:null,selected:!1}}),getValueFromDOM:function(){var e=[];return this.$el.find("select").find(":selected").each((function(){e.push(t(this).attr("value"))})),e}}),l.MultiSelectAjaxControl=r.extend({defaults:i.extend({},r.prototype.defaults,{select2:{multiple:!0,allowClear:!0,width:"style"}})}),l}.apply(t,n))||(e.exports=a)},29908:(e,t,i)=>{"use strict";var n,a;i(68309),i(24812),i(89554),i(32564),n=[i(81311),i(55112),i(19755),i(35816)],void 0===(a=function(e,t,i){var n=t.Browser=t.Browser||{},a=window.wcDocker;return t.Browser.Panel=function(t){e.extend(this,e.pick(t,["name","title","width","height","showTitle","isCloseable","isPrivate","isLayoutMember","content","icon","events","onCreate","elContainer","canHide","limit","extraClasses","canMaximise"]))},e.extend(t.Browser.Panel.prototype,{name:"",title:"",width:300,height:600,showTitle:!0,isCloseable:!0,isPrivate:!1,isLayoutMember:!0,content:"",icon:"",panel:null,onCreate:null,elContainer:!1,canMaximise:!1,limit:null,extraClasses:null,load:function(t,n){var l=this;l.panel||t.registerPanelType(l.name,{title:l.title,isPrivate:l.isPrivate,limit:l.limit,isLayoutMember:l.isLayoutMember,onCreate:function(t){if(i(t).data("pgAdminName",l.name),t.initSize(l.width,l.height),l.showTitle){var s='<a href="#" tabindex="-1" class="panel-link-heading">'+(n||l.title)+"</a>";t.title(s),""!=l.icon&&t.icon(l.icon)}else t.title(!1);var o=i("<div>",{class:"pg-panel-content"}).append(i(l.content));e.isNull("extraClasses")||o.addClass(l.extraClasses),t.maximisable(!!l.canMaximise),t.closeable(!!l.isCloseable),t.layout().addItem(o),l.panel=t,l.events&&e.isObject(l.events)&&e.each(l.events,(function(i,n){i&&e.isFunction(i)&&t.on(n,i)})),e.each([a.EVENT.UPDATED,a.EVENT.VISIBILITY_CHANGED,a.EVENT.BEGIN_DOCK,a.EVENT.END_DOCK,a.EVENT.GAIN_FOCUS,a.EVENT.LOST_FOCUS,a.EVENT.CLOSED,a.EVENT.BUTTON,a.EVENT.ATTACHED,a.EVENT.DETACHED,a.EVENT.MOVE_STARTED,a.EVENT.MOVE_ENDED,a.EVENT.MOVED,a.EVENT.RESIZE_STARTED,a.EVENT.RESIZE_ENDED,a.EVENT.RESIZED,a.EVENT.SCROLLED],(function(e){t.on(e,l.eventFunc.bind(t,e))})),l.onCreate&&e.isFunction(l.onCreate)&&l.onCreate.apply(l,[t,o]),["dragover","drop"].forEach((function(e){o[0].addEventListener(e,(function(e){e.stopPropagation(),e.preventDefault()}))})),l.elContainer&&(t.pgElContainer=o,o.addClass("pg-el-container"),e.each([a.EVENT.RESIZED,a.EVENT.ATTACHED,a.EVENT.DETACHED,a.EVENT.VISIBILITY_CHANGED],(function(e){t.on(e,l.resizedContainer.bind(t))})),l.resizedContainer.apply(t)),l.canHide&&e.each([a.EVENT.CLOSED,a.EVENT.VISIBILITY_CHANGED],(function(e){t.on(e,l.handleVisibility.bind(t,e))}))}})},eventFunc:function(e){var t=i(this).data("pgAdminName");try{n.Events.trigger("pgadmin-browser:panel",e,this,arguments),n.Events.trigger("pgadmin-browser:panel:"+e,this,arguments),t&&(n.Events.trigger("pgadmin-browser:panel-"+t,e,this,arguments),n.Events.trigger("pgadmin-browser:panel-"+t+":"+e,this,arguments))}catch(e){console.warn(e.stack||e)}},resizedContainer:function(){var e=this;if(e.pgElContainer&&!e.pgResizeTimeout){if(!e.isVisible())return clearTimeout(e.pgResizeTimeout),void(e.pgResizeTimeout=null);e.pgResizeTimeout=setTimeout((function(){var t=e.width(),i="xs";e.pgResizeTimeout=null,t<480&&(i="xs"),t>=480&&(i="sm"),t>=768&&(i="md"),t>=992&&(i="lg"),t>=1200&&(i="xl"),e.pgElContainer.attr("el",i)}),100)}},handleVisibility:function(i){var a={dashboard:t.Dashboard,statistics:n.NodeStatistics,dependencies:n.NodeDependencies,dependents:n.NodeDependents}[this._type];e.isUndefined(a)||e.isUndefined(a.toggleVisibility)||("panelClosed"==i?a.toggleVisibility.call(a,!1,!0):"panelVisibilityChanged"==i&&a.toggleVisibility.call(a,n.docker.findPanels(this._type)[0].isVisible(),!1))}}),t.Browser.Panel}.apply(t,n))||(e.exports=a)},58386:(e,t,i)=>{"use strict";var n,a;i(62032),i(65894),i(63867),n=[i(91669),i(28008),i(19755),i(81311),i(55112),i(55455)],void 0===(a=function(e,t,i,n,a,l){return(a=a||window.pgAdmin||{}).FileManager||(a.FileManager={init:function(){this.initialized||(this.initialized=!0)},show_dialog:function(e){var t=a.Browser.stdW.calc(a.Browser.stdW.md),i=a.Browser.stdH.calc(a.Browser.stdH.lg);"create_file"==e.dialog_type?l.createModeDlg(e).resizeTo(t,i):"storage_dialog"==e.dialog_type?l.fileStorageDlg(e).resizeTo(t,i):l.fileSelectionDlg(e).resizeTo(t,i)}}),a.FileManager}.apply(t,n))||(e.exports=a)},55455:(e,t,i)=>{"use strict";var n,a,l=i(64492);i(82772),i(74916),i(15306),i(24603),i(39714),i(32564),i(24812),i(26833),i(69826),n=[i(91669),i(58307),i(19755),i(44092)],void 0===(a=function(e,t,i,n){t.defaults.transition="zoom",t.defaults.theme.ok="btn btn-primary fa fa-lg fa-check pg-alertify-button",t.defaults.theme.cancel="btn btn-secondary fa fa-lg fa-times pg-alertify-button",t.defaults.theme.input="form-control",t.defaults.closable=!1,t.pgIframeDialog||t.dialog("pgIframeDialog",(function(){var e;return{main:function(e){return this.set({pg_msg:e})},setup:function(){return{options:{padding:!1,overflow:!1,closable:!0}}},build:function(){(e=document.createElement("iframe")).src="",e.frameBorder="no",e.width="100%",e.height="100%",this.elements.content.appendChild(e),this.elements.body.style.minHeight=.5*screen.height+"px"},settings:{pg_msg:void 0},settingUpdated:function(t,i,n){if("pg_msg"===t){var a=e.contentWindow||e.contentDocument;a.document&&(a=a.document),a.open(),a.write(n),a.close()}},hooks:{onupdate:function(t,i,n){"resizable"===t&&(n?(this.elements.content.removeAttribute("style"),e&&e.removeAttribute("style")):(this.elements.content.style.minHeight="inherit",e&&(e.style.minHeight="inherit")))}}}})),t.pgNotifier=function(i,n,a,s){var o=n.responseText,r=n.getResponseHeader("Content-Type");if(0==n.status)o=e("Connection to the server has been lost."),a=e("Connection Lost");else if(r)try{if(0==r.indexOf("application/json")){var d=JSON.parse(o);if("CRYPTKEY_MISSING"==d.info)return void window.pgAdmin.Browser.set_master_password("",(function(){s&&"function"==typeof s&&s("CRYPTKEY_SET")}));if(null!=d.result&&(!d.errormsg||""==d.errormsg)&&s&&"function"==typeof s)return s(d.result);o=l.escape(d.result)||l.escape(d.errormsg)||"Unknown error"}if(0==r.indexOf("text/html")){var c=a;return"error"===i&&(c='<div class="media text-danger text-14"><div class="media-body media-middle"><div class="alert-text" role="alert">'+a+'</div><br/><div class="alert-text" role="alert">'+e("Click for details.")+"</div></div></div>"),void t.notify(c,i,0,(function(){t.pgIframeDialog().show().set({frameless:!1}).set("pg_msg",o)}))}}catch(e){t.alert().show().set("message",e.message).set("title","Error").set("closable",!0)}t.alert().show().set("message",o.replace(new RegExp(/\r?\n/,"g"),"<br />")).set("title",a).set("closable",!0)},t.pgRespErrorNotify=function(i,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=i.getResponseHeader("Content-Type");if(410===i.status){var o=window.pgAdmin.Browser;o.report_error(e("Error: Object not found - %s.",i.statusText),i.responseJSON.errormsg)}else{try{if(0===i.status)n=e("Connection to the server has been lost.");else{if(s&&s.indexOf("application/json")>=0){var r=JSON.parse(i.responseText);n=l.escape(r.result)||l.escape(r.errormsg)||e("Unknown error")}if(s.indexOf("text/html")>=0){var d='<div class="media text-danger text-14"><div class="media-body media-middle"><div class="alert-text" role="alert">'+e("INTERNAL SERVER ERROR")+'</div><br/><div class="alert-text" role="alert">'+e("Click for details.")+"</div></div></div>";return void t.notify(d,"error",0,(function(){t.pgIframeDialog().show().set({frameless:!1}).set("pg_msg",i.responseText)}))}}}catch(e){n=e.message}t.error(a+" "+n)}};var a=function(e){var t=this;e&&(t.pgResizeRecursion=!1),t.pgResizeTimeout||(t.pgResizeTimeout=setTimeout(function(){var e=i(this.elements.dialog),t=e.width(),n="xs";this.pgResizeTimeout=null,t<480&&(n="xs"),t>=480&&(n="sm"),t>=768&&(n="md"),t>=992&&(n="lg"),t>=1200&&(n="xl"),e.attr("el",n)}.bind(t),100))},s=function e(t){var i=this;t&&(i.pgResizeRecursion=!0),setTimeout((function(){a.apply(i),i.pgResizeRecursion&&e.apply(i,[!1])}),100)};t.pgDialogBuild=function(){this.set("onshow",(function(){var t=this;this.elements.dialog.classList.add("pg-el-container"),i(this.elements.commands.close).attr("title",e("Close")),i(this.elements.commands.maximize).attr("title",e("Maximize")),i(this.elements.commands.close).attr("aria-label",e("Close")),i(this.elements.commands.maximize).attr("aria-label",e("Maximize")),a.apply(this,arguments);var l=this,s=Object.values(this.elements.commands);i(s).on("keydown","button",(function(e){if(e.shiftKey&&9==e.keyCode&&0==i(t).nextAll("button:not([disabled])").length){var a=i(l.elements.footer);n.findAndSetFocus(a.find("button:not([disabled]):last"))}}))})),this.set("onresize",s.bind(this,!0)),this.set("onresized",a.bind(this,!0)),this.set("onmaximized",a),this.set("onrestored",a);for(var t=0;t<this.__internal.buttons.length;t++)l.isUndefined(this.__internal.buttons[t].key)&&(this.__internal.buttons[t].key=null);var o=this;i(this.elements.footer).on("keydown","button",(function(e){if(!e.shiftKey&&9==e.keyCode&&0==i(this).nextAll("button:not([disabled])").length)return n.findAndSetFocus(i(o.elements.dialog)),!1}))},t.pgHandleItemError=function(t,n,a,l){var s=window.pgAdmin.Browser;if(t&&s){var o=t.getResponseHeader("Content-Type"),r=o&&0==o.indexOf("application/json")&&JSON.parse(t.responseText);if(r&&(503==t.status?"CONNECTION_LOST"==r.info&&"server"in l.info&&r.data.sid>=0&&r.data.sid==l.info.server._id:428==t.status&&r.errormsg&&r.errormsg==e("Connection to the server has been lost."))){l.preHandleConnectionLost&&"function"==typeof l.preHandleConnectionLost&&l.preHandleConnectionLost.apply(this,arguments);var d=s.Nodes.server,c={resp:r,xhr:t,args:l},u=function(){var e=function(i,n,a){this.args.info.server._id==i&&(s.Events.off("pgadmin:server:connected",e),s.Events.off("pgadmin:server:connect:cancelled",t),this.resp.data.database&&this.resp.data.database!=a.db&&s.Events.trigger("pgadmin:database:connection:lost",this.args.item,this.resp,!0))}.bind(this),t=function(i,n,a){i==this.args.info.server.id&&(s.Events.off("pgadmin:server:connected",e),s.Events.off("pgadmin:server:connect:cancelled",t),s.Events.trigger("pgadmin:database:connect:cancelled",i,this.resp.data.database||a.db,n,a))}.bind(this);s.Events.on("pgadmin:server:connected",e),s.Events.on("pgadmin:server:connect:cancelled",t),s.Events.trigger("pgadmin:server:connection:lost",this.args.item,this.resp)}.bind(c);return i.ajax({url:d.generate_url(null,"connect",l.info.server,!0,l.info),dataType:"json"}).done((function(e){e.success&&"connected"in e.data&&e.data.connected?s.Events.trigger("pgadmin:database:connection:lost",l.item,r):u()})).fail((function(){u()})),!0}return r&&"CRYPTKEY_MISSING"==r.info&&t.status,!1}};var o=t.success,r=t.error,d=t.warning;return l.extend(t,{orig_success:o,orig_error:r,orig_warning:d}),l.extend(t,{success:function(e,i,n){var a='<div class="d-flex px-3 py-2">\n        <div class="pr-2">\n          <i class="fa fa-check" aria-hidden="true"></i>\n        </div>\n        <div class="alert-text-body" role="status">'.concat(e,"</div>\n      </div>");return t.orig_success(a,i,n)},error:function(e,i,n){var a='<div class="d-flex px-3 py-2">\n        <div class="pr-2">\n          <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>\n        </div>\n        <div class="alert-text-body" role="status">'.concat(e,"</div>\n      </div>");return t.orig_error(a,i,n)},info:function(e,i){var n='<div class="d-flex px-3 py-2">\n        <div class="mr-3">\n          <i class="fa fa-info-circle" aria-hidden="true"></i>\n        </div>\n        <div class="alert-text-body" role="status">'.concat(e,"</div>\n      </div>");return t.notify(n,i)},warning:function(e,i){var n='<div class="d-flex px-3 py-2">\n        <div class="mr-3">\n          <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>\n        </div>\n        <div class="alert-text-body" role="status">'.concat(e,"</div>\n      </div>");return t.orig_warning(n,i)}}),t.confirm().set({onshow:function(){i(this.elements.commands.close).attr("title",e("Close")),i(this.elements.commands.maximize).attr("title",e("Maximize")),i(this.elements.content).addClass("ajs-wrap-text"),i(this.elements.header).attr("id","confirm-dialog-header"),i(this.elements.body).attr("id","confirm-dialog-body"),i(this.elements.dialog).attr({role:"alertdialog","aria-modal":"true","aria-labelledby":"confirm-dialog-header","aria-describedby":"confirm-dialog-body"})},reverseButtons:!0}),t.prompt().set({reverseButtons:!0}),t.alert().set({onshow:function(){i(this.elements.header).attr("id","alert-dialog-header"),i(this.elements.body).attr("id","alert-dialog-body"),i(this.elements.modal).attr({role:"alertdialog","aria-modal":"true","aria-labelledby":"alert-dialog-header","aria-describedby":"alert-dialog-body"})}}),i("body").off("keyup").on("keyup",(function(e){if(13===e.which||27===e.which)for(var t=["select2-selection","select2-search__field"],n=i(e.target),a=0;a<t.length;a++)if(n.hasClass(t[a])){e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation();break}})),t}.apply(t,n))||(e.exports=a)},12030:(e,t,i)=>{"use strict";var n,a;function l(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?l(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i(69070),i(82526),i(57327),i(38880),i(89554),i(54747),i(49337),i(33321),i(74916),i(23123),i(69600),i(69826),i(5735),i(83753),i(68309),i(32564),i(24812),i(92222),i(82772),i(47941),i(5212),i(73210),i(21249),i(15306),i(91058),i(83710),i(41539),i(39714),n=[i(91669),i(81311),i(19755),i(72316),i(95283),i(83879),i(4631),i(81240),i(72945),i(1950),i(75471),i(76573),i(71158),i(20454),i(56796)],void 0===(a=function(e,t,i,n,a,l,o,r,d,c,u,p){var h=window.pgAdmin=window.pgAdmin||{},f=h.Browser;h.editableCell=function(){if(this.attributes&&!t.isUndefined(this.attributes.disabled)&&!t.isNull(this.attributes.disabled)){if(t.isFunction(this.attributes.disabled))return!this.attributes.disabled.apply(this,arguments);if(t.isBoolean(this.attributes.disabled))return!this.attributes.disabled}},t.extend(a,{controlLabelClassName:"control-label pg-el-sm-3 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-9 pg-el-12",controlContainerClassName:"pgadmin-controls pg-el-sm-9 pg-el-12",groupClassName:"pgadmin-control-group form-group row pg-el-12",setGroupClassName:"set-group pg-el-12",tabClassName:"backform-tab pg-el-12",setGroupContentClassName:"fieldset-content pg-el-12",accordianGroupClassName:"accordian-group pg-el-12",accordianContentClassName:"accordian-content pg-el-12",hiddenClassName:"d-none",helpMessageClassName:"form-text text-muted help-block",helpBlockControlClass:"pgadmin-controls offset-sm-3 pg-el-sm-9 pg-el-12"}),a.controlMapper={int:["uneditable-input","numeric","integer"],text:["uneditable-input","input","string"],numeric:["uneditable-input","numeric","numeric"],date:"datepicker",datetime:"datetimepicker",boolean:"boolean",options:["readonly-option","select",l.Extension.PGSelectCell],multiline:["textarea","textarea","string"],collection:["sub-node-collection","sub-node-collection","string"],uniqueColCollection:["unique-col-collection","unique-col-collection","string"],switch:"switch",select2:"select2",note:"note",color:"color",radioModern:"radioModern"},a.getMappedControl=function(e,i){if(e in a.controlMapper){var n=a.controlMapper[e];if(!t.isArray(n))return n;var l=1,s=t.size(n);switch(i){case"properties":l=0;break;case"edit":case"create":case"control":l=1;break;case"cell":l=2;break;default:l=0}return n[l>s?0:l]}return e};var m=a.RawFormatter=function(){};t.extend(m.prototype,{fromRaw:function(e){return e},toRaw:function(e){return e}});var g=a.Control.prototype.initialize,v=a.Control.prototype.remove;t.extend(a.Control.prototype,{defaults:t.extend(a.Control.prototype.defaults,{helpMessage:null}),initialize:function(){g.apply(this,arguments);var e=this.field.get("deps"),i=this;e&&t.isArray(e)&&t.each(e,(function(e){var t=e.split(".").shift();i.listenTo(i.model,"change:"+t,i.render)}))},remove:function(){var e=this,i=e.field.get("deps"),a=this.field.get("name").split("."),l=a.shift();e.stopListening(e.model,"change:"+l,e.render),e.model.errorModel instanceof n.Model&&e.stopListening(e.model.errorModel,"change:"+l,e.updateInvalid),i&&t.isArray(i)&&t.each(i,(function(t){var i=t.split(".").shift();e.stopListening(e.model,"change:"+i,e.render)})),this.cleanup&&this.cleanup.apply(this),v?v.apply(e,arguments):n.View.prototype.remove.apply(e,arguments)},template:t.template(['<label class="<%=Backform.controlLabelClassName%>" for="<%=cId%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <input id="<%=cId%>" class="<%=Backform.controlClassName%> uneditable-input" <%=disabled ? "disabled" : ""%> <%=readonly ? "readonly aria-readonly=true" : ""%> id="<%=cId%>" value="<%-value%>" />',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),clearInvalid:function(){return this.$el.removeClass(a.errorClassName),this.$el.find(".pgadmin-control-error-message").remove(),this},updateInvalid:function(){var e=this,l=this.model.errorModel;if(!(l instanceof n.Model))return this;this.clearInvalid(),this.$el.find(":input[name]").not("button").each((function(n,s){var o=e.keyPathAccessor(l.toJSON(),i(s).attr("name"));t.isEmpty(o)||e.$el.addClass(a.errorClassName)}))},render:function(){var e=t.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=e.name.split("."),l=n.shift(),s=n.join("."),o=this.keyPathAccessor(i[l],s),r=t.extend(e,{rawValue:o,value:this.formatter.fromRaw(o,this.model),attributes:i,formatter:this.formatter}),d=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};return t.extend(r,{disabled:d(r.disabled,r,this.model),readonly:d(r.readonly,r,this.model),visible:d(r.visible,r,this.model),required:d(r.required,r,this.model)}),r.cId=r.cId||t.uniqueId("pgC_"),this.$el.removeClass(a.hiddenClassName),r.visible||this.$el.addClass(a.hiddenClassName),this.$el.html(this.template(r)).addClass(e.name),this.updateInvalid(),this}}),t.extend(a.InputControl.prototype,{defaults:t.extend(a.InputControl.prototype.defaults,{controlLabelClassName:a.controlLabelClassName,controlsClassName:a.controlsClassName}),template:t.template(['<label class="<%=controlLabelClassName%>" for="<%=cId%>"><%=label%></label>','<div class="<%=controlsClassName%>">','  <input type="<%=type%>" id="<%=cId%>" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" maxlength="<%=maxlength%>" value="<%-value%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=readonly ? "readonly aria-readonly=true" : ""%> <%=required ? "required" : ""%> />',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),events:{"change input":"onChange","blur input":"onChange","keyup input":"onKeyUp","focus input":"clearInvalid"},onKeyUp:function(e){this.key_timeout&&clearTimeout(this.key_timeout),this.keyup_timeout=setTimeout(function(){this.onChange(e)}.bind(this),400)}}),t.extend(a.TextareaControl.prototype,{defaults:t.extend(a.TextareaControl.prototype.defaults,{rows:5,helpMessage:null,maxlength:null}),events:{"change textarea":"onChange","keyup textarea":"onKeyUp","paste textarea":"onChange","selectionchange textarea":"onChange","focus textarea":"clearInvalid"},template:t.template(['<label class="<%=Backform.controlLabelClassName%>" for="<%=cId%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <textarea id="<%=cId%>"','    class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" aria-label="<%=name%>"',"  <% if (maxlength) { %>",'    maxlength="<%=maxlength%>"',"  <% } %>",'    placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=readonly ? "readonly aria-readonly=true" : ""%>','    rows=<%=rows ? rows : ""%>','    <%=required ? "required" : ""%>><%-value%></textarea>',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),onKeyUp:function(e){this.key_timeout&&clearTimeout(this.key_timeout),this.keyup_timeout=setTimeout(function(){this.onChange(e)}.bind(this),400)}}),a.SelectControl.prototype.render=function(){var e=t.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=e.name.split("."),l=n.shift(),s=n.join("."),o=this.keyPathAccessor(i[l],s),r=t.extend(e,{rawValue:o,value:this.formatter.fromRaw(o,this.model),attributes:i,formatter:this.formatter}),d=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};if(t.extend(r,{disabled:d(r.disabled,r,this.model),visible:d(r.visible,r,this.model),required:d(r.required,r,this.model)}),t.isFunction(r.options))try{r.options=r.options(this)}catch(e){r.options=[],this.model.trigger("pgadmin-view:transform:error",this.model,this.field,e)}return r.cId=r.cId||t.uniqueId("pgC_"),this.$el.removeClass(a.hiddenClassName),r.visible||this.$el.addClass(a.hiddenClassName),this.$el.html(this.template(r)).addClass(e.name),this.updateInvalid(),this},a.SelectControl.prototype.template=t.template(['<label class="<%=Backform.controlLabelClassName%>" for="<%=cId%>"><%=label%></label>','<div class="<%=Backform.controlContainerClassName%>">','  <select id="<%=cId%>" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" value="<%-value%>" <%=disabled ? "disabled" : ""%> <%=readonly ? "disabled" : ""%> <%=required ? "required" : ""%> >',"    <% for (var i=0; i < options.length; i++) { %>","      <% var option = options[i]; %>",'      <option value="<%-formatter.fromRaw(option.value)%>" <%=option.value === rawValue ? "selected=\'selected\'" : ""%> <%=option.disabled ? "disabled=\'disabled\'" : ""%>><%-option.label%></option>',"    <% } %>","  </select>","</div>"].join("\n")),t.extend(a.SelectControl.prototype.defaults,{helpMessage:null}),a.ReadonlyOptionControl=a.SelectControl.extend({template:t.template(['<label class="<%=Backform.controlLabelClassName%>" for="<%=cId%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">',"<% for (var i=0; i < options.length; i++) { %>"," <% var option = options[i]; %>"," <% if (option.value === rawValue) { %>",' <input id="<%=cId%>" class="<%=Backform.controlClassName%> uneditable-input" readonly value="<%-option.label%>"></span>'," <% } %>","<% } %>","<% if (helpMessage && helpMessage.length) { %>",'  <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"<% } %>","</div>"].join("\n")),events:{},getValueFromDOM:function(){return this.formatter.toRaw(this.$el.find("span").text(),this.model)}}),t.extend(a.RadioControl.prototype,{updateInvalid:function(){var e=this,l=this.model.errorModel;if(!(l instanceof n.Model))return this;this.clearInvalid(),this.$el.find(":input[name]").not("button").each((function(n,s){var o=e.keyPathAccessor(l.toJSON(),i(s).attr("name"));t.isEmpty(o)||e.$el.addClass(a.errorClassName).find('[type="radio"]').append(i("<div></div>").addClass("pgadmin-control-error-message pg-el-offset-4 pg-el-8 pg-el-8 help-block").text(o))}))}}),a.RadioModernControl=a.RadioControl.extend({defaults:{controlLabelClassName:a.controlLabelClassName,controlsClassName:a.controlsClassName,extraClasses:[],helpMessage:"",name:""},events:t.extend({},a.InputControl.prototype.events,{"click label.btn":"toggle"}),toggle:function(e){var t=i(e.currentTarget);t.closest(".btn-group").find(".btn").removeClass("btn-primary").addClass("btn-secondary").find(".fa").addClass("visibility-hidden").siblings("input").prop("checked",!1),t.removeClass("btn-secondary").addClass("btn-primary").find(".fa").removeClass("visibility-hidden").siblings("input").prop("checked",!0).trigger("change"),e.preventDefault(),e.stopPropagation()},template:t.template(["<% if (label) { %>",'<label class="<%=controlLabelClassName%>" id="<%=cId%>_grplabel"><%=label%></label>',"<% } %>","<div class=\"<%=controlsClassName%> <%=extraClasses.join(' ')%>\">",' <div class="btn-group pgadmin-controls-radio-none<% if (disabled) {%> disabled <%}%>" role="radiogroup" <% if (label) {%> aria-labelledby="<%=cId%>_grplabel" <%}%>>',"  <% for (var i=0; i < options.length; i++) { %>","  <% var option = options[i]; %>",'  <label role="radio" class="btn btn-radiomodern <% if (option.value == value) { %> btn-primary <%} else {%> btn-secondary <%}%> <% if (!option.disabled && !disabled) { %>" tabindex="0"<% } else { %> disabled"<% } %>>','    <i class="fa fa-check  <% if (option.value != value) { %>visibility-hidden <%}%>" role="img"></i>','    <input type="radio" name="<%=name%>" autocomplete="off" value=<%-formatter.fromRaw(option.value)%> <% if (option.value == value) { %> checked<%}%> <% if (option.disabled || disabled) { %> disabled <%}%>> <%-option.label%>',"  </label>","  <% } %>"," </div>"," <% if (helpMessage && helpMessage.length) { %>",'  <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>'," <% } %>","</div>"].join("\n")),formatter:m,getValueFromDOM:function(){return this.formatter.toRaw(this.$el.find('input[type="radio"]:checked').attr("value"),this.model)},render:function(){var e=t.defaults(this.field.toJSON(),this.defaults),n=this.model.toJSON(),l=e.name.split("."),s=l.shift(),o=l.join("."),r=this.keyPathAccessor(n[s],o),d=t.extend(e,{rawValue:r,value:this.formatter.fromRaw(r,this.model),attributes:n,formatter:this.formatter}),c=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};return t.extend(d,{disabled:c(d.disabled,d,this.model),visible:c(d.visible,d,this.model),required:c(d.required,d,this.model)}),d.cId=d.cId||t.uniqueId("pgC_"),d.options=t.isFunction(d.options)?d.options.apply(d,[this.model]):d.options,this.$el.removeClass(a.hiddenClassName),d.visible||this.$el.addClass(a.hiddenClassName),this.$el.html(this.template(d)).addClass(e.name),this.updateInvalid(),this.$el.find(".btn").on("keyup",(function(e){32==e.keyCode&&i(e.currentTarget).trigger("click")})),this}}),a.SwitchControl=a.InputControl.extend({defaults:{label:"",options:{onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"ternary",size:"mini",width:null,height:null},controlLabelClassName:a.controlLabelClassName,controlsClassName:a.controlsClassName,extraClasses:[],helpMessage:null,extraToggleClasses:null},template:t.template(['<span class="<%=controlLabelClassName%>"><%=label%></span>',"<div class=\"<%=controlsClassName%> <%=extraClasses.join(' ')%>\">",'      <input tabindex="-1" type="checkbox" aria-hidden="true" aria-label="'+e("Toggle button")+'" data-style="quick" data-toggle="toggle"','      data-size="<%=options.size%>" data-height="<%=options.height%>"  ','      data-on="<%=options.onText%>" data-off="<%=options.offText%>" ','      data-onstyle="<%=options.onColor%>" data-offstyle="<%=options.offColor%>" data-width="<%=options.width%>" ','      name="<%=name%>" <%=value ? "checked=\'checked\'" : ""%> <%=disabled ? "disabled" : ""%> <%=readonly ? "disabled" : ""%> <%=required ? "required" : ""%> />',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),getValueFromDOM:function(){return this.formatter.toRaw(this.$input.prop("checked"),this.model)},events:{"change input":"onChange",keyup:"toggleSwitch"},setSrValue:function(){var i=t.defaults(this.field.get("options"),this.defaults.options),n=i.onText,a=i.offText,l=this.field.get("label");this.$el.find(".toggle.btn").hasClass("off")?this.$el.find(".sr-value").text("\n          ".concat(l,", ").concat(a,", ")+e("Toggle")+"\n        "):this.$el.find(".sr-value").text("\n          ".concat(l,", ").concat(n,", ")+e("Toggle")+"\n        ")},onChange:function(){a.InputControl.prototype.onChange.apply(this,arguments),this.setSrValue()},toggleSwitch:function(e){32==e.keyCode&&(this.$el.find("input[type=checkbox]").bootstrapToggle("toggle"),e.preventDefault(),this.setSrValue())},render:function(){var e=t.defaults(this.field.toJSON(),this.defaults),n=this.model.toJSON(),l=e.name.split("."),s=l.shift(),o=l.join("."),r=this.keyPathAccessor(n[s],o),d=t.extend(e,{rawValue:r,value:this.formatter.fromRaw(r,this.model),attributes:n,formatter:this.formatter}),c=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};return t.extend(d,{disabled:c(e.disabled,e,this.model),readonly:c(e.readonly,e,this.model),visible:c(d.visible,e,this.model),required:c(d.required,e,this.model)}),d.cId=d.cId||t.uniqueId("pgC_"),this.$el.removeClass(a.hiddenClassName),d.visible||this.$el.addClass(a.hiddenClassName),a.requiredInputClassName&&this.$el.removeClass(a.requiredInputClassName),d.required&&this.$el.addClass(a.requiredInputClassName),d.options=t.defaults({disabled:d.disabled||d.readonly},this.field.get("options"),this.defaults.options,i.fn.bootstrapToggle.defaults),this.$el.html(this.template(d)).addClass(e.name),t.isNull(e.extraToggleClasses)||this.$el.addClass(e.extraToggleClasses),this.$input=this.$el.find("input[type=checkbox]").first(),this.$input.bootstrapToggle(),this.$el.find(".toggle.btn").attr("tabindex",d.disabled?"-1":"0").attr("id",d.cId),this.$el.find(".toggle.btn .toggle-group .btn").attr("aria-hidden",!0),this.$el.find("div.toggle").append('<label class="sr-value sr-only" for="<%=cId%>"></label>'),this.setSrValue(),this.updateInvalid(),d.readonly&&this.$el.find(".select2-selection").attr("tabindex",0),this}}),a.Dialog=a.Form.extend({schema:void 0,tagName:"div",legend:!0,className:function(){return"pg-el-sm-12 pg-el-md-12 pg-el-lg-12 pg-el-12"},tabPanelClassName:function(){return a.tabClassName},tabIndex:0,initialize:function(e){var i=e.schema;i&&t.isArray(i)&&(this.schema=t.each(i,(function(i){!i.fields||i.fields instanceof n.Collection||(i.fields=new a.Fields(i.fields)),i.cId=i.cId||t.uniqueId("pgC_"),i.hId=i.hId||t.uniqueId("pgH_"),i.disabled=i.disabled||!1,i.legend=e.legend})),e.tabPanelClassName&&t.isFunction(e.tabPanelClassName)&&(this.tabPanelClassName=e.tabPanelClassName)),this.model.errorModel=e.errorModel||this.model.errorModel||new n.Model,this.controls=[]},template:{header:t.template(['<li class="nav-item" <%=disabled ? "disabled" : ""%>>',' <a class="nav-link" data-toggle="tab" role="tab" tabindex="-1" data-tab-index="<%=tabIndex%>" href="#<%=cId%>"','  id="<%=hId%>" aria-controls="<%=cId%>">',"<%=label%></a></li>"].join(" ")),panel:t.template('<div role="tabpanel" tabindex="-1" class="tab-pane <%=label%> <%=tabPanelCodeClass%> pg-el-sm-12 pg-el-md-12 pg-el-lg-12 pg-el-12 fade" id="<%=cId%>" aria-labelledby="<%=hId%>"></div>')},render:function(){this.cleanup();var e=this.$el.children().first().children(".active").first().attr("id"),n=this.model,a=this.controls,l=this.template,s=this,o=100*this.tabIndex;this.$el.empty().attr("role","tabpanel").attr("class",t.result(this,"tabPanelClassName")),n.panelEl=this.$el;var r=i('<ul class="nav nav-tabs" role="tablist"></ul>').appendTo(this.$el),d=i('<div class="tab-content pg-el-sm-12 pg-el-md-12 pg-el-lg-12 pg-el-12"></div>').appendTo(this.$el);t.each(this.schema,(function(e){if(o++,e.version_compatible&&(c=e.visible,u=e,p=n,t.isFunction(c)?c.apply(u,[p]):c)){var c,u,p,h=i(l.panel(t.extend(e,{tabIndex:o,tabPanelCodeClass:e.tabPanelCodeClass?e.tabPanelCodeClass:""}))).appendTo(d).removeClass("collapse").addClass("collapse");i(l.header(e)).appendTo(r),e.fields.each((function(e){var t=new(e.get("control"))({field:e,model:n,dialog:s,tabIndex:o});h.append(t.render().$el),a.push(t)})),r.find('a[data-toggle="tab"]').off("shown.bs.tab").off("hidden.bs.tab").on("hidden.bs.tab",(function(){s.hidden_tab=i(this).data("tabIndex")})).on("shown.bs.tab",(function(){var e=this;e.shown_tab=i(e).data("tabIndex"),n.trigger("pg-property-tab-changed",{model:n,shown:e.shown_tab,hidden:e.hidden_tab,tab:e})}))}}));var c=r.find('[id="'+e+'"]').first();return 1==c.length?(c.addClass("active show"),d.find("#"+c.attr("aria-controls")).addClass("active show")):(r.find(".nav-link").first().addClass("active show"),d.find(".tab-pane").first().addClass("active show")),this},remove:function(e){e&&e.data&&(this.model&&(this.model.reset&&this.model.reset({validate:!1,silent:!0,stop:!0}),this.model.clear({validate:!1,silent:!0,stop:!0}),delete this.model),this.errorModel&&(this.errorModel.clear({validate:!1,silent:!0,stop:!0}),delete this.errorModel)),this.cleanup(),a.Form.prototype.remove.apply(this,arguments)}}),a.Accordian=a.Dialog.extend({className:function(){return"set-group pg-el-12"},tabPanelClassName:function(){return a.tabClassName},legendClass:"badge",contentClass:a.accordianContentClassName+" collapse show",template:{header:t.template(['<div class="<%=Backform.accordianGroupClassName%>" <%=disabled ? "disabled" : ""%>>'," <% if (legend != false) { %>",'  <div class="<%=legendClass%>" <%=collapse ? "data-toggle=\'collapse\'" : ""%> data-target="#<%=cId%>" aria-controls="<%=cId%>" aria-level="3" role="heading"><%=collapse ? "<span class=\'caret\'></span>" : "" %><%=label%></legend>'," <% } %>","</div>"].join("\n")),content:t.template('  <div id="<%= cId %>" class="<%=contentClass%>"></div>')},collapse:!0,render:function(){this.cleanup();var e=this.model,n=this.$el,a=this.template,l=this.controls,s={className:t.result(this,"className"),legendClass:t.result(this,"legendClass"),contentClass:t.result(this,"contentClass"),collapse:t.result(this,"collapse")},o=100*this.tabIndex;return this.$el.empty(),t.each(this.schema,(function(r){if(o++,r.version_compatible&&function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e}(r.visible,r,e)&&r.fields){var d=t.extend({},s,r),c=i(a.header(d)).appendTo(n),u=i(a.content(d)).appendTo(c);r.fields.each((function(t){var i=new(t.get("control"))({field:t,model:e,tabIndex:o});u.append(i.render().$el),l.push(i)}))}})),this},getValueFromDOM:function(){return""},events:{}}),a.Fieldset=a.Dialog.extend({className:function(){return"set-group pg-el-12"},tabPanelClassName:function(){return a.tabClassName},fieldsetClass:a.setGroupClassName,legendClass:"badge",contentClass:a.setGroupContentClassName+" collapse show",template:{header:t.template(['<fieldset class="<%=fieldsetClass%>" <%=disabled ? "disabled" : ""%>>'," <% if (legend != false) { %>",'  <legend class="<%=legendClass%>" <%=collapse ? "data-toggle=\'collapse\'" : ""%> data-target="#<%=cId%>"><%=collapse ? "<span class=\'caret\'></span>" : "" %><%=label%></legend>'," <% } %>","</fieldset>"].join("\n")),content:t.template('  <div id="<%= cId %>" class="<%=contentClass%>"></div>')},collapse:!0,render:function(){this.cleanup();var e=this.model,n=this.$el,a=this.template,l=this.controls,s={className:t.result(this,"className"),fieldsetClass:t.result(this,"fieldsetClass"),legendClass:t.result(this,"legendClass"),contentClass:t.result(this,"contentClass"),collapse:t.result(this,"collapse")},o=100*this.tabIndex;return this.$el.empty(),t.each(this.schema,(function(r){if(o++,r.version_compatible&&function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e}(r.visible,r,e)&&r.fields){var d=t.extend({},s,r),c=i(a.header(d)).appendTo(n),u=i(a.content(d)).appendTo(c);r.fields.each((function(t){var i=new(t.get("control"))({field:t,model:e,tabIndex:o});u.append(i.render().$el),l.push(i)}))}})),this},getValueFromDOM:function(){return""},events:{}}),a.generateGridColumnsFromModel=function(e,i,n,s,o){var r,d=a.generateViewSchema(e,i,n,o,!0,!0),c=[],u=[],p=0;if(t.isNull(s)||t.isUndefined(s))r=function(e){e.cell_priority=p,p+=1,!e.headerCell&&e.cellHeaderClasses&&(e.headerCell=l.Extension.CustomHeaderCell)};else if(t.isArray(s))r=function(e){e.cell_priority=t.indexOf(s,e.name),!e.headerCell&&e.cellHeaderClasses&&(e.headerCell=l.Extension.CustomHeaderCell)};else if(t.isObject(s)){var h=Object.keys(s);r=function(e){var i,n=e.name in s&&s[e.name];t.isNull(n)||t.isUndefined(n)?e.cell_priority=-1:(t.isObject(n)&&("index"in n?(e.cell_priority=n.index,p=p>n.index?p+1:n.index):(i=t.indexOf(h,e.name),e.cell_priority=p=i>p?i:p,p+=1),e.headerCell||(e.cellHeaderClasses&&(e.headerCell=l.Extension.CustomHeaderCell),"class"in n&&t.isString(n.class)&&(e.headerCell=l.Extension.CustomHeaderCell,e.cellHeaderClasses=(e.cellHeaderClasses||"")+" "+n.class))),t.isString(n)&&(i=t.indexOf(h,e.name),e.cell_priority=p=i>p?i:p,p+=1,e.headerCell||(e.headerCell=l.Extension.CustomHeaderCell),e.cellHeaderClasses=(e.cellHeaderClasses||"")+" "+n))}}return t.each(d,(function(e){t.each(e.fields,(function(e){e.cell&&(r(e),-1!=e.cell_priority&&u.push(e))})),c.push(e)})),{columns:t.sortBy(u,(function(e){return e.cell_priority})),schema:c}},a.BinaryPathsGridControl=a.Control.extend({initialize:function(){a.Control.prototype.initialize.apply(this,arguments);var i=n.Model.extend({idAttribute:"serverType",defaults:{serverType:void 0,binaryPath:void 0,isDefault:!1}});this.gridColumns=[{name:"isDefault",label:e("Set as default"),sortable:!1,cell:l.RadioCell,cellHeaderClasses:"width_percent_10",headerCell:l.Extension.CustomHeaderCell,deps:["binaryPath"],editable:function(e){return!t.isUndefined(e.get("binaryPath"))&&!t.isNull(e.get("binaryPath"))&&""!==e.get("binaryPath")||(t.isUndefined(e.get("isDefault"))||t.isNull(e.get("isDefault"))||setTimeout((function(){e.set("isDefault",!1)}),10),!1)}},{name:"serverType",label:e("Database Server"),editable:!1,cell:"string",cellHeaderClasses:"width_percent_20",headerCell:l.Extension.CustomHeaderCell},{name:"binaryPath",label:e("Binary Path"),sortable:!1,cell:l.Extension.SelectFileCell,dialog_type:"select_folder",dialog_title:e("Select Folder"),placeholder:"False"===h.server_mode||h.enable_binary_path_browsing?e("Select binary path..."):e("Enter binary path..."),browse_btn_label:e("Select path"),check_btn_label:e("Validate utilities"),browse_btn_visible:"False"===h.server_mode||!!h.enable_binary_path_browsing}];var s=this.BinPathCollection=new(n.Collection.extend({model:i}))(null),o=JSON.parse(this.model.get(this.field.get("name")));this.BinPathCollection.add(o),this.listenTo(s,"change",this.binPathCollectionChanged)},render:function(){var t=this,n=["<div class='subnode-header'>","  <span class='control-label pg-el-sm-12'>"+e(this.field.get("label"))+"</span>","</div>"].join("\n"),a=i("<div class='pgadmin-control-group backgrid form-group pg-el-12 object subnode'></div>").append(n);return t.grid=new l.Grid({columns:t.gridColumns,collection:t.BinPathCollection,className:"backgrid table presentation table-bordered table-noouter-border table-hover"}),this.$el.empty(),this.$el.append(a.append(t.grid.render().$el)),this.$el.append(['<span class="pg-el-sm-12 form-text text-muted help-block">'+e("Enter the directory in which the psql, pg_dump, pg_dumpall, and pg_restore utilities can be found for the corresponding database server version. The default path will be used for server versions that do not have a path specified.")+"</span>"].join("\n")),this},binPathCollectionChanged:function(){var e=JSON.stringify(this.BinPathCollection.toJSON());this.model.set(this.field.get("name"),e,{silent:!1})}}),a.UniqueColCollectionControl=a.Control.extend({initialize:function(){a.Control.prototype.initialize.apply(this,arguments);var e=this.field.get("uniqueCol")||[],i=this.field.get("model"),n=i.prototype.schema||i.__super__.schema,l=[],s=this;if(t.each(n,(function(e){l.push(e.id)})),e.length>t.intersection(l,e).length){var o="Developer: Unique columns [ "+t.difference(e,l)+" ] not found in collection model [ "+l+" ].";throw o}var r=s.collection=s.model.get(s.field.get("name"));r||(r=s.collection=new h.Browser.Node.Collection(null,{model:s.field.get("model"),silent:!0,handler:s.model,top:s.model.top||s.model,attrName:s.field.get("name")}),s.model.set(s.field.get("name"),r,{silent:!0})),this.field.get("version_compatible")&&(s.listenTo(r,"add",s.collectionChanged),s.listenTo(r,"change",s.collectionChanged))},cleanup:function(){this.stopListening(this.collection,"change",this.collectionChanged),this.field.get("version_compatible")&&(this.stopListening(self.collection,"add",this.collectionChanged),this.stopListening(self.collection,"change",this.collectionChanged)),this.grid&&(this.grid.remove(),delete this.grid),this.$el.empty()},collectionChanged:function(e,n,a){var l=this.field.get("uniqueCol")||[],s=[];if(e.attributes&&(t.each(l,(function(i){t.has(e.attributes,i)&&s.push(i)})),0!=s.length)){var o=this.model.get(this.field.get("name"));this.stopListening(o,"change",this.collectionChanged);var r=void 0,d=void 0;if(o.each((function(i){if(e!=i){var n=[];t.each(l,(function(a){var l=e.get(a);t.isUndefined(l)||l!=i.get(a)||n.push(l)})),n.length==l.length&&(r=e,d=i)}})),r&&(a&&a.add?setTimeout((function(){o.remove(r)}),0):r.set(s[0],r.previous(s[0])),d)){var c=o.indexOf(d);if(c>-1){var u=this.grid.body.rows[c].$el;u.addClass("new"),i(u).pgMakeVisible("backform-tab"),setTimeout((function(){u.removeClass("new")}),3e3)}}this.listenTo(o,"change",this.collectionChanged)}},render:function(){this.undelegateEvents(),this.$el.empty();var e=t.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=e.name.split("."),a=n.shift(),l=n.join("."),s=this.keyPathAccessor(i[a],l),o=t.extend(e,{rawValue:s,value:this.formatter.fromRaw(s,this.model),attributes:i,formatter:this.formatter}),r=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};if(t.extend(o,{disabled:e.version_compatible&&r.apply(this.field,[o.disabled,o,this.model]),visible:r.apply(this.field,[o.visible,o,this.model]),required:r.apply(this.field,[o.required,o,this.model]),canAdd:e.version_compatible&&r.apply(this.field,[o.canAdd,o,this.model]),canAddRow:o.canAddRow,canDelete:r.apply(this.field,[o.canDelete,o,this.model]),canEdit:r.apply(this.field,[o.canEdit,o,this.model])}),t.extend(o,{add_label:""}),!o.visible)return this;this.control_data=t.clone(o);var d=this.showGridControl(o);return this.$el.html(d).addClass(e.name),this.updateInvalid(),this.delegateEvents(),this},showGridControl:function(n){n.cId=n.cId||t.uniqueId("pgC_");var s=this,o=t.template(['<div class="subnode-header">','  <span  class="control-label pg-el-sm-10" id="<%=cId%>"><%-label%></span>','  <button aria-label="'+e("Add new row")+'" class="btn btn-sm-sq btn-primary-icon add fa fa-plus" <%=canAdd ? "" : "disabled=\'disabled\'"%> title="'+e("Add new row")+'"><%-add_label%></button>',"</div>"].join("\n")),r=i('<div class="pgadmin-control-group backgrid form-group pg-el-12 object subnode "></div>').append(o(n));if(s.grid&&s.grid.remove(),!n.subnode)return"";var u=n.subnode.schema?n.subnode:n.subnode.prototype,p=a.generateGridColumnsFromModel(n.node_info,u,this.field.get("mode"),n.columns);if("properties"==n.mode&&i(r).find("button.add").remove(),!n.disabled&&n.canDelete&&p.columns.unshift({name:"pg-backform-delete",label:"",cell:l.Extension.DeleteCell,editable:!1,cell_priority:-1,canDeleteRow:n.canDeleteRow}),0==n.disabled&&n.canEdit){var h=l.Extension.ObjectCell.extend({schema:p.schema});p.columns.unshift({name:"pg-backform-edit",label:"",cell:h,cell_priority:-2,canEditRow:n.canEditRow})}var m=this.model.get(n.name);m.on("enteringEditMode",(function(e){var t=this,i=e[0];this.each((function(e){if(i.model!=e){var n=t.indexOf(e);if(n>-1){var a=s.grid.body.rows[n].$el.find(".subnode-edit-in-process").parent();if(a.length>0){var l=new Event("click");a[0].dispatchEvent(l)}}}}))}),m),s.grid=new l.Grid({columns:p.columns,collection:m,className:"backgrid table presentation table-bordered table-noouter-border table-hover",attr:{"aria-labelledby":n.cId}});for(var g=0;g<m.length;g++)m.at(g).parentTr=s.grid.body.rows[g].$el;var v=s.grid.render().$el;n.canDelete&&n.canEdit&&(i(v).find("th.pg-backform-delete").remove(),i(v).find("th.pg-backform-edit").attr("colspan","2"));var b=r.append(v),y=f;0==f.preferences_cache.length&&(y=c.default.pgAdmin.Browser);var C=y.get_preferences_for_module("browser");if(C){var _=b.find(".add");i(_).attr("title",d.shortcut_title(e("Add new row"),C.add_grid_row))}return n.disabled||0==n.canAdd||b.find("button.add").first().on("click",(function(e){if(e.preventDefault(),!t.isFunction(n.canAddRow)||n.canAddRow.apply(s,[s.model])){if(t.each(s.grid.body.rows,(function(e){var t=e.$el.find(".subnode-edit-in-process").parent();if(t.length>0){var i=new Event("click");t[0].dispatchEvent(i)}})),!!!s.field.get("allowMultipleEmptyRows")&&m){var a=!1;if(m.each((function(e){var i=[];t.each(e.attributes,(function(e){i.push(e)})),t.some(i,t.identity)||(a=!0)})),a)return!1}i(s.grid.body.$el.find(i("tr.new"))).removeClass("new");var l=new n.model(null,{silent:!0,handler:m,top:s.model.top||s.model,collection:m,node_info:s.model.node_info});n.beforeAdd&&(l=n.beforeAdd.apply(s,[l])),m.add(l);var o=m.indexOf(l),r=s.grid.body.rows[o].$el;return m.get(l).parentTr=r,l.parentTr=r,r.addClass("new"),i(r).pgMakeBackgridVisible(".backform-tab")||i(r).pgMakeBackgridVisible(".set-group"),!1}})),b},clearInvalid:function(){return this.$el.removeClass("subnode-error"),this.$el.find(".pgadmin-control-error-message").remove(),this},updateInvalid:function(){if(!(this.model.errorModel instanceof n.Model))return this;this.clearInvalid()}}),a.SubNodeCollectionControl=a.Control.extend({row:l.Row,render:function(){var e=t.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=e.name.split("."),l=n.shift(),s=n.join("."),o=this.keyPathAccessor(i[l],s),r=t.extend(e,{rawValue:o,value:this.formatter.fromRaw(o,this.model),attributes:i,formatter:this.formatter}),d=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};t.extend(r,{disabled:d(r.disabled,r,this.model),visible:d(r.visible,r,this.model),required:d(r.required,r,this.model),canAdd:d(r.canAdd,r,this.model),canAddRow:r.canAddRow,canEdit:d(r.canEdit,r,this.model),canDelete:d(r.canDelete,r,this.model),showError:r.showError||!0});var c=null==r.subnode?"":this.showGridControl(r);return this.$el.removeClass(a.hiddenClassName),r.visible||this.$el.addClass(a.hiddenClassName),this.$el.html(c).addClass(e.name),this.updateInvalid(),this},updateInvalid:function(){var e=this,a=this.model.errorModel;if(!(a instanceof n.Model))return this;this.clearInvalid();var l=e.field.get("name").split(".").join("."),s=e.keyPathAccessor(a.toJSON(),l);t.isEmpty(s)||e.field.get("showError")&&e.$el.addClass("subnode-error").append(i("<div></div>").addClass("pgadmin-control-error-message pg-el-offset-4 pg-el-8 help-block").text(s))},cleanup:function(){this.grid&&this.grid.remove(),this.collection&&this.collection.off("enteringEditMode")},clearInvalid:function(){return this.field.get("showError")&&(this.$el.removeClass("subnode-error"),this.$el.find(".pgadmin-control-error-message").remove()),this},showGridControl:function(n){var s=this,o=this,r=["<div class='subnode-header'>","  <span class='control-label pg-el-sm-10'>"+n.label+"</span>",'  <button aria-label="'+e("Add")+"\" class='btn btn-sm-sq btn-primary-icon add fa fa-plus' title='"+e("Add new row")+"'></button>","</div>"].join("\n"),u=i("<div class='pgadmin-control-group backgrid form-group pg-el-12 object subnode'></div>").append(r),p=n.subnode.schema?n.subnode:n.subnode.prototype,h=a.generateGridColumnsFromModel(n.node_info,p,this.field.get("mode"),n.columns,n.schema_node);if(o.grid&&o.grid.remove(),(n.disabled||0==n.canAdd)&&i(u).find("button.add").remove(),0==n.disabled&&n.canDelete&&h.columns.unshift({name:"pg-backform-delete",label:"",cell:l.Extension.DeleteCell,editable:!1,cell_priority:-1,canDeleteRow:n.canDeleteRow,customDeleteMsg:n.customDeleteMsg,customDeleteTitle:n.customDeleteTitle}),0==n.disabled&&n.canEdit){var m=l.Extension.ObjectCell.extend({schema:h.schema}),g=o.field.has("canEdit")&&o.field.get("canEdit")||!0;h.columns.unshift({name:"pg-backform-edit",label:"",cell:m,cell_priority:-2,editable:g,canEditRow:n.canEditRow})}var v=o.model.get(n.name);v||(v=new f.Node.Collection(null,{handler:o.model.handler||o.model,model:n.model,top:o.model.top||o.model,silent:!0}),o.model.set(n.name,v,{silent:!0}));v.on("enteringEditMode",(function(e){var t=this,i=e[0];this.each((function(e){if(i.model!=e){var n=t.indexOf(e);if(n>-1){var a=b.body.rows[n].$el.find(".subnode-edit-in-process").parent();if(a.length>0){var l=new Event("click");a[0].dispatchEvent(l)}}}}))}),v);var b=o.grid=new l.Grid({columns:h.columns,collection:v,row:this.row,className:"backgrid table presentation table-bordered table-noouter-border table-hover"}),y=b.render().$el;n.canDelete&&n.canEdit&&(i(y).find("th.pg-backform-delete").remove(),i(y).find("th.pg-backform-edit").attr("colspan","2"));var C=u.append(y),_=f;0==f.preferences_cache.length&&(_=c.default.pgAdmin.Browser);var w=_.get_preferences_for_module("browser");if(w){var x=C.find(".add");i(x).attr("title",d.shortcut_title(e("Add new row"),w.add_grid_row))}return C.find("button.add").on("click",(function(e){if(e.preventDefault(),!t.isFunction(n.canAddRow)||n.canAddRow.apply(o,[o.model])){t.each(b.body.rows,(function(e){var t=e.$el.find(".subnode-edit-in-process").parent();if(t.length>0){var i=new Event("click");t[0].dispatchEvent(i)}})),b.insertRow({});var a=i(b.body.rows[v.length-1].$el);return a.attr("class","new").on("click",(function(){i(s).attr("class","editable")})),i(a).pgMakeBackgridVisible(".backform-tab")||i(a).pgMakeBackgridVisible(".set-group"),!1}})),C}}),a.SqlTabControl=a.Control.extend({defaults:{label:"",controlsClassName:"pgadmin-controls pg-el-sm-12 SQL",extraClasses:[],helpMessage:null},template:t.template(['<label for="<%=cId%>" class="sr-only"><%=(label==""?"SQL":label)%></label>','<div class="<%=controlsClassName%>">','  <textarea id="<%=cId%>" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" aria-label="<%=name%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=readonly ? "readonly aria-readonly=true" : ""%> <%=required ? "required" : ""%>><%-value%></textarea>',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),initialize:function(e){a.Control.prototype.initialize.apply(this,arguments),this.dialog=e.dialog,this.tabIndex=e.tabIndex,t.bindAll(this,"onTabChange","onPanelResized")},getValueFromDOM:function(){return this.formatter.toRaw(this.$el.find("textarea").val(),this.model)},reflectPreferences:function(){var e=this;if(e.sqlCtrl){var t=h.Browser.get_preferences_for_module("sqleditor");i(e.sqlCtrl.getWrapperElement()).css("font-size",r.calcFontSize(t.sql_font_size)),e.sqlCtrl.setOption("tabSize",t.tab_size),e.sqlCtrl.setOption("lineWrapping",t.wrap_code),e.sqlCtrl.setOption("autoCloseBrackets",t.insert_pair_brackets),e.sqlCtrl.setOption("matchBrackets",t.brace_matching),e.sqlCtrl.refresh()}},render:function(){this.sqlCtrl&&(this.sqlCtrl.toTextArea(),delete this.sqlCtrl,this.sqlCtrl=null,this.$el.empty(),this.model.off("pg-property-tab-changed",this.onTabChange,this),this.model.off("pg-browser-resized",this.onPanelResized,this)),a.Control.prototype.render.apply(this,arguments),this.sqlCtrl=o.fromTextArea(this.$el.find("textarea")[0],{lineNumbers:!0,mode:"text/x-pgsql",readOnly:!0,extraKeys:h.Browser.editor_shortcut_keys,screenReaderLabel:"SQL"}),this.reflectPreferences();var e=this;return this.$el.find("textarea").attr("tabindex",-1),f.onPreferencesChange("sqleditor",(function(){e.reflectPreferences()})),this.model.on("pg-property-tab-changed",this.onTabChange,this),this.model.on("pg-browser-resized",this.onPanelResized,this),this},onTabChange:function(n){if(this.dialog&&n.shown==this.tabIndex){if(this.model.sessChanged())if(0==t.size(this.model.errorModel.attributes)){var a=this,l=a.field.get("schema_node"),s=l.generate_url.apply(l,[null,"msql",this.field.get("node_data"),!a.model.isNew(),this.field.get("node_info"),l.url_jump_after_node]);a.model.trigger("pgadmin-view:msql:fetching",a.method,l),i.ajax({url:s,type:"GET",cache:!1,data:a.model.toJSON(!0,"GET"),dataType:"json",contentType:"application/json"}).done((function(e){a.sqlCtrl.clearHistory(),a.sqlCtrl.setValue(e.data)})).fail((function(){a.model.trigger("pgadmin-view:msql:error",a.method,l,arguments)})).always((function(){a.model.trigger("pgadmin-view:msql:fetched",a.method,l,arguments)}))}else this.sqlCtrl.clearHistory(),this.sqlCtrl.setValue("-- "+e("Definition incomplete."));else this.sqlCtrl.clearHistory(),this.sqlCtrl.setValue("-- "+e("No updates."));this.sqlCtrl.refresh.apply(this.sqlCtrl)}},onPanelResized:function(e){if(e&&e.container){var t=e.container.find(".backform-tab > .tab-content").first(),i=t.find("div[role=tabpanel].tab-pane.SQL");i.hasClass("active")&&i.find(".CodeMirror").css("cssText","height: "+(t.height()+8)+"px !important;")}},remove:function(){this.sqlCtrl&&(this.sqlCtrl.toTextArea(),delete this.sqlCtrl,this.sqlCtrl=null,this.$el.empty()),this.model.off("pg-property-tab-changed",this.onTabChange,this),this.model.off("pg-browser-resized",this.onPanelResized,this),a.Control.__super__.remove.apply(this,arguments)}}),a.NumericControl=a.InputControl.extend({defaults:{type:"number",label:"",min:void 0,max:void 0,maxlength:255,extraClasses:[],helpMessage:null},template:t.template(['<label for="<%=cId%>" class="<%=Backform.controlLabelClassName%> text-wrap"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <input type="<%=type%>" id="<%=cId%>" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" min="<%=min%>" max="<%=max%>"maxlength="<%=maxlength%>" value="<%-value%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=readonly ? "readonly aria-readonly=true" : ""%> <%=required ? "required" : ""%> />',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n"))}),a.generateViewSchema=function(i,n,l,s,o,r,d){var c=n&&n.prototype||n,u=d||c&&c.schema,p=[],m={};if(u&&t.isArray(u)){var g,v=v=function(e){return e&&c[e]&&"function"==typeof c[e]?c[e]:e},b={},y=i&&"server"in i&&f.serverInfo&&f.serverInfo[i.server._id],C=i&&"catalog"in i;if(t.each(u,(function(r){if("group"==r.type){var d=!0;return g=!!t.isUndefined(y)||(!!t.isUndefined(r.server_type)||y.type in r.server_type)&&(!!t.isUndefined(r.min_version)||y.version>=r.min_version)&&(!!t.isUndefined(r.max_version)||y.version<=r.max_version),r.mode&&t.isObject(r.mode)&&(d=t.indexOf(r.mode,l)>-1),d&&(d=v(r.visible)),void(m[r.id]={label:r.label||r.id,version_compatible:g,visible:d,tabPanelCodeClass:""})}if(!r.mode||r&&r.mode&&t.isObject(r.mode)&&-1!=t.indexOf(r.mode,l)){var c=r.group||e("General"),u=r.control||a.getMappedControl(r.type,l),p=r.cell||a.getMappedControl(r.type,"cell");if(null==u)return;b[c]=b[c]||[];var _=!(g=!!t.isUndefined(y)||(!!t.isUndefined(r.server_type)||y.type in r.server_type)&&(!!t.isUndefined(r.min_version)||y.version>=r.min_version)&&(!!t.isUndefined(r.max_version)||y.version<=r.max_version))||C,w="properties"==l,x=r.node&&t.isString(r.node)&&r.node in f.Nodes&&f.Nodes[r.node]||s,k=t.extend(t.clone(r),{name:r.id,disabled:!!_||v(r.disabled),readonly:!!w||v(r.readonly),editable:t.isUndefined(r.editable)?h.editableCell:v(r.editable),subnode:t.isString(r.model)&&r.model in f.Nodes?f.Nodes[r.model].model:r.model,canAdd:!_&&!w&&v(r.canAdd),canAddRow:!_&&!w&&v(r.canAddRow),canEdit:!_&&!w&&v(r.canEdit),canDelete:!_&&!w&&v(r.canDelete),canEditRow:!_&&!w&&v(r.canEditRow),canDeleteRow:!_&&!w&&v(r.canDeleteRow),transform:v(r.transform),mode:l,control:u,cell:p,node_info:i,schema_node:x,visible:v(r.visible),node:s,node_data:o,version_compatible:g});delete k.id,b[c].push(k),"nested"==r.type&&(delete k.name,delete k.cell,k.schema=a.generateViewSchema(i,n,l,s,o,!0,r.schema),k.control=k.control||"tab")}})),t.isEmpty(b))return null;r||!s||!s.hasSQL||"create"!=l&&"edit"!=l||(b[e("SQL")]=[{name:"sql",visible:!0,disabled:!1,type:"text",control:"sql-tab",node_info:i,schema_node:s,node_data:o}]),t.each(b,(function(e,i){var n=t.pluck(e,"tabPanelCodeClass");n&&(n=n.join(" ").trim()),p.push(t.extend(t.defaults(m[i]||{label:i,tabPanelCodeClass:n},{version_compatible:!0,visible:!0}),{fields:e}))}))}return p};var b=function(){};t.extend(b.prototype,{fromRaw:function(e){return encodeURIComponent(e)},toRaw:function(e,i,n){return t.isArray(e)?n&&n.tags?e:t.map(e,decodeURIComponent):t.isNull(e)||t.isUndefined(e)?null:decodeURIComponent(e)}}),a.Select2Control=a.SelectControl.extend({defaults:t.extend({},a.SelectControl.prototype.defaults,{select2:{first_empty:!0,multiple:!1,emptyOptions:!1,preserveSelectionOrder:!1,isDropdownParent:!1},controlLabelClassName:a.controlLabelClassName,controlsClassName:a.controlsClassName}),events:function(){return t.extend({},a.SelectControl.prototype.events,{"select2:select":"onSelect"})},onSelect:function(e){var n=this.field.get("select2");if(!t.isUndefined(n)&&!t.isNull(n)&&n.multiple&&n.preserveSelectionOrder){var a=e.params.data.element,l=i(a);l.detach(),i(this.$sel).append(l),i(this.$sel).trigger("change")}var s=t.findWhere(this.field.get("options"),{value:e.params.data.id});s&&!t.isUndefined(s.preview_src)&&s.preview_src&&this.$el.find(".preview-img img").attr("src",s.preview_src)},formatter:b,template:t.template(["<% if(label == false) {} else {%>",'  <label class="<%=controlLabelClassName%>" for="<%=cId%>"><%=label%></label>',"<% }%>",'<div class="<%=controlsClassName%>">',' <select title="<%=name%>" id="<%=cId%>" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>"','  name="<%=name%>" value="<%-value%>" <%=disabled ? "disabled" : ""%> <%=readonly ? "disabled" : ""%>','  <%=required ? "required" : ""%><%= select2.multiple ? " multiple>" : ">" %>','  <%=select2.first_empty ? " <option></option>" : ""%>',"  <% for (var i=0; i < options.length; i++) {%>","   <% var option = options[i]; %>","   <option ","    <% if (option.image) { %> data-image=<%=option.image%> <%}%>","    value=<%- formatter.fromRaw(option.value) %>",'    <% if (option.selected) {%>selected="selected"<%} else {%>','    <% if (!select2.multiple && option.value === rawValue) {%>selected="selected"<%}%>','    <% if (select2.multiple && rawValue && rawValue.indexOf(option.value) != -1){%>selected="selected" data-index="rawValue.indexOf(option.value)"<%}%>',"    <%}%>",'    <%= disabled ? "disabled" : ""%> <%=readonly ? "disabled" : ""%>><%-option.label%></option>',"  <%}%>"," </select>"," <% if (helpMessage && helpMessage.length) { %>",' <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>'," <% } %>"," <% for (var i=0; i < options.length; i++) {%>","   <% var option = options[i]; %>","     <% if (option.preview_src && option.value === rawValue) { %>",'       <div class="preview-img mt-2">','         <img src="<%=option.preview_src%>" class="img-fluid mx-auto d-block w-50 border" alt="'+e("Preview not available...")+'">',"       </div>","    <%}%>"," <%}%>","</div>"].join("\n")),render:function(){var e=this;this.$sel&&this.$sel.select2&&this.$sel.select2.hasOwnProperty("destroy")&&this.$sel.select2("destroy");var n=t.defaults(this.field.toJSON(),this.defaults),l=this.model.toJSON(),s=n.name.split("."),o=s.shift(),r=s.join("."),d=this.keyPathAccessor(l[o],r),c=t.extend(n,{rawValue:d,value:this.formatter.fromRaw(d,this.model),attributes:l,formatter:this.formatter}),p=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};if(c.select2=c.select2||{},t.defaults(c.select2,this.defaults.select2,{first_empty:!0,multiple:!1,emptyOptions:!1,preserveSelectionOrder:!1,isDropdownParent:!1,showOnScroll:!0}),t.extend(c,{disabled:p(c.disabled,c,this.model),readonly:p(c.readonly,c,this.model),visible:p(c.visible,c,this.model),required:p(c.required,c,this.model)}),t.isFunction(c.options))try{c.options=c.options(this)}catch(e){c.options=[],this.model.trigger("pgadmin-view:transform:error",this.model,this.field,e)}c.cId=c.cId||t.uniqueId("pgC_"),this.$el.removeClass(a.hiddenClassName),c.visible||this.$el.addClass(a.hiddenClassName),this.$el.html(this.template(c)).addClass(n.name);var h=t.extend({disabled:c.disabled||c.readonly},n.select2,{options:this.field.get("options")||this.defaults.options});return c.select2.isDropdownParent&&(h.dropdownParent=c.select2.dropdownParent||this.$el),(c.disabled||c.readonly)&&(h.placeholder=""),c.select2.tags&&c.select2.emptyOptions&&(h.data=c.rawValue),h=u.default(h),this.$sel=this.$el.find("select").select2(h),c.select2.tags&&c.select2.emptyOptions&&(this.$sel.val(c.rawValue),this.$sel.trigger("change.select2"),this.$sel.on("select2:unselect",(function(e){i(this).find('option[value="'+e.params.data.text.replace("'","\\'").replace('"','\\"')+'"]').remove(),i(this).trigger("change.select2"),null==i(this).val()&&i(this).empty()}))),this.$sel&&this.$sel.data("select2").on("keypress",(function(e){9===e.which&&this.isOpen()&&(e.preventDefault(),this.trigger("results:select",{}))})),c.readonly&&!c.disabled&&setTimeout((function(){e.$el.find(".select2-selection").attr("tabindex",0)}),500),this.updateInvalid(),this},getValueFromDOM:function(){var e=t.extend({},this.field.get("select2")||this.defaults.select2),i=this.formatter.toRaw(this.$sel.val(),this.model,e);return e.multiple&&null==i?[]:i}}),a.FieldsetControl=a.Fieldset.extend({initialize:function(e){a.Control.prototype.initialize.apply(this,arguments),a.Dialog.prototype.initialize.apply(this,[{schema:e.field.get("schema")}]),this.dialog=e.dialog,this.tabIndex=e.tabIndex,this.contentClass=e.field.get("contentClass")?e.field.get("contentClass"):"";var i=this.field.get("deps"),n=this;i&&t.isArray(i)&&t.each(i,(function(e){var t=e.split(".").shift();n.listenTo(n.model,"change:"+t,n.render)}))},orig_render:a.Fieldset.prototype.render,render:function(){var e=t.defaults(this.field.toJSON(),this.defaults),i=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};return e.version_compatible&&i(e.visible,e,this.model)?this.orig_render.apply(this,arguments):(this.cleanup(),this.$el.empty()),this},formatter:function(){},cleanup:function(){a.Fieldset.prototype.cleanup.apply(this)},remove:function(){a.Control.prototype.remove.apply(this,arguments),a.Dialog.prototype.remove.apply(this,arguments)},className:function(){return"set-group"},tabPanelClassName:function(){return a.tabClassName},fieldsetClass:"inline-fieldset",legendClass:"",collapse:!1}),a.TabControl=a.FieldsetControl.extend({tagName:"div",className:"inline-tab-panel",tabPanelClassName:"inline-tab-panel",tabPanelExtraClasses:"",initialize:function(e){a.FieldsetControl.prototype.initialize.apply(this,arguments),this.tabIndex=(e.tabIndex||parseInt(1e3*Math.random()))+1,e.field.get("tabPanelExtraClasses")&&(this.tabPanelExtraClasses=e.field.get("tabPanelExtraClasses")),this.tabPanelClassName=this.tabPanelClassName+" "+this.tabPanelExtraClasses},orig_render:a.Dialog.prototype.render,template:a.Dialog.prototype.template}),a.PlainFieldsetControl=a.FieldsetControl.extend({initialize:function(){a.FieldsetControl.prototype.initialize.apply(this,arguments)},template:{header:t.template(['<fieldset class="<%=fieldsetClass%>" <%=disabled ? "disabled" : ""%>>'," <% if (legend != false) { %>",'  <div><legend class="<%=legendClass%>" <%=collapse ? "data-toggle=\'collapse\'" : ""%> data-target="#<%=cId%>"><%=collapse ? "<span class=\'caret\'></span>" : "" %></legend></div>'," <% } %>","</fieldset>"].join("\n")),content:t.template('  <div id="<%= cId %>" class="<%=contentClass%>"></div>')},fieldsetClass:"inline-fieldset-without-border",legend:!1}),a.SqlFieldControl=a.TextareaControl.extend({defaults:{label:"",extraClasses:[],helpMessage:null,maxlength:4096,rows:void 0},template:t.template(['<label class="<%=Backform.controlLabelClassName%>" for="<%=cId%>"><%=label%></label>',"<div class=\"<%=Backform.controlsClassName%> sql_field_layout <%=extraClasses.join(' ')%>\">",'  <textarea id="<%=cId%>"','    class="<%=Backform.controlClassName%> " name="<%=name%>" aria-label="<%=name%>"','    maxlength="<%=maxlength%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=readonly ? "readonly aria-readonly=true" : ""%>',"    rows=<%=rows%>",'    <%=required ? "required" : ""%>><%-value%></textarea>',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),initialize:function(){a.TextareaControl.prototype.initialize.apply(this,arguments),this.sqlCtrl=null,t.bindAll(this,"onFocus","onBlur","refreshTextArea")},getValueFromDOM:function(){return this.sqlCtrl.getValue()},reflectPreferences:function(){var e=this;if(e.sqlCtrl){var t=c.default.pgAdmin.Browser.get_preferences_for_module("sqleditor");i(e.sqlCtrl.getWrapperElement()).css("font-size",r.calcFontSize(t.sql_font_size)),e.sqlCtrl.setOption("indentWithTabs",!t.use_spaces),e.sqlCtrl.setOption("indentUnit",t.tab_size),e.sqlCtrl.setOption("tabSize",t.tab_size),e.sqlCtrl.setOption("lineWrapping",t.wrap_code),e.sqlCtrl.setOption("autoCloseBrackets",t.insert_pair_brackets),e.sqlCtrl.setOption("matchBrackets",t.brace_matching),setTimeout((function(){e.sqlCtrl&&e.sqlCtrl.refresh()}),500)}},render:function(){this.sqlCtrl&&(this.model.off("pg-property-tab-changed",this.refreshTextArea,this),this.sqlCtrl.off("focus",this.onFocus),this.sqlCtrl.off("blur",this.onBlur),this.sqlCtrl.toTextArea(),delete this.sqlCtrl,this.sqlCtrl=null,this.$el.empty()),a.TextareaControl.prototype.render.apply(this,arguments);var e=t.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=e.name.split("."),l=n.shift(),s=n.join("."),r=this.keyPathAccessor(i[l],s),d=t.extend(e,{rawValue:r,value:this.formatter.fromRaw(r,this.model),attributes:i,formatter:this.formatter}),c=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};d.cId=d.cId||t.uniqueId("pgC_");var u=c(d.disabled,d,this.model),p=c(d.visible,d,this.model),m=c(d.readonly,d,this.model),g=this;if(g.sqlCtrl=o.fromTextArea(g.$el.find("textarea")[0],{lineNumbers:!0,mode:"text/x-pgsql",extraKeys:h.Browser.editor_shortcut_keys,screenReaderLabel:d.label}),g.reflectPreferences(),f.onPreferencesChange("sqleditor",(function(){g.reflectPreferences()})),u||m){g.sqlCtrl.setOption("readOnly",!0),g.sqlCtrl.setOption("extraKeys",{Tab:!1,"Shift-Tab":!1});var v=g.sqlCtrl.getWrapperElement();v&&(v.className+=" cm_disabled hide-cursor-workaround")}return p||g.$el.addClass(a.hiddenClassName),g.model.on("pg-property-tab-changed",this.refreshTextArea,this),this.sqlCtrl.setOption("dragDrop",!0),this.sqlCtrl.on("focus",this.onFocus),this.sqlCtrl.on("blur",this.onBlur),this.sqlCtrl.on("drop",this.onDrop),setTimeout((function(){g.refreshTextArea.apply(g)}),0),g},onDrop:function(e,t){var i=null;try{i=JSON.parse(t.dataTransfer.getData("text")),t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()}catch(e){return}var n=e.coordsChar({left:t.x,top:t.y});e.replaceRange(i.text,n),e.focus(),e.setSelection(s(s({},n),{},{ch:n.ch+i.cur.from}),s(s({},n),{},{ch:n.ch+i.cur.to}))},onFocus:function(){var e=this.$el.find(".pgadmin-controls").first();e.hasClass("focused")||e.addClass("focused")},onBlur:function(){this.$el.find(".pgadmin-controls").first().removeClass("focused")},refreshTextArea:function(){this.sqlCtrl&&this.sqlCtrl.refresh()},remove:function(){this.sqlCtrl&&(this.sqlCtrl.off("focus",this.onFocus),this.sqlCtrl.off("blur",this.onBlur),delete this.sqlCtrl,this.sqlCtrl=null,this.$el.empty()),this.model.off("pg-property-tab-changed",this.refreshTextArea,this),a.TextareaControl.prototype.remove.apply(this,arguments)}}),a.SqlCodeControl=a.SqlFieldControl.extend({template:t.template(['<label class="sr-only" for="<%=cId%>"><%=(label==""?"Code":label)%></label>',"<div class=\"pgadmin-controls pg-el-12 <%=extraClasses.join(' ')%>\">",'  <textarea id="<%=cId%>" ','    class="<%=Backform.controlClassName%> " name="<%=name%>" aria-label="<%=name%>"','    maxlength="<%=maxlength%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=readonly ? "readonly aria-readonly=true" : ""%> ',"    rows=<%=rows%>",'    <%=required ? "required" : ""%>><%-value%></textarea>',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n"))}),a.NoteControl=a.Control.extend({defaults:{label:e("Note"),text:"",extraClasses:["pg-el-12","d-flex"],noteClass:"backform-note",faIcon:"fa-file-alt",faExtraClass:"fa-rotate-180 fa-flip-vertical",iconWidthClass:"col-0 pr-2",textWidthClass:"col-sm"},template:t.template(["<div class=\"<%=noteClass%> <%=extraClasses.join(' ')%>\">",'  <div class="icon <%=iconWidthClass%>">','    <i class="fa <%=faIcon%> <%=faExtraClass%>" aria-hidden="true"></i>',"  </div>",'  <div class="<%=textWidthClass%>">',"    <span><%=text%></span>","  </div>","</div>"].join("\n"))}),a.FileControl=a.InputControl.extend({defaults:{type:"text",label:"",min:void 0,max:void 0,maxlength:255,extraClasses:[],dialog_title:"",btn_primary:"",helpMessage:null,dialog_type:"select_file"},initialize:function(){a.InputControl.prototype.initialize.apply(this,arguments)},template:t.template(['<label class="<%=Backform.controlLabelClassName%>" for="<%=cId%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','<div class="input-group">','<input type="<%=type%>" id="<%=cId%>" class="form-control <%=extraClasses.join(\' \')%>" name="<%=name%>" min="<%=min%>" max="<%=max%>"maxlength="<%=maxlength%>" value="<%-value%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=readonly ? "readonly aria-readonly=true" : ""%> <%=required ? "required" : ""%> />','<div class="input-group-append">','<button class="btn btn-primary-icon fa fa-ellipsis-h select_item" <%=disabled ? "disabled" : ""%> <%=readonly ? "disabled" : ""%> aria-hidden="true" aria-label="'+e("Select file")+'" title="'+e("Select file")+'"></button>',"</div>","</div>","<% if (helpMessage && helpMessage.length) { %>",'<span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"<% } %>","</div>"].join("\n")),events:function(){return t.extend({},a.InputControl.prototype.events,{"click .select_item":"onSelect"})},onSelect:function(){var e=this.field.get("dialog_type"),t=this.field.get("supp_types"),i=this.field.get("btn_primary"),n={supported_types:t,dialog_type:e,dialog_title:this.field.get("dialog_title"),btn_primary:i};h.FileManager.init(),h.FileManager.show_dialog(n),this.listen_file_dlg_events()},storage_dlg_hander:function(e){var t=this.field.get("name").split(".").shift();this.remove_file_dlg_event_listeners(),this.model.set(t,decodeURI(e)),this.$el.find("input[type=text]").focus()},storage_close_dlg_hander:function(){this.remove_file_dlg_event_listeners()},listen_file_dlg_events:function(){h.Browser.Events.on("pgadmin-storage:finish_btn:"+this.field.get("dialog_type"),this.storage_dlg_hander,this),h.Browser.Events.on("pgadmin-storage:cancel_btn:"+this.field.get("dialog_type"),this.storage_close_dlg_hander,this)},remove_file_dlg_event_listeners:function(){h.Browser.Events.off("pgadmin-storage:finish_btn:"+this.field.get("dialog_type"),this.storage_dlg_hander,this),h.Browser.Events.off("pgadmin-storage:cancel_btn:"+this.field.get("dialog_type"),this.storage_close_dlg_hander,this)},clearInvalid:function(){return a.InputControl.prototype.clearInvalid.apply(this,arguments),this.$el.removeClass("pgadmin-file-has-error"),this},updateInvalid:function(){a.InputControl.prototype.updateInvalid.apply(this,arguments),this.$el.addClass("pgadmin-file-has-error")},disable_button:function(){this.$el.find("button.select_item").attr("disabled","disabled")},enable_button:function(){this.$el.find("button.select_item").removeAttr("disabled")}}),a.DatetimepickerControl=a.InputControl.extend({defaults:{type:"text",label:"",options:{format:"YYYY-MM-DD HH:mm:ss Z",icons:{time:"fa fa-clock",data:"fa fa-calendar-alt",today:"fa fa-calendar-check",clear:"fa fa-trash-alt"},buttons:{showToday:!0},toolbarPlacement:"top",widgetPositioning:{horizontal:"auto",vertical:"bottom"},keepOpen:!1},placeholder:"YYYY-MM-DD HH:mm:ss Z",extraClasses:[],helpMessage:null,setMinDate:!0},events:{"blur input":"onChange","change input":"onChange","changeDate input":"onChange","focus input":"clearInvalid","focusout input":"closePicker","change.datetimepicker":"onChange","click .input-group":"togglePicker","keydown .datetimepicker-input":"keyboardEvent"},togglePicker:function(){this.has_datepicker&&this.$el.find("input").datetimepicker("toggle")},closePicker:function(){this.has_datepicker&&this.$el.find("input").datetimepicker("hide")},template:t.template(['<label for="<%=cId%>" class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="input-group  <%=Backform.controlsClassName%>">',' <input id="<%=cId%>" type="text" class="<%=Backform.controlClassName%> datetimepicker-input <%=extraClasses.join(\' \')%>" name="<%=name%>" value="<%-value%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=readonly ? "readonly aria-readonly=true" : ""%> <%=required ? "required" : ""%> data-toggle="datetimepicker"/>',' <div class="input-group-append">','   <span class="input-group-text fa fa-calendar-alt"></span>'," </div>","</div>","<% if (helpMessage && helpMessage.length) { %>",'<div class="<%=Backform.helpBlockControlClass%>">',' <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"</div>","<% } %>"].join("\n")),keyboardEvent:function(e){var t=!1;e.altKey||38!=e.keyCode||this.up(),e.altKey||40!=e.keyCode||this.down(),37==e.keyCode&&this.left(),39==e.keyCode&&this.right(),27==e.keyCode&&(this.$el.find("input").datetimepicker("hide"),t=!0),13==e.keyCode&&(this.$el.find(".datepicker").is(":visible")||this.$el.find(".timepicker").is(":visible")?this.$el.find("input").datetimepicker("hide"):this.$el.find("input").datetimepicker("show")),e.altKey&&84==e.keyCode&&this.timePicker(),e.altKey&&38==e.keyCode&&this.controlUp(),e.altKey&&40==e.keyCode&&this.controlDown(),t&&e.stopImmediatePropagation()},down:function(){var e=this.$el.find(".datetimepicker-input"),t=e.data("datetimepicker").date().clone();this.$el.find(".datepicker").is(":visible")?e.datetimepicker("date",t.add(7,"d")):e.datetimepicker("date",t.subtract(1,"m"))},up:function(){var e=this.$el.find(".datetimepicker-input"),t=e.data("datetimepicker").date().clone();this.$el.find(".datepicker").is(":visible")?e.datetimepicker("date",t.subtract(7,"d")):e.datetimepicker("date",t.add(1,"m"))},left:function(){var e=this.$el.find(".datetimepicker-input"),t=e.data("datetimepicker").date().clone();this.$el.find(".datepicker").is(":visible")&&e.datetimepicker("date",t.subtract(1,"d"))},right:function(){var e=this.$el.find(".datetimepicker-input"),t=e.data("datetimepicker").date().clone();this.$el.find(".datepicker").is(":visible")&&e.datetimepicker("date",t.add(1,"d"))},timePicker:function(){this.$el.find(".timepicker").is(":visible")?this.$el.find(".fa-calendar-alt").click():this.$el.find(".fa-clock").click()},controlUp:function(){this.$el.find(".fa-clock").click();var e=this.$el.find(".datetimepicker-input"),t=e.data("datetimepicker").date().clone();e.datetimepicker("date",t.add(1,"h"))},controlDown:function(){this.$el.find(".fa-clock").click();var e=this.$el.find(".datetimepicker-input"),t=e.data("datetimepicker").date().clone();e.datetimepicker("date",t.subtract(1,"h"))},render:function(){var e=t.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=e.name.split("."),l=n.shift(),s=n.join("."),o=this.keyPathAccessor(i[l],s),r=t.extend(e,{rawValue:o,value:this.formatter.fromRaw(o,this.model),attributes:i,formatter:this.formatter}),d=function(e,i){return t.isFunction(e)?!!e(i):!!e};if("properties"==r.mode&&(r.disabled=!0),t.extend(r,{disabled:d(r.disabled,this.model),readonly:d(r.readonly,this.model),visible:d(r.visible,this.model),required:d(r.required,this.model)}),r.cId=r.cId||t.uniqueId("pgC_"),r.disabled||"properties"==r.mode||(r.placeholder=r.placeholder||this.defaults.placeholder),this.has_datepicker&&this.$el.find("input").datetimepicker("destroy"),this.$el.empty(),this.$el.removeClass(a.hiddenClassName),this.$el.html(this.template(r)).addClass(e.name),r.visible){this.has_datepicker=!0;var c=this;t.isUndefined(r.value)||t.isNull(r.value)||"infinity"!==r.value.toLowerCase()||(r.value=null);var u={};u=r.setMinDate?{date:r.value,minDate:r.value}:{date:r.value},this.$el.find("input").first().datetimepicker(t.extend({keyBinds:{enter:function(e){var t=this;e?setTimeout((function(){t.toggle(),c.$el.find("input").first().trigger("blur")}),10):setTimeout((function(){t.toggle()}),10)},tab:function(e){e||setTimeout((function(){c.$el.find("input").first().trigger("blur")}),10)},escape:function(e){if(e){var t=this;setTimeout((function(){t.toggle(),c.$el.find("input").first().trigger("blur")}),10)}}}},this.defaults.options,this.field.get("options"),u))}else this.has_datepicker=!1,this.$el.addClass(a.hiddenClassName);return this.updateInvalid(),this},clearInvalid:function(){return a.InputControl.prototype.clearInvalid.apply(this,arguments),this.$el.removeClass("pgadmin-datepicker-has-error"),this},updateInvalid:function(){a.InputControl.prototype.updateInvalid.apply(this,arguments),this.$el.addClass("pgadmin-datepicker-has-error")},cleanup:function(){this.has_datepicker&&this.$el.find("input").datetimepicker("destroy"),this.$el.empty()}}),a.ColorControl=a.InputControl.extend({defaults:{label:"",extraClasses:[],helpMessage:null,showPalette:!0,allowEmpty:!0,colorFormat:"HEX",defaultColor:null,position:"right-middle",clearText:e("No color")},template:t.template(['<label class="<%=Backform.controlLabelClassName%>" for="<%=cId%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <input id="<%=cId%>" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%> d-none" name="<%=name%>" value="<%-value%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />',"  <p></p>","  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),applyColor:function(e,t,i){i?(t.applyColor(!0),this.model.set(e,t.getSelectedColor().toHEXA().toString(),{silent:!0})):this.model.set(e,"",{silent:!0})},render:function(){var e=this;this.picker&&(this.picker.destroyAndRemove(),this.picker=null);var i=t.defaults(this.field.toJSON(),this.defaults),n=this.model.toJSON(),l=i.name.split("."),s=l.shift(),o=l.join("."),r=this.keyPathAccessor(n[s],o),d=t.extend(i,{rawValue:r,value:this.formatter.fromRaw(r,this.model),attributes:n,formatter:this.formatter}),c=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};return t.extend(d,{disabled:c(d.disabled,d,this.model),visible:c(d.visible,d,this.model),required:c(d.required,d,this.model)}),d.cId=d.cId||t.uniqueId("pgC_"),this.$el.empty(),d.visible||this.$el.addClass(a.hiddenClassname),this.$el.html(this.template(d)).addClass(i.name),d.colorFormat=d.colorFormat?d.colorFormat.toUpperCase():"HEX",d.value=d.value&&""!=d.value?d.value:d.defaultColor,this.picker=new p({el:this.$el.find("p")[0],theme:"monolith",swatches:["#000","#666","#ccc","#fff","#f90","#ff0","#0f0","#f0f","#f4cccc","#fce5cd","#d0e0e3","#cfe2f3","#ead1dc","#ea9999","#b6d7a8","#a2c4c9","#d5a6bd","#e06666","#93c47d","#76a5af","#c27ba0","#f1c232","#6aa84f","#45818e","#a64d79","#bf9000","#0c343d","#4c1130"],position:d.position,strings:{clear:d.clearText},components:{palette:d.showPalette,preview:!0,hue:d.showPalette,interaction:{clear:d.allowEmpty,defaultRepresentation:d.colorFormat,disabled:d.disabled}}}),this.picker.on("init",(function(t){e.picker.setColor(d.value,!0),d.disabled&&e.picker.disable();var i=t.getRoot().preview.lastColor,n=t.getRoot().interaction.clear;n.addEventListener("keydown",(function(e){9===e.keyCode&&(e.preventDefault(),e.stopPropagation(),i.focus())})),i.addEventListener("keydown",(function(e){9===e.keyCode&&e.shiftKey&&(e.preventDefault(),e.stopPropagation(),n.focus())}))})).on("clear",(function(t){e.applyColor(s,t,null)})).on("change",(function(t,i,n){e.applyColor(s,n,t)})).on("show",(function(e,t){t.getRoot().palette.palette.focus()})).on("hide",(function(e){e.getRoot().button.focus()})),this.updateInvalid(),this}});var y=a.KeyCodeControlFormatter=function(){};return t.extend(y.prototype,{fromRaw:function(e){return e.char},toRaw:void 0}),a.KeyCodeControl=a.InputControl.extend({defaults:t.defaults({escapeKeyCodes:[16,17,18,27]},a.InputControl.prototype.defaults),events:{"keydown input":"onkeyDown","keyup input":"preventEvent","focus select":"clearInvalid"},formatter:y,preventEvent:function(e){var i=e.which||e.keyCode;-1==t.defaults(this.field.toJSON(),this.defaults).escapeKeyCodes.indexOf(i)&&(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation())},template:t.template(['<label class="<%=Backform.controlLabelClassName%> keyboard-shortcut-label"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <input aria-label="<%=name%>" type="<%=type%>" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" oncopy="return false; oncut="return false; onpaste="return false;" maxlength="<%=maxlength%>" value="<%-value%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),onkeyDown:function(i){var a,l,s=this,o=this.model,r=this.field.get("name").split(".").shift(),d=i.which||i.keyCode;-1==t.defaults(this.field.toJSON(),this.defaults).escapeKeyCodes.indexOf(d)&&(this.model.errorModel instanceof n.Model&&this.model.errorModel.unset(r),l=e(i.key),32==d&&(l=e("Space")),a={key_code:i.which||i.keyCode,char:l},this.stopListening(this.model,"change:"+r,this.render),o.set(r,a),this.listenTo(this.model,"change:"+r,this.render),setTimeout((function(){s.$el.find("input").val(l)})),i.preventDefault())},keyPathAccessor:function(e,i){var n=e;i=i.split(".");for(var a=0;a<i.length;a++){if(t.isNull(n))return null;t.isEmpty(i[a])||(t.isUndefined(n[i[a]])||(n=n[i[a]]))}return n}}),a.KeyboardShortcutControl=a.Control.extend({initialize:function(){a.Control.prototype.initialize.apply(this,arguments);var e=this.field.get("fields");if(!e)throw new ReferenceError('"fields" not found in keyboard shortcut');this.innerModel=new n.Model,this.controls=[]},cleanup:function(){this.stopListening(this.innerModel,"change",this.onInnerModelChange),t.each(this.controls,(function(e){e.remove()})),this.controls.length=0},template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%> d-flex flex-row">',"</div>"].join("\n")),onInnerModelChange:function(){var e=this.field.get("name"),t=i.extend(!0,{},this.model.get(e));this.stopListening(this.model,"change:"+e,this.render),this.model.set(e,i.extend(!0,t,this.innerModel.toJSON())),this.listenTo(this.model,"change:"+e,this.render)},render:function(){this.cleanup(),this.$el.empty();var e=this,n={},l=t.defaults(this.field.toJSON(),this.defaults),s=e.model.get(l.name),o=l.fields;this.$el.html(e.template(l)).addClass(l.name);var r=i(e.$el.find(".pgadmin-controls"));return t.each(o,(function(e){n[e.name]=s[e.name]})),e.innerModel.set(n),e.listenTo(e.innerModel,"change",e.onInnerModelChange),t.each(o,(function(n){var l=new a.Field(t.extend({},{id:n.name,name:n.name,control:"checkbox"==n.type?"checkboxWithBox":n.type,label:n.label})),s=new(l.get("control"))({field:l,model:e.innerModel});(s.render(),"checkbox"==n.type)?(s.$el.find("label.control-label").text().trim().length<=0&&s.$el.find("label.control-label").remove(),"alt"==n.name?r.append(i('<div class="pg-el-sm-3 pg-el-12"></div>').append(s.$el)):r.append(i('<div class="pg-el-sm-2 pg-el-12"></div>').append(s.$el))):r.append(i('<div class="pg-el-sm-5 pg-el-12"></div>').append(s.$el));e.controls.push(s)})),e},remove:function(){this.cleanup(),a.Control.prototype.remove.apply(this,arguments)}}),a.CheckboxWithBoxControl=a.CheckboxControl.extend({events:t.extend({},a.CheckboxControl.prototype.events,{"click button":"onButtonClick"}),template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=controlLabel%></label>','<div class="<%=Backform.controlContainerClassName%>">','  <button class="btn btn-secondary btn-checkbox">',"  <div class=\"custom-control custom-checkbox <%=extraClasses.join(' ')%>\">",'    <input tabindex="-1" type="checkbox" class="custom-control-input" id="<%=cId%>" name="<%=name%>" <%=value ? "checked=\'checked\'" : ""%> <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />','    <label class="custom-control-label" for="<%=cId%>" aria-label="<%=cId%>">',"      <%=label%>","    </label>","  </div>","  </button>","</div>"].join("\n")),onButtonClick:function(e){"BUTTON"===e.target.nodeName&&this.$el.find("input[type=checkbox]").trigger("click")}}),a.ThresholdControl=a.Control.extend({template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlContainerClassName%>">','  <span class="control-label pg-el-sm-2 pg-el-12"><%=warning_label%></span>','  <input type="text" id="warning_threshold" class="pg-el-sm-2" value="<%=warning_value%>" />','  <span class="control-label pg-el-sm-1 pg-el-12"><%=alert_label%></span>','  <input type="text" id="alert_threshold" class="pg-el-sm-2" value="<%=alert_value%>" />','  <span class="control-label pg-el-sm-3 pg-el-12"><%=unit%></span>',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),events:{"change input#warning_threshold":"onChange","change input#alert_threshold":"onChange"},initialize:function(){a.Control.prototype.initialize.apply(this,arguments)},render:function(){var e=t.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=[];t.isUndefined(this.model.get("value"))||t.isNull(this.model.get("value"))||(n=this.model.get("value").split("|"));var a=t.extend(e,{attributes:i,warning_value:n.length>0?n[0]:"",alert_value:n.length>1?n[1]:""});return this.$el.html(this.template(a)),this},onChange:function(){var e=i("input#warning_threshold").val()+"|"+i("input#alert_threshold").val();this.model.set(this.field.get("name"),e,{silent:!1})}}),a}.apply(t,n))||(e.exports=a)},71158:(e,t,i)=>{"use strict";var n,a,l=i(19755);i(73210),i(74916),i(15306),i(2707),i(82772),i(32564),i(69600),i(69826),i(24812),i(92222),i(5735),i(83753),i(41539),i(91058),i(54678),i(23123),i(56977),i(21249),i(66992),i(33948),i(68309),i(64765),n=[i(91669),i(81311),i(19755),i(72316),i(95283),i(83879),i(58307),i(30381),i(44431),i(4631),i(44092),i(72945),i(75471),i(1950),i(28008),i(75084),i(63790),i(56796)],void 0===(a=function(e,t,i,n,a,s,o,r,d,c,u,p,h,f,m){var g=window.pgAdmin=window.pgAdmin||{},v=g.Browser;t.extend(s.Column.prototype.defaults,{cellFunction:void 0}),t.extend(s.Cell.prototype.events,{mouseover:function(){var e=i(this.el);e.text().length>0&&!e.attr("title")&&e.innerWidth()+1<e[0].scrollWidth&&e.attr("title",i.trim(e.text()))}}),t.extend(s.InputCellEditor.prototype.events,{keydown:function(e){var t=f.default.pgAdmin.Browser.get_preferences_for_module("browser");t&&p.validateShortcutKeys(t.add_grid_row,e)?v.keyboardNavigation.bindAddGridRow():s.InputCellEditor.prototype.saveOrCancel.apply(this,arguments)}}),t.extend(s.Body.prototype,{sort:function(e,i){if(!t.contains(["ascending","descending",null],i))throw new RangeError('direction must be one of "ascending", "descending" or `null`');t.isString(e)&&(e=this.columns.findWhere({name:e}));var a,l=this.collection;a="ascending"===i?-1:"descending"===i?1:null;var s=e.get("cell").prototype.className||"string-cell",o=this.makeComparator(e.get("name"),a,a?e.sortValue():function(e){return 1*e.cid.replace("c","")},s);return n.PageableCollection&&l instanceof n.PageableCollection?(l.setSorting(a&&e.get("name"),a,{sortValue:e.sortValue()}),l.fullCollection?(null==l.fullCollection.comparator&&(l.fullCollection.comparator=o),l.fullCollection.sort(),l.trigger("backgrid:sorted",e,i,l)):l.fetch({reset:!0,success:function(){l.trigger("backgrid:sorted",e,i,l)}})):(l.comparator=o,l.sort(),l.trigger("backgrid:sorted",e,i,l)),e.set("direction",i),this},makeComparator:function(e,i,n,a){return function(l,s){var o,r=n(l,e),c=n(s,e);if(!t.isUndefined(r)&&!t.isUndefined(c)){if(t.include(["number-cell","integer-cell"],a)){var u,p;try{u=new d(r)}catch(e){u=NaN}try{p=new d(c)}catch(e){p=NaN}return 1===i&&(o=u,u=p,p=o),u.eq(p)?0:u.lt(p)?-1:1}return 1===i&&(o=r,r=c,c=o),r===c?0:null===r&&null!=c?-1:null!=r&&null===c?1:r<c?-1:1}}},moveToNextCell:function(e,t,n){var a,l,o,r,d,c=this.collection.indexOf(e),u=this.columns.indexOf(t);if(-1===u)return this;if(this.rows[c].cells[u].exitEditMode(),n.moveUp()||n.moveDown()||n.moveLeft()||n.moveRight()||n.save()){var p=this.columns.length,h=p*this.collection.length;if(n.moveUp()||n.moveDown()){r=c+(n.moveUp()?-1:1);var f=this.rows[r];f?(a=f.cells[u],s.callByNeed(a.column.editable(),a.column,e)&&(a.enterEditMode(),e.trigger("backgrid:next",r,u,!1))):e.trigger("backgrid:next",r,u,!0)}else if(n.moveLeft()||n.moveRight()){for(var m=n.moveRight(),g=c*p+u+(m?1:-1);g>=0&&g<h;m?g++:g--){if(d=g-(r=~~(g/p))*p,a=this.rows[r].cells[d],l=s.callByNeed(a.column.renderable(),a.column,a.model),o=s.callByNeed(a.column.editable(),a.column,e),a&&a.$el.hasClass("edit-cell")&&!a.$el.hasClass("privileges")||a.$el.hasClass("delete-cell")){e.trigger("backgrid:next",r,d,!1),a.$el.hasClass("delete-cell")&&setTimeout((function(){i(a.$el).trigger("focus")}),50);break}if(l&&o){a.enterEditMode(),e.trigger("backgrid:next",r,d,!1);break}}g==h&&e.trigger("backgrid:next",~~(g/p),g-r*p,!0)}}return this}}),t.extend(s.Row.prototype,{makeCell:function(e){return new(this.getCell(e))({column:e,model:this.model})},getCell:function(e){var i=e.get("cellFunction");if(!t.isFunction(i))return e.get("cell");var n=i.apply(e,[this.model]);try{return s.resolveNameToClass(n,"Cell")}catch(t){if(t instanceof ReferenceError)return e.get("cell");throw t}}});var b=s.Extension.ObjectCellEditor=s.CellEditor.extend({modalTemplate:t.template(['<div class="subnode-dialog" tabindex="0">','    <div class="subnode-body"></div>',"</div>"].join("\n")),stringTemplate:t.template(['<div class="form-group">','  <label class="control-label col-sm-4"><%=label%></label>','  <div class="col-sm-8">','    <input type="text" class="form-control" name="<%=name%>" value="<%=value%>" placeholder="<%=placeholder%>" />',"  </div>","</div>"].join("\n")),extendWithOptions:function(e){t.extend(this,e)},render:function(){return this},postRender:function(e,n){var l=this.columns_length,s=this.schema.length?this.schema:this.column.get("schema");if(null!=n&&n.get("name")!=this.column.get("name"))return!1;if(!t.isArray(s))throw new TypeError("schema must be an array");var o=this.createDialog(l),r=i('<form class="form-dialog"></form>');o.find("div.subnode-body").append(r);var d=o.find("form.form-dialog");return this.objectView=new a.Dialog({el:d,model:this.model,schema:s,tabPanelClassName:function(){return"sub-node-form col-sm-12"},events:{keydown:function(e){var t=f.default.pgAdmin.Browser.get_preferences_for_module("browser");t&&p.validateShortcutKeys(t.add_grid_row,e)&&v.keyboardNavigation.bindAddGridRow()}}}),this.objectView.render(),this},createDialog:function(e){e=e||1;var t=this.$dialog=i(this.modalTemplate({title:""})),n=i('<tr class="nohover editor-row">'),a=i("<td>",{class:"editable sortable renderable",style:"height: auto",colspan:e+2}).appendTo(n);return this.tr=n,a.append(t.css("display","block")),this.el.parent("tr").after(n),t},save:function(){return this.model.trigger("backgrid:edited",this.model,this.column,new s.Command({keyCode:13})),this.tr&&this.tr.remove(),this},remove:function(){return this.objectView.remove(),s.CellEditor.prototype.remove.apply(this,arguments),this.tr&&this.tr.remove(),this}});s.Extension.PGSelectCell=s.SelectCell.extend({optionValues:function(){var e=[],i=t.result(this.column.attributes,"options");return t.each(i,(function(t){e.push([t.label,t.value])})),e}}),s.Extension.ObjectCell=s.Cell.extend({editorOptionDefaults:{schema:[]},className:"edit-cell",editor:b,initialize:function(e){s.Cell.prototype.initialize.apply(this,arguments);var n=this,a={};t.each(this.editorOptionDefaults,(function(t,i){n[i]||(n[i]=t),e&&e[i]&&(n[i]=e[i]),a[i]=n[i]})),a.el=i(this.el),a.columns_length=this.column.collection.length,a.el.attr("tabindex",0),this.listenTo(this.model,"backgrid:edit",(function(e,t,i,n){t.get("name")==this.column.get("name")&&n.extendWithOptions(a)})),this.$el.on("keydown",(function(e){32==e.keyCode&&i(this).click()}))},enterEditMode:function(){var n=!(!t.isUndefined(this.column.get("canEditRow"))&&t.isFunction(this.column.get("canEditRow")))||s.callByNeed(this.column.get("canEditRow"),this.column,this.model);if(n){this.model.trigger("enteringEditMode",[this]),s.Cell.prototype.enterEditMode.apply(this,arguments),this.delegateEvents();var a=s.callByNeed(this.column.editable(),this.column,this.model);if(a){this.$el.html("<i class='fa fa-pen-square subnode-edit-in-process' title='"+e("Edit row")+"' aria-label='"+e("Edit row")+"'></i>");var l=i(this.$el).parents()[1],r=i(l).find(".tab-content:first > .tab-pane.active:first");u.findAndSetFocus(r),v.keyboardNavigation.getDialogTabNavigator(i(l).find(".subnode-dialog")),this.model.trigger("pg-sub-node:opened",this.model,this)}}else o.alert(e("Edit object"),e("This object is not user editable."),(function(){return!0}))},render:function(){return this.$el.empty(),this.$el.html("<i class='fa fa-edit' title='"+e("Edit row")+"' aria-label='"+e("Edit row")+"'></i>"),this.delegateEvents(),this.grabFocus&&this.$el.trigger("focus"),this},exitEditMode:function(){if(!t.isUndefined(this.currentEditor)||!t.isEmpty(this.currentEditor)){var e=i(this.currentEditor.objectView.el).find('.nav-tabs > .active > a[data-toggle="tab"]').first().data("tabIndex");s.Cell.prototype.exitEditMode.apply(this,arguments),this.model.trigger("pg-sub-node:closed",this,e),this.grabFocus=!0}},events:{click:function(e){this.$el.find("i").first().hasClass("subnode-edit-in-process")?(this.undelegateEvents(),this.currentEditor.save()):this.enterEditMode.call(this,[]),e.preventDefault()},keydown:function(e){var t=this.model,i=this.column,n=new s.Command(e);n.moveLeft()&&setTimeout((function(){t.trigger("backgrid:edited",t,i,n)}),20)}}}),s.Extension.DeleteCell=s.Cell.extend({defaults:t.defaults({defaultDeleteMsg:e("Are you sure you wish to delete this row?"),defaultDeleteTitle:e("Delete Row")},s.Cell.prototype.defaults),className:"delete-cell",events:{click:"deleteRow"},deleteRow:function(n){n.preventDefault();var a=this;if(!(!t.isUndefined(this.column.get("canDeleteRow"))&&t.isFunction(this.column.get("canDeleteRow")))||s.callByNeed(this.column.get("canDeleteRow"),this.column,this.model)){var l=t.isUndefined(this.column.get("customDeleteMsg"))?a.defaults.defaultDeleteMsg:this.column.get("customDeleteMsg"),r=t.isUndefined(this.column.get("customDeleteTitle"))?a.defaults.defaultDeleteTitle:this.column.get("customDeleteTitle");o.confirm(r,l,(function(){var e=i(a.el).parents("tbody").eq(0);a.model.collection.remove(a.model);var t=i(e).find("tr");t.length>0?t.first().children()[0].focus():i(e).parents(".subnode").eq(0).find(".add").focus()}),(function(){return!0}))}else o.alert(e("Delete object"),e("This object cannot be deleted."),(function(){return!0}))},exitEditMode:function(){this.$el.removeClass("editor")},initialize:function(){s.Cell.prototype.initialize.apply(this,arguments)},render:function(){var t=this;return this.$el.empty(),i(this.$el).attr("tabindex",0),this.$el.html('<i aria-label="'+e("Delete row")+"\" class='fa fa-trash-alt' title='"+e("Delete row")+"'></i>"),this.$el.on("keydown",(function(e){var i;if(32==e.keyCode&&t.$el.click(),9!=e.keyCode&&16!=e.keyCode||(i=e.shiftKey?t.$el.prev():t.$el.next()),i){var n=new s.Command({key:"Tab",keyCode:9,which:9,shiftKey:e.shiftKey});setTimeout((function(){i.hasClass("editable")?(e.preventDefault(),e.stopPropagation(),t.model.trigger("backgrid:edited",t.model,t.column,n)):t.model.trigger("backgrid:edited",t.model,t.column,n)}),20)}})),this.delegateEvents(),this}}),s.Extension.ClearCell=s.Cell.extend({defaults:t.defaults({defaultClearMsg:e("Are you sure you wish to clear this row?"),defaultClearTitle:e("Clear Row")},s.Cell.prototype.defaults),className:"clear-cell",events:{click:"clearRow"},clearRow:function(e){if(e.preventDefault(),t.isEmpty(e.currentTarget.innerHTML))return!1;var i=this,n=t.isUndefined(this.column.get("customClearMsg"))?i.defaults.defaultClearMsg:this.column.get("customClearMsg"),a=t.isUndefined(this.column.get("customClearTitle"))?i.defaults.defaultClearTitle:this.column.get("customClearTitle");o.confirm(a,n,(function(){i.model.set("name",null),i.model.set("sql",null)}),(function(){return!0}))},exitEditMode:function(){this.$el.removeClass("editor")},initialize:function(){s.Cell.prototype.initialize.apply(this,arguments)},render:function(){var t=this;return this.$el.empty(),i(this.$el).attr("tabindex",0),null!==this.model.get("name")&&null!==this.model.get("sql")&&this.$el.html('<i aria-label="'+e("Clear row")+"\" class='fa fa-eraser' title='"+e("Clear row")+"'></i>"),this.$el.on("keydown",(function(e){var i;if(32==e.keyCode&&t.$el.click(),9!=e.keyCode&&16!=e.keyCode||(i=e.shiftKey?t.$el.prev():t.$el.next()),i){var n=new s.Command({key:"Tab",keyCode:9,which:9,shiftKey:e.shiftKey});setTimeout((function(){i.hasClass("editable")?(e.preventDefault(),e.stopPropagation(),t.model.trigger("backgrid:edited",t.model,t.column,n)):t.model.trigger("backgrid:edited",t.model,t.column,n)}),20)}})),this.delegateEvents(),this}}),s.Extension.CustomHeaderCell=s.HeaderCell.extend({initialize:function(){s.HeaderCell.prototype.initialize.apply(this,arguments);var e=this.column.get("cellHeaderClasses"),t=this.column.get("cellAriaLabel");e&&this.$el.addClass(e),t&&this.$el.attr("aria-label",t)},render:function(){if(s.HeaderCell.prototype.render.apply(this,arguments),""==this.column.get("label")||!this.column.get("label")){var e=this.column.get("cellAriaLabel");e&&this.$el.append('<span class="sr-only">'.concat(e,"</span>"))}return this}}),l&&l.fn.bootstrapToggle&&(i.fn.bootstrapToggle=l.fn.bootstrapToggle),s.Extension.SwitchCell=s.BooleanCell.extend({defaults:{options:t.defaults({onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"ternary",size:"mini",width:null,height:null},i.fn.bootstrapToggle.defaults)},className:"switch-cell",initialize:function(){s.BooleanCell.prototype.initialize.apply(this,arguments),this.onChange=this.onChange.bind(this)},enterEditMode:function(){this.$el.addClass("editor"),i(this.$el.find(".toggle.btn")).trigger("focus")},exitEditMode:function(){this.$el.removeClass("editor")},events:{"change input":"onChange","blur input":"exitEditMode",keydown:"onKeyDown"},onKeyDown:function(e){var t=f.default.pgAdmin.Browser.get_preferences_for_module("browser");p.validateShortcutKeys(t.add_grid_row,e)&&v.keyboardNavigation.bindAddGridRow()},onChange:function(){var e=this.model,t=this.column,i=this.formatter.toRaw(this.$input.prop("checked"),e);this.enterEditMode(),e.set(t.get("name"),i),this.setSrValue()},setSrValue:function(){var i=t.defaults({},this.column.get("options"),this.defaults.options),n=i.onText,a=i.offText;this.$el.find(".toggle.btn").hasClass("off")?this.$el.find(".sr-value").text("\n          ".concat(a,", ").concat(e("Toggle button"),"\n        ")):this.$el.find(".sr-value").text("\n          ".concat(n,", ").concat(e("Toggle button"),"\n        "))},render:function(){var e=this,n=t.defaults(this.column.toJSON(),this.defaults),a=this.model,l=this.column,o=this.formatter.fromRaw(a.get(l.get("name")),a),r=s.callByNeed(n.editable,l,a),d=t.defaults({},n.options,this.defaults.options),c=t.uniqueId("pgC_");return this.undelegateEvents(),this.$el.empty(),this.$el.append('<label class="sr-value sr-only" for="'+c+'"></label>'),this.$el.append(i("<input>",{tabIndex:-1,type:"checkbox","aria-hidden":"true","aria-label":l.get("name")}).prop("checked",o).prop("disabled",!r).attr("data-toggle","toggle").attr("data-size",d.size).attr("data-on",d.onText).attr("data-off",d.offText).attr("data-width",d.width).attr("data-height",d.height).attr("data-onstyle",d.onColor).attr("data-offstyle",d.offColor)),this.$input=this.$el.find("input[type=checkbox]").first(),this.$input.bootstrapToggle(),this.$el.find(".toggle.btn").attr("tabindex",r?"0":"-1").attr("id",c).on("keydown",(function(t){32==t.keyCode&&(e.$el.find("input[type=checkbox]").bootstrapToggle("toggle"),t.preventDefault(),t.stopPropagation(),e.setSrValue())})),this.$el.find(".toggle.btn .toggle-group .btn").attr("aria-hidden",!0),this.setSrValue(),this.$el.on("keydown",(function(t){var i;if(9==t.keyCode&&(i=t.shiftKey?e.$el.prev():e.$el.next()),i&&i.length>0){i.hasClass("editable")&&(t.preventDefault(),t.stopPropagation());var n=new s.Command({key:"Tab",keyCode:9,which:9,shiftKey:t.shiftKey});setTimeout((function(){i.hasClass("editable")&&i.hasClass("edit-cell")?i.trigger("focus"):i.hasClass("editable")?(setTimeout((function(){e.model.trigger("backgrid:edited",e.model,e.column,n)}),10),i.trigger("focus")):setTimeout((function(){e.model.trigger("backgrid:edited",e.model,e.column,n)}),10)}),20)}})),this.delegateEvents(),this}}),s.Extension.Select2Cell=s.SelectCell.extend({className:"select2-cell",editor:null,defaults:t.defaults({select2:{},opt:{label:null,value:null,selected:!1}},s.SelectCell.prototype.defaults),enterEditMode:function(){this.$el.hasClass("editor")||this.$el.addClass("editor"),this.$select.select2("focus"),this.$select.select2("open"),this.$select.on("blur",this.exitEditMode)},exitEditMode:function(){this.$select.off("blur",this.exitEditMode),this.$select.select2("close"),this.$el.removeClass("editor"),this.$el.find(".select2-selection").trigger("focus")},saveOrCancel:function(e){var t,i=this,n=new s.Command(e),a="blur"===e.type;if((n.moveUp()||n.moveDown()||n.moveLeft()||n.moveRight()||n.save()||a)&&(9!=e.keyCode&&16!=e.keyCode||(t=e.shiftKey?i.$el.prev():i.$el.next(),0==i.$el.next().length&&setTimeout((function(){i.$el.find(".select2-selection").blur()}),100)),t)){var l=new s.Command({key:"Tab",keyCode:9,which:9,shiftKey:e.shiftKey});setTimeout((function(){t.hasClass("editable")?(e.preventDefault(),e.stopPropagation(),i.model.trigger("backgrid:edited",i.model,i.column,l)):i.model.trigger("backgrid:edited",i.model,i.column,l)}),20)}},events:{"select2:open":"enterEditMode","select2:close":"exitEditMode",change:"onSave","select2:unselect":"onSave",blur:"saveOrCancel",keydown:"saveOrCancel"},template:t.template(['<option value="<%- value %>" ','<%= selected ? \'selected="selected"\' : "" %>>',"<%- label %></option>"].join(""),null,{variable:null}),initialize:function(){s.SelectCell.prototype.initialize.apply(this,arguments),this.onSave=this.onSave.bind(this),this.enterEditMode=this.enterEditMode.bind(this),this.exitEditMode=this.exitEditMode.bind(this)},render:function(){var e=t.defaults(this.column.toJSON(),this.defaults),n=this.model,a=this.column,l=s.callByNeed(e.editable,a,n),o=t.clone(this.optionValues||(t.isFunction(this.column.get("options"))?this.column.get("options")(this):this.column.get("options")));if(this.undelegateEvents(),this.$select&&(this.$select.data("select2")&&this.$select.select2("destroy"),delete this.$select,this.$select=null),this.$el.empty(),!t.isArray(o))throw new TypeError("optionValues must be an array");var r=null,d=null,c=this,u=n.get(this.column.get("name")),p=t.extend({openOnEnter:!1,multiple:!1,showOnScroll:!0,first_empty:!0},c.defaults.select2,e.select2||{}),f=t.template('<select <%=multiple ? "multiple" : "" %>></select>'),m=c.$select=i(f({multiple:p.multiple})).appendTo(c.$el);p.first_empty&&o.unshift(this.defaults.opt);for(var g=0;g<o.length;g++){var v=o[g];t.isArray(v)?(r=v[0],d=v[1],m.append(c.template({label:r,value:d,selected:u==d||p.multiple&&t.indexOf(u,d)>-1}))):(v=t.defaults({},v,{selected:u==v.value||p.multiple&&t.indexOf(u,v.value)>-1},c.defaults.opt),m.append(c.template(v)))}if(e&&t.has(e.disabled)){t.extend(p,{disabled:function(){var e=[];Array.prototype.push.apply(e,arguments);var t=e.shift();return"function"==typeof t?t.apply(c,e):t}(e.disabled,e,n)})}else t.extend(p,{disabled:!l});return this.delegateEvents(),l&&"properties"!==e.mode||(p.placeholder=""),p=h.default(p),this.$sel=this.$select.select2(p),this.$sel&&this.$sel.data("select2").on("keypress",(function(e){9===e.which&&this.isOpen()&&(this.trigger("results:select",{}),e.preventDefault())})),this},onSave:function(){var e=this.model,t=this.column;e.set(t.get("name"),this.$select.val())},remove:function(){this.$select.off("change",this.onSave),this.$select.data("select2")&&this.$select.select2("destroy"),this.$el.empty(),s.SelectCell.prototype.remove.apply(this,arguments)}});var y=s.TextareaCellEditor=s.InputCellEditor.extend({tagName:"textarea",events:{blur:"saveOrCancel",keydown:""}});s.Extension.TextareaCell=s.Cell.extend({className:"textarea-cell",editor:y}),s.Extension.CustomHeaderIconCell=s.HeaderCell.extend({className:"header-icon-cell",events:{click:"addHeaderIcon"},addHeaderIcon:function(e){this.collection.add(new this.collection.model),e.preventDefault()},render:function(){return this.$el.empty(),this.$el.html("<label><a><span style='font-weight:normal;'>"+e("Array Values")+"</a></span></label> <button class='btn-sm btn-secondary add'>"+e("Add")+"</button>"),this.delegateEvents(),this}});var C=n.Model.extend({defaults:{value:null}}),_=s.Extension.InputArrayCellEditor=s.CellEditor.extend({tagName:"div",events:{blur:"lostFocus"},render:function(){var t=this,n=this.model.get(this.column.get("name")),a="string";switch(this.model.get("type").replace("[]","")){case"boolean":a="boolean";break;case"integer":case"smallint":case"bigint":case"serial":case"smallserial":case"bigserial":case"oid":case"cid":case"xid":case"tid":a="integer";break;case"real":case"numeric":case"double precision":case"decimal":a="number";break;case"date":a="date"}var l=[{name:"value",label:e("Array Values"),type:"text",cell:a,headerCell:s.Extension.CustomHeaderIconCell,cellHeaderClasses:"width_percent_100"}],o=i("<div class='pgadmin-control-group backgrid form-group col-12 object subnode'></div>");this.$el.attr("tabindex","1"),l.unshift({name:"pg-backform-delete",label:"",cell:s.Extension.DeleteCell,editable:!1,cell_priority:-1}),this.$el.empty();var r,d=t.grid=new s.Grid({columns:l,collection:n});return this.grid.listenTo(n,"backgrid:error",(r=this,function(e){r.model.trigger("backgrid:error",r.model,r.column,new s.Command(e))})),this.grid.listenTo(n,"backgrid:edited",function(e){return function(t){e.model.trigger("backgrid:edited",e.model,e.column,new s.Command(t))}}(this)),d.render(),o.append(d.$el),this.$el.html(o),i(t.$el).pgMakeVisible("backform-tab"),t.delegateEvents(),this},lostFocus:function(e){var t=this;setTimeout((function(){if(t.$el[0]!=document.activeElement&&!function(e,t){for(var i=t.parentNode;null!=i;){if(i==e)return!0;i=i.parentNode}return!1}(t.$el[0],document.activeElement)){var i=t.model,n=t.column;i.trigger("backgrid:edited",i,n,new s.Command(e)),setTimeout((function(){t.grid&&(t.grid.remove(),t.grid=null)}),10)}}),10)}}),w=s.Extension.InputStringArrayCellFormatter=function(){};t.extend(w.prototype,{fromRaw:function(e){var i=[];return e.each((function(e){var n=e.get("value");t.isUndefined(n)?i.push("null"):i.push(e.get("value"))})),i.toString()},toRaw:function(e){return e}});var x=s.Extension.InputIntegerArrayCellFormatter=function(){};t.extend(x.prototype,{fromRaw:function(e){var i=[];return e.each((function(e){var n=e.get("value");t.isUndefined(n)||t.isNull(n)?i.push("NULL"):i.push(e.get("value"))})),i.toString()},toRaw:function(e){return e.each((function(e){e.set("value",parseInt(e.get("value")),{silent:!0})})),e}});var k=s.Extension.InputNumberArrayCellFormatter=function(){};t.extend(k.prototype,{fromRaw:function(e){var i=[];return e.each((function(e){var n=e.get("value");t.isUndefined(n)||t.isNull(n)?i.push("NULL"):i.push(e.get("value"))})),i.toString()},toRaw:function(e){return e.each((function(e){e.set("value",parseFloat(e.get("value")),{silent:!0})})),e}}),s.Extension.InputStringArrayCell=s.Cell.extend({className:"width_percent_25",formatter:w,editor:_,initialize:function(){s.Cell.prototype.initialize.apply(this,arguments);var e=arguments[0].model;t.isUndefined(this.collection)&&(this.collection=new(n.Collection.extend({model:C}))(e.get("value"))),this.model.set(this.column.get("name"),this.collection),this.listenTo(this.collection,"remove",this.render)}}),s.Extension.InputIntegerArrayCell=s.IntegerCell.extend({className:"width_percent_25",formatter:x,editor:_,initialize:function(){s.IntegerCell.prototype.initialize.apply(this,arguments);var e=arguments[0].model;t.each(e.get("value"),(function(e){"NULL"===e.value&&(e.value=null)})),t.isUndefined(this.collection)&&(this.collection=new(n.Collection.extend({model:C}))(e.get("value"))),this.model.set(this.column.get("name"),this.collection),this.listenTo(this.collection,"remove",this.render)}}),s.Extension.InputNumberArrayCell=s.NumberCell.extend({className:"width_percent_25",formatter:k,editor:_,initialize:function(){s.NumberCell.prototype.initialize.apply(this,arguments);var e=arguments[0].model;t.each(e.get("value"),(function(e){"NULL"===e.value&&(e.value=null)})),t.isUndefined(this.collection)&&(this.collection=new(n.Collection.extend({model:C}))(e.get("value"))),this.model.set(this.column.get("name"),this.collection),this.listenTo(this.collection,"remove",this.render)}}),s.Extension.InputBooleanArrayCell=s.BooleanCell.extend({className:"width_percent_25",editor:_,initialize:function(){s.BooleanCell.prototype.initialize.apply(this,arguments);var e=arguments[0].model;t.isUndefined(this.collection)&&(this.collection=new(n.Collection.extend({model:C}))(e.get("value"))),this.model.set(this.column.get("name"),this.collection),this.listenTo(this.collection,"remove",this.render)}});var N=s.Extension.DependentCell=function(){};t.extend(N.prototype,{initialize:function(){var e=this.column.get("deps"),i=this;e&&t.isArray(e)&&t.each(e,(function(e){var t=e.split(".").shift();i.listenTo(i.model,"change:"+t,i.dependentChanged)}))},remove:function(){var e=this,i=e.column.get("deps");i&&t.isArray(i)&&t.each(i,(function(t){var i=t.split(".").shift();e.stopListening(e.model,"change:"+i,e.dependentChanged)}))}});var E=s.PasswordFormatter=function(){};E.prototype=new s.CellFormatter,t.extend(E.prototype,{fromRaw:function(e){if(t.isUndefined(e)||t.isNull(e))return"";for(var i="",n=0;n<e.length;n++)i+="*";return i}}),s.Extension.PasswordCell=s.StringCell.extend({formatter:E,editor:s.InputCellEditor.extend({attributes:{type:"password",autocomplete:"new-password"},render:function(){var e=this.model;return this.$el.val(e.get(this.column.get("name"))),this}})}),t.extend(s.NumberFormatter.prototype,{fromRaw:function(e){if(t.isNull(e)||t.isUndefined(e))return"";var i=(e=parseFloat(e).toFixed(~~this.decimals)).split("."),n=i[0],a=i[1]?(this.decimalSeparator||".")+i[1]:"";return n.replace(this.HUMANIZED_NUM_RE,"$1"+this.orderSeparator)+a}});var T=s.Extension.JSONBCellFormatter=function(){};t.extend(T.prototype,{fromRaw:function(e){if(t.isArray(e)){return"{"+t.map(e,(function(e){return JSON.stringify(JSON.stringify(e))})).join()+"}"}return t.isObject(e)?JSON.stringify(e):e},toRaw:function(e){return e}}),s.Extension.JSONBCell=s.StringCell.extend({className:"jsonb-cell",formatter:T});var S=s.InputCellEditor.extend({events:{},initialize:function(){s.InputCellEditor.prototype.initialize.apply(this,arguments);var e=this;i(this.el).prop("readonly",!0),i(this.el).datepicker({onClose:function(t){var i=new s.Command({});e.model.set(e.column.get("name"),t),e.model.trigger("backgrid:edited",e.model,e.column,i),e=null}})}});s.Extension.DatepickerCell=s.Cell.extend({editor:S});var I=s.Extension.MomentFormatter=function(e){t.extend(this,this.defaults,e)};I.prototype=new s.CellFormatter,t.extend(I.prototype,{defaults:{modelInUnixOffset:!1,modelInUnixTimestamp:!1,modelInUTC:!0,modelLang:r.locale(),modelFormat:r.defaultFormat,displayInUnixOffset:!1,displayInUnixTimestamp:!1,displayInUTC:!0,displayLang:r.locale(),displayFormat:r.defaultFormat,allowEmpty:!1},fromRaw:function(e){if(null==e)return"";var t=this.modelInUnixOffset?r(e):this.modelInUnixTimestamp?r.unix(e):this.modelInUTC?r.utc(e,this.modelFormat,this.modelLang):r(e,this.modelFormat,this.modelLang);return this.displayInUnixOffset?+t:this.displayInUnixTimestamp?t.unix():(this.displayLang&&t.locale(this.displayLang),this.displayInUTC?t.utc():t.local(),this.displayFormat!=r.defaultFormat?t.format(this.displayFormat):t.format())},toRaw:function(e){var t=this.displayInUnixOffset?r(+e):this.displayInUnixTimestamp?r.unix(+e):this.displayInUTC?r.utc(e,this.displayFormat,this.displayLang):r(e,this.displayFormat,this.displayLang);return t&&t.isValid()?this.modelInUnixOffset?+t:this.modelInUnixTimestamp?t.unix():(this.modelLang&&t.locale(this.modelLang),this.modelInUTC?t.utc():t.local(),this.modelFormat!=r.defaultFormat?t.format(this.modelFormat):t.format()):this.allowEmpty&&""===e?null:void 0}});var D=s.Extension.MomentCell=s.Cell.extend({editor:s.InputCellEditor,className:"datetime-cell",formatter:I,initialize:function(e){D.__super__.initialize.apply(this,arguments);var i=I.prototype.defaults,n=t.keys(i),a=t.pick(this,n),l=t.pick(e,n),s=t.pick(this.column.toJSON(),n);t.extend(this.formatter,i,a,l,s),this.editor=this.editor.extend({attributes:t.extend({},this.editor.prototype.attributes||this.editor.attributes||{},{placeholder:this.formatter.displayFormat}),options:this.column.get("options")})}});s.Extension.DatetimePickerEditor=s.InputCellEditor.extend({postRender:function(){var e=this,i=t.extend({format:"YYYY-MM-DD HH:mm:ss Z",icons:{time:"fa fa-clock",data:"fa fa-calendar-alt",today:"fa fa-calendar-check",clear:"fa fa-trash"},buttons:{showToday:!0},toolbarPlacement:"top",widgetPositioning:{horizontal:"auto",vertical:"bottom"},keepOpen:!1},function(){var t=[];Array.prototype.push.apply(t,arguments);var i=t.shift();return"function"==typeof i?i.apply(e,t):i}(this.column.get("options")),{keyBinds:{"shift tab":function(t){t&&setTimeout((function(){e.closeIt({keyCode:9,shiftKey:!0})}),10)},tab:function(t){t&&setTimeout((function(){e.closeIt({keyCode:9})}),10)}}});this.tabKeyPress=!1,this.$el.datetimepicker(i),this.$el.datetimepicker("show"),this.picker=this.$el.data("datetimepicker")},events:{"hide.datetimepicker":"closeIt",focusout:"closeIt",keydown:"keydownHandler"},keydownHandler:function(e){var t=!1,n=this;if(e.altKey||38!=e.keyCode)if(e.altKey||40!=e.keyCode){if(39==e.keyCode){var a=n.$el.data("datetimepicker").date().clone();i(this.el).datetimepicker("date",a.add(1,"d"))}else if(37==e.keyCode){var l=n.$el.data("datetimepicker").date().clone();i(this.el).datetimepicker("date",l.subtract(1,"d"))}}else{var s=n.$el.data("datetimepicker").date().clone();n.$el.data("datetimepicker").widget.find(".datepicker").is(":visible")?i(this.el).datetimepicker("date",s.add(7,"d")):i(this.el).datetimepicker("date",s.subtract(7,"m"))}else{var o=n.$el.data("datetimepicker").date().clone();n.$el.data("datetimepicker").widget.find(".datepicker").is(":visible")?i(this.el).datetimepicker("date",o.subtract(7,"d")):i(this.el).datetimepicker("date",o.add(7,"m"))}if(e.altKey&&84==e.keyCode&&(n.$el.data("datetimepicker").widget.find(".timepicker").is(":visible")?n.$el.data("datetimepicker").widget.find(".fa-calendar-alt").click():n.$el.data("datetimepicker").widget.find(".fa-clock").click()),e.altKey&&38==e.keyCode){var r=n.$el.data("datetimepicker").date().clone();i(this.el).datetimepicker("date",r.add(1,"h"))}else if(e.altKey&&40==e.keyCode){var d=n.$el.data("datetimepicker").date().clone();i(this.el).datetimepicker("date",d.subtract(1,"h"))}27==e.keyCode&&(this.$el.datetimepicker("hide"),t=!0),t&&e.stopImmediatePropagation();9===e.keyCode&&n.el===e.target&&n.closeIt(e,!0)},closeIt:function(e,i){if(!this.is_closing&&!this.tabKeyPress){this.is_closing=!0,this.tabKeyPress=i;var n=this.formatter,a=this.model,l=this.column,o=this.$el.val(),r=n.toRaw(o,a);this.$el.datetimepicker("destroy"),this.is_closing=!1,(t.isUndefined(r)||""==String(o).replace(/^\s+|\s+$/g,""))&&(r=null),a.set(l.get("name"),r);var d=new s.Command(e);a.trigger("backgrid:edited",a,l,d)}}}),t.extend(D.prototype,I.prototype.defaults),s.Extension.StringDepCell=s.StringCell.extend({initialize:function(){s.StringCell.prototype.initialize.apply(this,arguments),s.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){this.$el.empty();var e=this,i=this.model,n=this.column,a=this.column.get("editable");this.render();var l=t.isFunction(a)?!!a.apply(n,[i]):!!a;return setTimeout((function(){e.$el.removeClass("editor"),l?e.$el.addClass("editable"):e.$el.removeClass("editable")}),10),this.delegateEvents(),this},remove:s.Extension.DependentCell.prototype.remove}),s.Extension.Select2DepCell=s.Extension.Select2Cell.extend({initialize:function(){s.Extension.Select2Cell.prototype.initialize.apply(this,arguments),s.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){var e=this.model,i=this.column,n=this.column.get("editable");return this.render(),(t.isFunction(n)?n.apply(i,[e]):n)?this.$el.addClass("editable"):this.$el.removeClass("editable"),this.delegateEvents(),this},remove:s.Extension.DependentCell.prototype.remove}),s.Extension.ClientSideFilter=s.Extension.ClientSideFilter.extend({$customSearchBox:null,template:function(e){return'<span class="search">&nbsp;</span><input type="search" '+(e.placeholder?'aria-label= "'+e.placeholder+'"':"")+" "+(e.placeholder?'placeholder="'+e.placeholder+'"':"")+' name="'+e.name+'" '+(e.value?'value="'+e.value+'"':"")+'/><a class="clear" data-backgrid-action="clear" href="#">&times;</a>'},searchBox:function(){return this.$customSearchBox?this.$customSearchBox:this.$el.find("input[type=search]")},setCustomSearchBox:function(e){return this.$customSearchBox=e,this.$customSearchBox.attr("type","search"),this.$customSearchBox.on("keydown",this.search.bind(this)),this.$customSearchBox.on("mousedown",this.search.bind(this)),this},unsetCustomSearchBox:function(){return this.$customSearchBox.off("keydown",this.search.bind(this)),this.$customSearchBox=null,this}});var $=s.BooleanCellFormatter=function(){};return t.extend($.prototype,{fromRaw:function(e){return!t.isUndefined(e)&&!t.isNull(e)&&("1"===e||"True"===e||"0"!==e&&"False"!==e&&e)},toRaw:function(e){return e}}),s.BooleanCell=s.BooleanCell.extend({className:"boolean-cell",enterEditMode:function(){this.$el.addClass("editor"),i(this.$el.find("input[type=checkbox]")).trigger("focus")},exitEditMode:function(){this.$el.removeClass("editor")},events:{"change input":"onChange","blur input":"exitEditMode",keydown:"onKeyDown"},onChange:function(e){var t=this.model,i=this.column,n=this.formatter.toRaw(this.$input.prop("checked"),t);this.enterEditMode(),t.set(i.get("name"),n),t.trigger("backgrid:edited",t,i,new s.Command(e))},render:function(){this.$el.empty();var n=this.model,a=this.column,l=s.callByNeed(a.editable(),a,n),o=a.get("align_center")||!1,r=this.formatter.fromRaw(n.get(a.get("name")),n),d="".concat(a.get("name"),"_").concat(t.uniqueId());return this.$el.empty(),this.$el.append(i('<div class="custom-control custom-checkbox custom-checkbox-no-label '.concat(o?"text-center":"",'">\n          <input tabindex="0" type="checkbox" class="custom-control-input" id="').concat(d,'" ').concat(l?"":"disabled"," ").concat(r?"checked":"",'/>\n          <label class="custom-control-label" for="').concat(d,'">\n            <span class="sr-only">')+e("Select")+"<span>\n          </label>\n        </div>")),this.$input=this.$el.find("input"),this.delegateEvents(),this}}),s.Extension.SqlCell=s.Extension.TextareaCell.extend({className:"sql-cell",defaults:{lineWrapping:!0},template:t.template(['<div data-toggle="tooltip" data-placement="top" data-html="true" title="<%- val %>"><textarea aria-label="'+e("SQL")+'" + style="display: none;"><%- val %></textarea><div>'].join("\n")),render:function(){var e=this,i=t.defaults(this.column.toJSON(),this.defaults),n=this.model,a=this.column,l=this.column.get("name"),o=s.callByNeed(i.editable,a,n);return this.sqlCell&&(this.sqlCell.toTextArea(),delete this.sqlCell,this.sqlCell=null),this.$el.empty(),this.$el.append(this.template({val:this.formatter.fromRaw(n.get(l),n)})),this.$el.addClass(l),this.updateStateClassesMaybe(),this.delegateEvents(),setTimeout((function(){e.sqlCell=c.fromTextArea(e.$el.find("textarea")[0],{mode:"text/x-pgsql",readOnly:!o,singleCursorHeightPerLine:!0,screenReaderLabel:l})})),this},enterEditMode:function(){this.$el.hasClass("editor")||this.$el.addClass("editor"),this.sqlCell.focus(),this.sqlCell.on("blur",this.exitEditMode.bind(this))},exitEditMode:function(){this.$el.removeClass("editor"),this.saveOrCancel.apply(this,arguments)},saveOrCancel:function(){var e=this.model,i=this.column;if(this.sqlCell){var n=this.sqlCell.getTextArea().value,a=this.sqlCell.getValue();t.isUndefined(a)?e.trigger("backgrid:error",e,i,n):e.set(i.get("name"),a)}},remove:function(){return this.sqlCell&&(i(this.$el.find('[data-toggle="tooltip"]')).tooltip("dispose"),this.sqlCell.toTextArea(),delete this.sqlCell,this.sqlCell=null),s.Extension.TextareaCell.prototype.remove.apply(this,arguments)}}),s.RadioCell=s.BooleanCell.extend({className:"radio-cell",initialize:function(){s.BooleanCell.prototype.initialize.apply(this,arguments),s.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){return this.render()},enterEditMode:function(){this.$el.addClass("editor"),i(this.$el.find("input[type=radio]")).trigger("focus")},exitEditMode:function(){this.$el.removeClass("editor")},events:{"change input":"onChange","blur input":"exitEditMode"},onChange:function(e){var i=this.model,n=this.column,a=this.formatter.toRaw(this.$input.prop("checked"),i);this.enterEditMode(),t.each(this.model.collection.models,(function(t){t.set(n.get("name"),!1),t.trigger("backgrid:edited",t,n,new s.Command(e))})),i.set(n.get("name"),a),i.trigger("backgrid:edited",i,n,new s.Command(e))},render:function(){this.$el.empty();var e=this.model,n=this.column,a=s.callByNeed(n.editable(),n,e),l=this.formatter.fromRaw(e.get(n.get("name")),e),o="".concat(n.get("name"),"_").concat(t.uniqueId());return this.$el.empty(),this.$el.append(i('<div style="text-align: center">\n          <input tabindex="0" type="radio" id="'.concat(o,'" ').concat(a?"":"disabled"," ").concat(l?"checked":"","/>\n        </div>"))),this.$input=this.$el.find("input"),this.delegateEvents(),this}}),s.Extension.SelectFileCell=s.Cell.extend({className:"file-cell",defaults:{supported_types:["*"],dialog_type:"select_file",dialog_title:e("Select file"),type:"text",value:"",placeholder:e("Select file..."),disabled:!1,browse_btn_label:e("Select file"),check_btn_label:e("Validate file"),browse_btn_visible:!0,validate_btn_visible:!0},initialize:function(){s.Cell.prototype.initialize.apply(this,arguments),this.data=t.extend(this.defaults,this.column.toJSON())},template:t.template(['<div class="input-group">','<input type="<%=type%>" id="<%=cId%>" class="form-control" value="<%-value%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> />',"<% if (browse_btn_visible) { %>",'<div class="input-group-append">','<button class="btn btn-primary-icon fa fa-ellipsis-h select_item" <%=disabled ? "disabled" : ""%>  aria-hidden="true" aria-label=<%=browse_btn_label%> title=<%=browse_btn_label%>></button>',"</div>","<% } %>","<% if (validate_btn_visible) { %>",'<div class="input-group-append">','<button class="btn btn-primary-icon fa fa-clipboard-check validate_item" <%=disabled ? "disabled" : ""%> <%=(value=="" || value==null) ? "disabled" : ""%>  aria-hidden="true" aria-label=<%=check_btn_label%> title=<%=check_btn_label%>></button>',"</div>","<% } %>","</div>"].join("\n")),events:{"change input":"onChange","click .select_item":"onSelect","click .validate_item":"onValidate"},render:function(){return this.$el.empty(),this.data=t.extend(this.data,{value:this.model.get(this.column.get("name"))}),this.data.cId=t.uniqueId("pgC_"),this.$el.append(this.template(this.data)),this.$input=this.$el.find("input"),this.delegateEvents(),this},onChange:function(){var e=this.model,t=this.column,i=this.formatter.toRaw(this.$input.prop("value"),e);e.set(t.get("name"),i)},onSelect:function(){var e=this,t={supported_types:e.data.supported_types,dialog_type:e.data.dialog_type,dialog_title:e.data.dialog_title};g.FileManager.init(),g.FileManager.show_dialog(t),this.listen_file_dlg_events()},storage_dlg_hander:function(e){var t=this.column.get("name").split(".").shift();this.remove_file_dlg_event_listeners(),this.model.set(t,decodeURI(e))},storage_close_dlg_hander:function(){this.remove_file_dlg_event_listeners()},listen_file_dlg_events:function(){g.Browser.Events.on("pgadmin-storage:finish_btn:"+this.data.dialog_type,this.storage_dlg_hander,this),g.Browser.Events.on("pgadmin-storage:cancel_btn:"+this.data.dialog_type,this.storage_close_dlg_hander,this)},remove_file_dlg_event_listeners:function(){g.Browser.Events.off("pgadmin-storage:finish_btn:"+this.data.dialog_type,this.storage_dlg_hander,this),g.Browser.Events.off("pgadmin-storage:cancel_btn:"+this.data.dialog_type,this.storage_close_dlg_hander,this)},onValidate:function(){var n=this.model,a=this.formatter.toRaw(this.$input.prop("value"),n);(t.isNull(a)||""===a.trim())&&o.alert(e("Validate Path"),e("Path should not be empty.")),i.ajax({url:m("misc.validate_binary_path"),method:"POST",contentType:"application/json",data:JSON.stringify({utility_path:a})}).done((function(t){o.alert(e("Validate binary path"),e(t.data))})).fail((function(t,i){o.pgNotifier(i,t,e("Failed to validate binary path."))}))}}),s}.apply(t,n))||(e.exports=a)},63828:(e,t,i)=>{"use strict";var n=i(64492),a=i(19755);i(82526),i(41817),i(41539),i(32165),i(66992),i(78783),i(33948),i(73210),i(69826),i(79753),i(69600),i(74916),i(23123),i(47042);var l=r(i(28210)),s=r(i(91669)),o=r(i(55455));function r(e){return e&&e.__esModule?e:{default:e}}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){function a(){return e("<div class='pg-text-editor' />")}function l(){return e("<textarea class='pg-textarea text-12' hidefocus rows=5'>")}function r(){return e("<div id='pg-json-editor' hidefocus>")}function c(t){var i=e("<div class='pg_buttons' />"),n=t?(0,s.default)("Cancel"):(0,s.default)("OK");return e("<button class='btn "+(t?"btn-secondary":"btn-primary")+" long_text_editor pg-alertify-button' data-label=\""+n+'"><span class="fa '+(t?"fa-times":"fa-check")+' pg-alertify-button"></span>&nbsp;'+n+"</button>").appendTo(i),t&&e("<button class='btn btn-primary long_text_editor' data-label=\""+(0,s.default)("OK")+'"><span class="fa fa-check pg-alertify-button"></span>&nbsp;'+(0,s.default)("OK")+"</button>").appendTo(i),i}function u(t){return!(""!=(t=e.trim(t))&&("{"!=t.charAt(0)||"}"!=t.charAt(t.length-1)))}function p(e,i,a,l){var s=e.grid;if(i.is_row_copied){s.copied_rows||(s.copied_rows=[[]]);var o=s.getActiveCell(),r=o.row,d=o.cell,c=i[e.column.pos];c="number"===l&&n.isEmpty(c)||c,i[e.column.field]=a,c&&n.isNull(a)&&(n.isUndefined(s.copied_rows[r])||n.isUndefined(s.copied_rows[r][d]))&&(i[e.column.field]=void 0,null==s.copied_rows[r]&&(s.copied_rows[r]=[]),s.copied_rows[r][d]=1)}else i[e.column.field]="jsonb"===l&&null!=a?t.stringify(t.parse(a)):a}function h(e,t){var i=t.parent().find("#datagrid");e.top=e.top-t.height();var n=i.width(),a=t.width()+32;return(a+=e.left)>n&&(e.left-=a-n),e}e.extend(!0,window,{Slick:{Editors:{pgText:function(t){var i,o,r,d,f=this;this.init=function(){var n=e("body");o=a().appendTo(n),i=l().appendTo(o),(r=c(!0).appendTo(o)).find("button:first").on("click",this.cancel),r.find("button:last").on("click",this.save),i.on("keydown",this.handleKeyDown),f.position(t.position),i.trigger("focus").trigger("select")},this.handleKeyDown=function(i){i.which==e.ui.keyCode.ENTER&&i.ctrlKey?f.save():i.which==e.ui.keyCode.ESCAPE?(i.preventDefault(),f.cancel()):i.which==e.ui.keyCode.TAB&&i.shiftKey?(i.preventDefault(),t.grid.navigatePrev()):i.which==e.ui.keyCode.TAB&&(i.preventDefault(),t.grid.navigateNext())},this.save=function(){t.commitChanges()},this.cancel=function(){i.val(d),t.cancelChanges()},this.hide=function(){o.hide()},this.show=function(){o.show()},this.position=function(e){h(e,o),o.css("top",e.top).css("left",e.left)},this.destroy=function(){o.remove()},this.focus=function(){i.trigger("focus")},this.loadValue=function(e){n.isUndefined(e[t.column.field])||n.isNull(e[t.column.field])?i.val(d=""):t.column.is_array?(i.val(d=e[t.column.field]),i.trigger("select")):""===e[t.column.field]?(i.val(d="''"),i.trigger("select")):"''"===e[t.column.field]?i.val(d="\\'\\'"):'""'===e[t.column.field]?i.val(d='\\"\\"'):(i.val(d=e[t.column.field]),i.trigger("select"))},this.serializeValue=function(){var n=i.val();return""===n?null:t.column.is_array?e.trim(n):"''"===n||'""'===n?"":"\\'\\'"===n?"''":'\\"\\"'===n?'""':n},this.applyValue=function(e,i){p(t,e,i,"text")},this.isValueChanged=function(){return(""!=i.val()||!n.isUndefined(d))&&(!(""==i.val()&&n.isNull(d))&&i.val()!==d)},this.validate=function(){if(t.column.validator){var e=t.column.validator(i.val());if(!e.valid)return e}return t.column.is_array&&!u(i.val())?{valid:!1,msg:(0,s.default)('Arrays must start with "{" and end with "}"')}:{valid:!0,msg:null}},this.init()},JsonText:function(l){var u,f,m,g,v,b,y=this,C=!1;this.init=function(){var t=e("body");f=a().appendTo(t),u=r().appendTo(f),(m=c(!0).appendTo(f)).find("button:first").on("click",this.cancel),m.find("button:last").on("click",this.save),u.on("keydown",this.handleKeyDown),y.position(l.position)},this.handleKeyDown=function(t){t.which==e.ui.keyCode.ENTER&&t.ctrlKey?y.save():t.which==e.ui.keyCode.ESCAPE&&(t.preventDefault(),y.cancel())},this.save=function(){l.commitChanges()},this.cancel=function(){l.cancelChanges()},this.hide=function(){f.hide()},this.show=function(){f.show()},this.position=function(e){h(e,f),e.top=Math.max(e.top,0),f.css("top",e.top).css("left",e.left)},this.destroy=function(){g.destroy(),f.remove()},this.focus=function(){g.focus()},this.loadValue=function(a){var r=v=a[l.column.field];if(b=r,"jsonb"!==l.column.column_type_internal||Array.isArray(r)||null==r){if(Array.isArray(r)){var c=[];e.each(r,(function(e,i){"object"===d(i)?c.push(t.stringify(i,null,2)):c.push(i)})),r="["+c.join()+"]"}}else r=t.stringify(t.parse(r),null,2);n.isNull(r)&&(v="",r=""),g?(g.setText(r),g.focus()):(C=!0,i.e(708).then(function(e){var t=i(13807),n=document.getElementById("pg-json-editor");(g=new t(n,{modes:["code","form","tree","preview"],onError:function(e){var t="Invalid Json: "+e.message.split(":")[0];o.default.error((0,s.default)(t))}})).setText(r),g.focus()}.bind(null,i)).catch((function(e){throw e})))},this.serializeValue=function(){if(C||i.e(708).then(function(e){var t=i(13807),n=document.getElementById("pg-json-editor");if(n){return(g=new t(n,{modes:["code","form","tree","preview"],onError:function(e){var t="Invalid Json: "+e.message.split(":")[0];o.default.error((0,s.default)(t))}})).setText(""),g.focus(),null}}.bind(null,i)).catch((function(e){throw e})),g){var e=g.getText();return""===e?null:e}return b},this.applyValue=function(e,t){"jsonb"===l.column.column_type_internal?p(l,e,t,"jsonb"):p(l,e,t,"text")},this.isValueChanged=function(){var e=g.getText();return(""!=e||!n.isUndefined(v)&&!n.isNull(v))&&("jsonb"!==l.column.column_type_internal||n.isUndefined(v)||""==v||(v=JSON.stringify(JSON.parse(v),null,2)),!(""==e&&n.isNull(v))&&e!=v)},this.validate=function(){if("jsonb"===l.column.column_type_internal||"json"===l.column.column_type_internal){var e=g.getText();try{""!=e&&JSON.parse(e)}catch(e){return u.addClass("pg-text-invalid"),{valid:!1,msg:e.message}}}return{valid:!0,msg:null}},this.init()},CustomNumber:function(t){var i,a;this.init=function(){(i=e("<input type=text class='editor-text' />")).on("keydown.nav",(function(t){t.keyCode!==e.ui.keyCode.LEFT&&t.keyCode!==e.ui.keyCode.RIGHT||t.stopImmediatePropagation()})),i.appendTo(t.container),i.trigger("focus").trigger("select")},this.destroy=function(){i.remove()},this.focus=function(){i.trigger("focus")},this.loadValue=function(e){a=e[t.column.field],!Array.isArray(a)||n.isNull(a)||n.isUndefined(a)?i.val(a):i.val("{"+a.join()+"}"),i[0].defaultValue=a,i.trigger("select")},this.serializeValue=function(){var e=i.val();return""===e?null:e},this.applyValue=function(e,i){p(t,e,i,"number")},this.isValueChanged=function(){return(""!=i.val()||!n.isUndefined(a))&&(""==i.val()&&""==a||!(""==i.val()&&n.isNull(a))&&i.val()!=a)},this.validate=function(){var e=i.val();if(!t.column.is_array&&isNaN(e))return{valid:!1,msg:(0,s.default)("Please enter a valid number")};if(t.column.validator){var n=t.column.validator(e);if(!n.valid)return n}if(t.column.is_array){if(!u(e))return{valid:!1,msg:(0,s.default)('Arrays must start with "{" and end with "}"')};var a,l=e.trim().slice(1,-1);for(var o in a=""==l?[]:l.split(","))if(isNaN(a[o]))return{valid:!1,msg:(0,s.default)("Please enter a valid number")}}return{valid:!0,msg:null}},this.init()},Checkbox:function(t){var i,a,l;this.init=function(){var n=this;(i=e("<div class='multi-checkbox' tabindex=\"0\"><span class='check' hideFocus></span></div>")).appendTo(t.container),i.trigger("focus"),i.on("click",this.changeValue),i.on("keydown",(function(t){t.which==e.ui.keyCode.SPACE&&(t.preventDefault(),n.changeValue(t))}))},this.changeValue=function(){var e=["unchecked","partial","checked"],t=i.find(".check").data("state")||0;t++,i.find(".check").removeClass("unchecked partial checked").addClass(e[t%e.length]).data("state",t%e.length)},this.destroy=function(){i.remove()},this.focus=function(){i.trigger("focus")},this.loadValue=function(e){a=e[t.column.field],l=1,n.isNull(a)||n.isUndefined(a)?i.find(".check").data("state",1).addClass("partial"):(a=!!e[t.column.field])?(i.find(".check").data("state",2).addClass("checked"),l=2):(i.find(".check").data("state",0).addClass("unchecked"),l=0)},this.serializeValue=function(){return 1==i.find(".check").data("state")?null:2==i.find(".check").data("state")},this.applyValue=function(e,i){e[t.column.field]=i},this.isValueChanged=function(){return i.find(".check").data("state")!==l},this.validate=function(){if(t.column.validator){var e=t.column.validator(this.serializeValue());if(!e.valid)return e}return{valid:!0,msg:null}},this.init()},ReadOnlyText:function(t){var i,n;this.init=function(){i=e("<input type=text class='editor-text' readonly/>").appendTo(t.container).on("keydown.nav",(function(t){t.keyCode!==e.ui.keyCode.LEFT&&t.keyCode!==e.ui.keyCode.RIGHT||t.stopImmediatePropagation()})).trigger("focus").trigger("select")},this.destroy=function(){i.remove()},this.focus=function(){i.trigger("focus")},this.getValue=function(){return i.val()},this.loadValue=function(e){var a=e[t.column.field];null==a&&(a=""),n=a,i.val(n),i[0].defaultValue=n,i.trigger("select")},this.serializeValue=function(){return i.val()},this.applyValue=function(e,i){e[t.column.field]=i},this.isValueChanged=function(){return!(""==i.val()&&null==n)&&i.val()!=n},this.validate=function(){if(t.column.validator){var e=t.column.validator(i.val());if(!e.valid)return e}return{valid:!0,msg:null}},this.init()},ReadOnlyCheckbox:function(t){var i,a;this.init=function(){(i=e("<input type=checkbox value='true' class='editor-checkbox' hideFocus disabled>")).appendTo(t.container),i.trigger("focus")},this.destroy=function(){i.remove()},this.focus=function(){i.trigger("focus")},this.loadValue=function(e){a=e[t.column.pos],n.isNull(a)||n.isUndefined(a)?(i.prop("indeterminate",!0),i.data("checked",2)):(a=!!e[t.column.pos])?(i.prop("checked",!0),i.data("checked",0)):(i.prop("checked",!1),i.data("checked",1))},this.serializeValue=function(){return i.prop("indeterminate")?null:i.prop("checked")},this.applyValue=function(e,i){e[t.column.pos]=i},this.isValueChanged=function(){var e=i.data("checked");return!(2===e&&(null==a||null==a))&&e!==a},this.validate=function(){return{valid:!0,msg:null}},this.init()},ReadOnlypgText:function(t){var i,n,s,o=this;this.init=function(){var s=e("body");n=a().appendTo(s),i=l().appendTo(n),c(!1).appendTo(n).find("button:first").on("click",this.cancel),i.on("keydown",this.handleKeyDown),o.position(t.position),i.trigger("focus").trigger("select")},this.handleKeyDown=function(i){i.which==e.ui.keyCode.ENTER&&i.ctrlKey?o.cancel():i.which==e.ui.keyCode.ESCAPE?(i.preventDefault(),o.cancel()):i.which==e.ui.keyCode.TAB&&i.shiftKey?(o.cancel(),i.preventDefault(),t.grid.navigatePrev()):i.which==e.ui.keyCode.TAB&&(o.cancel(),i.preventDefault(),t.grid.navigateNext())},this.cancel=function(){i.val(s),t.cancelChanges()},this.hide=function(){n.hide()},this.show=function(){n.show()},this.position=function(e){h(e,n),n.css("top",e.top).css("left",e.left)},this.destroy=function(){n.remove()},this.focus=function(){i.trigger("focus")},this.loadValue=function(e){i.val(s=e[t.column.field]),i.trigger("select")},this.serializeValue=function(){return i.val()},this.applyValue=function(e,i){e[t.column.field]=i},this.isValueChanged=function(){return!(""==i.val()&&null==s)&&i.val()!=s},this.validate=function(){if(t.column.validator){var e=t.column.validator(i.val());if(!e.valid)return e}return{valid:!0,msg:null}},this.init()},ReadOnlyJsonText:function(l){var s,o,u,p,f,m=this;this.init=function(){var t=e("body");o=a().appendTo(t),s=r().appendTo(o),c(!1).appendTo(o).find("button:first").on("click",this.cancel),s.on("keydown",this.handleKeyDown),m.position(l.position)},this.handleKeyDown=function(t){t.which==e.ui.keyCode.ENTER&&t.ctrlKey?m.cancel():t.which==e.ui.keyCode.ESCAPE&&(t.preventDefault(),m.cancel())},this.cancel=function(){s.val(p),l.cancelChanges()},this.hide=function(){o.hide()},this.show=function(){o.show()},this.position=function(e){h(e,o),e.top=Math.max(e.top,0),o.css("top",e.top).css("left",e.left)},this.destroy=function(){u.destroy(),o.remove()},this.focus=function(){u.focus()},this.loadValue=function(a){var s=p=a[l.column.field];if(f=s,"jsonb"!==l.column.column_type_internal||Array.isArray(s)||null==s){if(Array.isArray(s)){var o=[];e.each(s,(function(e,i){"object"===d(i)?o.push(t.stringify(i,null,2)):o.push(i)})),s="["+o.join()+"]"}}else s=t.stringify(t.parse(s),null,2);n.isNull(s)&&(p="",s=""),i.e(708).then(function(e){var t=i(13807),n=document.getElementById("pg-json-editor");n.setAttribute("readonly",!0);n&&(u=new t(n,{modes:["code","form","tree","preview"],onEditable:function(){return!1}})).setText(s)}.bind(null,i)).catch((function(e){throw e}))},this.serializeValue=function(){if(u){var e=u.getText();return""===e?null:e}return f},this.applyValue=function(e,t){e[l.column.field]=t},this.isValueChanged=function(){var e=u.getText();return!(""==e&&null==p)&&e!=p},this.validate=function(){if(l.column.validator){var e=l.column.validator(u.getText());if(!e.valid)return e}return{valid:!0,msg:null}},this.init()}}}})}(a,l.default)},27528:(e,t,i)=>{"use strict";var n=i(64492),a=i(19755);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}i(79753),i(69600),i(55674),i(82526),i(41817),i(41539),i(32165),i(66992),i(78783),i(33948),function(e){function t(e,t,i,a){return n.isUndefined(i)&&a.has_default_val?"<span class='pull-left disabled_cell'>[default]</span>":n.isUndefined(i)&&a.not_null||n.isUndefined(i)||null===i?"<span class='pull-left disabled_cell'>[null]</span>":null}e.extend(!0,window,{Slick:{Formatters:{JsonString:function(i,a,s,o){var r=t(i,a,s,o);if(r)return r;if("object"!==l(s)||Array.isArray(s)){if(Array.isArray(s)){var d=[];return e.each(s,(function(e,t){"object"===l(t)?d.push(JSON.stringify(t)):d.push(t)})),n.escape("["+d.join()+"]")}return n.escape(s)}return n.escape(JSON.stringify(s))},Numbers:function(e,t,i,a){var l=function(e,t,i,a){if(n.isUndefined(i)&&a.has_default_val)return"<span class='pull-right disabled_cell'>[default]</span>";if(n.isUndefined(i)&&a.not_null||n.isUndefined(i)||null===i)return"<span class='pull-right disabled_cell'>[null]</span>";return null}(0,0,i,a);return l||"<span style='float:right'>"+n.escape(i)+"</span>"},Checkmark:function(e,i,n,a){var l=t(e,i,n,a);return l||(n?"true":"false")},Text:function(e,i,a,l){var s,o=t(e,i,a,l);s=o||n.escape(a);s.trimStart()!=s&&(s="[...] "+s.trimStart());return s},Binary:function(e,i,a,l){var s=t(e,i,a,l);return s||"<span class='pull-left disabled_cell'>["+n.escape(a)+"]</span>"}}}})}(a)}}]);
//# sourceMappingURL=pgadmin_commons.js.map