define(["pgadmin.browser.constants","pgadmin.browser.endpoints","pgadmin.browser.messages","pgadmin.browser.utils","pgadmin.server.supported_servers","pgadmin.user_management.current_user","translations"],((e,t,n,a,i,r,o)=>(()=>{"use strict";var s,l,d={14511:(e,t,n)=>{var a,i;n(32564),n(82772),n(26699),n(32023),n(74916),n(15306),n(73210),n(71151),n(39538),n(90491),n(72126),n(5878),n(24482),n(11769),n(24149),n(9750),n(59719),n(96193),n(43e3),n(9822),n(10083),n(43311),n(47271),n(84835),n(65379),n(34175),n(65010),n(32032),n(8118),n(19101),n(2384),n(53394),n(44639),n(25142),n(83666),n(78924),n(54553),n(90580),n(46318),n(16119),n(48801),n(52629),n(33231),n(62984),n(89619),n(92545),n(81353),n(96311),n(65239),n(58837),n(48663),n(26456),n(18897),n(14496),n(23742),n(25365),n(43815),n(95941),n(69610),n(65228),n(78529),a=[n(91669),n(28008),n(19755),n(81311),n(55455),n(55112),n(20811),n(81240),n(72316),n(52934),n(7167),n(14953),n(9807),n(44092),n(35816)],void 0===(i=function(e,t,n,a,i,r,o,s,l,d,c,u,f,p){var h=window.wcDocker,_=r.Browser;return r.DataGrid||(r.DataGrid=a.extend({init:function(){if(!this.initialized){this.initialized=!0,this.title_index=1;var t=this,n=setInterval((function(){_.preference_version()>0&&(t.preferences=_.get_preferences_for_module("sqleditor"),clearInterval(n))}),0);_.onPreferencesChange("sqleditor",(function(){t.preferences=_.get_preferences_for_module("sqleditor")}));for(var i=["table","view","mview","foreign_table","catalog_object","partition"],o=function(t){var n=!a.isUndefined(t)&&!a.isNull(t)&&-1!==a.indexOf(i,t._type);return u.enable(e("View Data"),n),u.enable(e("Filtered Rows"),n),n},s=[{name:"query_tool",module:this,applies:["tools"],callback:"show_query_tool",enable:function(t){var n=!(a.isUndefined(t)||a.isNull(t)||-1!=a.indexOf(r.unsupported_nodes,t._type)||("database"!=t._type||!t.allowConn)&&"database"==t._type);return u.enable(e("Query Tool"),n),n},priority:1,label:e("Query Tool"),icon:"pg-font-icon icon-query_tool",data:{applies:"tools",data_disabled:e("Please select a database from the browser tree to access Query Tool.")}}],l=0;l<i.length;l++)s.push({name:"view_all_rows_context_"+i[l],node:i[l],module:this,data:{mnuid:3},applies:["context","object"],callback:"show_data_grid",enable:o,category:"view_data",priority:101,label:e("All Rows")},{name:"view_first_100_rows_context_"+i[l],node:i[l],module:this,data:{mnuid:1},applies:["context","object"],callback:"show_data_grid",enable:o,category:"view_data",priority:102,label:e("First 100 Rows")},{name:"view_last_100_rows_context_"+i[l],node:i[l],module:this,data:{mnuid:2},applies:["context","object"],callback:"show_data_grid",enable:o,category:"view_data",priority:103,label:e("Last 100 Rows")},{name:"view_filtered_rows_context_"+i[l],node:i[l],module:this,data:{mnuid:4},applies:["context","object"],callback:"show_filtered_row",enable:o,category:"view_data",priority:104,label:e("Filtered Rows...")});r.Browser.add_menu_category("view_data",e("View/Edit Data"),100,""),r.Browser.add_menus(s),new r.Browser.Frame({name:"frm_datagrid",showTitle:!0,isCloseable:!0,isRenamable:!0,isPrivate:!0,url:"about:blank"}).load(_.docker),this.on("pgadmin-datagrid:transaction:created",(function(e){this.launch_grid(e)}))}},show_data_grid:function(e,t){var n=p.getRandomInt(1,9999999);d.showDataGrid(this,_,i,e,t,n)},show_filtered_row:function(e,t){var n=p.getRandomInt(1,9999999);d.showDataGrid(this,_,i,e,t,n,!0,this.preferences)},show_query_tool:function(t,n){var a=p.getRandomInt(1,9999999),r=_.tree,o=n||r.selected(),s=o&&1==o.length?r.itemData(o):void 0;if(!_.get_preference("sqleditor","copy_sql_to_query_tool").value||s._type.includes("coll-")||""!==t&&"tools"!==t.applies)s._type.includes("coll-")&&(t=""),c.showQueryTool(this,_,i,t,n,a);else{var l={script:s._type.toLowerCase(),data_disabled:e("The selected tree node does not support this option.")};_.Node.callbacks.show_script(l)}},launch_grid:function(r,o,s,l){var u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,g=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,m='\n          <form id="queryToolForm" action="'.concat(o,'" method="post">\n            <input id="title" name="title" hidden />');u&&(m+='<input name="query_url" value="'.concat(u,'" hidden />')),g&&(m+='<textarea name="sql_filter" hidden>'.concat(g,"</textarea>")),m+='\n          </form>\n            <script>\n              document.getElementById("title").value = "'.concat(a.escape(l.replace("\\","\\\\")),'";\n              document.getElementById("queryToolForm").submit();\n            <\/script>\n          ');var b=_.get_preferences_for_module("browser"),v=b.new_browser_tab_open;if(v&&v.includes("qt")){var y=window.open("","_blank");if(!y)return!1;y.document.write(m),y.document.title=l,setTimeout((function(){_.send_signal_to_runtime("Runtime new window opened")}),500)}else{var w=_.docker.findPanels("properties"),x=_.docker.addPanel("frm_datagrid",h.DOCK.STACKED,w[0]);x.trans_id=r,c._set_dynamic_tab(_,b.dynamic_tabs),f.setQueryToolDockerTitle(x,s,a.unescape(l)),x.focus(),x.isVisible()&&x.on(h.EVENT.CLOSED,(function(){n.ajax({url:t("datagrid.close",{trans_id:r}),method:"DELETE"})})),x.on(h.EVENT.VISIBILITY_CHANGED,(function(){x.trigger(h.EVENT.RESIZED)})),p.registerDetachEvent(x),x.on(h.EVENT.RENAME,(function(t){var n=t.$titleText[0].textContent,r=!!x.is_dirty_editor&&x.is_dirty_editor,o=x.is_dirty_editor?t.$titleText[0].textContent.replace(/.$/,""):n;i.prompt("",o,(function(e,n){if(n=n.trim()){var i=!1;t.$titleText[0].innerHTML.includes("File - ")&&(i=!0);var o=_.treeMenu.selected(),l="";l=s?f.getPanelTitle(_,o,n):d.generateDatagridTitle(_,o,n),r&&(l+=" *"),f.setQueryToolDockerTitle(x,s,a.unescape(l),i)}}),(function(e){e.cancel=!1})).set({title:e("Rename Panel")})}));var C=function(e){var t=n('<div class="pg-sp-container">\n                    <div class="pg-sp-content">\n                        <div class="row">\n                            <div class="col-12 pg-sp-icon"></div>\n                        </div>\n                    </div>\n                </div>').appendTo(n(e).data("embeddedFrame").$container),a=setInterval((function(){if(n(e).data("frameInitialized")){clearInterval(a);var i=n(e).data("embeddedFrame");i&&(i.onLoaded((function(){t.remove()})),i.openHTML(m))}}),100)};C(x)}return!0}},l.Events)),r.DataGrid}.apply(t,a))||(e.exports=i)},53673:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.disableTriggers=function(e,t,n,a){return r(e,t,n,a,{is_enable_trigger:"D"})},t.enableTriggers=function(e,t,n,a){return r(e,t,n,a,{is_enable_trigger:"O"})};var a,i=(a=n(9669))&&a.__esModule?a:{default:a};function r(e,t,n,a,r){var o=function(e,t){var n=(e||{}).item||t.selected();return t.findNodeByDomElement(n)}(a,e);if(!o||null===o.getData()||void 0===o.getData())return!1;i.default.put(n(o.getHtmlIdentifier(),"set_trigger",o.getData(),!0),r).then((function(n){1===n.data.success&&(t.success(n.data.info),o.reload(e))})).catch((function(n){try{var a=n.response.data;0===a.success&&t.error(a.errormsg)}catch(e){console.warn(e.stack||e)}o.unload(e)}))}},48982:(e,t,n)=>{var a,i;n(32564),n(82772),n(21249),n(74916),n(23123),n(68309),n(15306),n(5212),n(57327),a=[n(91669),n(19755),n(81311),n(72316),n(58894),n(12030),n(71158),n(50159)],void 0===(i=function(e,t,n,a,i,r,o){o.PartitionRow=o.Row.extend({modelDuplicateClass:"bg-model-duplicate",initialize:function(){o.Row.prototype.initialize.apply(this,arguments);var e=this;e.model.on("change:is_attach",(function(){setTimeout((function(){e.columns.each((function(t){if("partition_name"==t.get("name")){var n=e.columns.indexOf(t),a=new(t.get("cellFunction").apply(t,[e.model]))({column:t,model:e.model});e.cells[n].remove(),e.cells[n]=a,e.render()}}))}),10)})),e.listenTo(e.model,"pgadmin-session:model:duplicate",e.modelDuplicate),e.listenTo(e.model,"pgadmin-session:model:unique",e.modelUnique)},modelDuplicate:function(){t(this.el).removeClass("new"),t(this.el).addClass(this.modelDuplicateClass)},modelUnique:function(){t(this.el).removeClass(this.modelDuplicateClass)}});r.PartitionKeyModel=i.Node.Model.extend({defaults:{key_type:"column",pt_column:void 0,expression:void 0},keys:["pt_column"],schema:[{id:"key_type",label:e("Key type"),type:"select2",editable:!0,cell:"select2",cellHeaderClasses:"width_percent_25",select2:{allowClear:!1},options:[{label:e("Column"),value:"column"},{label:e("Expression"),value:"expression"}]},{id:"pt_column",label:e("Column"),type:"text",cell:o.Extension.Select2DepCell.extend({keyPathAccessor:function(e,t){var a=e;if(n.isArray(a))return n.map(a,(function(e){return e.pt_column}));t=t.split(".");for(var i=0;i<t.length;i++){if(n.isNull(a))return null;n.isEmpty(t[i])||(n.isUndefined(a[t[i]])||(a=a[t[i]]))}return n.isObject(a)&&!n.isArray(a)?null:a},initialize:function(){var e=this;if(this.model.handler){if(o.Extension.Select2DepCell.prototype.initialize.apply(this,arguments),n.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.resetColOptions),e.listenTo(t,"change:name",e.resetColOptions)}e.custom_options()}},resetColOptions:function(){var e=this;setTimeout((function(){e.custom_options(),e.render.apply(e)}),50)},custom_options:function(){var e=this.model.top.get("columns"),t=this.model.top.get("typname"),a=this.model.top.of_types_tables,i=[];e.length>0?n.each(e.models,(function(e){var t=e.get("name");n.isUndefined(t)||n.isNull(t)||i.push({label:t,value:t,image:"icon-column"})})):!n.isUndefined(t)&&!n.isNull(t)&&!n.isUndefined(a)&&a.length>0&&n.each(a,(function(e){e.label==t&&n.each(e.oftype_columns,(function(e){i.push({label:e.name,value:e.name,image:"icon-column"})}))})),this.column.set("options",i)},remove:function(){if(this.model.handler){var e=this,t=e.model.top.get("columns");e.stopListening(t,"remove",e.resetColOptions),e.stopListening(t,"change:name",e.resetColOptions),o.Extension.Select2DepCell.prototype.remove.apply(this,arguments)}}}),deps:["key_type"],cellHeaderClasses:"width_percent_30",transform:function(e){var t=[];return e&&n.isArray(e)&&n.each(e,(function(e){t.push({label:e.label,value:e.label,image:"icon-column"})})),t},select2:{allowClear:!1},editable:function(e){return"expression"!=e.get("key_type")||(setTimeout((function(){e.set("pt_column",void 0)}),10),!1)}},{id:"expression",label:e("Expression"),type:"text",cell:o.Extension.StringDepCell,cellHeaderClasses:"width_percent_45",deps:["key_type"],editable:function(e){return"column"!=e.get("key_type")||(setTimeout((function(){e.set("expression",void 0)}),10),!1)}}],validate:function(){var t,a=this.get("key_type"),i=this.get("pt_column"),r=this.get("expression");return this.errorModel.clear(),n.isUndefined(a)||n.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")?(t=e("Partition key type cannot be empty."),this.errorModel.set("key_type",t),t):"column"==a&&n.isUndefined(i)||n.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")?(t=e("Partition key column cannot be empty."),this.errorModel.set("pt_column",t),t):"expression"==a&&n.isUndefined(r)||n.isNull(r)||""==String(r).replace(/^\s+|\s+$/g,"")?(t=e("Partition key expression cannot be empty."),this.errorModel.set("expression",t),t):null}}),r.PartitionsModel=i.Node.Model.extend({idAttribute:"oid",defaults:{oid:void 0,is_attach:!1,partition_name:void 0,is_default:void 0,values_from:void 0,values_to:void 0,values_in:void 0,values_modulus:void 0,values_remainder:void 0,is_sub_partitioned:!1,sub_partition_type:"range"},keys:["partition_name"],schema:[{id:"oid",label:e("OID"),type:"text",mode:["properties"]},{id:"is_attach",label:e("Operation"),cell:"switch",type:"switch",options:{onText:e("Attach"),offText:e("Create"),width:65},cellHeaderClasses:"width_percent_5",editable:function(e){return!(!(e instanceof a.Model&&e.isNew())||e.top.isNew())},disabled:function(e){return!(e instanceof a.Model&&e.isNew()&&!e.top.isNew())}},{id:"partition_name",label:e("Name"),type:"text",cell:"string",cellHeaderClasses:"width_percent_15",editable:function(e){return!!(e instanceof a.Model&&e.isNew())},cellFunction:function(e){if(e.get("is_attach")){var t=[];return e.set({partition_name:void 0},{silent:!0}),n.each(e.top.table_options,(function(e){t.push([e.label,e.value])})),o.Extension.Select2Cell.extend({optionValues:t})}return o.StringCell},disabled:function(e){return!(e instanceof a.Model&&e.isNew())}},{id:"is_default",label:e("Default"),type:"switch",cell:"switch",cellHeaderClasses:"width_percent_5",min_version:11e4,options:{onText:e("Yes"),offText:e("No")},editable:function(e){return!!(e.handler&&e.handler.top&&e.handler.top.attributes&&("range"===e.handler.top.attributes.partition_type||"list"===e.handler.top.attributes.partition_type)&&e instanceof a.Model&&e.isNew()&&e.handler.top.node_info.server.version>=11e4)},disabled:function(e){return!(e.handler&&e.handler.top&&e.handler.top.attributes&&("range"===e.handler.top.attributes.partition_type||"list"===e.handler.top.attributes.partition_type)&&e instanceof a.Model&&e.isNew()&&e.handler.top.node_info.server.version>=11e4)}},{id:"values_from",label:e("From"),type:"text",cell:o.Extension.StringDepCell,deps:["is_default"],cellHeaderClasses:"width_percent_15",editable:function(e){return!!(e.handler&&e.handler.top&&e.handler.top.attributes&&"range"===e.handler.top.attributes.partition_type&&e instanceof a.Model&&e.isNew()&&!0!==e.get("is_default"))},disabled:function(e){return!(e.handler&&e.handler.top&&e.handler.top.attributes&&"range"===e.handler.top.attributes.partition_type&&e instanceof a.Model&&e.isNew()&&!0!==e.get("is_default"))}},{id:"values_to",label:e("To"),type:"text",cell:o.Extension.StringDepCell,deps:["is_default"],cellHeaderClasses:"width_percent_15",editable:function(e){return!!(e.handler&&e.handler.top&&e.handler.top.attributes&&"range"===e.handler.top.attributes.partition_type&&e instanceof a.Model&&e.isNew()&&!0!==e.get("is_default"))},disabled:function(e){return!(e.handler&&e.handler.top&&e.handler.top.attributes&&"range"===e.handler.top.attributes.partition_type&&e instanceof a.Model&&e.isNew()&&!0!==e.get("is_default"))}},{id:"values_in",label:e("In"),type:"text",cell:o.Extension.StringDepCell,deps:["is_default"],cellHeaderClasses:"width_percent_15",editable:function(e){return!!(e.handler&&e.handler.top&&e.handler.top.attributes&&"list"===e.handler.top.attributes.partition_type&&e instanceof a.Model&&e.isNew()&&!0!==e.get("is_default"))},disabled:function(e){return!(e.handler&&e.handler.top&&e.handler.top.attributes&&"list"===e.handler.top.attributes.partition_type&&e instanceof a.Model&&e.isNew()&&!0!==e.get("is_default"))}},{id:"values_modulus",label:e("Modulus"),type:"int",cell:o.Extension.StringDepCell,cellHeaderClasses:"width_percent_15",editable:function(e){return!!(e.handler&&e.handler.top&&e.handler.top.attributes&&"hash"===e.handler.top.attributes.partition_type&&e instanceof a.Model&&e.isNew())},disabled:function(e){return!(e.handler&&e.handler.top&&e.handler.top.attributes&&"hash"===e.handler.top.attributes.partition_type&&e instanceof a.Model&&e.isNew())}},{id:"values_remainder",label:e("Remainder"),type:"int",cell:o.Extension.StringDepCell,cellHeaderClasses:"width_percent_15 width_percent_20",editable:function(e){return!!(e.handler&&e.handler.top&&e.handler.top.attributes&&"hash"===e.handler.top.attributes.partition_type&&e instanceof a.Model&&e.isNew())},disabled:function(e){return!(e.handler&&e.handler.top&&e.handler.top.attributes&&"hash"===e.handler.top.attributes.partition_type&&e instanceof a.Model&&e.isNew())}},{id:"is_sub_partitioned",label:e("Partitioned table?"),cell:"switch",group:"Partition",type:"switch",mode:["properties","create","edit"],deps:["is_attach"],disabled:function(e){return!e.isNew()||!!e.get("is_attach")&&(setTimeout((function(){e.set("is_sub_partitioned",!1)}),10),!0)}},{id:"sub_partition_type",label:e("Partition Type"),editable:!1,type:"select2",select2:{allowClear:!1},group:"Partition",deps:["is_sub_partitioned"],options:function(){var t=[{label:e("Range"),value:"range"},{label:e("List"),value:"list"}];return!n.isUndefined(this.node_info)&&!n.isUndefined(this.node_info.server)&&!n.isUndefined(this.node_info.server.version)&&this.node_info.server.version>=11e4&&t.push({label:e("Hash"),value:"hash"}),t},visible:function(e){return!!e.isNew()},disabled:function(e){return!e.isNew()||!e.get("is_sub_partitioned")}},{id:"sub_partition_keys",label:e("Partition Keys"),model:r.PartitionKeyModel,subnode:r.PartitionKeyModel,editable:!0,type:"collection",group:"Partition",mode:["properties","create","edit"],deps:["is_sub_partitioned","sub_partition_type"],canEdit:!1,canDelete:!0,control:"sub-node-collection",canAdd:function(e){return!(!e.isNew()||!e.get("is_sub_partitioned"))},canAddRow:function(e){var t=e.top.get("columns"),a=e.top.get("typname"),i=!1,r=1e3;return e.get("sub_partition_type")&&"list"==e.get("sub_partition_type")&&(r=1),t.length<=0&&!n.isUndefined(a)&&!n.isNull(a)&&e.of_types_tables.length>0?n.each(e.of_types_tables,(function(e){e.label==a&&e.oftype_columns.length>0&&(i=!0)})):t.length>0&&(i=n.some(t.pluck("name"))),e.get("sub_partition_keys")&&e.get("sub_partition_keys").length<r&&i},disabled:function(e){e.get("sub_partition_keys")&&e.get("sub_partition_keys").models.length>0&&setTimeout((function(){var t=e.get("sub_partition_keys");t.remove(t.filter((function(){return!0})))}),10)},visible:function(e){return!!e.isNew()}},{id:"sub_partition_scheme",label:e("Partition Scheme"),type:"note",group:"Partition",mode:["edit"],visible:function(e){return!e.isNew()&&!n.isUndefined(e.get("sub_partition_scheme"))&&""!=e.get("sub_partition_scheme")},disabled:function(e){e.isNew()||(this.text=e.get("sub_partition_scheme"))}}],validate:function(){var t,a=this.get("partition_name"),i=this.get("is_default"),r=this.get("values_from"),o=this.get("values_to"),s=this.get("values_in"),l=this.get("values_modulus"),d=this.get("values_remainder"),c=this.get("is_sub_partitioned"),u=this.get("sub_partition_keys");if(this.errorModel.clear(),this.top.errorModel.clear(),n.isUndefined(a)||n.isNull(a)||""===String(a).replace(/^\s+|\s+$/g,""))return t=e("Partition name cannot be empty."),this.errorModel.set("partition_name",t),t;if(c&&this.isNew()&&!n.isNull(u)&&u.length<=0)return t=e("Please specify at least one key for partitioned table."),this.top.errorModel.set("sub_partition_keys",t),t;if("range"===this.top.get("partition_type")){if(!0!==i&&(n.isUndefined(r)||n.isNull(r)||""===String(r).replace(/^\s+|\s+$/g,"")))return t=e("For range partition From field cannot be empty."),this.errorModel.set("values_from",t),t;if(!0!==i&&(n.isUndefined(o)||n.isNull(o)||""===String(o).replace(/^\s+|\s+$/g,"")))return t=e("For range partition To field cannot be empty."),this.errorModel.set("values_to",t),t}else if("list"===this.top.get("partition_type")){if(!0!==i&&(n.isUndefined(s)||n.isNull(s)||""===String(s).replace(/^\s+|\s+$/g,"")))return t=e("For list partition In field cannot be empty."),this.errorModel.set("values_in",t),t}else if("hash"===this.top.get("partition_type")){if(n.isUndefined(l)||n.isNull(l)||""===String(l).replace(/^\s+|\s+$/g,""))return t=e("For hash partition Modulus field cannot be empty."),this.errorModel.set("values_modulus",t),t;if(n.isUndefined(d)||n.isNull(d)||""===String(d).replace(/^\s+|\s+$/g,""))return t=e("For hash partition Remainder field cannot be empty."),this.errorModel.set("values_remainder",t),t}return null}})}.apply(t,a))||(e.exports=i)},92741:(e,t,n)=>{function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(66992),n(41539),n(78783),n(4129),n(33948),n(69070),n(38880),n(82526),n(41817),n(32165),Object.defineProperty(t,"__esModule",{value:!0}),t.show_advanced_tab=function(e){if(function(e){return!i.isUndefined(e.node_info)&&!i.isUndefined(e.node_info.server)&&"gpdb"===e.node_info.server.server_type}(e))return!1;return!0};var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var n=r(t);if(n&&n.has(e))return n.get(e);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var l=o?Object.getOwnPropertyDescriptor(e,s):null;l&&(l.get||l.set)?Object.defineProperty(i,s,l):i[s]=e[s]}i.default=e,n&&n.set(e,i);return i}(n(81311));function r(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(r=function(e){return e?n:t})(e)}},64532:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.pgBrowser=void 0,n(32564),n(89554);var a=l(n(19755)),i=l(n(81311)),r=l(n(55112)),o=l(n(1950)),s=n(44092);function l(e){return e&&e.__esModule?e:{default:e}}var d=r.default.Browser=r.default.Browser||{};t.pgBrowser=d;i.default.extend(d,{inactivity_timeout_at:null,logging_activity:!1,inactivity_timeout_daemon_running:!1,is_pgadmin_timedout:function(){return!o.default.pgAdmin},is_inactivity_timeout:function(){return o.default.pgAdmin.Browser.inactivity_timeout_at<this.get_epoch_now()},get_epoch_now:function(){return(0,s.getEpoch)()},log_activity:function(){var e=this;this.logging_activity||(this.logging_activity=!0,this.inactivity_timeout_at=this.get_epoch_now()+r.default.user_inactivity_timeout,setTimeout((function(){e.logging_activity=!1}),1e3))},register_to_activity_listener:function(e,t){var n=["mousemove","mousedown","keydown"],a=this;n.forEach((function(i){e.addEventListener(i,(function i(){a.is_pgadmin_timedout()?(n.forEach((function(t){e.removeEventListener(t,i,!0)})),t()):o.default.pgAdmin.Browser.log_activity()}),!0)}))},override_activity_event_decorator:function(e){return function(){return r.default.override_user_inactivity_timeout&&o.default.pgAdmin.Browser.log_activity(),e.apply(this,arguments)}},logout_inactivity_user:function(){i.default.isUndefined(d.utils)||i.default.isUndefined(d.utils.logout_url)||(window.location.href=d.utils.logout_url)},start_inactivity_timeout_daemon:function(){var e=this;if(r.default.user_inactivity_timeout>0&&!e.inactivity_timeout_daemon_running)var t=setInterval((function(){e.inactivity_timeout_daemon_running=!0,e.is_inactivity_timeout()&&(clearInterval(t),e.inactivity_timeout_daemon_running=!1,(0,a.default)(window).off("beforeunload"),e.logout_inactivity_user())}),1e3)}})},37294:(e,t,n)=>{function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(66992),n(41539),n(78783),n(4129),n(33948),n(69070),n(38880),n(82526),n(41817),n(32165),n(24812),n(32564),n(69826);var i=h(n(81311)),r=h(n(55112)),o=h(n(19755)),s=h(n(42441)),l=p(n(44092)),d=h(n(89087)),c=p(n(72945)),u=h(n(1950));function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}function p(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}return i.default=e,n&&n.set(e,i),i}function h(e){return e&&e.__esModule?e:{default:e}}var _=r.default.Browser=r.default.Browser||{};_.keyboardNavigation=_.keyboardNavigation||{},i.default.extend(_.keyboardNavigation,{init:function(){s.default.reset(),_.preferences_cache.length>0&&(this.keyboardShortcut={file_shortcut:l.parseShortcutValue(_.get_preference("browser","main_menu_file").value),object_shortcut:l.parseShortcutValue(_.get_preference("browser","main_menu_object").value),tools_shortcut:l.parseShortcutValue(_.get_preference("browser","main_menu_tools").value),help_shortcut:l.parseShortcutValue(_.get_preference("browser","main_menu_help").value),left_tree_shortcut:l.parseShortcutValue(_.get_preference("browser","browser_tree").value),tabbed_panel_backward:l.parseShortcutValue(_.get_preference("browser","tabbed_panel_backward").value),tabbed_panel_forward:l.parseShortcutValue(_.get_preference("browser","tabbed_panel_forward").value),sub_menu_query_tool:l.parseShortcutValue(_.get_preference("browser","sub_menu_query_tool").value),sub_menu_view_data:l.parseShortcutValue(_.get_preference("browser","sub_menu_view_data").value),sub_menu_search_objects:l.parseShortcutValue(_.get_preference("browser","sub_menu_search_objects").value),sub_menu_properties:l.parseShortcutValue(_.get_preference("browser","sub_menu_properties").value),sub_menu_create:l.parseShortcutValue(_.get_preference("browser","sub_menu_create").value),sub_menu_delete:l.parseShortcutValue(_.get_preference("browser","sub_menu_delete").value),sub_menu_refresh:l.parseShortcutValue(_.get_preference("browser","sub_menu_refresh").value),context_menu:l.parseShortcutValue(_.get_preference("browser","context_menu").value),direct_debugging:l.parseShortcutValue(_.get_preference("browser","direct_debugging").value),drop_multiple_objects:l.parseShortcutValue(_.get_preference("browser","grid_menu_drop_multiple").value),drop_cascade_multiple_objects:l.parseShortcutValue(_.get_preference("browser","grid_menu_drop_cascade_multiple").value),add_grid_row:l.parseShortcutValue(_.get_preference("browser","add_grid_row").value),open_quick_search:l.parseShortcutValue(_.get_preference("browser","open_quick_search").value)},this.shortcutMethods={bindMainMenu:{shortcuts:[this.keyboardShortcut.file_shortcut,this.keyboardShortcut.object_shortcut,this.keyboardShortcut.tools_shortcut,this.keyboardShortcut.help_shortcut]},bindRightPanel:{shortcuts:[this.keyboardShortcut.tabbed_panel_backward,this.keyboardShortcut.tabbed_panel_forward]},bindLeftTree:{shortcuts:this.keyboardShortcut.left_tree_shortcut},bindSubMenuQueryTool:{shortcuts:this.keyboardShortcut.sub_menu_query_tool},bindSubMenuViewData:{shortcuts:this.keyboardShortcut.sub_menu_view_data},bindSubMenuSearchObjects:{shortcuts:this.keyboardShortcut.sub_menu_search_objects},bindSubMenuProperties:{shortcuts:this.keyboardShortcut.sub_menu_properties},bindSubMenuCreate:{shortcuts:this.keyboardShortcut.sub_menu_create},bindSubMenuDelete:{shortcuts:this.keyboardShortcut.sub_menu_delete},bindSubMenuRefresh:{shortcuts:this.keyboardShortcut.sub_menu_refresh,bindElem:"#tree"},bindContextMenu:{shortcuts:this.keyboardShortcut.context_menu},bindDirectDebugging:{shortcuts:this.keyboardShortcut.direct_debugging},bindDropMultipleObjects:{shortcuts:this.keyboardShortcut.drop_multiple_objects},bindDropCascadeMultipleObjects:{shortcuts:this.keyboardShortcut.drop_cascade_multiple_objects},bindAddGridRow:{shortcuts:this.keyboardShortcut.add_grid_row},bindOpenQuickSearch:{shortcuts:this.keyboardShortcut.open_quick_search}},this.bindShortcuts())},bindShortcuts:function(){var e=this;i.default.each(e.shortcutMethods,(function(t,n){e._bindWithMousetrap(t.shortcuts,e[n],t.bindElem)}));(0,o.default)(".pg-navbar").on("keydown",(function(t){switch(t.keyCode){case 37:e.bindMainMenuLeft(t);break;case 38:e.bindMainMenuUpDown(t,"up");break;case 39:e.bindMainMenuRight(t);break;case 40:e.bindMainMenuUpDown(t,"down")}}))},_bindWithMousetrap:function(e,t,n){var a=this;if(s.default.unbind(e),n){var i=document.querySelector(n);(0,s.default)(i).bind(e,function(){t.apply(this,arguments)}.bind(i))}else s.default.bind(e,(function(){t.apply(a,arguments)}))},unbindShortcuts:function(){i.default.each(this.mousetrapInstances,(function(e){e.instance.reset()})),this.mousetrapInstances=[]},bindMainMenu:function(e,t){var n=this.keyboardShortcut;t===n.file_shortcut&&(0,o.default)("#mnu_file a.dropdown-toggle").dropdown("toggle"),t===n.object_shortcut&&(0,o.default)("#mnu_obj a.dropdown-toggle").first().dropdown("toggle"),t===n.tools_shortcut&&(0,o.default)("#mnu_tools a.dropdown-toggle").dropdown("toggle"),t===n.help_shortcut&&(0,o.default)("#mnu_help a.dropdown-toggle").dropdown("toggle")},bindRightPanel:function(e,t){var n=0,a=r.default.Browser.docker.findPanels().length-1,o=0,s=!1,l=this.keyboardShortcut;i.default.each(r.default.Browser.docker.findPanels(),(function(e,t){e.isVisible()&&!s&&"browser"!==e._type&&(o=t,s=!0)})),t===l.tabbed_panel_backward?n=o>0?o-1:1:t===l.tabbed_panel_forward&&(n=o<a?o+1:a),r.default.Browser.docker.findPanels()[n].focus(),setTimeout((function(){document.activeElement instanceof HTMLIFrameElement&&document.activeElement.blur()}),1e3)},bindMainMenuLeft:function(e){if((0,o.default)(e.target).hasClass("nav-link")){var t=(0,o.default)(e.target).closest(".nav-item");for(c._stopEventPropagation(e),t=t.prev(".nav-item");t.hasClass("d-none");)t=t.prev(".nav-item");t.find(".dropdown-toggle").first().dropdown("toggle")}else if((0,o.default)(e.target).closest(".dropdown-menu").length>0){var n=(0,o.default)(e.target).closest("li");c._stopEventPropagation(e);var a=n.closest(".dropdown-menu");a.closest(".dropdown-submenu").length>0&&(a.removeClass("show"),a.closest(".dropdown-submenu").removeClass("dropdown-submenu-visible"),(n=a.closest(".dropdown-submenu")).find(".dropdown-item").trigger("focus"))}},bindMainMenuRight:function(e){if((0,o.default)(e.target).hasClass("nav-link")){var t=(0,o.default)(e.target).closest(".nav-item");for(c._stopEventPropagation(e),t=t.next(".nav-item");t.hasClass("d-none");)t=t.next(".nav-item");t.find(".dropdown-toggle").first().dropdown("toggle")}else if((0,o.default)(e.target).closest(".dropdown-menu").length>0){var n=(0,o.default)(e.target).closest("li");c._stopEventPropagation(e),n.hasClass("dropdown-submenu")&&(n.addClass("dropdown-submenu-visible"),n.find(".dropdown-menu").addClass("show"),n.find(".dropdown-menu .dropdown-item").first().trigger("focus"))}},bindMainMenuUpDown:function(e,t){if((0,o.default)(e.target).closest(".dropdown-menu").length>0){c._stopEventPropagation(e);var n=(0,o.default)(e.target).closest("li"),a=(0,o.default)(e.target).closest(".dropdown-menu");for(a.find(".show").removeClass("show"),a.find(".dropdown-submenu").removeClass("dropdown-submenu-visible"),"up"===t?n=n.prev():"down"===t&&(n=n.next());n.hasClass("dropdown-divider")||n.find(".dropdown-item").first().hasClass("disabled");)"up"===t?n=n.prev():"down"===t&&(n=n.next());n.find(".dropdown-item").trigger("focus")}},bindLeftTree:function(){var e=this.getTreeDetails();(0,o.default)("#tree").trigger("focus"),e.t.focus(e.i),e.t.select(e.i)},bindSubMenuQueryTool:function(){var e=this.getTreeDetails();e.d&&r.default.DataGrid.show_query_tool("",e.i)},bindSubMenuViewData:function(){var e=this.getTreeDetails();e.d&&r.default.DataGrid.show_data_grid({mnuid:1},e.i)},bindSubMenuSearchObjects:function(){var e=this.getTreeDetails();e.d&&r.default.SearchObjects.show_search_objects("",e.i)},bindSubMenuProperties:function(){var e=this.getTreeDetails();e.d&&!0!==r.default.Browser.Nodes[e.t.itemData(e.i)._type].collection_node&&r.default.Browser.Node.callbacks.show_obj_properties.call(r.default.Browser.Nodes[e.t.itemData(e.i)._type],{action:"edit"})},bindSubMenuCreate:function(){var e=this.getTreeDetails(),t=r.default.Browser.Nodes[e.t.itemData(e.i)._type];if(e.d){if(!0===t.collection_node){if(!t.node)return;t=r.default.Browser.Nodes[t.node]}r.default.Browser.Node.callbacks.show_obj_properties.call(t,{action:"create",item:e.i})}},bindSubMenuDelete:function(){var e=this.getTreeDetails();e.d&&!0!==r.default.Browser.Nodes[e.t.itemData(e.i)._type].collection_node&&r.default.Browser.Node.callbacks.delete_obj.call(r.default.Browser.Nodes[e.t.itemData(e.i)._type])},bindSubMenuRefresh:function(e){e.preventDefault();var t=_.keyboardNavigation.getTreeDetails();r.default.Browser.Node.callbacks.refresh.call(r.default.Browser.Nodes[t.t.itemData(t.i)._type])},bindContextMenu:function(e){var t=this.getTreeDetails(),n=e.srcElement||e.target,a=(0,o.default)(n).find(".aciTreeEntry").position().left+70,i=(0,o.default)(n).find(".aciTreeEntry").position().top+70;t.t.blur(t.i),(0,o.default)("#tree").trigger("blur"),t.i.children().contextMenu({x:a,y:i})},bindDirectDebugging:function(){var e=this.getTreeDetails(),t=e.t.itemData(e.i)._type;!e.d||"function"!==t&&"procedure"!==t||r.default.Tools.Debugger.can_debug(e.d,e.i,{debug_type:"direct"})&&r.default.Tools.Debugger.get_function_information(r.default.Browser.Nodes[t])},bindDropMultipleObjects:function(){!0===this.isPropertyPanelVisible()&&(0,o.default)("button.delete_multiple").length>0&&(0,o.default)("button.delete_multiple").click()},bindDropCascadeMultipleObjects:function(){!0===this.isPropertyPanelVisible()&&(0,o.default)("button.delete_multiple_cascade").length>0&&(0,o.default)("button.delete_multiple_cascade").click()},bindAddGridRow:function(){var e=(0,o.default)(document.activeElement).closest(".object.subnode");(0,o.default)(e).length&&(0,o.default)(e).find(".add").click()},isPropertyPanelVisible:function(){var e=!1;return i.default.each(r.default.Browser.docker.findPanels(),(function(t){"properties"===t._type&&(e=t.isVisible())})),e},getTreeDetails:function(){var e=r.default.Browser.tree,t=e.selected().length>0?e.selected():e.first(),n=t&&1===t.length?e.itemData(t):void 0;return{t:e,i:t,d:n}},getDialogTabNavigator:function(e){var t=u.default.pgAdmin.Browser.get_preference("browser","dialog_tab_backward").value,n=u.default.pgAdmin.Browser.get_preference("browser","dialog_tab_forward").value;return new d.default.dialogTabNavigator(e,t,n)},bindOpenQuickSearch:function(){(0,o.default)("#search_icon").trigger("click")}}),e.exports=r.default.Browser.keyboardNavigation},59434:(e,t,n)=>{var a=n(64492);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(66992),n(41539),n(78783),n(4129),n(33948),n(69070),n(38880),n(82526),n(41817),n(32165),Object.defineProperty(t,"__esModule",{value:!0}),t.pgBrowser=void 0,n(32564),n(68309);var r=f(n(55112)),o=f(n(28008)),s=f(n(19755)),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(a,o,s):a[o]=e[o]}a.default=e,n&&n.set(e,a);return a}(n(55455)),d=f(n(91669));n(35816);var c=f(n(1950));function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}function f(e){return e&&e.__esModule?e:{default:e}}var p=r.default.Browser=r.default.Browser||{};t.pgBrowser=p;var h=window.wcDocker;a.extend(p,{lock_layout_levels:{PREVENT_DOCKING:"docking",FULL:"full",NONE:"none"},buildDefaultLayout:function(e){var t=e.addPanel("browser",h.DOCK.LEFT),n=e.addPanel("dashboard",h.DOCK.RIGHT,t);e.addPanel("properties",h.DOCK.STACKED,n,{tabOrientation:h.TAB.TOP}),e.addPanel("sql",h.DOCK.STACKED,n),e.addPanel("statistics",h.DOCK.STACKED,n),e.addPanel("dependencies",h.DOCK.STACKED,n),e.addPanel("dependents",h.DOCK.STACKED,n)},save_current_layout:function(e,t){if(t){var n={setting:e,value:t.save()};s.default.ajax({type:"POST",url:(0,o.default)("settings.store_bulk"),data:n})}},restore_layout:function(e,t,n){if(""!=t)try{e.restore(t)}catch(t){e.clear(),n&&n(e)}else n&&n(e);var a=c.default.pgAdmin.Browser,i=setInterval((function(){a.get_preferences_for_module("browser")&&(clearInterval(i),a.reflectLocklayoutChange(e),a.onPreferencesChange("browser",(function(){a.reflectLocklayoutChange(e)})))}),500)},reflectLocklayoutChange:function(e){var t=c.default.pgAdmin.Browser,n=t.get_preferences_for_module("browser");t.lock_layout(e,n.lock_layout)},lock_layout:function(e,t){var n=this.menus.file.mnu_locklayout.menu_items;switch(t){case this.lock_layout_levels.PREVENT_DOCKING:e.lockLayout(h.LOCK_LAYOUT_LEVEL.PREVENT_DOCKING);break;case this.lock_layout_levels.FULL:e.lockLayout(h.LOCK_LAYOUT_LEVEL.FULL);break;case this.lock_layout_levels.NONE:e.lockLayout(h.LOCK_LAYOUT_LEVEL.NONE)}a.each(n,(function(e){e.name!="mnu_lock_"+t?e.change_checked(!1):e.change_checked(!0)}))},save_lock_layout:function(e){var t=c.default.pgAdmin.Browser;s.default.ajax({url:(0,o.default)("browser.lock_layout"),method:"PUT",contentType:"application/json",data:JSON.stringify({value:e})}).done((function(){t.cache_preferences("browser")})).fail((function(e,t){l.pgNotifier(t,e,(0,d.default)("Failed to save the lock layout setting."))}))},mnu_lock_docking:function(){this.lock_layout(this.docker,this.lock_layout_levels.PREVENT_DOCKING),this.save_lock_layout(this.lock_layout_levels.PREVENT_DOCKING)},mnu_lock_full:function(){this.lock_layout(this.docker,this.lock_layout_levels.FULL),this.save_lock_layout(this.lock_layout_levels.FULL)},mnu_lock_none:function(){this.lock_layout(this.docker,this.lock_layout_levels.NONE),this.save_lock_layout(this.lock_layout_levels.NONE)}})},33240:(e,t,n)=>{var a=n(64492);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(66992),n(41539),n(78783),n(4129),n(33948),n(69070),n(38880),n(82526),n(41817),n(32165),Object.defineProperty(t,"__esModule",{value:!0}),t.pgBrowser=void 0,n(83710),n(68309),n(47941),n(32564);var r=p(n(55112)),o=p(n(28008)),s=p(n(19755)),l=f(n(55455)),d=f(n(81240)),c=p(n(1950));function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}function f(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(a,o,s):a[o]=e[o]}return a.default=e,n&&n.set(e,a),a}function p(e){return e&&e.__esModule?e:{default:e}}var h=n(23602),_=r.default.Browser=r.default.Browser||{};t.pgBrowser=_,a.extend(_,{preferences_cache:[],prefcache_version:0,generate_preference_version:function(){return(new Date).getTime()},preference_version:function(e){if(!e)return this.prefcache_version;this.prefcache_version=e},get_preference:function(e,t){return a.findWhere(this.preferences_cache,{module:e,name:t})},get_preferences_for_module:function(e){var t={};if(a.each(a.where(this.preferences_cache,{module:e}),(function(e){t[e.name]=e.value})),Object.keys(t).length>0)return t},get_preference_for_id:function(e){return a.findWhere(this.preferences_cache,{id:e})},cache_preferences:function(e){var t=this,n={};n[r.default.csrf_token_header]=r.default.csrf_token,setTimeout((function(){s.default.ajax({url:(0,o.default)("preferences.get_all"),headers:n}).done((function(n){t.preferences_cache=n,t.preference_version(t.generate_preference_version()),_.keyboardNavigation.init(),_.tree&&(h.modifyAcitreeAnimation(t),h.modifyAlertifyAnimation(t)),_.browserTreeState.init(),e&&("string"==typeof e?s.default.event.trigger("prefchange:"+e):a.each(e,(function(e,t){s.default.event.trigger("prefchange:"+t)})))})).fail((function(e,t,n){l.pgRespErrorNotify(e,n)}))}),500)},reflectPreferences:function(e){var t=this;if("sqleditor"===e||null==e){var n=t.get_preferences_for_module("sqleditor");(0,s.default)(t.editor.getWrapperElement()).css("font-size",d.calcFontSize(n.sql_font_size)),t.editor.setOption("tabSize",n.tab_size),t.editor.setOption("lineWrapping",n.wrap_code),t.editor.setOption("autoCloseBrackets",n.insert_pair_brackets),t.editor.setOption("matchBrackets",n.brace_matching),t.editor.refresh()}},onPreferencesChange:function(e,t){(0,s.default)(c.default).on("prefchange:"+e,(function(e){t(e)}))}})},39538:(e,t,n)=>{n(32564);var a=o(n(67294)),i=o(n(73935)),r=n(58069);function o(e){return e&&e.__esModule?e:{default:e}}var s=function(e,t){console.warn("URL = "+e),console.warn(t)};setTimeout((function(){document.getElementById("quick-search-component")&&i.default.render(a.default.createElement(r.Search,{onResult:s}),document.getElementById("quick-search-component"))}),500)},27331:(e,t,n)=>{function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(12419),n(78011),n(69070),n(66992),n(41539),n(78783),n(4129),n(33948),n(38880),n(82526),n(41817),n(32165),Object.defineProperty(t,"__esModule",{value:!0}),t.Iframe=void 0,n(68304),n(30489);var i,r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var l=r?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(i,o,l):i[o]=e[o]}i.default=e,n&&n.set(e,i);return i}(n(67294)),o=(i=n(45697))&&i.__esModule?i:{default:i};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p(e);if(t){var i=p(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return f(this,n)}}function f(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(s,e);var t,n,a,i=u(s);function s(){return l(this,s),i.apply(this,arguments)}return t=s,a=[{key:"propTypes",get:function(){return{id:o.default.string.isRequired,srcURL:o.default.string.isRequired,onLoad:o.default.func.isRequired}}}],(n=[{key:"render",value:function(){var e=this.props,t=e.id,n=e.srcURL,a=e.onLoad;return r.default.createElement("iframe",{id:t,src:n,onLoad:a,width:"20",height:"20",style:{border:"0",display:"block",position:"absolute",opacity:"0"}})}}])&&d(t.prototype,n),a&&d(t,a),s}(r.Component);t.Iframe=h},95778:(e,t,n)=>{n(69070),n(47941),n(82526),n(57327),n(38880),n(49337),n(33321),Object.defineProperty(t,"__esModule",{value:!0}),t.menuSearch=function(e,t){var n;e=e.trim();var a=t.setState,r=[];window.pgAdmin.Browser.utils.app_name&&(n=(0,i.default)("About "+window.pgAdmin.Browser.utils.app_name));var s=function(t,i){Array.from(t.children).forEach((function(t){var s,c;"UL"==t.tagName?(s=l(t),c="".concat(i,"/").concat(s),d(t,c)):"LI"==t.tagName&&(t.classList.contains("dropdown-submenu")?(s=l(t),c="".concat(i,"/").concat(s),d(t,c)):function(t,i){var s=l(t);if(s&&-1!=s.toLowerCase().indexOf(e.toLowerCase())){var d={};d[s]=i,d.element=t.children[0],r.push(d)}s===n&&a((function(e){return o(o({},e),{},{fetched:!0,data:r})}))}(t,i))}))},d=function(e,t){Array.from(e.children).forEach((function(e){"UL"==e.tagName&&s(e,t)}))},c=document.querySelector(".navbar-nav");Array.from(c.children).forEach((function(e){d(e,l(e))}))},n(73210),n(74916),n(15306),n(82772),n(91038),n(78783),n(89554),n(54747),n(92222);var a,i=(a=n(91669))&&a.__esModule?a:{default:a};function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(e){var t,n=e.getElementsByTagName("a");return n.length>0&&(t=(t=n[0].text.trim()).replace(/\.+$/g,"")),t}},9129:(e,t,n)=>{n(69070),n(47941),n(82526),n(57327),n(38880),n(89554),n(54747),n(49337),n(33321),Object.defineProperty(t,"__esModule",{value:!0}),t.onlineHelpSearch=function(e,t){e=e.split(" ").join("+");var n=t.setState,s=(0,o.default)("help.static",{filename:"search.html"}),l="".concat(s,"?q=").concat(e),c=!1;document.getElementById("hidden-quick-search-iframe")&&document.getElementById("hidden-quick-search-iframe").contentDocument.location.reload(!0);i.default.render(a.default.createElement(r.Iframe,{id:"hidden-quick-search-iframe",srcURL:l,onLoad:function(){if(c)return!1;c=!0;var e=document.getElementById("hidden-quick-search-iframe"),t=(e.contentWindow||e.contentDocument).document;window.pooling=setInterval((function(){var e=t.getElementById("search-results"),a=e.getElementsByTagName("h2"),r=e&&e.getElementsByTagName("LI"),s=window.pooling;if(r&&r.length>0){var u=function(e){for(var t={},n=0;n<e.length;n++){var a=e[n].getElementsByTagName("A");if(0==a.length)break;var i=a[0].text,r=(0,o.default)("help.static",{filename:a[0].getAttribute("href")});t[i]=r}return t}(r);"Searching"!=a[0].childNodes[0].textContent?(window.clearInterval(s),n((function(e){return d(d({},e),{},{fetched:!0,clearedPooling:!0,url:l,data:u})})),c=!1,i.default.unmountComponentAtNode(document.getElementById("quick-search-iframe-container"))):n((function(e){return d(d({},e),{},{fetched:!0,clearedPooling:!1,url:l,data:u})}))}else"Search Results"==a[0].childNodes[0].textContent&&(n((function(e){return d(d({},e),{},{fetched:!0,clearedPooling:!0,url:l,data:{}})})),i.default.unmountComponentAtNode(document.getElementById("quick-search-iframe-container")),c=!1,window.clearInterval(s))}),500)}}),document.getElementById("quick-search-iframe-container"))},n(69600),n(74916),n(23123),n(92222),n(32564);var a=s(n(67294)),i=s(n(73935)),r=n(27331),o=s(n(28008));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},58069:(e,t,n)=>{n(82526),n(41817),n(41539),n(32165),n(66992),n(78783),n(33948),n(47042),n(68309),n(91038),n(69070),n(57327),n(38880),n(49337),n(33321),n(4129),Object.defineProperty(t,"__esModule",{value:!0}),t.Search=function(){var e=(0,a.useRef)(null),t=_((0,a.useState)(""),2),n=t[0],d=t[1],c=_((0,a.useState)(!1),2),f=c[0],h=c[1],g=_((0,a.useState)(!1),2),m=g[0],b=g[1],v=_((0,a.useState)(!1),2),y=v[0],w=v[1],x=_((0,a.useState)({fetched:!1,data:[]}),2),C=x[0],S=x[1],k=_((0,a.useState)({fetched:!1,clearedPooling:!0,url:"",data:[]}),2),E=k[0],T=k[1],O=_((0,a.useState)(!1),2),P=O[0],q=O[1],D=function(){S((function(e){return p(p({},e),{},{fetched:!1,data:[]})})),T((function(e){return p(p({},e),{},{fetched:!1,clearedPooling:!0,url:"",data:{}})}))};(0,a.useEffect)((function(){1==C.fetched&&b(!1),1==E.fetched&&w(!1)}),[C,E]);(0,i.useDelayDebounce)((function(e){b(!0),w(!0),(0,r.onlineHelpSearch)(e,{state:E,setState:T}),(0,o.menuSearch)(e,{state:C,setState:S})}),n,1e3);var N=function(){var e=window.pooling;e&&window.clearInterval(e),document.getElementsByClassName("live-search-field")[0].value="",setTimeout((function(){document.getElementById("live-search-field").focus()}),100),D(),q(!P),b(!1),w(!1),h(!1)},j=function(e){if(e){for(var t=e.split("/"),n=[],i=0;i<t.length;i++)i==t.length-1?n.push(t[i]):n.push(a.default.createElement("span",{key:"menu-span-sub"+i}," ",t[i]," ",a.default.createElement("i",{className:"fa fa-angle-right","aria-hidden":"true"})," "));return n}};return function(e){(0,a.useEffect)((function(){function t(t){if(!e.current||e.current.contains(t.target));else{var n=document.getElementById("live-search-field");if(null==n)return;var a=n.value;a&&a.length>0&&N()}}return document.addEventListener("mousedown",t),function(){document.removeEventListener("mousedown",t)}}),[e])}(e),a.default.createElement("ul",{id:"quick-search-container",ref:e,className:"test",role:"menu"},a.default.createElement("li",null,a.default.createElement("ul",{id:"myDropdown"},a.default.createElement("li",{className:"dropdown-item-input"},a.default.createElement("input",{tabIndex:"0",autoFocus:!0,type:"text",autoComplete:"off",className:"form-control live-search-field","aria-label":"live-search-field",id:"live-search-field",placeholder:(0,l.default)("Quick Search"),onChange:function(e){!function(e){var t=window.pooling;t&&window.clearInterval(t);D(),d(""),e.length>=3?(d(e),b(!0),w(!0),h(!1)):(b(!1),w(!1));e.length<3&&e.length>0&&h(!0);0==e.length&&h(!1)}(e.target.value)}})),a.default.createElement("div",{style:{marginBottom:0}},a.default.createElement("div",null,f?a.default.createElement("div",{className:"pad-12 no-results"},a.default.createElement("span",{className:"fa fa-info-circle"}),"Please enter minimum 3 characters to search"):"",a.default.createElement("div",null,1==C.fetched&&0==m?a.default.createElement("div",null,a.default.createElement("div",{className:"menu-groups"},a.default.createElement("span",{className:"fa fa-window-maximize"})," ",(0,l.default)("MENU ITEMS")," (",C.data.length,")"),function(e){if(e.length>0){var t=function(){for(var t=[],n=function(n){Object.keys(e[n]).forEach((function(i){"element"!=i&&"No object selected"!=i&&t.push(a.default.createElement("li",{key:"li-menu-"+n},a.default.createElement("a",{tabIndex:"0",id:"li-menu-"+n,href:"#",className:1==e[n].element.classList.contains("disabled")?"dropdown-item menu-groups-a disabled":"dropdown-item menu-groups-a",key:"menu-"+n,onClick:function(){e[n].element.click(),N()}},i,a.default.createElement("span",{key:"menu-span-"+n},j(e[n][i]))),1==e[n].element.classList.contains("disabled")&&null!=e[n].element.getAttribute("data-disabled")?a.default.createElement("i",{className:"fa fa-info-circle quick-search-tooltip","data-toggle":"tooltip",title:e[n].element.getAttribute("data-disabled"),"aria-label":"Test data tooltip","aria-hidden":"true"}):""))}))},i=0;i<e.length;i++)n(i);return(0,s.default)('[data-toggle="tooltip"]').tooltip(),{v:t}}();if("object"===u(t))return t.v}}(C.data)):m?a.default.createElement("div",{className:"pad-12"},a.default.createElement("div",{className:"search-icon"},(0,l.default)("Searching..."))):"",0==C.data.length&&1==C.fetched&&0==m?a.default.createElement("div",{className:"pad-12 no-results"},a.default.createElement("span",{className:"fa fa-info-circle"})," ",(0,l.default)("No search results")):"",1==E.fetched&&0==y?a.default.createElement("div",null,a.default.createElement("div",{className:"help-groups"},a.default.createElement("span",{className:"fa fa-question-circle"})," ",(0,l.default)("HELP ARTICLES")," ",Object.keys(E.data).length>10?a.default.createElement("span",null,"(10 of ",Object.keys(E.data).length," )"):"("+Object.keys(E.data).length+")","",E.clearedPooling?"":a.default.createElement("img",{src:"/static/img/loading.gif",alt:(0,l.default)("Loading..."),className:"help_loading_icon"}),Object.keys(E.data).length>10?a.default.createElement("a",{href:E.url,className:"pull-right no-padding",target:"_blank",rel:"noreferrer"},(0,l.default)("Show all")," ",a.default.createElement("span",{className:"fas fa-external-link-alt"})):""),Object.keys(E.data).map((function(e,t){if(t<=9)return a.default.createElement("li",{key:"li-help-"+t},a.default.createElement("a",{tabIndex:"0",href:E.data[e],key:"help-"+t,className:"dropdown-item",target:"_blank",rel:"noreferrer"},e))})),0==Object.keys(E.data).length?a.default.createElement("div",{className:"pad-12 no-results"},a.default.createElement("span",{className:"fa fa-info-circle"})," ",(0,l.default)("No search results")):""):y&&0==m?a.default.createElement("div",null,a.default.createElement("div",{className:"help-groups"},a.default.createElement("span",{className:"fa fa-question-circle"}),"HELP ARTICLES",Object.keys(E.data).length>10?"(10 of "+Object.keys(E.data).length+")":"("+Object.keys(E.data).length+")",Object.keys(E.data).length>10?a.default.createElement("a",{href:E.url,className:"pull-right no-padding",target:"_blank",rel:"noreferrer"},"Show all ",a.default.createElement("span",{className:"fas fa-external-link-alt"})):""),a.default.createElement("div",{className:"pad-12"},a.default.createElement("div",{className:"search-icon"},(0,l.default)("Searching...")))):""))))),a.default.createElement("div",{id:"quick-search-iframe-container"}))},n(32564),n(89554),n(54747),n(47941),n(74916),n(23123),n(21249),n(79753);var a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==u(e)&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var a={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var o=i?Object.getOwnPropertyDescriptor(e,r):null;o&&(o.get||o.set)?Object.defineProperty(a,r,o):a[r]=e[r]}a.default=e,n&&n.set(e,a);return a}(n(67294)),i=n(50464),r=n(9129),o=n(95778),s=d(n(19755)),l=d(n(91669));function d(e){return e&&e.__esModule?e:{default:e}}function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var a,i,r=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(r.push(a.value),!t||r.length!==t);o=!0);}catch(e){s=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}},7134:(e,t,n)=>{var a=n(64492);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(66992),n(41539),n(78783),n(4129),n(33948),n(69070),n(38880),n(82526),n(41817),n(32165),Object.defineProperty(t,"__esModule",{value:!0}),t.pgBrowser=void 0;var r=u(n(55112)),o=u(n(28008)),s=u(n(19755)),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(a,o,s):a[o]=e[o]}a.default=e,n&&n.set(e,a);return a}(n(55455)),d=u(n(91669));function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}function u(e){return e&&e.__esModule?e:{default:e}}var f=r.default.Browser=r.default.Browser||{};t.pgBrowser=f,a.extend(f,{send_signal_to_runtime:function(e){s.default.ajax({url:(0,o.default)("browser.signal_runtime"),method:"POST",contentType:"application/json",data:JSON.stringify({command:e})}).fail((function(e,t){l.pgNotifier(t,e,(0,d.default)("Failed to send signal to runtime."))}))},mnu_configure_runtime:function(){this.send_signal_to_runtime("Runtime Open Configuration")},mnu_viewlog_runtime:function(){this.send_signal_to_runtime("Runtime Open View Log")},mnu_toggle_fullscreen_runtime:function(){this.send_signal_to_runtime("Runtime Toggle Full Screen")},mnu_actual_size_runtime:function(){this.send_signal_to_runtime("Runtime Actual Size")},mnu_zoomin_runtime:function(){this.send_signal_to_runtime("Runtime Zoom In")},mnu_zoomout_runtime:function(){this.send_signal_to_runtime("Runtime Zoom Out")}})},14953:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.initializeToolbar=function(e,t){l=e,i.default.each(d,(function(e){u(e)})),i.default.each(c,(function(e){u(e)})),e.on(t.EVENT.BUTTON,(function(e){if("name"in e&&e.name===(0,a.default)("Query Tool"))r.default.DataGrid.show_query_tool("",r.default.Browser.tree.selected());else if("name"in e&&e.name===(0,a.default)("View Data"))r.default.DataGrid.show_data_grid({mnuid:3},r.default.Browser.tree.selected());else if("name"in e&&e.name===(0,a.default)("Filtered Rows"))r.default.DataGrid.show_filtered_row({mnuid:4},r.default.Browser.tree.selected());else if("name"in e&&e.name===(0,a.default)("Search objects"))r.default.SearchObjects.show_search_objects("",r.default.Browser.tree.selected());else if("name"in e&&e.name===(0,a.default)("PSQL Tool")){var t=r.default.Browser.tree,n={}.item||t.selected(),i=n&&1==n.length?t.itemData(n):void 0;r.default.Browser.psql.psql_tool(i,n,!0)}}))},t.enable=function(e,t){e in s?l.buttonEnable(e,t):console.warn("Developer warning: No tool button found with label: "+e)},n(34553),n(68309);var a=o(n(91669)),i=o(n(81311)),r=o(n(55112));function o(e){return e&&e.__esModule?e:{default:e}}var s={},l=null,d=[{label:(0,a.default)("Search objects"),ariaLabel:(0,a.default)("Search objects"),btnClass:"fa fa-search",text:"",toggled:!1,toggleClass:"",parentClass:"pg-toolbar-btn btn-primary-icon",enabled:!1},{label:(0,a.default)("Filtered Rows"),ariaLabel:(0,a.default)("Filtered Rows"),btnClass:"pg-font-icon icon-row_filter",text:"",toggled:!1,toggleClass:"",parentClass:"pg-toolbar-btn btn-primary-icon",enabled:!1},{label:(0,a.default)("View Data"),ariaLabel:(0,a.default)("View Data"),btnClass:"pg-font-icon sql-icon-lg icon-view_data",text:"",toggled:!1,toggleClass:"",parentClass:"pg-toolbar-btn btn-primary-icon",enabled:!1},{label:(0,a.default)("Query Tool"),ariaLabel:(0,a.default)("Query Tool"),btnClass:"pg-font-icon icon-query_tool",text:"",toggled:!1,toggleClass:"",parentClass:"pg-toolbar-btn btn-primary-icon",enabled:!1}];r.default.enable_psql&&d.unshift({label:(0,a.default)("PSQL Tool"),ariaLabel:(0,a.default)("PSQL Tool"),btnClass:"fas fa-terminal",text:"",toggled:!1,toggleClass:"",parentClass:"pg-toolbar-btn btn-primary-icon pg-toolbar-psql",enabled:!1});var c=[];function u(e){(!(e.label in s)||i.default.findIndex(l._buttonList,{name:e.label})<0)&&(l.addButton(e.label,e.btnClass,e.text,e.label,e.toggled,e.toggleClass,e.parentClass,e.enabled,e.ariaLabel),s[e.label]=e)}},7361:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.fetch_ticket=s,t.validate_kerberos_ticket=function(){if(i.default.current_auth_source!=r.default.KERBEROS)return;return setInterval((function(){l().then((function(){}),s)}),1e4)},t.fetch_ticket_lifetime=l,n(41539),n(88674),n(32564);var a=o(n(28008)),i=o(n(6537)),r=o(n(92026));function o(e){return e&&e.__esModule?e:{default:e}}function s(){return fetch((0,a.default)("kerberos.update_ticket")).then((function(e){return e.status>=200&&e.status<300?Promise.resolve(e):Promise.reject(new Error(e.statusText))}))}function l(){return fetch((0,a.default)("kerberos.validate_ticket")).then((function(e){return e.status>=200&&e.status<300?e.json():Promise.reject(new Error(e.statusText))})).then((function(e){var t=e.data.ticket_lifetime;return t>0?Promise.resolve(t):Promise.reject()}))}},11034:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(69070);var a=o(n(67294)),i=o(n(73935)),r=o(n(15412));function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var d=function(){function e(t,n,a,i){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];s(this,e),this.container=t,this.preferences=n,this.sid=a,this.did=i,this.pageVisible=r}var t,n,o;return t=e,(n=[{key:"render",value:function(){this.container&&this.preferences.show_graphs&&i.default.render(a.default.createElement(r.default,{sid:this.sid,did:this.did,preferences:this.preferences,pageVisible:this.pageVisible}),this.container)}},{key:"unmount",value:function(){this.container&&i.default.unmountComponentAtNode(this.container)}},{key:"setSidDid",value:function(e,t){this.sid=e,this.did=t,this.render()}},{key:"reflectPreferences",value:function(e){this.preferences=e,e.show_graphs?this.render():this.unmount()}},{key:"setPageVisible",value:function(e){this.pageVisible=e,this.render()}}])&&l(t.prototype,n),o&&l(t,o),e}();t.default=d},15412:(e,t,n)=>{function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(79753),n(82526),n(41817),n(32165),n(78783),n(91038),n(68309),n(69070),n(57327),n(38880),n(49337),n(33321),n(4129),Object.defineProperty(t,"__esModule",{value:!0}),t.transformData=x,t.legendCallback=C,t.getStatsUrl=S,t.statsReducer=k,t.default=T,t.GraphsWrapper=O,t.POINT_SIZE=t.X_AXIS_LENGTH=void 0,n(21249),n(47941),n(66992),n(41539),n(33948),n(69600),n(89554),n(54747),n(92222),n(47042),n(91058);var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var n=h(t);if(n&&n.has(e))return n.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}i.default=e,n&&n.set(e,i);return i}(n(67294)),r=n(10416),o=n(9109),s=p(n(28008)),l=p(n(9669)),d=p(n(91669)),c=n(44092),u=n(50464),f=p(n(45697));function p(e){return e&&e.__esModule?e:{default:e}}function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(h=function(e){return e?n:t})(e)}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var a,i,r=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(r.push(a.value),!t||r.length!==t);o=!0);}catch(e){s=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return r}(e,t)||y(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e){return function(e){if(Array.isArray(e))return w(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||y(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}t.X_AXIS_LENGTH=75;function x(e,t){var n=["#00BCD4","#9CCC65","#E64A19"],a=Object.keys(e).map((function(t,a){return{label:t,data:e[t]||[],borderColor:n[a],backgroundColor:n[a],pointHitRadius:2}}))||[];return{labels:v(Array(75).keys()),datasets:a,refreshRate:t}}function C(e){var t=[];t.push('<div class="'+e.id+'-legend d-flex">');for(var n=0;n<e.data.datasets.length;n++)t.push('<div class="legend-value"><span style="background-color:'+e.data.datasets[n].backgroundColor+'">&nbsp;&nbsp;&nbsp;&nbsp;</span>'),e.data.datasets[n].label&&t.push('<span class="legend-label">'+e.data.datasets[n].label+"</span>"),t.push("</div>");return t.push("</div>"),t.join("")}function S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=(0,s.default)("dashboard.dashboard_stats");return a+="/"+e,a+=t>0?"/"+t:"",a+="?chart_names="+n.join(",")}function k(e,t){if(t.reset)return t.reset;if(!t.incoming)return e;t.counterData||(t.counterData=t.incoming);var n={};return Object.keys(t.incoming).forEach((function(a){e[a]?n[a]=[t.counter?t.incoming[a]-t.counterData[a]:t.incoming[a]].concat(v(e[a].slice(0,74))):n[a]=[t.counter?t.incoming[a]-t.counterData[a]:t.incoming[a]]})),n}t.POINT_SIZE=2;var E={session_stats:{Total:[],Active:[],Idle:[]},tps_stats:{Transactions:[],Commits:[],Rollbacks:[]},ti_stats:{Inserts:[],Updates:[],Delete:[]},to_stats:{Fetched:[],Returned:[]},bio_stats:{Reads:[],Hits:[]}};function T(e){var t=e.preferences,n=e.sid,a=e.did,r=e.pageVisible,o=e.enablePoll,s=void 0===o||o,f=(0,i.useRef)(null),p=(0,u.usePrevious)(t),h=b((0,i.useReducer)(k,E.session_stats),2),_=h[0],m=h[1],v=b((0,i.useReducer)(k,E.tps_stats),2),y=v[0],w=v[1],C=b((0,i.useReducer)(k,E.ti_stats),2),T=C[0],P=C[1],q=b((0,i.useReducer)(k,E.to_stats),2),D=q[0],N=q[1],j=b((0,i.useReducer)(k,E.bio_stats),2),M=j[0],A=j[1],R=b((0,i.useState)({}),2),I=R[0],L=R[1],B=b((0,i.useState)(null),2),V=B[0],U=B[1],H=b((0,i.useState)(1e3),2),F=H[0],z=H[1],$=b((0,i.useState)(!1),2),K=$[0],G=$[1];return(0,i.useEffect)((function(){var e=!1;p?(p.session_stats_refresh!=t.session_stats_refresh&&(m({reset:E.session_stats}),e=!0),p.tps_stats_refresh!=t.tps_stats_refresh&&(w({reset:E.tps_stats}),e=!0),p.ti_stats_refresh!=t.ti_stats_refresh&&(P({reset:E.ti_stats}),e=!0),p.to_stats_refresh!=t.to_stats_refresh&&(N({reset:E.to_stats}),e=!0),p.bio_stats_refresh!=t.bio_stats_refresh&&(A({reset:E.bio_stats}),e=!0)):e=!0,e&&z(1e3*(0,c.getGCD)(Object.keys(E).map((function(e){return t[e+"_refresh"]}))))}),[t]),(0,i.useEffect)((function(){r&&!K&&G(!0)}),[r]),(0,u.useInterval)((function(){var e=(0,c.getEpoch)();if(null===f.current){var i={};Object.keys(E).forEach((function(t){i[t]=e})),f.current=i}var r=[];Object.keys(E).forEach((function(n){e>=f.current[n]&&(r.push(n),f.current[n]=e+t[n+"_refresh"])}));var o=S(n,a,r);l.default.get(o).then((function(e){var t=e.data;U(null),m({incoming:t.session_stats}),w({incoming:t.tps_stats,counter:!0,counterData:I.tps_stats}),P({incoming:t.ti_stats,counter:!0,counterData:I.ti_stats}),N({incoming:t.to_stats,counter:!0,counterData:I.to_stats}),A({incoming:t.bio_stats,counter:!0,counterData:I.bio_stats}),L((function(e){return g(g({},e),t)}))})).catch((function(e){if(!V)if(m({reset:E.session_stats}),w({reset:E.tps_stats}),P({reset:E.ti_stats}),N({reset:E.to_stats}),A({reset:E.bio_stats}),L({}),e.response)428===e.response.status?U((0,d.default)("Please connect to the selected server to view the graph.")):U((0,d.default)("An error occurred whilst rendering the graph."));else{if(e.request)return void U((0,d.default)("Not connected to the server or the connection to the server has been closed."));console.error(e)}}))}),s?F:-1),i.default.createElement(i.default.Fragment,null,i.default.createElement("div",{"data-testid":"graph-poll-delay",className:"d-none"},F),K&&i.default.createElement(O,{sessionStats:x(_,t.session_stats_refresh),tpsStats:x(y,t.tps_stats_refresh),tiStats:x(T,t.ti_stats_refresh),toStats:x(D,t.to_stats_refresh),bioStats:x(M,t.bio_stats_refresh),errorMsg:V,showTooltip:t.graph_mouse_track,showDataPoints:t.graph_data_points,isDatabase:a>0}))}function O(e){var t=(0,i.useRef)(),n=(0,i.useRef)(),a=(0,i.useRef)(),s=(0,i.useRef)(),l=(0,i.useRef)(),c=(0,i.useMemo)((function(){return{normalized:!0,legendCallback:C,animation:{duration:0},hover:{animationDuration:0},responsiveAnimationDuration:0,legend:{display:!1},elements:{point:{radius:e.showDataPoints?2:0}},tooltips:{enabled:e.showTooltip,callbacks:{title:function(e,t){var n="";try{n=parseInt(e[0].xLabel)*t.refreshRate+(0,d.default)(" seconds ago")}catch(e){n=""}return n}}},scales:{yAxes:[{ticks:{min:0,userCallback:function(e){if(Math.floor(e)===e)return e},fontColor:getComputedStyle(document.documentElement).getPropertyValue("--color-fg")},gridLines:{drawBorder:!1,zeroLineColor:getComputedStyle(document.documentElement).getPropertyValue("--border-color"),color:getComputedStyle(document.documentElement).getPropertyValue("--border-color")}}],xAxes:[{display:!1,gridLines:{display:!1},ticks:{display:!1,reverse:!0}}]}}}),[e.showTooltip,e.showDataPoints]),u=(0,i.useMemo)((function(){return{duration:0}}),[]),f=(0,i.useCallback)((function(e){return function(t){e.current.innerHTML=t.generateLegend()}}));return i.default.createElement(i.default.Fragment,null,i.default.createElement(o.DashboardRow,null,i.default.createElement(o.DashboardRowCol,{breakpoint:"md",parts:6},i.default.createElement(o.ChartContainer,{id:"sessions-graph",title:e.isDatabase?(0,d.default)("Database sessions"):(0,d.default)("Server sessions"),legendRef:t,errorMsg:e.errorMsg},i.default.createElement(r.LineChart,{options:c,data:e.sessionStats,updateOptions:u,onInit:f(t)}))),i.default.createElement(o.DashboardRowCol,{breakpoint:"md",parts:6},i.default.createElement(o.ChartContainer,{id:"tps-graph",title:(0,d.default)("Transactions per second"),legendRef:n,errorMsg:e.errorMsg},i.default.createElement(r.LineChart,{options:c,data:e.tpsStats,updateOptions:u,onInit:f(n)})))),i.default.createElement(o.DashboardRow,null,i.default.createElement(o.DashboardRowCol,{breakpoint:"md",parts:4},i.default.createElement(o.ChartContainer,{id:"ti-graph",title:(0,d.default)("Tuples in"),legendRef:a,errorMsg:e.errorMsg},i.default.createElement(r.LineChart,{options:c,data:e.tiStats,updateOptions:u,onInit:f(a)}))),i.default.createElement(o.DashboardRowCol,{breakpoint:"md",parts:4},i.default.createElement(o.ChartContainer,{id:"to-graph",title:(0,d.default)("Tuples out"),legendRef:s,errorMsg:e.errorMsg},i.default.createElement(r.LineChart,{options:c,data:e.toStats,updateOptions:u,onInit:f(s)}))),i.default.createElement(o.DashboardRowCol,{breakpoint:"md",parts:4},i.default.createElement(o.ChartContainer,{id:"bio-graph",title:(0,d.default)("Block I/O"),legendRef:l,errorMsg:e.errorMsg},i.default.createElement(r.LineChart,{options:c,data:e.bioStats,updateOptions:u,onInit:f(l)})))))}T.propTypes={preferences:f.default.object.isRequired,sid:f.default.oneOfType([f.default.string.isRequired,f.default.number.isRequired]),did:f.default.oneOfType([f.default.string.isRequired,f.default.number.isRequired]),pageVisible:f.default.bool,enablePoll:f.default.bool};var P=f.default.shape({labels:f.default.array.isRequired,datasets:f.default.array,refreshRate:f.default.number.isRequired});O.propTypes={sessionStats:P.isRequired,tpsStats:P.isRequired,tiStats:P.isRequired,toStats:P.isRequired,bioStats:P.isRequired,errorMsg:f.default.string,showTooltip:f.default.bool.isRequired,showDataPoints:f.default.bool.isRequired,isDatabase:f.default.bool.isRequired}},71151:(e,t,n)=>{var a,i;n(24812),n(69826),n(68309),n(40561),n(74916),n(64765),n(32564),n(92222),a=[n(28008),n(91669),n,n(19755),n(81311),n(55112),n(72316),n(83879),n(55455),n(12030),n(90585),n(1950),n(11034),n(58894),n(43734),n(35816)],void 0===(i=function(e,t,a,i,r,o,s,l,d,c,u,f,p){o.Browser=o.Browser||{};var h=o.Browser;if(!o.Dashboard){var _,g,m=!0,b="",v="",y=!1,w=!1,x=!1,C=!1,S=l.Extension.DeleteCell.extend({render:function(){this.$el.empty();var e=this;return"cancel"===e.column.get("cell_action")?this.$el.html("<i class='fa fa-stop' data-toggle='tooltip' title='"+t("Cancel the active query")+"' aria-label='"+t("Cancel the active query")+"'></i>"):this.$el.html("<i class='fa fa-times-circle text-danger' data-toggle='tooltip' title='"+t("Terminate the session")+"' aria-label='"+t("Terminate the session")+"'></i>"),this.$el.attr("tabindex",0),this.$el.on("keydown",(function(t){32==t.keyCode&&e.$el.click()})),this.delegateEvents(),this},deleteRow:function(e){var n,a,r,o,s,c=this,u=c.column.get("cell_action");if(e.preventDefault(),l.callByNeed(c.column.get("canDeleteRow"),c.column,c.model)){"cancel"===u?(n=t("Cancel Active Query?"),a=t("Are you sure you wish to cancel the active query?"),r=t("Active query cancelled successfully."),o=t("An error occurred whilst cancelling the active query."),s=b+c.model.get("pid")):(n=t("Terminate Session?"),a=t("Are you sure you wish to terminate the session?"),r=t("Session terminated successfully."),o=t("An error occurred whilst terminating the active query."),s=v+c.model.get("pid")),d.confirm(n,a,(function(){i.ajax({url:s,type:"DELETE"}).done((function(e){e==t("Success")?(d.success(r),i("#btn_refresh").trigger("click")):d.error(o)})).fail((function(e,t,n){d.pgRespErrorNotify(e,n)}))}),(function(){return!0}))}}}),k=l.Extension.ObjectCell.extend({enterEditMode:function(){this.model.trigger("enteringEditMode",[this]),l.Cell.prototype.enterEditMode.apply(this,arguments),this.delegateEvents();var e=l.callByNeed(this.column.editable(),this.column,this.model);e&&(this.$el.html("<i class='fa fa-caret-down subnode-edit-in-process'></i>"),this.model.trigger("pg-sub-node:opened",this.model,this))},render:function(){return this.$el.empty(),this.$el.html("<i class='fa fa-caret-right' data-toggle='tooltip' title='"+t("View the active session details")+"' aria-label='"+t("View the active session details")+"'></i>"),this.delegateEvents(),this.grabFocus&&this.$el.trigger("focus"),this}}),E=s.Model.extend({defaults:{version:null},schema:[{id:"backend_type",label:t("Backend type"),type:"text",editable:!0,readonly:!0,group:t("Details"),visible:function(){return this.version>=1e5}},{id:"query_start",label:t("Query started at"),type:"text",editable:!1,readonly:!0,group:t("Details")},{id:"state_change",label:t("Last state changed at"),type:"text",editable:!0,readonly:!0,group:t("Details")},{id:"query",label:t("SQL"),type:"text",editable:!0,readonly:!0,control:c.SqlFieldControl,group:t("Details")}]});return o.Dashboard={init:function(){if(!this.initialized){this.initialized=!0,this.chartsDomObj=null,this.sid=this.did=-1,this.version=-1;var n=this.object_selected.bind(this),a=this.object_disconnected.bind(this);h.Events.on("pgadmin-browser:tree:selected",n),h.Events.on("pgadmin:server:disconnect",a);var r=e("dashboard.index"),o=h.panels.dashboard.panel;if(o){var s=o.layout().scene().find(".pg-panel-content");if(s){i(s).html('<div class="pg-panel-message" role="alert">'+t("Loading dashboard...")+"</div>"),function e(){i.ajax({url:r,type:"GET",dataType:"html"}).done((function(e){i(s).html(e)})).fail((function(n,a){d.pgNotifier(a,n,t("An error occurred whilst loading the dashboard."),(function(n){"CRYPTKEY_SET"===n?e():i(s).html('<div class="pg-panel-message" role="alert">'+t("An error occurred whilst loading the dashboard.")+"</div>")}))}))}(),i(o).data("sid",-1),i(o).data("did",-1)}}}},object_disconnected:function(){var e=h.tree.selected(),t=e&&h.tree.itemData(e);0!=e.length&&this.object_selected(e,t,h.Nodes[t._type])},object_selected:function(n,a,o){var s=this;if(a&&a._type){var l=o.getTreeNodeHierarchy(n),c=u.url(a,n,l);if(null===c){c=e("dashboard.index"),s.version=l.server&&l.server.version||0,b=c+"cancel_query/",v=c+"terminate_session/";var f=l.server;g=f&&f.db||null,C=!(!f||!f.user)&&f.user.can_signal_backend,f&&f.user&&f.user.is_superuser?y=!0:(y=!1,_=f&&f.user?f.user.name:null),"database"in l?(s.sid=l.server._id,s.did=l.database._id,w=!1,x=!0,c+=s.sid+"/"+s.did,b+=s.sid+"/"+s.did+"/",v+=s.sid+"/"+s.did+"/"):"server"in l?(s.sid=l.server._id,s.did=-1,w=!0,x=!1,c+=s.sid,b+=s.sid+"/",v+=s.sid+"/"):w=x=!1}else w=x=!1;var p=h.panels.dashboard.panel;if(p){var m=p.layout().scene().find(".pg-panel-content");if(m){if(a.connected||r.isUndefined(a.connected)){if(c!==i(p).data("dashboard_url")||c===i(p).data("dashboard_url")&&0==i(p).data("server_status")){this.chartsDomObj&&this.chartsDomObj.unmount(),i(m).empty();i(m).html('<div class="pg-panel-message" role="alert">'+t("Loading dashboard...")+"</div>"),function e(){i.ajax({url:c,type:"GET",dataType:"html"}).done((function(e){i(m).html(e),s.init_dashboard()})).fail((function(n,a){d.pgNotifier(a,n,t("An error occurred whilst loading the dashboard."),(function(n){"CRYPTKEY_SET"===n?e():i(m).html('<div class="pg-panel-message" role="alert">'+t("An error occurred whilst loading the dashboard.")+"</div>")}))}))}(),i(p).data("server_status",!0)}}else this.chartsDomObj&&this.chartsDomObj.unmount(),i(m).html('<div class="pg-panel-message" role="alert">'+t("Please connect to the selected server to view the dashboard.")+"</div>"),i(p).data("server_status",!1);i(p).data("dashboard_url",c)}}}},add_new_server:function(){if(h&&h.tree){for(var e=0!=h.tree.selected().length?h.tree.selected():h.tree.first(null,!1),t=n(59719),a=h.tree.itemData(e);a&&"server_group"!=a._type;)e=h.tree.next(e),a=h.tree.itemData(e);if(!a)return;t&&t.callbacks.show_obj_properties.apply(t,[{action:"create"},e])}},render_grid:function(e,n,a){var o=s.Model.extend({}),d=this,c=n+d.sid;-1!=d.did&&(c+="/"+d.did);var u=new(s.Collection.extend({model:o,url:c,mode:"client"})),f=l.Row.extend({render:function(){l.Row.prototype.render.call(this);var e=this.model.get("row_type");return r.isUndefined(e)||r.isNull(e)?(this.$el.removeClass("alert"),this.$el.removeClass("warning")):"warning"===e?this.$el.addClass("warning"):"alert"===e&&this.$el.addClass("alert"),this}}),p=new l.Grid({emptyText:t("No data found"),columns:a,collection:u,className:"backgrid presentation table table-bordered table-noouter-border table-hover",row:f});i(e).empty(),i(e).append(p.render().el);var h=new l.Extension.ClientSideFilter({collection:u});h.setCustomSearchBox(i("#txtGridSearch")),i(e).data("data",u),i(e).data("grid",p),i(e).data("filter",h)},__loadMoreRows:function(e){var t=e.currentTarget;t.scrollHeight-10<t.scrollTop+t.offsetHeight&&this.data.length>0&&this.local_grid.collection.add(this.data.splice(0,50))},render_grid_data:function(e){var n=this,a=i(e).data("data"),s=i(e).data("grid"),l=i(e).data("filter");if(r.isUndefined(a))return null;a.fetch({reset:!0,success:function(t){n.data=t.models,n.local_grid=s,s.collection.reset(n.data.splice(0,50)),i(e).hasClass("grid-error")&&(i(e).removeClass("grid-error"),i(e).html(s.render().el),i(l.el).show()),n.data.length>50?i(".wcScrollableY").on("scroll",n.__loadMoreRows.bind(n)):i(".wcScrollableY").off("scroll",n.__loadMoreRows),l.search()},error:function(n,s){var d="",c="info";0===s.readyState?d=t("Not connected to the server or the connection to the server has been closed."):(d=JSON.parse(s.responseText).errormsg,428===s.status?(r.isUndefined(d)||r.isNull(d))&&(d=t("Please connect to the selected server to view the table.")):(d=t("An error occurred whilst rendering the table."),c="error")),i(e).hasClass("grid-error")||(i(l.el).hide(),i(e).addClass("grid-error")),i(e).html('<div class="pg-panel-'+c+' pg-panel-message" role="alert">'+d+"</div>"),setTimeout((function(){o.Dashboard.render_grid_data(e,a)}),5e3)}})},init_dashboard:function(){var e=this;this.chartsDomObj=new p.default(document.getElementById("dashboard-graphs"),e.preferences,e.sid,e.did,!(i(".dashboard-container")[0].clientHeight<=0));var t=setInterval((function(){try{f.default.pgAdmin.Browser.preference_version()>0&&(clearInterval(t),e.reflectPreferences())}catch(e){throw clearInterval(t),e}}),0);h.onPreferencesChange("dashboards",(function(){e.reflectPreferences()}))},reflectPreferences:function(){var e=this;e.preferences=f.default.pgAdmin.Browser.get_preferences_for_module("dashboards"),this.chartsDomObj.reflectPreferences(e.preferences),(w||x)&&(e.preferences.show_activity&&i("#dashboard-activity").hasClass("dashboard-hidden")?i("#dashboard-activity").removeClass("dashboard-hidden"):e.preferences.show_activity||i("#dashboard-activity").addClass("dashboard-hidden"),e.preferences.show_activity&&i("#dashboard-activity").hasClass("dashboard-hidden")?i("#dashboard-activity").removeClass("dashboard-hidden"):e.preferences.show_activity||i("#dashboard-activity").addClass("dashboard-hidden"),w?e.reflectPreferencesServer():x&&e.reflectPreferencesDatabase())},reflectPreferencesServer:function(){var n=this,a=i(".dashboard-container"),s=a.find("#server_activity").get(0),l=a.find("#server_locks").get(0),d=a.find("#server_prepared").get(0),u=a.find("#server_config").get(0),f={tab_server_activity:s,tab_server_locks:l,tab_server_prepared:d,tab_server_config:u};if(n.preferences.show_activity){var p=[{name:"pid",label:t("PID"),editable:!1,cell:"string"},{name:"datname",label:t("Database"),editable:!1,cell:"string"},{name:"usename",label:t("User"),editable:!1,cell:"string"},{name:"application_name",label:t("Application"),editable:!1,cell:"string"},{name:"client_addr",label:t("Client"),editable:!1,cell:"string"},{name:"backend_start",label:t("Backend start"),editable:!1,cell:"string"},{name:"state",label:t("State"),editable:!1,cell:"string"}];p=n.version<90600?p.concat([{name:"waiting",label:t("Waiting?"),editable:!1,cell:"string"}]):p.concat([{name:"wait_event",label:t("Wait event"),editable:!1,cell:"string"},{name:"blocking_pids",label:t("Blocking PIDs"),editable:!1,cell:"string"}]);var h=new E,_=c.generateViewSchema(null,h,"create",null,null,!0);r.each(_[0].fields,(function(e){e.version=n.version})),p.unshift({name:"pg-backform-expand",label:"",cell:k,cell_priority:-1,postgres_version:n.version,schema:_}),p.unshift({name:"pg-backform-delete",label:"",cell:S,cell_action:"cancel",editable:!1,cell_priority:-1,canDeleteRow:o.Dashboard.can_take_action,postgres_version:n.version}),p.unshift({name:"pg-backform-delete",label:"",cell:S,cell_action:"terminate",editable:!1,cell_priority:-1,canDeleteRow:o.Dashboard.can_take_action,postgres_version:n.version});var g=[{name:"pid",label:t("PID"),editable:!1,cell:"string"},{name:"datname",label:t("Database"),editable:!1,cell:"string"},{name:"locktype",label:t("Lock type"),editable:!1,cell:"string"},{name:"relation",label:t("Target relation"),editable:!1,cell:"string"},{name:"page",label:t("Page"),editable:!1,cell:"string"},{name:"tuple",label:t("Tuple"),editable:!1,cell:"string"},{name:"virtualxid",label:t("vXID (target)"),editable:!1,cell:"string"},{name:"transactionid",label:t("XID (target)"),editable:!1,cell:"string"},{name:"classid",label:t("Class"),editable:!1,cell:"string"},{name:"objid",label:t("Object ID"),editable:!1,cell:"string"},{name:"virtualtransaction",label:t("vXID (owner)"),editable:!1,cell:"string"},{name:"mode",label:t("Mode"),editable:!1,cell:"string"},{name:"granted",label:t("Granted?"),editable:!1,cell:"string"}],m=[{name:"git",label:t("Name"),editable:!1,cell:"string"},{name:"database",label:t("Database"),editable:!1,cell:"string"},{name:"Owner",label:t("Owner"),editable:!1,cell:"string"},{name:"transaction",label:t("XID"),editable:!1,cell:"string"},{name:"prepared",label:t("Prepared at"),editable:!1,cell:"string"}],b=[{name:"name",label:t("Name"),editable:!1,cell:"string"},{name:"category",label:t("Category"),editable:!1,cell:"string"},{name:"setting",label:t("Setting"),editable:!1,cell:"string"},{name:"unit",label:t("Unit"),editable:!1,cell:"string"},{name:"short_desc",label:t("Description"),editable:!1,cell:"string"}];i(s).addClass("pg-el-container"),i(s).attr("el","sm"),o.Dashboard.render_grid(s,e("dashboard.activity"),p),o.Dashboard.render_grid(l,e("dashboard.locks"),g),o.Dashboard.render_grid(d,e("dashboard.prepared"),m),o.Dashboard.render_grid(u,e("dashboard.config"),b),o.Dashboard.render_grid_data(s),i('a[data-toggle="tab"]').on("shown.bs.tab",(function(e){var t=f[i(e.relatedTarget).attr("aria-controls")];i(t).data("filtertext",i("#txtGridSearch").val());var n=f[i(e.target).attr("aria-controls")];i("#txtGridSearch").val(i(n).data("filtertext")),o.Dashboard.render_grid_data(n)})),i("#btn_refresh").off("click").on("click",(function(){var e=f[i("#dashboard-activity .nav-tabs .active").attr("aria-controls")];o.Dashboard.render_grid_data(e)}))}},reflectPreferencesDatabase:function(){var n=this,a=document.getElementById("database_activity"),s=document.getElementById("database_locks"),l=document.getElementById("database_prepared"),d={tab_database_activity:a,tab_database_locks:s,tab_database_prepared:l};if(n.preferences.show_activity){var u=[{name:"pid",label:t("PID"),editable:!1,cell:"string"},{name:"usename",label:t("User"),editable:!1,cell:"string"},{name:"application_name",label:t("Application"),editable:!1,cell:"string"},{name:"client_addr",label:t("Client"),editable:!1,cell:"string"},{name:"backend_start",label:t("Backend start"),editable:!1,cell:"string"},{name:"state",label:t("State"),editable:!1,cell:"string"}];u=n.version<90600?u.concat([{name:"waiting",label:t("Waiting?"),editable:!1,cell:"string"}]):u.concat([{name:"wait_event",label:t("Wait event"),editable:!1,cell:"string"},{name:"blocking_pids",label:t("Blocking PIDs"),editable:!1,cell:"string"}]);var f=new E,p=c.generateViewSchema(null,f,"create",null,null,!0);r.each(p[0].fields,(function(e){e.version=n.version})),u.unshift({name:"pg-backform-expand",label:"",cell:k,cell_priority:-1,postgres_version:n.version,schema:p}),u.unshift({name:"pg-backform-delete",label:"",cell:S,cell_action:"cancel",editable:!1,cell_priority:-1,canDeleteRow:o.Dashboard.can_take_action,postgres_version:n.version}),u.unshift({name:"pg-backform-delete",label:"",cell:S,cell_action:"terminate",editable:!1,cell_priority:-1,canDeleteRow:o.Dashboard.can_take_action,postgres_version:n.version});var h=[{name:"pid",label:t("PID"),editable:!1,cell:"string"},{name:"locktype",label:t("Lock type"),editable:!1,cell:"string"},{name:"relation",label:t("Target relation"),editable:!1,cell:"string"},{name:"page",label:t("Page"),editable:!1,cell:"string"},{name:"tuple",label:t("Tuple"),editable:!1,cell:"string"},{name:"virtualxid",label:t("vXID (target)"),editable:!1,cell:"string"},{name:"transactionid",label:t("XID (target)"),editable:!1,cell:"string"},{name:"classid",label:t("Class"),editable:!1,cell:"string"},{name:"objid",label:t("Object ID"),editable:!1,cell:"string"},{name:"virtualtransaction",label:t("vXID (owner)"),editable:!1,cell:"string"},{name:"mode",label:t("Mode"),editable:!1,cell:"string"},{name:"granted",label:t("Granted?"),editable:!1,cell:"string"}],_=[{name:"git",label:t("Name"),editable:!1,cell:"string"},{name:"Owner",label:t("Owner"),editable:!1,cell:"string"},{name:"transaction",label:t("XID"),editable:!1,cell:"string"},{name:"prepared",label:t("Prepared at"),editable:!1,cell:"string"}];i(a).addClass("pg-el-container"),i(a).attr("el","sm"),o.Dashboard.render_grid(a,e("dashboard.activity"),u),o.Dashboard.render_grid(s,e("dashboard.locks"),h),o.Dashboard.render_grid(l,e("dashboard.prepared"),_),o.Dashboard.render_grid_data(a),i('a[data-toggle="tab"]').on("shown.bs.tab",(function(e){var t=d[i(e.relatedTarget).attr("aria-controls")];i(t).data("filtertext",i("#txtGridSearch").val());var n=d[i(e.target).attr("aria-controls")];i("#txtGridSearch").val(i(n).data("filtertext")),o.Dashboard.render_grid_data(n)})),i("#btn_refresh").off("click").on("click",(function(){var e=d[i("#dashboard-activity .nav-tabs .active").attr("aria-controls")];o.Dashboard.render_grid_data(e)}))}},toggleVisibility:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(m=e,t)this.chartsDomObj&&this.chartsDomObj.unmount();else{var n=h.tree,a=n.selected(),i=a&&n.itemData(a),r=a&&i&&h.Nodes[i._type];this.chartsDomObj&&this.chartsDomObj.setPageVisible(m),this.object_selected(a,i,r)}},can_take_action:function(e){var n,a=e.collection.where({state:"active"}),i=this.get("postgres_version")||null,r="cancel"===(this.get("cell_action")||null);return i&&i>=1e5&&!e.get("datname")?(n=t(r?"You cannot cancel background worker processes.":"You cannot terminate background worker processes."),d.info(n),!1):g==e.get("datname")&&"active"==e.get("state")&&1==a.length?(n=t(r?"You are not allowed to cancel the main active session.":"You are not allowed to terminate the main active session."),d.error(n),!1):r&&"idle"==e.get("state")?(d.info(t("The session is already in idle state.")),!1):!!C||(!!y||(!(!_||_!=e.get("usename"))||(n=t(r?"Superuser privileges are required to cancel another users query.":"Superuser privileges are required to terminate another users query."),d.error(n),!1)))}},o.Dashboard}}.apply(t,a))||(e.exports=i)},9109:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.ChartContainer=o,t.ChartError=s,t.DashboardRow=l,t.DashboardRowCol=d,n(92222);var a=r(n(67294)),i=r(n(45697));function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return a.default.createElement("div",{className:"card dashboard-graph",role:"object-document",tabIndex:"0","aria-labelledby":e.id},a.default.createElement("div",{className:"card-header"},a.default.createElement("div",{className:"d-flex"},a.default.createElement("div",{id:e.id},e.title),a.default.createElement("div",{className:"ml-auto my-auto legend",ref:e.legendRef}))),a.default.createElement("div",{className:"card-body dashboard-graph-body"},a.default.createElement("div",{className:"chart-wrapper "+(e.errorMsg?"d-none":"")},e.children),a.default.createElement(s,{message:e.errorMsg})))}function s(e){return null===e.message?a.default.createElement(a.default.Fragment,null):a.default.createElement("div",{className:"pg-panel-error pg-panel-message",role:"alert"},e.message)}function l(e){var t=e.children;return a.default.createElement("div",{className:"row dashboard-row"},t)}function d(e){var t=e.breakpoint,n=e.parts,i=e.children;return a.default.createElement("div",{className:"col-".concat(t,"-").concat(n)},i)}o.propTypes={id:i.default.string.isRequired,title:i.default.string.isRequired,legendRef:i.default.oneOfType([i.default.func,i.default.shape({current:i.default.any})]).isRequired,children:i.default.node.isRequired,errorMsg:i.default.string},s.propTypes={message:i.default.string},l.propTypes={children:i.default.node.isRequired},d.propTypes={breakpoint:i.default.oneOf(["xs","sm","md","lg","xl"]).isRequired,parts:i.default.number.isRequired,children:i.default.node.isRequired}},68363:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.getHelpUrl=function(e,t,n,a){var i=Math.floor(n/1e4),r=Math.floor(n/100)-100*i,o=n-(1e4*i+100*r),s="",l=i+"."+r;"ppas"==a&&i<10?l=i+"."+r+"."+o:"pg"==a&&i>=10&&(l=i);"/"!=(s=e.replace("$VERSION$",l)).substr(-1)&&(s+="/");return s+t},n(74916),n(15306)},24149:(e,t,n)=>{var a,i;n(32564),n(83710),n(54678),n(24603),n(74916),n(39714),n(69600),n(92222),n(41539),n(69826),n(24812),n(91058),a=[n(55112),n(91669),n(28008),n(81311),n(19755),n(58894),n(58307)],void 0===(i=function(e,t,n,a,i,r,o){if(r.BackgroundProcessObsorver=r.BackgroundProcessObsorver||{},r.BackgroundProcessObsorver.initialized)return r.BackgroundProcessObsorver;var s="True"==e.server_mode,l=window.wcDocker,d=function(e,t){var n=this;setTimeout((function(){n.initialize.apply(n,[e,t])}),1)};return a.extend(d.prototype,{success_status_tpl:a.template('\n      <div class="d-flex px-2 py-1 bg-success-light border border-success rounded">\n        <div class="pr-2">\n          <i class="fa fa-check text-success pg-bg-status-icon" aria-hidden="true" role="img"></i>\n        </div>\n        <div class="mx-auto pg-bg-status-text alert-text-body"><%-status_text%></div>\n      </div>'),failed_status_tpl:a.template('\n      <div class="d-flex px-2 py-1 bg-danger-lighter border border-danger rounded">\n        <div class="pr-2">\n          <i class="fa fa-times fa-lg text-danger pg-bg-status-icon" aria-hidden="true" role="img"></i>\n        </div>\n        <div class="mx-auto pg-bg-status-text alert-text-body"><%-status_text%></div>\n      </div>'),other_status_tpl:a.template('\n      <div class="d-flex px-2 py-1 bg-primary-light border border-primary rounded">\n        <div class="pr-2">\n          <i class="fa fa-info fa-lg text-primary pg-bg-status-icon" aria-hidden="true" role="img"></i>\n        </div>\n        <div class="mx-auto pg-bg-status-text alert-text-body"><%-status_text%></div>\n      </div>'),initialize:function(e,t){a.extend(this,{details:!1,notify:a.isUndefined(t)||t,curr_status:null,state:0,completed:!1,current_storage_dir:null,id:e.id,type_desc:null,desc:null,detailed_desc:null,stime:null,exit_code:null,acknowledge:e.acknowledge,execution_time:null,out:-1,err:-1,lot_more:!1,notifier:null,container:null,panel:null,logs:i("<ol></ol>",{class:"pg-bg-process-logs"})}),this.notify&&(r.Events&&r.Events.on("pgadmin-bgprocess:started:"+this.id,(function(e){e.notifier||e.show.apply(e)})),r.Events&&r.Events.on("pgadmin-bgprocess:finished:"+this.id,(function(e){e.notifier||e.show.apply(e)})));var n=this;setTimeout((function(){n.update.apply(n,[e])}),1)},bgprocess_url:function(e){switch(e){case"status":return this.details&&-1!=this.out&&-1!=this.err?n("bgprocess.detailed_status",{pid:this.id,out:this.out,err:this.err}):n("bgprocess.status",{pid:this.id});case"acknowledge":return n("bgprocess.acknowledge",{pid:this.id});case"stop_process":return n("bgprocess.stop_process",{pid:this.id});default:return n("bgprocess.list")}},update:function(n){var i=this,o=[],s=[];"stime"in n&&(i.stime=new Date(n.stime)),"execution_time"in n&&(i.execution_time=parseFloat(n.execution_time)),"type_desc"in n&&(i.type_desc=n.type_desc),"desc"in n&&(i.desc=n.desc),"details"in n&&(i.detailed_desc=n.details),"exit_code"in n&&(i.exit_code=n.exit_code),"process_state"in n&&(i.state=n.process_state),"current_storage_dir"in n&&(i.current_storage_dir=n.current_storage_dir),"out"in n&&(i.out=n.out&&n.out.pos,n.out&&n.out.lines&&(o=n.out.lines)),"err"in n&&(i.err=n.err&&n.err.pos,n.err&&n.err.lines&&(s=n.err.lines)),i.completed=i.completed||"err"in n&&"out"in n&&n.err.done&&n.out.done||!i.details&&!a.isNull(i.exit_code);for(var l=0,d=0,c=[],u=document.createElement("textarea"),f=function(e){return u.textContent=e,u.innerHTML};l<o.length&&d<s.length;)if(e.natural_sort(o[l][0],s[d][0])<=0)c.push('<li class="pg-bg-res-out">'+f(o[l++][1])+"</li>");else{var p=f(s[d++][1]);new RegExp(": ("+t("error")+"|"+t("fatal")+"):","i").test(p)?c.push('<li class="pg-bg-res-err">'+p+"</li>"):c.push('<li class="pg-bg-res-out">'+p+"</li>")}for(;l<o.length;)c.push('<li class="pg-bg-res-out">'+f(o[l++][1])+"</li>");for(;d<s.length;){var h=f(s[d++][1]);new RegExp(": ("+t("error")+"|"+t("fatal")+"):","i").test(h)?c.push('<li class="pg-bg-res-err">'+h+"</li>"):c.push('<li class="pg-bg-res-out">'+h+"</li>")}c.length&&(i.logs.append(c.join("")),setTimeout((function(){i.logs[0].scrollTop=i.logs[0].scrollHeight}))),i.logs_loading&&(i.logs_loading.remove(),i.logs_loading=null),i.stime&&(i.curr_status=i.other_status_tpl({status_text:t("Started")}),i.execution_time>=2&&(i.curr_status=i.other_status_tpl({status_text:t("Running...")})),a.isNull(i.exit_code)?a.isNull(i.exit_code)&&3===i.state&&(i.curr_status=i.other_status_tpl({status_text:t("Terminating the process...")})):3===i.state?i.curr_status=i.failed_status_tpl({status_text:t("Terminated by user.")}):0==i.exit_code?i.curr_status=i.success_status_tpl({status_text:t("Successfully completed.")}):i.curr_status=i.failed_status_tpl({status_text:t("Failed (exit code: %s).",String(i.exit_code))}),0==i.state&&i.stime&&(i.state=1,r.Events&&r.Events.trigger("pgadmin-bgprocess:started:"+i.id,i,i)),1!=i.state||a.isNull(i.exit_code)||(i.state=2,r.Events&&r.Events.trigger("pgadmin-bgprocess:finished:"+i.id,i,i)),setTimeout((function(){i.show.apply(i)}),10)),i.completed||setTimeout((function(){i.status.apply(i)}),1e3)},status:function(){var e=this;i.ajax({typs:"GET",timeout:3e4,url:e.bgprocess_url("status"),cache:!1,async:!0,contentType:"application/json"}).done((function(t){setTimeout((function(){e.update(t)}),10)})).fail((function(t){410!=t.status&&setTimeout((function(){e.update(t)}),1e4)}))},show:function(){var e=this;if(e.notify&&!e.details){if(!e.notifier){var n=i('\n            <div class="card">\n              <div class="card-header bg-primary d-flex">\n                <div>'.concat(e.type_desc,'</div>\n                <div class="ml-auto">\n                  <button class="btn btn-sm-sq btn-primary pg-bg-close" aria-label=\'close\'><i class="fa fa-lg fa-times" role="img"></i></button>\n                </div>\n              </div>\n              <div class="card-body px-2">\n                <div class="py-1">').concat(e.desc,'</div>\n                <div class="py-1">').concat(e.stime.toString(),'</div>\n                <div class="d-flex py-1">\n                  <div class="my-auto mr-2">\n                    <span class="fa fa-clock fa-lg" role="img"></span>\n                  </div>\n                  <div class="pg-bg-etime my-auto mr-2"></div>\n                  <div class="ml-auto">\n                    <button class="btn btn-secondary pg-bg-more-details" title="More Details"><span class="fa fa-info-circle" role="img"></span>&nbsp;')+t("More details...")+'</button>\n                    <button class="btn btn-danger bg-process-stop" disabled><span class="fa fa-times-circle" role="img" title="Stop the operation"></span>&nbsp;'+t("Stop Process")+'</button>\n                  </div>\n                </div>\n                <div class="pg-bg-status py-1">\n                </div>\n              </div>\n            </div>\n            '),a=n.find(".pg-bg-more-details"),r=n.find(".pg-bg-close");e.container=n,e.notifier=o.notify(n.get(0),"bg-bgprocess",0,null),a.on("click",function(e){(e=e||window.event).cancelBubble=!0,e.stopPropagation(),this.notifier.dismiss(),this.notifier=null,this.completed=!1,this.show_detailed_view.apply(this)}.bind(e)),r.on("click",function(){this.notifier.dismiss(),this.notifier=null,this.acknowledge_server.apply(this)}.bind(this)),e.container.on("click",(function(e){(e=e||window.event).cancelBubble=!0,e.stopPropagation()})),n.find(".bg-process-stop").off("click").on("click",e.stop_process.bind(this))}e.container.find(".pg-bg-etime").empty().append(i("<span></span>").text(String(e.execution_time))).append(i("<span></span>").text(" "+t("seconds"))),i(e.container.find(".pg-bg-status")).html(e.curr_status);var s=i(e.container.find(".bg-process-stop"));1===parseInt(e.state)?s.attr("disabled",!1):s.attr("disabled",!0)}else e.show_detailed_view.apply(e)},show_detailed_view:function(){var e=this,n=this.panel,a=!1;e.panel||(a=!0,(n=this.panel=r.BackgroundProcessObsorver.create_panel()).title(t("Process Watcher - %s",e.type_desc)),n.focus());var o=n.$container,d=o.find(".bg-process-watcher"),c=o.find(".bg-process-details"),u=o.find(".bg-process-footer"),f=o.find(".bg-process-stop"),p=o.find(".bg-process-storage-manager");if(e.current_storage_dir&&s){if(0==p.length){o.find(".bg-process-details .bg-btn-section").prepend('<button id="bg-process-storage-manager" class="btn btn-secondary bg-process-storage-manager" title="Click to open file location" aria-label="Storage Manager" tabindex="0" disabled><span class="pg-font-icon icon-storage_manager" role="img"></span></button>&nbsp;'),p=o.find(".bg-process-storage-manager")}1===parseInt(e.state)?p.attr("disabled",!0):p.attr("disabled",!1),p.off("click").on("click",e.storage_manager.bind(this))}if(1===parseInt(e.state)?f.attr("disabled",!1):f.attr("disabled",!0),f.off("click").on("click",e.stop_process.bind(this)),a&&(d.html(e.logs),setTimeout((function(){e.logs[0].scrollTop=e.logs[0].scrollHeight})),e.logs_loading=i('<li class="pg-bg-res-out loading-logs">'+t("Loading process logs...")+"</li>"),e.logs.append(e.logs_loading),c.find(".bg-detailed-desc").html(e.detailed_desc)),c.find(".bg-process-stats .bgprocess-start-time").html(e.stime),u.find(".bg-process-status").html(e.curr_status),u.find(".bg-process-exec-time p").empty().append(i("<span></span>").text(String(e.execution_time))).append(i("<span></span>").text(" "+t("seconds"))),a){e.details=!0,e.err=0,e.out=0,setTimeout((function(){e.status.apply(e)}),1e3);var h=function(e,t,n){var a=t.outerHeight()+n.outerHeight();e.css("padding-bottom",a)}.bind(n,d,c,u);n.on(l.EVENT.RESIZED,h),n.on(l.EVENT.ATTACHED,h),n.on(l.EVENT.DETACHED,h),h(),n.on(l.EVENT.CLOSED,function(e){e.panel=null,e.details=!1,null!=e.exit_code&&e.acknowledge_server.apply(e)}.bind(n,this))}},acknowledge_server:function(){i.ajax({type:"PUT",timeout:3e4,url:this.bgprocess_url("acknowledge"),cache:!1,async:!0,contentType:"application/json"}).done((function(){})).fail((function(){console.warn(arguments)}))},stop_process:function(){this.state=3,i.ajax({type:"PUT",timeout:3e4,url:this.bgprocess_url("stop_process"),cache:!1,async:!0,contentType:"application/json"}).done((function(){})).fail((function(){console.warn(arguments)}))},storage_manager:function(){this.current_storage_dir&&r.Events.trigger("pgadmin:tools:storage_manager",this.current_storage_dir)}}),a.extend(r.BackgroundProcessObsorver,{bgprocesses:{},init:function(){var e=this;e.initialized||(e.initialized=!0,setTimeout((function(){e.update_process_list.apply(e)}),1e3),r.Events.on("pgadmin-bgprocess:created",(function(){setTimeout((function(){r.BackgroundProcessObsorver.update_process_list(!0)}),1e3)})))},update_process_list:function(e){var t=this;i.ajax({typs:"GET",timeout:3e4,url:n("bgprocess.list"),cache:!1,async:!0,contentType:"application/json"}).done((function(n){if(n&&a.isArray(n)){for(var i in n){var r=n[i];"id"in r&&(r.id in t.bgprocesses||(t.bgprocesses[r.id]=new d(r)))}e&&0==n.length&&setTimeout((function(){t.update_process_list(!1)}),3e3)}})).fail((function(){console.warn(arguments)}))},create_panel:function(){return this.register_panel(),r.docker.addPanel("bg_process_watcher",l.DOCK.FLOAT,null,{w:screen.width<700?.95*screen.width:.5*screen.width,h:screen.height<500?.95*screen.height:.5*screen.height,x:screen.width<700?"2%":"25%",y:screen.height<500?"2%":"25%"})},register_panel:function(){var e=r.docker.findPanels("bg_process_watcher");e&&e.length>=1||new r.Panel({name:"bg_process_watcher",showTitle:!0,isCloseable:!0,isPrivate:!0,isLayoutMember:!1,content:'<div class="bg-process-details"><div class="bg-detailed-desc"></div><div class="bg-process-stats d-flex py-1"><div class="my-auto mr-2"><span class="fa fa-clock fa-lg" role="img"></span></div><div class="pg-bg-etime my-auto mr-2"><span>'+t("Start time")+': <span class="bgprocess-start-time"></span></span></div><div class="ml-auto bg-btn-section"><button type="button" class="btn btn-danger bg-process-stop" disabled><span class="fa fa-times-circle" role="img"></span>&nbsp;'+t("Stop Process")+'</button></div></div></div><div class="bg-process-watcher"></div><div class="bg-process-footer p-2 d-flex"><div class="bg-process-status flex-grow-1"></div><div class="bg-process-exec-time ml-4 my-auto"><div class="exec-div"><span>'+t("Execution time")+":</span><p></p></div></div></div>",onCreate:function(e,t){t.addClass("pg-no-overflow p-2")}}).load(r.docker)}}),r.BackgroundProcessObsorver}.apply(t,a))||(e.exports=i)},5878:(e,t,n)=>{var a,i;n(74916),n(15306),n(69826),n(32564),n(40561),a=[n(91669),n(81311),n(19755),n(72316),n(55112),n(58894),n(55455),n(71158),n(44092)],void 0===(i=function(e,t,n,a,i,r,o,s,l){if(r.NodeDependencies)return r.NodeDependencies;var d=window.wcDocker;return r.NodeDependencies=r.NodeDependencies||{},t.extend(r.NodeDependencies,{init:function(){if(!this.initialized){this.initialized=!0,this.dependenciesPanel=r.docker.findPanels("dependencies")[0],t.bindAll(this,"showDependencies","__updateCollection","__loadMoreRows","__appendGridToPanel","toggleVisibility");var e=a.Model.extend({defaults:{icon:"icon-unknown",type:void 0,name:void 0,field:void 0},parse:function(e){var n=r.Nodes[e.type];return null!=e.icon&&""!=e.icon||(e.icon=n?t.isFunction(n.node_image)?n.node_image.apply(n,[null,null]):n.node_image||"icon-"+e.type:"icon-"+e.type),e.type=l.titleize(e.type.replace(/_/g," "),!0),e}});this.dependenciesCollection=new(a.Collection.extend({model:e}))(null),this.dependenciesPanel&&this.toggleVisibility(this.dependenciesPanel.isVisible())}},toggleVisibility:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){this.dependenciesPanel=r.docker.findPanels("dependencies")[0];var a=r.tree,i=a.selected(),o=i&&a.itemData(i),s=i&&o&&r.Nodes[o._type];this.showDependencies(i,o,s),r.Events.on("pgadmin-browser:tree:selected",this.showDependencies)}else t&&n(this.dependenciesPanel).data("node-prop",""),r.Events.off("pgadmin-browser:tree:selected",this.showDependencies)},__appendGridToPanel:function(){var t=this.dependenciesPanel.layout().scene().find(".pg-panel-content").find(".pg-panel-dependencies-container"),a=new s.Grid({emptyText:e("No data found"),columns:[{name:"type",label:e("Type"),cell:s.Cell.extend({render:function(){return s.Cell.prototype.render.apply(this,arguments),this.$el.prepend(n("<i>",{class:"wcTabIcon "+this.model.get("icon")})),this}}),editable:!1},{name:"name",label:e("Name"),cell:"string",editable:!1},{name:"field",label:e("field"),cell:"string",editable:!1}],collection:this.dependenciesCollection,className:"backgrid table presentation table-bordered table-noouter-border table-hover"});return this.dependenciesGrid=a,t.empty(),t.append(a.render().el),!0},showDependencies:function(e,t,n){var a=this;n&&(this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout((function(){a.__updateCollection(n.generate_url(e,"dependency",t,!0),n,e,t._type)}),400))},__updateCollection:function(a,s,l,c){var u=this,f=e("Please select an object in the tree view."),p=this.dependenciesPanel,h=p.layout().scene().find(".pg-panel-content"),_=h.find(".pg-panel-depends-message"),g=h.find(".pg-panel-dependencies-container"),m=s.getTreeNodeHierarchy(l);if(s&&(f=e("No dependency information is available for the selected object."),s.hasDepends)){var b={node_type:c,url:a};if(t.isEqual(n(p).data("node-prop"),b))return;n(p).data("node-prop",b),u.__appendGridToPanel(),this.dependenciesGrid.columns.models[2].set({label:e("Restriction")}),_.addClass("d-none"),g.removeClass("d-none");var v="";!function t(){n.ajax({url:a,type:"GET",beforeSend:function(t){t.setRequestHeader(i.csrf_token_header,i.csrf_token),v=setTimeout((function(){_.text(e("Fetching dependency information from the server...")),_.removeClass("d-none"),f=""}),1e3)}}).done((function(e){clearTimeout(v),e.length>0?(_.hasClass("d-none")||_.addClass("d-none"),g.removeClass("d-none"),u.dependenciesData=e,u.dependenciesCollection.reset(u.dependenciesData.splice(0,100),{parse:!0}),r.Events.on("pgadmin-browser:panel-dependencies:"+d.EVENT.SCROLLED,u.__loadMoreRows)):(r.Events.off("pgadmin-browser:panel-dependencies:"+d.EVENT.SCROLLED),u.dependenciesCollection.reset({silent:!0}),_.text(f),_.removeClass("d-none"),g.hasClass("d-none")||g.addClass("d-none"))})).fail((function(n,a,i){var s=m[c].label;r.Events.trigger("pgadmin:node:retrieval:error","depends",n,a,i),o.pgHandleItemError(n,a,i,{item:l,info:m})||o.pgNotifier(a,n,e("Error retrieving data from the server: %s",i||s),(function(e){"CRYPTKEY_SET"===e?t():console.warn(arguments)})),_.text(e("Failed to retrieve data from the server."))}))}()}""!=f&&(_.text(f),_.removeClass("d-none"),g.hasClass("d-none")||g.addClass("d-none"))},__loadMoreRows:function(){if(!(this.dependenciesPanel.length<1)){var e=this.dependenciesPanel.$container.find(".pg-panel-dependencies-container").closest(".wcFrameCenter")[0];e.scrollHeight-10<e.scrollTop+e.offsetHeight&&this.dependenciesData.length>0&&this.dependenciesCollection.add(this.dependenciesData.splice(0,100),{parse:!0})}}}),r.NodeDependencies}.apply(t,a))||(e.exports=i)},24482:(e,t,n)=>{var a,i;n(74916),n(15306),n(69826),n(32564),n(40561),a=[n(91669),n(81311),n(19755),n(72316),n(55112),n(58894),n(55455),n(71158),n(44092)],void 0===(i=function(e,t,n,a,i,r,o,s,l){if(r.NodeDependents)return r.NodeDependents;var d=window.wcDocker;return r.NodeDependents=r.NodeDependents||{},t.extend(r.NodeDependents,{init:function(){if(!this.initialized){this.initialized=!0,this.dependentsPanel=r.docker.findPanels("dependents")[0],t.bindAll(this,"showDependents","__updateCollection","__loadMoreRows","__appendGridToPanel","toggleVisibility");var e=a.Model.extend({defaults:{icon:"icon-unknown",type:void 0,name:void 0,field:void 0},parse:function(e){var n=r.Nodes[e.type];return null!=e.icon&&""!=e.icon||(e.icon=n?t.isFunction(n.node_image)?n.node_image.apply(n,[null,null]):n.node_image||"icon-"+e.type:"icon-"+e.type),e.type=l.titleize(e.type.replace(/_/g," "),!0),e}});this.dependentCollection=new(a.Collection.extend({model:e}))(null),this.dependentsPanel&&this.toggleVisibility(this.dependentsPanel.isVisible())}},toggleVisibility:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){this.dependentsPanel=r.docker.findPanels("dependents")[0];var a=r.tree,i=a.selected(),o=i&&a.itemData(i),s=i&&o&&r.Nodes[o._type];this.showDependents(i,o,s),r.Events.on("pgadmin-browser:tree:selected",this.showDependents)}else t&&n(this.dependentsPanel).data("node-prop",""),r.Events.off("pgadmin-browser:tree:selected",this.showDependents)},__appendGridToPanel:function(){var t=this.dependentsPanel.layout().scene().find(".pg-panel-content").find(".pg-panel-dependents-container"),a=new s.Grid({emptyText:e("No data found"),columns:[{name:"type",label:e("Type"),cell:s.Cell.extend({render:function(){return s.Cell.prototype.render.apply(this,arguments),this.$el.prepend(n("<i>",{class:"wcTabIcon "+this.model.get("icon")})),this}}),editable:!1},{name:"name",label:e("Name"),cell:"string",editable:!1},{name:"field",label:e("field"),cell:"string",editable:!1}],collection:this.dependentCollection,className:"backgrid table presentation table-bordered table-noouter-border table-hover"});return this.dependentGrid=a,t.empty(),t.append(a.render().el),!0},showDependents:function(e,t,n){var a=this;n&&(this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout((function(){a.__updateCollection(n.generate_url(e,"dependent",t,!0),n,e,t._type)}),400))},__updateCollection:function(a,s,l,c){var u=this,f=e("Please select an object in the tree view."),p=this.dependentsPanel,h=p.layout().scene().find(".pg-panel-content"),_=h.find(".pg-panel-depends-message"),g=h.find(".pg-panel-dependents-container"),m=s.getTreeNodeHierarchy(l);if(s&&(f=e("No dependent information is available for the selected object."),s.hasDepends)){var b={node_type:c,url:a};if(t.isEqual(n(p).data("node-prop"),b))return;n(p).data("node-prop",b),this.__appendGridToPanel(),"tablespace"==s.type||"role"==s.type?this.dependentGrid.columns.models[2].set({label:e("Database")}):this.dependentGrid.columns.models[2].set({label:e("Restriction")}),_.addClass("d-none"),g.removeClass("d-none");var v="";!function t(){n.ajax({url:a,type:"GET",beforeSend:function(t){t.setRequestHeader(i.csrf_token_header,i.csrf_token),v=setTimeout((function(){_.text(e("Fetching dependent information from the server...")),_.removeClass("d-none"),f=""}),1e3)}}).done((function(e){clearTimeout(v),e.length>0?(_.hasClass("d-none")||_.addClass("d-none"),g.removeClass("d-none"),u.dependentData=e,u.dependentCollection.reset(u.dependentData.splice(0,100),{parse:!0}),r.Events.on("pgadmin-browser:panel-dependents:"+d.EVENT.SCROLLED,u.__loadMoreRows)):(r.Events.off("pgadmin-browser:panel-dependents:"+d.EVENT.SCROLLED),u.dependentCollection.reset({silent:!0}),_.text(f),_.removeClass("d-none"),g.hasClass("d-none")||g.addClass("d-none"))})).fail((function(n,a,i){var s=m[c].label;r.Events.trigger("pgadmin:node:retrieval:error","depends",n,a,i),o.pgHandleItemError(n,a,i,{item:l,info:m})||o.pgNotifier(a,n,e("Error retrieving data from the server: %s",i||s),(function(e){"CRYPTKEY_SET"===e?t():console.warn(arguments)})),_.text(e("Failed to retrieve data from the server."))}))}()}""!=f&&(_.text(f),_.removeClass("d-none"),g.hasClass("d-none")||g.addClass("d-none"))},__loadMoreRows:function(){if(!(this.dependentsPanel.length<1)){var e=this.dependentsPanel.$container.find(".pg-panel-dependents-container").closest(".wcFrameCenter")[0];e.scrollHeight-10<e.scrollTop+e.offsetHeight&&this.dependentData.length>0&&this.dependentCollection.add(this.dependentData.splice(0,100),{parse:!0})}}}),r.NodeDependents}.apply(t,a))||(e.exports=i)},65894:(e,t,n)=>{var a=n(64492);n(94986),n(26699),n(32023),n(74916),n(23123),n(69826);var i=c(n(91669)),r=c(n(28008)),o=c(n(19755)),s=c(n(55455)),l=c(n(55112)),d=n(48987);function c(e){return e&&e.__esModule?e:{default:e}}e.exports=s.default.dialog("createModeDlg",(function(){return{setup:function(){return{buttons:[{text:(0,i.default)("Cancel"),key:27,className:"btn btn-secondary fa fa-times file_manager_create_cancel pg-alertify-button"},{text:(0,i.default)("Create"),key:13,className:"btn btn-primary fa fa-file file_manager_create file_manager_ok pg-alertify-button disabled"}],options:{closableByDimmer:!1,maximizable:!1,closable:!1,movable:!0,padding:!1,overflow:!1,model:0,resizable:!0,pinnable:!1,modal:!1,autoReset:!1}}},replace_file:function(){var e=(0,o.default)(".replace_file .btn_yes"),t=(0,o.default)(".replace_file .btn_no");(0,o.default)(".storage_dialog #uploader .input-path").attr("disabled",!0),(0,o.default)(".file_manager_ok").addClass("disabled"),(0,o.default)(".replace_file, .fm_dimmer").show(),e.on("click",(function(){(0,o.default)(".replace_file, .fm_dimmer").hide(),e.off(),t.off();var n=(0,o.default)(".storage_dialog #uploader .input-path").val();l.default.Browser.Events.trigger("pgadmin-storage:finish_btn:create_file",n),(0,o.default)(".file_manager_create_cancel").trigger("click"),(0,o.default)(".storage_dialog #uploader .input-path").attr("disabled",!1),(0,o.default)(".file_manager_ok").removeClass("disabled")})),t.on("click",(function(){(0,o.default)(".replace_file, .fm_dimmer").hide(),e.off(),t.off(),(0,o.default)(".storage_dialog #uploader .input-path").attr("disabled",!1),(0,o.default)(".file_manager_ok").removeClass("disabled")}))},is_file_exist:function(){var e=(0,o.default)(".storage_dialog #uploader .input-path").val(),t=e.substr(0,e.lastIndexOf("/")+1),n=e.substr(e.lastIndexOf("/")+1),a=!1,i={path:t,name:n,mode:"is_file_exist"};return o.default.ajax({type:"POST",data:JSON.stringify(i),url:(0,r.default)("file_manager.filemanager",{trans_id:this.trans_id}),dataType:"json",contentType:"application/x-download; charset=utf-8",async:!1}).done((function(e){var t=e.data.result;a=1===t.Code})),a},check_permission:function(e){var t=!1,n={path:e,mode:"permission"};return o.default.ajax({type:"POST",data:JSON.stringify(n),url:(0,r.default)("file_manager.filemanager",{trans_id:this.trans_id}),dataType:"json",contentType:"application/json; charset=utf-8",async:!1}).done((function(e){var n=e.data.result;1===n.Code?t=!0:((0,o.default)(".file_manager_ok").addClass("disabled"),s.default.error(n.Error))})).fail((function(){(0,o.default)(".file_manager_ok").addClass("disabled"),s.default.error((0,i.default)("Error occurred while checking access permission."))})),t},callback:function(e){if(e.cancel=!1,e.button.text==(0,i.default)("Create"))if("refresh_list"!=document.activeElement.id){var t,n=(0,o.default)(".storage_dialog #uploader .input-path").val(),r={path:(0,o.default)(".currentpath").val()},s=(0,o.default)(".allowed_file_types select").val();if(n.includes(".")&&n.split(".").pop()==s||"*"==s||(n=n+"."+s,(0,o.default)(".storage_dialog #uploader .input-path").val(n)),!this.check_permission(n))return void(e.cancel=!0);!a.isUndefined(n)&&""!==n&&this.is_file_exist()?(this.replace_file(),this.$container.find(".replace_file").find(".btn_yes").trigger("focus"),e.cancel=!0):(l.default.Browser.Events.trigger("pgadmin-storage:finish_btn:create_file",n),t=(0,o.default)(this.elements.body).find(".storage_content"),(0,o.default)(t).find("*").off(),t.remove(),(0,d.removeTransId)(this.trans_id)),(0,d.set_last_traversed_dir)(r,this.trans_id)}else e.cancel=!0;else e.button.text==(0,i.default)("Cancel")&&(t=(0,o.default)(this.elements.body).find(".storage_content"),(0,o.default)(t).find("*").off(),t.remove(),(0,d.removeTransId)(this.trans_id),l.default.Browser.Events.trigger("pgadmin-storage:cancel_btn:create_file"))}}}),!1,"fileSelectionDlg")},48987:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.getTransId=function(e){return i.default.ajax({data:e,type:"POST",async:!1,url:(0,a.default)("file_manager.get_trans_id"),dataType:"json",contentType:"application/json; charset=utf-8"})},t.removeTransId=function(e){return i.default.ajax({type:"GET",async:!1,url:(0,a.default)("file_manager.delete_trans_id",{trans_id:e}),dataType:"json",contentType:"application/json; charset=utf-8"})},t.set_last_traversed_dir=function(e,t){return i.default.ajax({url:(0,a.default)("file_manager.save_last_dir",{trans_id:t}),type:"POST",data:JSON.stringify(e),contentType:"application/json"})};var a=r(n(28008)),i=r(n(19755));function r(e){return e&&e.__esModule?e:{default:e}}},62032:(e,t,n)=>{var a=n(64492);n(69826),n(32564);var i=c(n(91669)),r=c(n(28008)),o=c(n(19755)),s=c(n(55455)),l=c(n(55112)),d=n(48987);function c(e){return e&&e.__esModule?e:{default:e}}e.exports=s.default.dialog("fileSelectionDlg",(function(){return{main:function(e){a.isUndefined(e.dialog_title)&&(e.dialog_title=(0,i.default)("Select file")),this.dialog_type=e.dialog_type,this.set("title",e.dialog_title),this.params=JSON.stringify(e),this.show()},settings:{label:void 0},settingUpdated:function(e,t,n){switch(e){case"message":this.setMessage(n);break;case"label":this.__internal.buttons[0].element&&(this.__internal.buttons[0].element.innerHTML=n)}},prepare:function(){var e=this;e.$container.find(".storage_content").remove(),e.$container.append("<div class='storage_content'></div>");var t=e.$container.find(".storage_content");t.empty(),(0,o.default)(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties"),o.default.get((0,r.default)("file_manager.index"),(function(e){t.append(e)}));var n,i=(0,d.getTransId)(e.params);4==i.readyState&&(n=JSON.parse(i.responseText)),e.trans_id=a.isUndefined(n)?0:n.data.fileTransId,setTimeout((function(){(0,o.default)(e.$container.find(".file_manager")).on("enter-key",(function(){(0,o.default)((0,o.default)(e.elements.footer).find(".file_manager_ok")).trigger("click")}))}),200),e.__internal.buttons[1]&&(e.__internal.buttons[1].element.disabled=!0)},setup:function(){return{buttons:[{text:(0,i.default)("Cancel"),key:27,className:"btn btn-secondary fa fa-times pg-alertify-button"},{text:(0,i.default)("Select"),key:13,className:"btn btn-primary fa fa-file file_manager_ok pg-alertify-button disabled"}],options:{closableByDimmer:!1,maximizable:!1,closable:!1,movable:!0,padding:!1,overflow:!1,model:0,resizable:!0,pinnable:!1,modal:!1,autoReset:!1}}},callback:function(e){var t;if(e.cancel=!1,e.button.text==(0,i.default)("Select"))if("refresh_list"!=document.activeElement.id){var n=(0,o.default)(".storage_dialog #uploader .input-path").val(),a={path:(0,o.default)(".currentpath").val()};l.default.Browser.Events.trigger("pgadmin-storage:finish_btn:"+this.dialog_type,n),t=(0,o.default)(this.elements.body).find(".storage_content"),(0,o.default)(t).find("*").off(),t.remove(),(0,d.removeTransId)(this.trans_id),(0,d.set_last_traversed_dir)(a,this.trans_id)}else e.cancel=!0;else e.button.text==(0,i.default)("Cancel")&&(t=(0,o.default)(this.elements.body).find(".storage_content"),(0,o.default)(t).find("*").off(),t.remove(),(0,d.removeTransId)(this.trans_id),l.default.Browser.Events.trigger("pgadmin-storage:cancel_btn:"+this.dialog_type))},build:function(){this.$container=(0,o.default)('<div class="storage_dialog file_selection_dlg"></div>'),this.elements.content.appendChild(this.$container.get(0)),s.default.pgDialogBuild.apply(this)},hooks:{onshow:function(){}}}}))},63867:(e,t,n)=>{var a=r(n(91669)),i=r(n(55455));function r(e){return e&&e.__esModule?e:{default:e}}e.exports=i.default.dialog("fileStorageDlg",(function(){return{settingUpdated:function(e,t,n){"message"==e&&this.setMessage(n)},setup:function(){return{buttons:[{text:(0,a.default)("Cancel"),key:27,className:"btn btn-secondary fa fa-times pg-alertify-button"}],options:{closableByDimmer:!1,maximizable:!1,closable:!1,movable:!0,padding:!1,overflow:!1,model:0,resizable:!0,pinnable:!1,modal:!1,autoReset:!1}}}}}),!0,"fileSelectionDlg")},11769:(e,t,n)=>{var a,i;n(24812),n(32564),a=[n(91669),n(81311),n(19755),n(55112),n(58894),n(55455)],void 0===(i=function(e,t,n,a,i,r){if(i.ShowNodeSQL=i.ShowNodeSQL||{},i.ShowNodeSQL.initialized)return i.ShowNodeSQL;var o=window.wcDocker;return t.extend(i.ShowNodeSQL,{init:function(){var e;this.initialized||(this.initialized=!0,t.bindAll(this,"showSQL","sqlPanelVisibilityChanged"),this.sqlPanels=e=i.docker.findPanels("sql"),i.Events.on("pgadmin-browser:panel-sql:"+o.EVENT.VISIBILITY_CHANGED,this.sqlPanelVisibilityChanged),i.Events.on("pgadmin:browser:node:updated",(function(){this.sqlPanels&&this.sqlPanels.length&&(n(this.sqlPanels[0]).data("node-prop",""),this.sqlPanelVisibilityChanged(this.sqlPanels[0]))}),this),0==e.length?i.Events.on("pgadmin-browser:panel-sql:"+o.EVENT.INIT,function(){(e[0].isVisible()||1!=e.length)&&(i.Events.on("pgadmin-browser:tree:selected",this.showSQL),i.Events.on("pgadmin-browser:tree:refreshing",this.refreshSQL,this))}.bind(this)):(e[0].isVisible()||1!=e.length)&&(i.Events.on("pgadmin-browser:tree:selected",this.showSQL),i.Events.on("pgadmin-browser:tree:refreshing",this.refreshSQL,this)))},refreshSQL:function(e,a,i){var r=this,o={node_type:a._type,url:i.generate_url(e,"sql",a,!0)};t.isEqual(n(r.sqlPanels[0]).data("node-prop"),o)&&(n(r.sqlPanels[0]).data("node-prop",""),r.showSQL(e,a,i))},showSQL:function(o,s,l){this.timeout&&clearTimeout(this.timeout);var d=this;this.timeout=setTimeout((function(){var c="-- "+e("Please select an object in the tree view.");if(l){c="-- "+e("No SQL could be generated for the selected object.");var u=s._type,f=l.generate_url(o,"sql",s,!0),p=l.getTreeNodeHierarchy(o),h={node_type:u,url:f};if(t.isEqual(n(d.sqlPanels[0]).data("node-prop"),h))return;if(n(d.sqlPanels[0]).data("node-prop",h),l.hasSQL){var _;c="";!function t(){n.ajax({url:f,type:"GET",beforeSend:function(t){t.setRequestHeader(a.csrf_token_header,a.csrf_token),_=setTimeout((function(){a.Browser.editor.setValue(e("Retrieving data from the server..."))}),1e3)}}).done((function(e){a.Browser.editor.getValue()!=e&&a.Browser.editor.setValue(e),clearTimeout(_)})).fail((function(n,a,s){var l=p[u].label;i.Events.trigger("pgadmin:node:retrieval:error","sql",n,a,s,o),r.pgHandleItemError(n,a,s,{item:o,info:p})||r.pgNotifier(a,n,e("Error retrieving the information - %s",s||l),(function(e){"CRYPTKEY_SET"===e?t():console.warn(arguments)}))}))}()}}""!=c&&a.Browser.editor.setValue(c)}),400)},sqlPanelVisibilityChanged:function(e){if(e.isVisible()){var t=i.tree,n=t.selected(),a=n&&t.itemData(n),r=n&&a&&i.Nodes[a._type];i.ShowNodeSQL.showSQL.apply(i.ShowNodeSQL,[n,a,r]),i.Events.on("pgadmin-browser:tree:selected",i.ShowNodeSQL.showSQL),i.Events.on("pgadmin-browser:tree:refreshing",i.ShowNodeSQL.refreshSQL,this)}else i.Events.off("pgadmin-browser:tree:selected",i.ShowNodeSQL.showSQL),i.Events.off("pgadmin-browser:tree:refreshing",i.ShowNodeSQL.refreshSQL,this)}}),i.ShowNodeSQL}.apply(t,a))||(e.exports=i)},50654:(e,t,n)=>{var a,i;e=n.nmd(e),n(74916),n(23123),n(92222),n(47042),n(69600),n(69826),n(66992),n(41539),n(33948),n(23157),n(5735),n(83753),n(68309),n(91058),n(32564),n(89554),n(83710),n(39714),n(57327),a=[n(28008),n(19755),n(81311),n(55112),n(72316),n(24511),n(4317),n(41081),n(91669),n(43734)],void 0===(i=function(e,t,a,i,r,o,s,l,d){i=i||window.pgAdmin||{},s=s.default;var c=null;if(i.Explain)return i.Explain;var u=i.Explain={prefix:e("misc.index")+"static/explain/img/"},f=100,p=100,h=10,_="15px",g=25,m=25,b=.01,v=.05,y=a.template(['<tr<% if (className) {%> class="<%=className%>"<%}%>>',' <td class="renderable name"><%- data.name %></td>',' <td class="renderable text-right"><%- data.count %></td>',' <td class="renderable timings d-none text-right">',"<%=Math.ceil10(data.sum_of_times, -3)%> ms","</td>",' <td class="renderable timings d-none text-right">',"<%=Math.ceil10(((data.sum_of_times||0)/(total_time||1)) * 100, -2)%>%","</td>","</tr>"].join("")),w=a.template(['<tr class="pga-ex-row','<% if (data["Plans"] && data["Plans"].length > 0) {%>'," pga-ex-collapsible","<%}%>",'<% if (data["exclusive_flag"] !== "undefined") {%>'," pga-ex-exclusive-",'<%- data["exclusive_flag"] %>',"<%}%>",'<% if (data["inclusive_flag"] !== "undefined") {%>'," pga-ex-inclusive-",'<%- data["inclusive_flag"] %>',"<%}%>",'<% if (data["rowsx_flag"] !== "undefined") {%>'," pga-ex-rowsx-",'<%- data["rowsx_flag"] %>',"<%}%>",'"','<% if (data["parent_node"]) {%>',' data-parent="pga_ex_<%= data["parent_node"] %>"',"<%}%>",' data-ex-id="pga_ex_<%= data["level"].join("_") %>">',' <td class="renderable pg-ex-highlighter clickable">','  <i class="fa fa-circle invisible"></i>',"</td>",' <td class="renderable clickable serial text-right">','<%= (data["_serial"]) %>.</td>',' <td class="renderable clickable" style="padding-left: ','<%= (data["level"].length) * 30%>px"','title="<%= tooltip_text %>"',">",'  <i class="pg-ex-subplans fa fa-long-arrow-alt-right"></i>',"<%= display_text %>","<%if (node_extra_info && node_extra_info.length > 0 ) {%>","<ui>","<%  for (var node_info_idx=0; "," node_info_idx<node_extra_info.length;node_info_idx++) {%>"," <li>","<%= node_extra_info[node_info_idx] %>","</li>","<% }%>","</ui>","<%}%>"," </td>",' <td class="renderable timings d-none text-right ','<% if (data["exclusive_flag"] !== "undefined") {%>',"pga-ex-exclusive-",'<%- data["exclusive_flag"] %>',"<%}%>",'">','<% if (typeof(data["exclusive"]) !== "undefined") {%>','<%= data["exclusive"] %> ms',"<%}%>"," </td>",' <td class="renderable timings d-none text-right ','<% if (data["inclusive_flag"] !== "undefined") {%>',"pga-ex-inclusive-",'<%- data["inclusive_flag"] %>',"<%}%>",'">','<% if (typeof(data["inclusive"]) !== "undefined") {%>','<%= data["inclusive"] %> ms',"<%}%>"," </td>",' <td class="renderable rowsx d-none text-right ','<% if (data["rowsx_flag"] !== "undefined") {%>',"pga-ex-rowsx-",'<%- data["rowsx_flag"] %>',"<%}%>",'">','<% if (data["rowsx_direction"] === "positive") {%>',"&uarr;","<%} else {%>","&darr;","<%}%> ",'<% if (typeof(data["rowsx"]) !== "undefined") {%>','<%- data["rowsx"] %>',"<%}%>  "," </td>",' <td class="renderable rowsx rows d-none text-right">','<% if (typeof(data["Actual Rows"]) !== "undefined") {%>','<%= data["Actual Rows"] %>',"<%}%>"," </td>",' <td class="renderable rowsx plan_rows d-none text-right">','<%= data["Plan Rows"] %>'," </td>",' <td class="renderable rows rowsx d-none text-right">','<% if (typeof(data["Actual Loops"]) !== "undefined") {%>','<%= data["Actual Loops"] %>',"<%}%>"," </td>",' <td class="renderable d-none">','  <i class="fa fa-ellipsis-h"></i>'," </td>","</tr>"].join("")),x=r.Model.extend({defaults:{Plans:[],level:[],image:void 0,image_text:void 0,xpos:void 0,ypos:void 0,width:f,height:p},_createSame:function(){return new x},parse:function(e,t){var n=1,i=e.level=e.level||[n],r=[],o=e["Node Type"],s=e.xpos=e.xpos-f,d=e.ypos,c=0;t.ctx.totalNodes++,t.ctx._explainTable.total_time=e.total_time||e["Actual Total Time"],e._serial=t.ctx.totalNodes,e.width=f,e.height=p,"SubPlan"===e["Parent Relationship"]&&(e.width+=62.5,e.height+=50,e.ypos+=m,s-=g,d+=m),o.startsWith("(slice")&&(o=o.substring(0,7));var u=l.default,h=a.isFunction(u[o])&&u[o].apply(void 0,[e])||u[o]||{image:"ex_unknown.svg",image_text:o};if(e.image=h.image,e.image_text=h.image_text,"Actual Total Time"in e&&"Actual Loops"in e&&(e.inclusive=Math.ceil10(e["Actual Total Time"]*e["Actual Loops"],-3),e.exclusive=e.inclusive,e.inclusive_factor=e.inclusive/(e.total_time||e["Actual Total Time"]),e.inclusive_flag=e.inclusive_factor<=.1?"1":e.inclusive_factor<.5?"2":e.inclusive_factor<=.9?"3":"4"),"Actual Rows"in e&&"Plan Rows"in e&&(0===e["Actual Rows"]||e["Actual Rows"]>e["Plan Rows"]?(e.rowsx=0===e["Plan Rows"]?0:e["Actual Rows"]/e["Plan Rows"],e.rowsx_direction="negative"):(e.rowsx=0===e["Actual Rows"]?0:e["Plan Rows"]/e["Actual Rows"],e.rowsx_direction="positive"),e.rowsx_flag=e.rowsx<=10?"1":e.rowsx<=100?"2":e.rowsx<=1e3?"3":"4",e.rowsx=Math.ceil10(e.rowsx,-2)),"Plans"in e){var _,b=this;e.width+=200,a.each(e.Plans,(function(o){var l=a.clone(i),u=b._createSame();l.push(n),u.set(u.parse(a.extend(o,{level:l,xpos:s-200,ypos:d,total_time:e.total_time||e["Actual Total Time"],parent_node:i.join("_")}),t)),c<u.get("width")&&(c=u.get("width")),"exclusive"in e&&(_=u.get("inclusive"))&&(e.exclusive-=_);var f=u.get("height");1!==n?e.height=e.height+f+60:f>e.height&&(e.height=f),d+=f+60,r.push(u),n++}))}return"exclusive"in e&&(e.exclusive=Math.ceil10(e.exclusive,-3),e.exclusive_factor=e.exclusive/(e.total_time||e["Actual Total Time"]),e.exclusive_flag=e.exclusive_factor<=.1?"1":e.exclusive_factor<.5?"2":e.exclusive_factor<=.9?"3":"4"),e.width+=c,e.Plans=r,e},getLabel:function(){return null==this.get("Schema")?this.get("image_text"):this.get("Schema")+"."+this.get("image_text")},draw:function(e,t,n,i,r,o,s,l){var c=e.g(),b=t+this.get("xpos"),v=n+this.get("ypos"),y="SubPlan"===this.get("Parent Relationship"),x=this.toJSON(),C=getComputedStyle(document.documentElement).getPropertyValue("--color-fg");!function(e,t){var n,i,r=['<span class="pg-explain-text-name">'],o=[],s=[],l=t._explainTable;if(/Scan/.test(e["Node Type"])?(r.push(e["Node Type"]),o.push(e["Node Type"])):(r.push(e.image_text),o.push(e.image_text)),n=o.join(""),r.push("</span>"),void 0!==e["Index Name"]&&(r.push(" using "),o.push(" using "),r.push('<span class="pg-explain-text-name">'),r.push(a.escape(e["Index Name"])),o.push(e["Index Name"]),r.push("</span>")),void 0!==e["Relation Name"]&&(r.push(" on "),o.push(" on "),void 0!==e.Schema&&(r.push('<span class="pg-explain-text-name">'),r.push(a.escape(e.Schema)),o.push(e.Schema),r.push("</span>"),r.push("."),o.push(".")),r.push('<span class="pg-explain-text-name">'),r.push(a.escape(e["Relation Name"])),o.push(e["Relation Name"]),r.push("</span>"),void 0!==e.Alias&&(r.push(" as "),o.push(" as "),r.push('<span class="pg-explain-text-name">'),r.push(a.escape(e.Alias)),o.push(a.escape(e.Alias)),r.push("</span>"))),void 0!==e["Plan Rows"]&&void 0!==e["Plan Width"]){var c=[" (cost=",void 0!==e["Startup Cost"]?e["Startup Cost"]:"","..",void 0!==e["Total Cost"]?e["Total Cost"]:""," rows=",e["Plan Rows"]," width=",e["Plan Width"],")"].join("");r.push(c),o.push(c)}if(void 0!==e["Actual Startup Time"]||void 0!==e["Actual Total Time"]||void 0!==e["Actual Rows"]){var u=[" (",void 0!==e["Actual Startup Time"]?"actual="+e["Actual Startup Time"]+"..":"",void 0!==e["Actual Total Time"]?e["Actual Total Time"]+" ":"",void 0!==e["Actual Rows"]?"rows="+e["Actual Rows"]:"",void 0!==e["Actual Loops"]?" loops="+e["Actual Loops"]:"",")"].join("");r.push(u),o.push(u)}if("Join Filter"in e&&s.push("<strong>"+d("Join Filter")+"</strong>: "+a.escape(e["Join Filter"])),"Filter"in e&&s.push("<strong>"+d("Filter")+"</strong>: "+a.escape(e.Filter)),"Index Cond"in e&&s.push("<strong>"+d("Index Cond")+"</strong>: "+a.escape(e["Index Cond"])),"Hash Cond"in e&&s.push("<strong>"+d("Hash Cond")+"</strong>: "+a.escape(e["Hash Cond"])),"Rows Removed by Filter"in e&&s.push("<strong>"+d("Rows Removed by Filter")+"</strong>: "+a.escape(e["Rows Removed by Filter"])),"Peak Memory Usage"in e){var f=["<strong>"+d("Buckets")+"</strong>:",a.escape(e["Hash Buckets"]),"<strong>"+d("Batches")+"</strong>:",a.escape(e["Hash Batches"]),"<strong>"+d("Memory Usage")+"</strong>:",a.escape(e["Peak Memory Usage"]),"kB"].join(" ");s.push(f)}if("Recheck Cond"in e&&s.push("<strong>"+d("Recheck Cond")+"</strong>: "+e["Recheck Cond"]),"Exact Heap Blocks"in e&&s.push("<strong>"+d("Heap Blocks")+"</strong>: exact="+e["Exact Heap Blocks"]),l.rows.push(w({data:e,display_text:r.join(""),tooltip_text:o.join(""),node_extra_info:s})),void 0!==e.exclusive_flag&&(l.show_timings=!0),void 0!==e.rowsx_flag&&(l.show_rowsx=!0),void 0!==e["Actual Loops"]&&(l.show_rows=!0),void 0!==e["Plan Rows"]&&(l.show_plan_rows=!0),void 0!==e.total_time&&(l.total_time=e.total_time),void 0!==e["Relation Name"]){var p=(void 0!==e.Schema?e.Schema+".":"")+e["Relation Name"],h=l.statistics.tables[p]||{name:p,count:0,sum_of_times:0,nodes:{}};i=h.nodes[n]||{name:n,count:0,sum_of_times:0},h.count++,h.sum_of_times+=e.exclusive,i.count++,i.sum_of_times+=e.exclusive,h.nodes[n]=i,l.statistics.tables[p]=h}(i=l.statistics.nodes[n]||{name:n,count:0,sum_of_times:0}).count++,i.sum_of_times+=e.exclusive,l.statistics.nodes[n]=i}(x,l),y&&(c.rect(b-this.get("width")+f+g,v-this.get("height")+p+m-5,this.get("width")-g,this.get("height")+(v-m),5).attr({stroke:"#444444",strokeWidth:1.2,fill:"gray",fillOpacity:.2}),c.text(b+f-this.get("width")/2-g,v+p-this.get("height")/2-m,this.get("Subplan Name")).attr({fontSize:_,"text-anchor":"start",fill:"red"})),this._drawImage(e,c,u.prefix+this.get("image"),b,v,o,s,l);var S=this.getLabel();if(c.multitext(b+50+5,v+p-5,S,150,{"font-size":_,"text-anchor":"middle",fill:C}),!a.isUndefined(r)){var k=b+f,E=v+50,T=i-h,O=r+50,P=this.get("Startup Cost"),q=this.get("Total Cost"),D=2;null!=P&&null!=q&&(D=(D=Math.round(Math.log((P+q)/2+P)))<1?1:D>10?10:D);var N={stroke:C,strokeWidth:D+2},j={stroke:C,strokeWidth:D+2},M={viewBox:[0,0,20,20].join(" "),fill:C};this.drawPolyLine(c,k,E,T,O,y?j:N,M)}var A=this.get("Plans");a.each(A,(function(a){a.draw(e,t,n,b,v,o,s,l)}))},_drawImage:function(e,t,n,a,i,r,o){this.drawImage(t,n,a,i,r,o)},toJSON:function(e){var t=r.Model.prototype.toJSON.apply(this,arguments);if(e)delete t.Plans;else{var n=[];a.each(t.Plans,(function(e){n.push(e.toJSON())})),t.Plans=n}return t},drawPolyLine:function(e,t,n,a,i,r,o){var s=t+(a-t)/3,l=t+(a-t)/3*2,d=e.polygon([0,10,5,10,2.5,0,0,h]).transform("r90").marker(0,0,h,10,0,5).attr(o);e.line(t,n,s,n).attr(r),e.line(s-1,n,l,i).attr(r),e.line(l,i,a,i).attr(r).attr({markerEnd:d})},drawImage:function(e,n,i,r,o,s){var l=e.image(n,i+25,r+25,50,50);l.attr({style:"cursor: pointer",class:"image-node"});var d=this.toJSON(),c=this.getLabel();l.click((function(){var e=s.find(".details-body");s.find(".details-title").text(c),e.empty(),l.node.textContent="";var n=t("\n          <table class='pgadmin-tooltip-table table table-bordered table-noouter-border table-bottom-border table-hover'>\n            <tbody></tbody>\n          </table>").appendTo(e).find("tbody");a.each(d,(function(e,t){"image"!==t&&"Plans"!==t&&"level"!==t&&"image"!==t&&"image_text"!==t&&"xpos"!==t&&"ypos"!==t&&"width"!==t&&"height"!==t&&(t=a.escape(t),e=a.escape(e),n.append('\n              <tr>\n                <td class="label explain-tooltip">'.concat(t,'</td>\n                <td class="label explain-tooltip-val">').concat(e,"</td>\n              </tr>\n            ")))})),s.removeClass("d-none"),e.scrollTop(0)}))}}),C=x.extend({_createSame:function(){return new C({parse:!0})},_drawImage:function(e,t,n,a,r,o,s,l){var d=i.Browser.get_browser();if("IE"===d.name||"Safari"===d.name&&parseInt(d.version)<10)this.drawImage(t,n,a,r,o,s);else{var f=this,p=u.prefix+this.get("image");c.load(p,(function(n){var i=c();i.append(n),f.drawImage(t,i.toDataURL(),a,r,o,s),e.parent().attr({"xmlns:xlink":"http://www.w3.org/1999/xlink"}),setTimeout((function(){l._onImageDownloaded()}),100)}))}}}),S=r.Model.extend({defaults:{Plan:void 0,xpos:0,ypos:0},initialize:function(){this.set("Plan",new x),this.set("Statistics",new o)},parse:function(e,t){if(e&&"Plan"in e){var n=this.get("Plan");n.set(n.parse(a.extend(e.Plan,{xpos:0,ypos:0}),t)),e.xpos=0,e.ypos=0,e.width=n.get("width")+50,e.height=n.get("height")+100,delete e.Plan}var i=this.get("Statistics");if(e&&"JIT"in e&&(i.set("JIT",e.JIT),delete e.JIT),e&&"Triggers"in e&&(i.set("Triggers",e.Triggers),delete e.Triggers),e){var r={};["Planning Time","Execution Time"].forEach((function(t){t in e&&(r[t]=e[t])})),i.set("Summary",r)}return e&&"Settings"in e&&(i.set("Settings",e.Settings),delete e.Settings),e},toJSON:function(){var e=r.Model.prototype.toJSON.apply(this,arguments);return e.Plan&&(e.Plan=e.Plan.toJSON()),e},draw:function(e,t,n,a,i,r){var o=e.g(),s=getComputedStyle(document.documentElement).getPropertyValue("--color-bg");o.rect(0,0,this.get("width")-10,this.get("height")-10,5).attr({fill:s}),this.get("Plan").draw(o,t,n,void 0,void 0,a,i,r),this.get("Statistics").set_statistics(i)}}),k=function e(){var n=e.cnt=(e.cnt||0)+1,a=function(e,t,a,i){return['   <li class="nav-item" role="presentation">','    <a class="nav-link ',i?"active":"",'"','       data-toggle="tab" tabindex="0"','       data-tab-index="'.concat(e,'"'),'       aria-selected="',i?"true":"false",'"','       role="tab" data-explain-role="'.concat(t,'"'),'       href="#pga_explain_'.concat(t,"_").concat(n,'"'),'       aria-controls="pga_explain_'.concat(t,"_").concat(n,'"'),'       id="pgah_explain_'.concat(t,"_").concat(n,'"> '),a,"</a>","</li>"].join("")},i=function(e,t,a){return['   <div role="tabpanel" tabindex="0" class="tab-pane pg-el-sm-12',"        pg-el-md-12 pg-el-lg-12 pg-el-12 fade collapse",t?" active show":""," ".concat(a,'"'),'        data-explain-tabpanel="'.concat(e,'"'),'        id="pga_explain_'.concat(e,"_").concat(n,'"'),'        aria-labelledby="pgah_explain_'.concat(e,"_").concat(n,'">'),"   </div>"].join("")};return t(['<div class="obj_properties container-fluid">',' <div tabindex="1" class="backform-tab pg-el-12" role="tabpanel">','  <ul class="nav nav-tabs" role="tablist">',"   </li>",'   <li class="nav-item" role="presentation">',a(1,"graphical",d("Graphical"),!0),a(2,"table",d("Analysis"),!1),a(3,"statistics",d("Statistics"),!1),"  </ul>",'  <div class="tab-content pg-el-sm-12 pg-el-12">',i("graphical",!0,"w-100 h-100 p-0"),i("table",!1,"p-0"),i("statistics",!1,""),"   </div>","  </div>"," </div>","</div>"].join(""))};return a.extend(u,{DrawJSONPlan:function(e,t,a,i){var r=this;n.e(92).then(function(o){var s=n(21223);(c=s).plugin((function(e,t,n){n.prototype.multitext=function(t,n,a,i,r){var o=e(),s="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",l=o.text(0,0,s);l.attr(r);var d=l.getBBox().width/s.length,c=Math.round(i/d)-1;o.remove();for(var u=a.split(" "),f=0,p=[],h="",_=function e(t,n,a){var r=a.length,o=[];return 0==r||(n&&n+r*d>i?(o.push(t),o=o.concat(e("",0,a))):n?o.push(t+" "+a):(t&&o.push(t),a.length>c+1?o.push(a.slice(0,c)+"-"):o.push(a),o=o.concat(e("",0,a.slice(c))))),o},g=0;g<u.length;g++){var m=_(h,f,u[g]);h&&(p=p.slice(0,p.length-1)),f=(h=(p=p.concat(m))[p.length-1]).length*d}var b=this.text(t,n,p).attr(r);return b.selectAll("tspan:nth-child(n+2)").attr({dy:"1.2em",x:t}),b}})),r.goForDraw(e,t,a,i)}.bind(null,n)).catch((function(e){throw e}))},goForDraw:function(e,n,r,l){var f=a.extend(l||{},{totalNodes:0,totalDownloadedNodes:0,isDownloaded:0});e.empty().attr("el","sm").addClass("pg-no-overflow pg-el-container");var p=k(),h=t(['<table class="backgrid table presentation table-bordered ','       table-noouter-border table-hover">'," <thead>","  <tr>",'    <th class="renderable pga-ex-collapsible" rowspan="2"></th>','    <th class="renderable" rowspan="2"><button disabled>',d("#"),"</button></th>",'    <th class="renderable" rowspan="2"><button disabled>',d("Node"),"</button></th>",'    <th class="renderable timings d-none" colspan="2"><button disabled>',d("Timings"),"</button></th>",'    <th class="renderable rowsx rows plan_rows d-none" colspan="3">',"<button disabled>",d("Rows"),"</button></th>",'    <th class="renderable rows rowsx d-none" rowspan="2">',"<button disabled>",d("Loops"),"</button></th>",'    <th class="renderable d-none" rowspan="2"><button disabled>',"  </tr>","  <tr>",'    <th class="renderable timings d-none"><button disabled>',d("Exclusive"),"</button></th>",'    <th class="renderable timings d-none"><button disabled>',d("Inclusive"),"</button></th>",'    <th class="renderable rowsx d-none"><button disabled>',d("Rows X"),"</button></th>",'    <th class="renderable rows rowsx d-none"><button disabled>',d("Actual"),"</button></th>",'    <th class="renderable plan_rows rowsx d-none"><button disabled>',d("Plan"),"</button></th>","  </tr>"," </thead>","</table>"].join("")),_=t(['<div class="row row-eq-height">',' <div class="col-sm-6 col-xs-6">','  <div class="col-xs-12 badge">',d("Statistics per Node Type"),"  </div>",'  <table class="backgrid table presentation table-bordered ','         table-hover" for="per_node_type">',"   <thead>","    <tr>",'      <th class="renderable"><button disabled>',d("Node type"),"</button></th>",'      <th class="renderable"><button disabled>',d("Count"),"</button></th>",'      <th class="renderable timings d-none"><button disabled>',d("Time spent"),"</button></th>",'      <th class="renderable timings d-none"><button disabled>',"% ",d("of query"),"</button></th>","    </tr>","   </thead>","  </table>"," </div>",' <div class="col-sm-6 col-xs-6">','  <div class="col-xs-12 badge">',d("Statistics per Relation"),"  </div>",'  <table class="backgrid table presentation table-bordered ','         table-hover" for="per_table">',"   <thead>","    <tr>",'      <th class="renderable"><button disabled>',d("Relation name"),"</button></th>",'      <th class="renderable"><button disabled>',d("Scan count"),"</button></th>",'      <th class="renderable timings d-none"><button disabled>',d("Total time"),"</button></th>",'      <th class="renderable timings d-none"><button disabled>',"% ",d("of query"),"</button></th>","    </tr>","    <tr>",'      <th class="renderable"><button disabled>',d("Node type"),"</button></th>",'      <th class="renderable"><button disabled>',d("Count"),"</button></th>",'      <th class="renderable timings d-none"><button disabled>',d("Sum of times"),"</button></th>",'      <th class="renderable timings d-none"><button disabled>',"% ",d("of relation"),"</button></th>","    </tr>","   </thead>","  </table>"," </div>","</div>"].join("")),w=p.find("[data-explain-tabpanel=graphical]"),x=p.find("[data-explain-tabpanel=table]");f.currentTab=e.find(".nav-link[aria-selected=true]").attr("data-explain-role"),p.appendTo(e),h.appendTo(x),_.appendTo(p.find("[data-explain-tabpanel=statistics]"));var E=t.extend(!0,[],n),T=1,O=t("<div></div>",{class:"pg-explain-zoom-area btn-group btn-group-sm",role:"group"}).appendTo(w),P=t("<button></button>",{class:"btn btn-primary-icon pg-explain-zoom-btn",title:d("Zoom in"),"aria-label":d("Zoom in"),tabindex:0}).appendTo(O).append(t("<i></i>",{class:"fa fa-search-plus"})),q=t("<button></button>",{class:"btn btn-primary-icon pg-explain-zoom-btn",title:d("Zoom to original"),"aria-label":d("Zoom to original"),tabindex:0}).appendTo(O).append(t("<i></i>",{class:"fa fa-arrows-alt"})),D=t("<button></button>",{class:"btn btn-primary-icon pg-explain-zoom-btn",title:d("Zoom out"),"aria-label":d("Zoom out"),tabindex:0}).appendTo(O).append(t("<i></i>",{class:"fa fa-search-minus"})),N=t("<div></div>",{class:"pg-explain-download-area btn-group btn-group-sm",role:"group"}).appendTo(w),j=t("<button></button>",{id:"btn-explain-download",class:"btn btn-primary-icon pg-explain-download-btn",title:d("Download"),"aria-label":d("Download"),tabindex:0,disabled:function(){var e=i.Browser.get_browser();return"IE"===e.name?(this.title="Not supported for Internet Explorer",!0):"Safari"===e.name&&parseInt(e.version)<10&&(this.title="Not supported for Safari version less than 10.1",!0)}}).appendTo(N).append(t("<i></i>",{class:"fa fa-download"})),M=t("<div></div>",{class:"pg-explain-stats-area btn-group btn-group-sm d-none",role:"group"}).appendTo(w);t("<button></button>",{id:"btn-explain-stats",class:"btn btn-primary-icon pg-explain-stats-btn",title:d("Statistics"),"aria-label":d("Statistics"),tabindex:0}).appendTo(M).append(t("<i></i>",{class:"fa fa-chart-line"}));var A=t("<div></div>",{class:"pgadmin-explain-container w-100 h-100 overflow-auto"}).appendTo(w);A.data("zoom-factor",T);var R=t('<div class="pgadmin-explain-details card d-none" data-bs-backdrop="false" tabindex="-1" aria-hidden="true">\n        <div class="card-header details-header d-flex">\n          <div class="details-title my-auto"></div>\n          <div class="ml-auto"><button class="btn btn-sm fa fa-times ml-auto details-close"/></div>\n        </div>\n        <div class="card-body details-body"></div>\n       </div>').appendTo(w);R.find(".details-close").on("click",(function(){R.addClass("d-none")}));var I,L,B,V=0,U=m;f._explainTable={rows:[],statistics:{tables:{},nodes:{}}},f._onImageDownloaded=function(){if(f.totalDownloadedNodes++,!f.isDownloaded&&f.totalNodes===f.totalDownloadedNodes){f.isDownloaded=!0;var e=c("#".concat(w.attr("id")," .pgadmin-explain-container svg")),t="explain_plan_"+(new Date).getTime()+".svg";s.downloadSVG(e.toString(),t)}},a.each(n,(function(n){var a;r?a=new(S.extend({initialize:function(){this.set("Plan",new C({parse:!0})),this.set("Statistics",new o)}}))({parse:!0}):a=new S;a.set(a.parse(n,{ctx:f})),V=a.get("width"),U=a.get("height");var i=c(V,U),l=t(i.node).detach();A.append(l),a.draw(i,V-g,m,A,R,f);var p=A.width();if(p<V){T=(T=(T=p/V)<b?b:T)>1?1:T;var h=new c.matrix;h.scale(T,T),l.find("g").first().attr({transform:h}),l.attr({width:V*T,height:U*T}),A.data("zoom-factor",T)}P.on("click",(function(){T=T+v>2?2:T+v;var e=new c.matrix;e.scale(T,T),l.find("g").first().attr({transform:e}),l.attr({width:V*T,height:U*T}),A.data("zoom-factor",T)})),D.on("click",(function(){T=T-v<b?b:T-v;var e=new c.matrix;e.scale(T,T),l.find("g").first().attr({transform:e}),l.attr({width:V*T,height:U*T}),A.data("zoom-factor",T)})),q.on("click",(function(){T=1;var e=new c.matrix;e.scale(T,T),l.find("g").first().attr({transform:e}),l.attr({width:V*T,height:U*T}),A.data("zoom-factor",T)})),j.on("click",(function(){u.DrawJSONPlan(e,E,!0),A.on("explain:svg:downloaded",(function(){if(f.totalDownloadedNodes++,!f.isDownloaded&&f.totalNodes===f.totalDownloadedNodes){f.isDownloaded=!0,i=c(".pgadmin-explain-container svg");var e="explain_plan_"+(new Date).getTime()+".svg";s.downloadSVG(i.toString(),e)}}))})),e.find(".image-node").tooltip({title:d("Click for details..."),template:'<div class="tooltip" role="tooltip"><div class="arrow d-none"></div><div class="tooltip-inner"></div></div>'})})),I=f._explainTable,L=h,B=t("<tbody></tbody>"),a.each(I.rows,(function(e){t(e).appendTo(B)})),B.appendTo(L),!0===I.show_timings&&L.find(".timings").removeClass("d-none"),!0===I.show_rowsx?L.find(".rowsx").removeClass("d-none"):!0===I.show_rows?(L.find(".rows").removeClass("d-none"),L.find("thead .rows[colspan=3]").attr("colspan",1)):!0===I.show_plan_rows&&(L.find(".plan_rows").removeClass("d-none"),L.find("thead .rows[colspan=3]").attr("colspan",1)),function(e,t){var n=t.find('table[for="per_table"]'),i=t.find('table[for="per_node_type"]');a.each(a.sortBy(a.values(e.statistics.nodes),"name"),(function(t){return i.append(y({data:t,total_time:e.total_time,className:""}))})),a.each(a.sortBy(a.values(e.statistics.tables),"name"),(function(t){t.sum_of_times=0,a.each(t.nodes,(function(e){return t.sum_of_times+=e.sum_of_times})),n.append(y({data:t,total_time:e.total_time,className:"table"})),a.each(a.sortBy(a.values(t.nodes),"name"),(function(e){n.append(y({data:e,total_time:t.sum_of_times,className:"node"}))}))})),e.show_timings&&t.find(".timings").removeClass("d-none")}(f._explainTable,_),e.on("shown.bs.tab",(function(){f.currentTab=e.find(".nav-link[aria-selected=true]").attr("data-explain-role")}))}}),t(document).on("mouseenter",".pga-ex-row.pga-ex-collapsible",(function(e){var n=t(e.currentTarget);n.parent().find("[data-parent="+n.attr("data-ex-id")+"] > td.pg-ex-highlighter > i").removeClass("invisible")})).on("mouseleave",".pga-ex-row.pga-ex-collapsible",(function(e){var n=t(e.currentTarget);n.parent().find(".pga-ex-row[data-parent="+n.attr("data-ex-id")+"] > td.pg-ex-highlighter > i").addClass("invisible")})).on("click",".pga-ex-row.pga-ex-collapsible",(function(e){var n=t(e.currentTarget);"true"===n.attr("data-collapsed")?(n.parent().find(".pga-ex-row[data-parent^="+n.attr("data-ex-id")+"]").removeClass("d-none").filter("[data-collapsed=true]").each((function(e,n){var a=t(n);a.parent().find(".pga-ex-row[data-parent^="+a.attr("data-ex-id")+"]").addClass("d-none")})),n.attr("data-collapsed","false")):(n.parent().find(".pga-ex-row[data-parent^="+n.attr("data-ex-id")+"]").addClass("d-none"),n.attr("data-collapsed","true"))})),u}.apply(t,a))||(e.exports=i)},24511:(e,t,n)=>{var a=n(64492);n(47941),n(69826),n(92222);var i=s(n(19755)),r=s(n(72316)),o=s(n(91669));function s(e){return e&&e.__esModule?e:{default:e}}var l=r.default.Model.extend({defaults:{JIT:[],Triggers:[],Summary:{}},set_statistics:function(e){var t=this.get("JIT"),n=this.get("Triggers"),r=this.get("Summary");(Object.keys(t).length>0||Object.keys(n).length>0||Object.keys(r).length>0)&&(0,i.default)(".pg-explain-stats-area").removeClass("d-none");var s=(0,i.default)("\n      <table class='pgadmin-tooltip-table table table-bordered table-noouter-border table-bottom-border table-hover'>\n        <tbody></tbody>\n      </table>"),l=s.find("tbody");Object.keys(t).length>0&&(l.append('<tr><td colspan="2" class="label explain-tooltip">'+(0,o.default)("JIT:")+"</td></tr>"),a.each(t,(function(e,t){t=a.escape(t),e=a.escape(e),l.append('\n          <tr>\n            <td class="label explain-tooltip">  '.concat(t,'</td>\n            <td class="label explain-tooltip-val">').concat(e,"</td>\n          </tr>\n        "))}))),Object.keys(n).length>0&&(l.append('<tr><td colspan="2" class="label explain-tooltip">'+(0,o.default)("Triggers:")+"</td></tr>"),a.each(n,(function(e,t){e instanceof Object?a.each(e,(function(e,t){"Trigger Name"===t?(t=a.escape(t),e=a.escape(e),l.append('\n                <tr>\n                  <td class="label explain-tooltip">  '.concat(t,'</td>\n                  <td class="label explain-tooltip-val">').concat(e,"</td>\n                </tr>\n              "))):(t=a.escape(t),e=a.escape(e),l.append('\n                <tr>\n                  <td class="label explain-tooltip">    '.concat(t,'</td>\n                  <td class="label explain-tooltip-val">').concat(e,"</td>\n                </tr>\n              ")))})):(t=a.escape(t),e=a.escape(e),l.append('\n            <tr>\n              <td class="label explain-tooltip">  '.concat(t,'</td>\n              <td class="label explain-tooltip-val">').concat(e,"</td>\n            </tr>\n          ")))}))),Object.keys(r).length>0&&(l.append('<tr><td colspan="2" class="label explain-tooltip">'+(0,o.default)("Summary:")+"</td></tr>"),a.each(r,(function(e,t){t=a.escape(t),e=a.escape(e),l.append('\n          <tr>\n            <td class="label explain-tooltip">  '.concat(t,'</td>\n            <td class="label explain-tooltip-val">').concat(e,"</td>\n          </tr>\n        "))}))),(0,i.default)(".pg-explain-stats-area").off("click").on("click",(function(){if(0!=Object.keys(t).length||0!=Object.keys(n).length||0!=Object.keys(r).length){var a=e.find(".details-body");e.find(".details-title").text("Statistics"),a.empty(),a.append(s),e.removeClass("d-none"),a.scrollTop(0)}}))}});e.exports=l},41081:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(23157);var a={Aggregate:{image:"ex_aggregate.svg",image_text:"Aggregate"},Append:{image:"ex_append.svg",image_text:"Append"},"Bitmap Index Scan":function(e){return{image:"ex_bmp_index.svg",image_text:e["Index Name"]}},"Bitmap Heap Scan":function(e){return{image:"ex_bmp_heap.svg",image_text:e["Relation Name"]}},BitmapAnd:{image:"ex_bmp_and.svg",image_text:"Bitmap AND"},BitmapOr:{image:"ex_bmp_or.svg",image_text:"Bitmap OR"},"CTE Scan":{image:"ex_cte_scan.svg",image_text:"CTE Scan"},"Function Scan":{image:"ex_result.svg",image_text:"Function Scan"},"Foreign Scan":{image:"ex_foreign_scan.svg",image_text:"Foreign Scan"},Gather:{image:"ex_gather_motion.svg",image_text:"Gather"},"Gather Merge":{image:"ex_gather_merge.svg",image_text:"Gather Merge"},Group:{image:"ex_group.svg",image_text:"Group"},GroupAggregate:{image:"ex_aggregate.svg",image_text:"Group Aggregate"},Hash:{image:"ex_hash.svg",image_text:"Hash"},"Hash Join":function(e){if(!e["Join Type"])return{image:"ex_join.svg",image_text:"Join"};switch(e["Join Type"]){case"Anti":return{image:"ex_hash_anti_join.svg",image_text:"Hash Anti Join"};case"Semi":return{image:"ex_hash_semi_join.svg",image_text:"Hash Semi Join"};default:return{image:"ex_hash.svg",image_text:String("Hash "+e["Join Type"]+" Join")}}},HashAggregate:{image:"ex_aggregate.svg",image_text:"Hash Aggregate"},"Index Only Scan":function(e){return{image:"ex_index_only_scan.svg",image_text:e["Index Name"]}},"Index Scan":function(e){return{image:"ex_index_scan.svg",image_text:e["Index Name"]}},"Index Scan Backword":{image:"ex_index_scan.svg",image_text:"Index Backward Scan"},Limit:{image:"ex_limit.svg",image_text:"Limit"},LockRows:{image:"ex_lock_rows.svg",image_text:"Lock Rows"},Materialize:{image:"ex_materialize.svg",image_text:"Materialize"},"Merge Append":{image:"ex_merge_append.svg",image_text:"Merge Append"},"Merge Join":function(e){switch(e["Join Type"]){case"Anti":return{image:"ex_merge_anti_join.svg",image_text:"Merge Anti Join"};case"Semi":return{image:"ex_merge_semi_join.svg",image_text:"Merge Semi Join"};default:return{image:"ex_merge.svg",image_text:String("Merge "+e["Join Type"]+" Join")}}},ModifyTable:function(e){switch(e.Operation){case"Insert":return{image:"ex_insert.svg",image_text:"Insert"};case"Update":return{image:"ex_update.svg",image_text:"Update"};case"Delete":return{image:"ex_delete.svg",image_text:"Delete"}}},"Named Tuplestore Scan":{image:"ex_named_tuplestore_scan.svg",image_text:"Named Tuplestore Scan"},"Nested Loop":function(e){switch(e["Join Type"]){case"Anti":return{image:"ex_nested_loop_anti_join.svg",image_text:"Nested Loop Anti Join"};case"Semi":return{image:"ex_nested_loop_semi_join.svg",image_text:"Nested Loop Semi Join"};default:return{image:"ex_nested.svg",image_text:"Nested Loop "+e["Join Type"]+" Join"}}},ProjectSet:{image:"ex_projectset.svg",image_text:"ProjectSet"},"Recursive Union":{image:"ex_recursive_union.svg",image_text:"Recursive Union"},Result:{image:"ex_result.svg",image_text:"Result"},"Sample Scan":{image:"ex_scan.svg",image_text:"Sample Scan"},Scan:{image:"ex_scan.svg",image_text:"Scan"},Seek:{image:"ex_seek.svg",image_text:"Seek"},SetOp:function(e){var t=e.Strategy,n=e.Command;return"Hashed"==t?n.startsWith("Intersect")?"Intersect All"==n?{image:"ex_hash_setop_intersect_all.svg",image_text:"Hashed Intersect All"}:{image:"ex_hash_setop_intersect.svg",image_text:"Hashed Intersect"}:n.startsWith("Except")?"Except All"==n?{image:"ex_hash_setop_except_all.svg",image_text:"Hashed Except All"}:{image:"ex_hash_setop_except.svg",image_text:"Hash Except"}:{image:"ex_hash_setop_unknown.svg",image_text:"Hashed SetOp Unknown"}:{image:"ex_setop.svg",image_text:"SetOp"}},"Seq Scan":function(e){return{image:"ex_scan.svg",image_text:e["Relation Name"]}},"Subquery Scan":{image:"ex_subplan.svg",image_text:"SubQuery Scan"},Sort:{image:"ex_sort.svg",image_text:"Sort"},"Tid Scan":{image:"ex_tid_scan.svg",image_text:"Tid Scan"},"Table Function Scan":{image:"ex_table_func_scan.svg",image_text:"Table Function Scan"},Unique:{image:"ex_unique.svg",image_text:"Unique"},"Values Scan":{image:"ex_values_scan.svg",image_text:"Values Scan"},WindowAgg:{image:"ex_window_aggregate.svg",image_text:"Window Aggregate"},"WorkTable Scan":{image:"ex_worktable_scan.svg",image_text:"WorkTable Scan"},Undefined:{image:"ex_unknown.svg",image_text:"Undefined"}};t.default=a},4317:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(66992),n(41539),n(78783),n(33948),n(60285),n(74916),n(15306);var a={blobURL:function(e,t){var n=new Blob([e],{type:t});return(window.URL||window.webkitURL).createObjectURL(n)},downloadSVG:function(e,t){e=e.replace(/NS\d+:href/gi,"xlink:href");var n=this.blobURL(e,"image/svg+xml"),a=document.createElement("a");a.href=n,a.setAttribute("download",t),document.body.appendChild(a),a.click(),document.body.removeChild(a)}};t.default=a},72126:(e,t,n)=>{var a,i;n(69826),n(32564),n(68309),n(82772),n(40561),a=[n(91669),n(81311),n(19755),n(72316),n(55112),n(58894),n(71158),n(58307),n(73870),n(42591)],void 0===(i=function(e,t,n,a,i,r,o,s,l,d){if(r.NodeStatistics)return r.NodeStatistics;if(r.NodeStatistics=r.NodeStatistics||{},r.NodeStatistics.initialized)return r.NodeStatistics;var c=o.SizeFormatter=function(){};t.extend(c.prototype,{fromRaw:function(e){return l(e)},toRaw:function(e){return e}});var u=o.Extension.SwitchCell.extend({defaults:t.extend({},o.Extension.SwitchCell.prototype.defaults)}),f={16:u,20:o.IntegerCell,21:o.IntegerCell,23:o.IntegerCell,700:o.NumberCell,701:o.NumberCell,1700:o.NumberCell,702:o.DatetimeCell,703:o.DatetimeCell,1082:o.DatetimeCell.extend({includeDate:!0,includeTime:!1,includeMilli:!1}),1083:o.DatetimeCell.extend({includeDate:!1,includeTime:!0,includeMilli:!0}),1114:o.DatetimeCell.extend({includeDate:!0,includeTime:!0,includeMilli:!0}),1184:"string",1266:"string"},p=window.wcDocker;return t.extend(u.prototype.defaults.options,{onText:e("True"),offText:e("False"),onColor:"success",offColor:"ternary",size:"mini"}),t.extend(r.NodeStatistics,{init:function(){this.initialized||(this.initialized=!0,t.bindAll(this,"showStatistics","toggleVisibility","__createMultiLineStatistics","__createSingleLineStatistics","__loadMoreRows"),t.extend(this,{collection:new a.Collection(null),statistic_columns:[{editable:!1,name:"statistics",label:e("Statistics"),cell:"string",headerCell:o.Extension.CustomHeaderCell,cellHeaderClasses:"width_percent_25"},{editable:!1,name:"value",label:e("Value"),cell:"string"}],columns:null,grid:null}),this.panel=r.docker.findPanels("statistics"),this.panel.length>0&&this.toggleVisibility(this.panel[0].isVisible()))},toggleVisibility:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){this.panel=r.docker.findPanels("statistics");var a=r.tree,i=a.selected(),o=i&&a.itemData(i),s=i&&o&&r.Nodes[o._type];r.NodeStatistics.showStatistics.apply(r.NodeStatistics,[i,o,s]),r.Events.on("pgadmin-browser:tree:selected",r.NodeStatistics.showStatistics),r.Events.on("pgadmin-browser:tree:refreshing",r.NodeStatistics.refreshStatistics,this)}else t&&n(this.panel[0]).data("node-prop",""),r.Events.off("pgadmin-browser:tree:selected",r.NodeStatistics.showStatistics),r.Events.off("pgadmin-browser:tree:refreshing",r.NodeStatistics.refreshStatistics,this)},__updateCollection:function(a,l,c,u){var f=this.panel[0].layout().scene().find(".pg-panel-content"),h=f.find(".pg-panel-statistics-message"),_=f.find(".pg-panel-statistics-container"),g=this.panel,m=this,b="",v=u;if(l){b=e("No statistics are available for the selected object.");var y=l.getTreeNodeHierarchy(c),w={node_type:u,url:a};if(t.isEqual(n(g[0]).data("node-prop"),w))return;if(n(g[0]).data("node-prop",w),d.nodeHasStatistics(l,c)){var x;b="";!function t(){n.ajax({url:a,type:"GET",beforeSend:function(t){t.setRequestHeader(i.csrf_token_header,i.csrf_token),x=setTimeout((function(){h.text(e("Retrieving data from the server...")),h.removeClass("d-none"),m.grid&&m.grid.remove()}),1e3)}}).done((function(t){if(clearTimeout(x),h.text(""),t.data){var n=m.data=t.data;l.hasCollectiveStatistics||n.rows.length>1?(r.Events.on("pgadmin-browser:panel-statistics:"+p.EVENT.SCROLLED,m.__loadMoreRows),m.__createMultiLineStatistics.call(m,n,l.statsPrettifyFields)):(r.Events.off("pgadmin-browser:panel-statistics:"+p.EVENT.SCROLLED,m.__loadMoreRows),m.__createSingleLineStatistics.call(m,n,l.statsPrettifyFields)),m.grid&&(delete m.grid,m.grid=null),m.grid=new o.Grid({emptyText:e("No data found"),columns:m.columns,collection:m.collection,className:"backgrid presentation table table-bordered table-noouter-border table-hover"}),m.grid.render(),_.empty(),_.append(m.grid.$el),h.hasClass("d-none")||h.addClass("d-none"),_.removeClass("d-none")}else t.info&&(_.hasClass("d-none")||_.addClass("d-none"),h.text(t.info),h.removeClass("d-none"))})).fail((function(n,a,i){var o=y[v].label;r.Events.trigger("pgadmin:node:retrieval:error","statistics",n,a,i,c),s.pgHandleItemError(n,a,i,{item:c,info:y})||s.pgNotifier(a,n,e("Error retrieving the information - %s",i||o),(function(e){"CRYPTKEY_SET"===e?t():console.warn(arguments)})),h.text(e("Failed to retrieve data from the server."))}))}()}}""!=b&&(_.hasClass("d-none")||_.addClass("d-none"),h.removeClass("d-none"),h.text(b))},refreshStatistics:function(e,a,i){var r=this,o={node_type:a._type,url:i.generate_url(e,"stats",a,!0)};t.isEqual(n(r.panel[0]).data("node-prop"),o)&&(n(r.panel[0]).data("node-prop",""),r.showStatistics(e,a,i))},showStatistics:function(e,t,n){var a=this;n&&(a.timeout&&clearTimeout(a.timeout),a.timeout=setTimeout((function(){a.__updateCollection.call(a,n.generate_url(e,"stats",t,!0),n,e,t._type)}),400))},__createMultiLineStatistics:function(e,n){var a=e.rows,i=e.columns;for(var r in this.columns=[],i){var o=i[r],s=f[o.type_code]||"string";"PID"==o.name&&(s=s.extend({orderSeparator:""}));var l={editable:!1,name:o.name,cell:s};-1!=t.indexOf(n,o.name)&&(l.formatter=c),this.columns.push(l)}this.collection.reset(a.splice(0,50))},__loadMoreRows:function(){var e=n(".pg-panel-statistics-container").closest(".wcFrameCenter")[0];if(e.scrollHeight-10<e.scrollTop+e.offsetHeight){var t=this.data.rows;t.length>0&&this.collection.add(t.splice(0,50))}},__createSingleLineStatistics:function(e,n){var a,i=e.rows[0],r=e.columns,o=[];for(var s in this.columns=this.statistic_columns,r)a=r[s].name,o.push({statistics:a,value:i&&i[a]?-1!=t.indexOf(n,a)?l(i[a]):i[a]:null});this.collection.reset(o)}}),r.NodeStatistics}.apply(t,a))||(e.exports=i)},20811:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(69826);var a,i=(a=n(4631))&&a.__esModule?a:{default:a};n(54086),n(64020),n(20017),n(88657),n(89700),n(71707),n(3585),n(69109),n(55292),n(81699),n(32095),n(14568),n(4328),n(82801),n(14504),n(90338),n(18473),i.default.commands.focusOut=function(){event.stopPropagation(),document.activeElement.blur(),event.currentTarget.hasOwnProperty("parents")&&event.currentTarget.parents().find(".sql-code-control")&&event.currentTarget.parents().find(".sql-code-control").focus()},i.default.defineInitHook((function(e){e.addKeyMap({Tab:function(e){e.somethingSelected()?e.execCommand("indentMore"):e.getOption("indentWithTabs")?e.replaceSelection("\t","end","+input"):e.execCommand("insertSoftTab")}})})),i.default.keyMap.default.Esc="focusOut";var r=i.default;t.default=r},73409:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(81812),n(52947),n(33059),n(26491),n(10883),n(98463),n(51827),n(98276),n(4165),n(25080),n(34964),n(35337),n(79387),n(5205);var a=window.Slick;t.default=a},61329:(e,t,n)=>{n(92222);var a,i=(a=n(81311))&&a.__esModule?a:{default:a};e.exports={generate_url:function(e,t,n,a,r,o){var s="";return i.default.each(i.default.sortBy(i.default.pick(t,r),(function(e){return e.priority})),(function(e){s="".concat(s,"/").concat(encodeURI(e._id))})),s=o?"".concat(s,"/").concat(o):"".concat(s,"/"),"".concat(e).concat(a,"/").concat(n).concat(s)}}},42331:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ModelValidation=void 0,n(73210),n(69070);var a=o(n(91669)),i=o(n(81311)),r=n(30033);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.err={},this.errmsg="",this.model=t}var t,n,o;return t=e,o=[{key:"isEmptyString",value:function(e){return i.default.isUndefined(e)||i.default.isNull(e)||""===String(e).trim()}}],(n=[{key:"validate",value:function(){var t=this.model.get("service"),n=this.model.get("pub");return!this.model.isNew()&&"id"in this.model.sessAttrs?(this.err.id=(0,a.default)("The ID cannot be changed."),this.errmsg=this.err.id):this.model.errorModel.unset("id"),this.checkForEmpty("name",(0,a.default)("Name must be specified.")),e.isEmptyString(t)?(this.setNullValueForEmptyString("service"),this.checkHostAndHostAddress(),this.checkForEmpty("db",(0,a.default)("Maintenance database must be specified.")),this.checkForEmpty("username",(0,a.default)("Username must be specified.")),this.checkForEmpty("port",(0,a.default)("Port must be specified.")),i.default.isUndefined(n)||this.checkForEmpty("pub",(0,a.default)("Publication must be specified."))):(this.checkForEmpty("db",(0,a.default)("Maintenance database must be specified.")),i.default.isUndefined(n)||this.checkForEmpty("pub",(0,a.default)("Publication must be specified.")),this.clearHostAddressAndDbErrors()),this.model.get("use_ssh_tunnel")&&(this.checkForEmpty("tunnel_host",(0,a.default)("SSH Tunnel host must be specified.")),this.checkForEmpty("tunnel_port",(0,a.default)("SSH Tunnel port must be specified.")),this.checkForEmpty("tunnel_username",(0,a.default)("SSH Tunnel username must be specified.")),this.model.get("tunnel_authentication")&&this.checkForEmpty("tunnel_identity_file",(0,a.default)("SSH Tunnel identity file must be specified."))),this.model.errorModel.set(this.err),i.default.size(this.err)?this.errmsg:null}},{key:"setNullValueForEmptyString",value:function(e){var t=this.model.get(e);i.default.isUndefined(t)||i.default.isNull(t)||""===String(t).trim()&&this.model.set(e,null)}},{key:"clearHostAddressAndDbErrors",value:function(){var e=this;i.default.each(["host","hostaddr","db","username","port"],(function(t){e.setNullValueForEmptyString(t),e.model.errorModel.unset(t)}))}},{key:"checkHostAndHostAddress",value:function(){var e=this.model.get("pub"),t=i.default.isUndefined(e)?(0,a.default)("Either Host name, Address or Service must be specified."):(0,a.default)("Host name, Address must be specified.");this.checkForEmpty("host",t)&&this.checkForEmpty("hostaddr",t)?this.errmsg=this.errmsg||t:(this.errmsg=void 0,delete this.err.host,delete this.err.hostaddr),this.checkForValidIp(this.model.get("hostaddr"),(0,a.default)("Host address must be valid IPv4 or IPv6 address."))}},{key:"checkForValidIp",value:function(e,t){if(e)try{new r.Address4(e)}catch(n){try{new r.Address6(e)}catch(e){this.err.hostaddr=t,this.errmsg=t}}else this.model.errorModel.unset("hostaddr")}},{key:"checkForEmpty",value:function(t,n){var a=this.model.get(t);return e.isEmptyString(a)?(this.err[t]=n,this.errmsg=this.errmsg||n,!0):(this.model.errorModel.unset(t),!1)}}])&&s(t.prototype,n),o&&s(t,o),e}();t.ModelValidation=l},10416:(e,t,n)=>{function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(82526),n(69070),n(57327),n(38880),n(89554),n(54747),n(49337),n(33321),n(19601),n(66992),n(41539),n(78783),n(4129),n(33948),n(41817),n(32165),Object.defineProperty(t,"__esModule",{value:!0}),t.default=_,t.LineChart=function(e){return i.default.createElement(_,d({},e,{type:"line"}))},n(47941),n(82772);var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}i.default=e,n&&n.set(e,i);return i}(n(67294)),r=s(n(17757)),o=s(n(45697));function s(e){return e&&e.__esModule?e:{default:e}}function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var h={responsive:!0,maintainAspectRatio:!1,elements:{line:{tension:0,borderWidth:2,fill:!1}},layout:{padding:8},hover:{animationDuration:0}};function _(e){var t=e.type,n=void 0===t?"line":t,a=e.id,o=e.options,s=e.data,l=e.redraw,d=void 0!==l&&l,c=p(e,["type","id","options","data","redraw"]),f=i.default.useRef(),_=i.default.useRef(),g=r.default.helpers.configMerge(h,o),m=function(){var e=f.current.getContext("2d");_.current=new r.default(e,{type:n,data:s,options:g}),c.onInit&&c.onInit(_.current)},b=function(){_.current&&_.current.destroy()};return(0,i.useEffect)((function(){return m(),b}),[]),(0,i.useEffect)((function(){if(void 0!==_.current){_.current.data=s;for(var e=0;e<_.current.data.datasets.length;e++)_.current.data.datasets[e]=u(u({},_.current.data.datasets[e]),s.datasets[e]);_.current.options=g,_.current.update(c.updateOptions||{}),c.onUpdate&&c.onUpdate(_.current)}}),[s,o]),(0,i.useEffect)((function(){d&&(b(),m())}),[d]),i.default.createElement("canvas",{id:a,ref:f})}_.propTypes={type:o.default.string.isRequired,id:o.default.string,data:o.default.object.isRequired,options:o.default.object,redraw:o.default.bool,updateOptions:o.default.object,onInit:o.default.func,onUpdate:o.default.func}},86620:(e,t,n)=>{var a,i;n(23157),n(74916),n(15306),n(82772),a=[n(19755),n(81311)],void 0===(i=function(e,t){return function(e,n){if(t.isUndefined(n)||t.isNull(n))return!0;n.startsWith("coll-")&&(n=n.replace("coll-",""));if(t.indexOf(["server_group","server","catalog_object_column"],n)>=0)return!0;var a=e.get_preference("browser","show_node_"+n);return!a||a.value}}.apply(t,a))||(e.exports=i)},90338:(e,t,n)=>{var a,i,r,o;function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e=n.nmd(e),n(94986),n(82772),n(82526),n(41817),n(41539),n(32165),n(66992),n(78783),n(33948),o=function(e){e.registerHelper("fold","sql",(function(t,n){return function(t,n,a){for(var i,r,o=n.line,s=t.getLine(o),l=s.length,d=0,c=a[d].start,u=a[d].end;l>0;){var f=s.toUpperCase().lastIndexOf(c,l),p=c,h=u;if(f<n.ch){if(++d>=a.length)return;c=a[d].start,u=a[d].end,l=s.length}else{if(r=t.getTokenAt(e.Pos(o,f+1)).type,!/^(comment|string)/.test(r)){i=f;break}l=f-1}}if(!(null==i||s.toUpperCase().lastIndexOf(p)>i)){var _,g,m=1,b=t.lineCount();e:for(var v=o+1;v<b;++v)for(var y=t.getLine(v).toUpperCase(),w=0,x=0;x<1;){var C=y.indexOf(p,w),S=y.indexOf(h,w);if(C<0&&(C=y.length),S<0&&(S=y.length),(w=Math.min(C,S))==y.length){x=1;break}if(t.getTokenAt(e.Pos(v,w+1)).type==r)if(w==C)++m;else if(!--m){_=v,g=w;break e}++w}if(null!=_&&_!=o+1)return{from:e.Pos(o,i+c.length),to:e.Pos(_,g)}}}(t,n,[{start:"BEGIN",end:"END;"},{start:"IF",end:"END IF"},{start:"LOOP",end:"END LOOP"},{start:"CASE",end:"END CASE"}])}))},"object"==s(t)&&"object"==s(e)?o(n(4631)):(i=[n(4631)],void 0===(r="function"==typeof(a=o)?a.apply(t,i):a)||(e.exports=r))},18473:(e,t,n)=>{var a;((a=n(4631))&&a.__esModule?a:{default:a}).default.defineExtension("centerOnLine",(function(e){var t=this.getScrollInfo().clientHeight,n=this.charCoords({line:e,ch:0},"local");this.scrollTo(null,(n.top+n.bottom-t)/2)}))},87789:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.setPGCSRFToken=function(e,t){if(!t)throw"csrf-token meta tag has not been set";var n=i.default.sync;i.default.sync=function(a,i,r){return r.beforeSend=function(n){n.setRequestHeader(e,t)},n(a,i,r)};var o=i.default.get;i.default.get=function(n,a,i){return i.beforeSend=function(n){n.setRequestHeader(e,t)},o(n,a,i)},a.default.ajaxSetup({beforeSend:function(n){n.setRequestHeader(e,t)}}),r.default.interceptors.request.use((function(n){return n.headers[e]=t,n}),(function(e){return Promise.reject(e)}))},n(41539),n(88674);var a=o(n(19755)),i=o(n(72316)),r=o(n(9669));function o(e){return e&&e.__esModule?e:{default:e}}},50464:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.useInterval=function(e,t){var n=(0,a.useRef)();(0,a.useEffect)((function(){n.current=e})),(0,a.useEffect)((function(){if(t>-1){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}}),[t])},t.usePrevious=function(e){var t=(0,a.useRef)();return(0,a.useEffect)((function(){t.current=e})),t.current},t.useDelayDebounce=function(e,t,n){(0,a.useEffect)((function(){var a=setTimeout((function(){t&&e(t)}),n);return function(){return clearTimeout(a)}}),[t])},n(32564);var a=n(67294)},89087:(e,t,n)=>{n(69826),n(24812),n(32564),n(69070);var a=o(n(19755)),i=o(n(42441)),r=n(44092);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var l=function(){function e(t,n,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dialogContainer=t,this.tabSwitching=!1,this.tabs=this.dialogContainer.find(".nav-tabs:visible"),this.tabs.length>0&&(this.tabs=this.tabs[0]),this.dialogTabBackward=(0,r.parseShortcutValue)(n),this.dialogTabForward=(0,r.parseShortcutValue)(a),(0,i.default)(this.dialogContainer[0]).bind(this.dialogTabBackward,this.onKeyboardEvent.bind(this)),(0,i.default)(this.dialogContainer[0]).bind(this.dialogTabForward,this.onKeyboardEvent.bind(this))}var t,n,o;return t=e,(n=[{key:"onKeyboardEvent",value:function(e,t){var n=this.dialogContainer.find(".tab-content:first > .tab-pane.active:first:visible"),a=this.isActivePaneHasChildTabs(n);this.tabSwitching||(this.tabSwitching=!0,a&&this.navigate(t,a.childTab,a.childTabPane,e)||this.navigate(t,this.tabs,n,e))}},{key:"isActivePaneHasChildTabs",value:function(e){var t=e.find(".nav-tabs:first:visible");return t.length>0?{childTab:t,childTabPane:e.find(".tab-content:first > .tab-pane.active:first:visible")}:null}},{key:"navigate",value:function(e,t,n,a){return e==this.dialogTabBackward?this.navigateBackward(t,n,a):e==this.dialogTabForward&&this.navigateForward(t,n,a)}},{key:"navigateBackward",value:function(e,t,n){var i,o,s=this,l=(0,a.default)(e).find("li").has("a.active").prev("li");return l.length>0?(l.find("a").tab("show"),(o=(i=t.prev()).find(".tab-content:first > .tab-pane.active:first:visible")).length>0?(0,r.findAndSetFocus)(o):(0,r.findAndSetFocus)(i),setTimeout((function(){s.tabSwitching=!1}),200),n.stopPropagation(),!0):(this.tabSwitching=!1,!1)}},{key:"navigateForward",value:function(e,t,n){var i,o,s=this,l=(0,a.default)(e).find("li").has("a.active").next("li");return l.length>0?(l.find("a").tab("show"),(o=(i=t.next()).find(".tab-content:first > .tab-pane.active:first:visible")).length>0?(0,r.findAndSetFocus)(o):(0,r.findAndSetFocus)(i),setTimeout((function(){s.tabSwitching=!1}),200),n.stopPropagation(),!0):(this.tabSwitching=!1,!1)}},{key:"detach",value:function(){(0,i.default)(this.dialogContainer[0]).unbind(this.dialogTabBackward),(0,i.default)(this.dialogContainer[0]).unbind(this.dialogTabForward)}}])&&s(t.prototype,n),o&&s(t,o),e}();e.exports={dialogTabNavigator:l}},91669:(e,t,n)=>{var a,i;n(69600),n(21249),n(74916),n(23123),a=[n(52536)],void 0===(i=function(e){return function(t){var n=e[t]?e[t]:t;if(1==arguments.length)return n;try{var a=arguments;return n.split("%s").map((function(e,t){return t>0?t<a.length?[a[t],e].join(""):["%s",e].join(""):e})).join("")}catch(e){return console.error(e),n}}}.apply(t,a))||(e.exports=i)},57550:(e,t,n)=>{function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i,r,o,s;n(82526),n(41817),n(32165),n(66992),n(78783),n(33948),n(41539),n(24603),n(74916),n(39714),n(15306),i=Object.prototype.toString,r=Function.prototype.toString,o=/^\[object .+?Constructor\]$/,s=RegExp("^"+String(i).replace(/[.*+?^${}()|[\]\/\\]/g,"\\$&").replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),e.exports=function(e){var t=a(e);return"function"==t?s.test(r.call(e)):e&&"object"==t&&o.test(i.call(e))||!1}},72945:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.processEventDebugger=function(e,t,n,i){var r,o,s="";this.validateShortcutKeys(n.edit_grid_values,t)?(this._stopEventPropagation(t),(r=e.find('div.wcPanelTabContent:not(".wcPanelTabContentHidden")')).length&&(o=(0,a.default)(r).find("td.editable:first")).length&&o.trigger("click")):this.validateShortcutKeys(n.move_next,t)?(this._stopEventPropagation(t),s=l(i,"right")):this.validateShortcutKeys(n.move_previous,t)?(this._stopEventPropagation(t),s=l(i,"left")):this.validateShortcutKeys(n.switch_panel,t)&&(this._stopEventPropagation(t),s=l(i,"switch"));return s},t.processEventQueryTool=function(e,t,n,i){if(e.isQueryRunning())return;var r=n.which||n.keyCode,o="",s=e.preferences.execute_query,d=e.preferences.explain_query,c=e.preferences.explain_analyze_query,u=e.preferences.download_results,f=e.preferences.move_next,p=e.preferences.move_previous,h=e.preferences.switch_panel,_=e.preferences.toggle_case,g=e.preferences.commit_transaction,m=e.preferences.rollback_transaction,b=e.preferences.save_data,v=e.preferences.show_query_tool;if(this.validateShortcutKeys(s,n))this._stopEventPropagation(n),t.executeQuery(e);else if(this.validateShortcutKeys(d,n))this._stopEventPropagation(n),t.explain(e);else if(this.validateShortcutKeys(c,n))this._stopEventPropagation(n),t.explainAnalyze(e);else if(this.validateShortcutKeys(u,n))e.is_save_results_to_file_disabled||(this._stopEventPropagation(n),t.download(e));else if(this.validateShortcutKeys(_,n))this._stopEventPropagation(n),t.toggleCaseOfSelectedText(e);else if(this.validateShortcutKeys(g,n))e.is_transaction_buttons_disabled||(this._stopEventPropagation(n),t.executeCommit(e));else if(this.validateShortcutKeys(m,n))e.is_transaction_buttons_disabled||(this._stopEventPropagation(n),t.executeRollback(e));else if(this.validateShortcutKeys(b,n))this._stopEventPropagation(n),t.saveDataChanges(e);else if(this.validateShortcutKeys(v,n))this._stopEventPropagation(n),t.openQueryTool(e);else if((this.isMac()&&n.metaKey||!this.isMac()&&n.ctrlKey)&&!n.altKey&&n.shiftKey&&191===r)this._stopEventPropagation(n),t.commentBlockCode(e);else if((this.isMac()&&!this.isKeyCtrlAltShift(n)&&n.metaKey||!this.isMac()&&!this.isKeyAltShift(n)&&n.ctrlKey)&&191===r)this._stopEventPropagation(n),t.commentLineCode(e);else if((this.isMac()&&!this.isKeyCtrlAltShift(n)&&n.metaKey||!this.isMac()&&!this.isKeyAltShift(n)&&n.ctrlKey)&&190===r)this._stopEventPropagation(n),t.uncommentLineCode(e);else if((this.isMac()&&n.metaKey||!this.isMac()&&n.ctrlKey)&&!n.altKey&&n.shiftKey&&75===r)this._stopEventPropagation(n),t.formatSql(e);else if(27==r)t.focusOut(e),(0,a.default)(n.target).hasClass("dropdown-item")&&(0,a.default)(n.target).closest(".dropdown-submenu").length>0&&(0,a.default)(n.target).closest(".dropdown-submenu").find(".dropdown-menu").removeClass("show");else if(this.validateShortcutKeys(f,n))this._stopEventPropagation(n),o=l(i,"right");else if(this.validateShortcutKeys(p,n))this._stopEventPropagation(n),o=l(i,"left");else if(this.validateShortcutKeys(h,n))this._stopEventPropagation(n),o=l(i,"switch");else if(38===r||40===r){if((0,a.default)(n.target).closest(".dropdown-menu").length>0){this._stopEventPropagation(n);var y=(0,a.default)(n.target).closest("li");for((0,a.default)(n.target).closest(".dropdown-menu").find(".show").removeClass("show"),38===r?y=y.prev():40===r&&(y=y.next());y.hasClass("dropdown-divider")||y.hasClass("d-none")||y.find(".dropdown-item").first().hasClass("disabled");)38===r?y=y.prev():40===r&&(y=y.next());y.find(".dropdown-item").trigger("focus")}}else if(37===r||39===r){if((0,a.default)(n.target).closest(".dropdown-menu").length>0){this._stopEventPropagation(n);var w=(0,a.default)(n.target).closest("li");if(39===r)w.hasClass("dropdown-submenu")&&(w.find(".dropdown-menu").addClass("show"),w.find(".dropdown-menu .dropdown-item").first().trigger("focus"));else if(37===r){var x=w.closest(".dropdown-menu");x.closest(".dropdown-submenu").length>0&&(x.removeClass("show"),(w=x.closest(".dropdown-submenu")).find(".dropdown-item").trigger("focus"))}}}else{var C=this.validateMacros(e,n);!1!==C&&(this._stopEventPropagation(n),t.executeMacro(e,C))}return o},t.focusDockerPanel=l,t.validateShortcutKeys=function(e,t){if(!e)return!1;var n=t.which||t.keyCode;return e.alt==t.altKey&&e.shift==t.shiftKey&&e.control==t.ctrlKey&&e.key.key_code==n},t.validateMacros=function(e,t){var n=t.which||t.keyCode,a=e.macros.filter((function(e){return e.alt==t.altKey&&e.control==t.ctrlKey&&e.key_code==n}));if(1==a.length)return a[0].id;return!1},t._stopEventPropagation=function(e){e.cancelBubble=!0,e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()},t.isMac=function(){return-1!=window.navigator.platform.search("Mac")},t.isKeyCtrlAlt=function(e){return e.ctrlKey||e.altKey},t.isKeyAltShift=function(e){return e.altKey||e.shiftKey},t.isKeyCtrlShift=function(e){return e.ctrlKey||e.shiftKey},t.isKeyCtrlAltShift=function(e){return e.ctrlKey||e.altKey||e.shiftKey},t.isAltShiftBoth=function(e){return e.altKey&&e.shiftKey&&!e.ctrlKey},t.isCtrlShiftBoth=function(e){return e.ctrlKey&&e.shiftKey&&!e.altKey},t.isCtrlAltBoth=function(e){return e.ctrlKey&&e.altKey&&!e.shiftKey},t.shortcut_key=s,t.shortcut_title=function(e,t){var n="";if(null==t)return n;t.alt&&(n=(0,i.default)("Alt")+"+");t.shift&&(n+=(0,i.default)("Shift")+"+");t.control&&(n+=(0,i.default)("Ctrl")+"+");return n+=s(t),"".concat(e," (").concat(n,")")},t.shortcut_accesskey_title=function(e,t){return"".concat(e," (")+(0,i.default)("accesskey")+" + ".concat(s(t),")")},n(74916),n(64765),n(92222),n(69826),n(57327);var a=o(n(19755)),i=o(n(91669)),r=n(44092);function o(e){return e&&e.__esModule?e:{default:e}}function s(e){var t="";return e.key&&e.key.char&&(t=e.key.char.toUpperCase()),t}function l(e,t){if(e){if(!e._focusFrame){if(0==e._frameList.length&&0==e._frameList[0]._panelList.length)return;e._frameList[0]._panelList[e._frameList[0]._curTab].focus()}var n=e._focusFrame,a=0,i=!1;if("switch"==t){var o,s=e._frameList.length;for(o=0;o<s&&n!==e._frameList[o];o++);a=(n=e._frameList[(0,r.getMod)(o+1,s)])._curTab,i=!0}else"left"==t?a=(0,r.getMod)(n._curTab-1,n._panelList.length):"right"==t&&(a=(0,r.getMod)(n._curTab+1,n._panelList.length));var l=n._panelList[a];return l.$container.find('*[tabindex]:not([tabindex="-1"])').trigger("focus"),l.focus(i),l._type}}},42591:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.nodeHasStatistics=function(e,t){if("function"==typeof e.hasStatistics){var n=e.getTreeNodeHierarchy(t);return e.hasStatistics(n)}return e.hasStatistics}},23602:(e,t,n)=>{n(69826);var a=o(n(19755)),i=o(n(81311)),r=o(n(1950));function o(e){return e&&e.__esModule?e:{default:e}}e.exports={modifyAcitreeAnimation:function(e,t){var n=e.get_preference("browser","enable_acitree_animation").value;i.default.isUndefined(t)&&(t=e.tree),n?t.options({animateRoot:!0,unanimated:!1,show:i.default.extend(t.options().show,{duration:75}),hide:i.default.extend(t.options().hide,{duration:75}),view:i.default.extend(t.options().view,{duration:75})}):t.options({animateRoot:!1,unanimated:!0,show:i.default.extend(t.options().show,{duration:0}),hide:i.default.extend(t.options().hide,{duration:0}),view:i.default.extend(t.options().view,{duration:0})})},modifyAlertifyAnimation:function(e){(i.default.isUndefined(e)||i.default.isNull(e))&&(e=r.default.pgAdmin.Browser),e.get_preference("browser","enable_alertify_animation").value?((0,a.default)(document).find("body").removeClass("alertify-no-animation"),i.default.each(document.getElementsByTagName("iframe"),(function(e){(0,a.default)(e.contentDocument).find("body").removeClass("alertify-no-animation")}))):((0,a.default)(document).find("body").addClass("alertify-no-animation"),i.default.each(document.getElementsByTagName("iframe"),(function(e){(0,a.default)(e.contentDocument).find("body").addClass("alertify-no-animation")})))}}},90585:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.url=function(e,t,n){var a=r.default.treeMenu.findNodeByDomElement(t),o=null;a&&a.anyFamilyMember((function(e){var t=e.getData(),a=r.default.Nodes[t._type],s=a&&a.dashboard;return(0,i.isFunction)(s)&&(s=s.apply(a,[e,t,n])),null!==(o=(0,i.isString)(s)?s:null)}));return o};var a,i=n(44092),r=(a=n(58894))&&a.__esModule?a:{default:a}},55112:(e,t,n)=>{var a;function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(82526),n(41817),n(32165),n(66992),n(78783),n(33948),n(74916),n(4723),n(54678),n(47042),n(15306),n(23123),n(91058),n(83710),n(41539),n(39714),void 0===(a=function(){var e=window.pgAdmin=window.pgAdmin||{};function t(e,t,n){return void 0===n||0==+n?Math[e](t):(t=+t,n=+n,isNaN(t)||n%1!=0?NaN:(t=t.toString().split("e"),+((t=(t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+n:n))))}return function(e,t,n){function a(t,n,a,r){a=a||"width";var o,l,d,f=(n.match(c)||[])[2],p="px"===f?1:u[f+"toPx"];if(p||/r?em/i.test(f)&&!r)t=p?t:"rem"===f?s:"fontSize"===a&&+e.parentNode||t,p=p||parseFloat(i(t,"fontSize")),d=parseFloat(n)*p;else{l=(o=t.style)[a];try{o[a]=n}catch(e){return 0}d=o[a]?parseFloat(i(t,a)):0,o[a]=undefined!==l?l:null}return d}function i(e,t){var n,o,s,l,u,f=["paddingTop","paddingBottom","borderTop","borderBottom"],p=4;if(o=e.style["pixel"+t.charAt(0).toUpperCase()+t.slice(1)],"%"===(s=((n=d?d(e)[t]:o?o+"px":"fontSize"===t?a(e,"1em","left",1)+"px":e.currentStyle[t]).match(c)||[])[2])&&r)if(/^top|bottom/.test(t)){for(l=(u=e.parentNode||e).offsetHeight;p--;)l-=parseFloat(i(u,f[p]));n=parseFloat(n)/100*l+"px"}else n=a(e,n);else("auto"===n||s&&"px"!==s)&&d?n=0:s&&"px"!==s&&!d&&(n=a(e,n)+"px");return n}var r,o=t.createElement("test"),s=t.documentElement,l=t.defaultView,d=l&&l.getComputedStyle,c=/^(-?[\d+\.\-]+)([a-z]+|%)$/i,u={},f=[1/25.4,1/2.54,1/72,1/6],p=["mm","cm","pt","pc","in","mozmm"],h=6;for(s.appendChild(o),d&&(o.style.marginTop="1%",r="1%"===d(o).marginTop);h--;)u[p[h]+"toPx"]=f[h]?f[h]*u.inToPx:a(o,"1"+p[h]);s.removeChild(o),e.toPx=a}(e,window.document),e.natural_sort=function(e,t,n){n=n||{};var a,r,o=/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,s=/(^[ ]*|[ ]*$)/g,l=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,d=/^0x[0-9a-f]+$/i,c=/^0/,u=function(e){return n.insensitive&&(""+e).toLowerCase()||""+e},f=u(e).replace(s,"")||"",p=u(t).replace(s,"")||"",h=f.replace(o,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),_=p.replace(o,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),g=parseInt(f.match(d))||1!==h.length&&f.match(l)&&Date.parse(f),m=parseInt(p.match(d))||g&&p.match(l)&&Date.parse(p)||null,b=n.desc?-1:1;if(m){if(g<m)return-1*b;if(g>m)return 1*b}for(var v=0,y=Math.max(h.length,_.length);v<y;v++){if(a=!(h[v]||"").match(c)&&parseFloat(h[v])||h[v]||0,r=!(_[v]||"").match(c)&&parseFloat(_[v])||_[v]||0,isNaN(a)!==isNaN(r))return(isNaN(a)?1:-1)*b;if(i(a)!==i(r)&&(a+="",r+=""),a<r)return-1*b;if(a>r)return 1*b}return 0},e.numeric_comparator=function(e,t){return(e=parseInt(e))<(t=parseInt(t))?-1:e==t?0:1},Math.round10||(Math.round10=function(e,n){return t("round",e,n)}),Math.floor10||(Math.floor10=function(e,n){return t("floor",e,n)}),Math.ceil10||(Math.ceil10=function(e,n){return t("ceil",e,n)}),e}.apply(t,[]))||(e.exports=a)},75471:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(e.showOnScroll){var t=a.default.fn.select2.amd.require("select2/utils"),n=function(e,t){this.$element=e,this.options=t,this._dataToConvert=t.get("data")||[]},r=null;r=null!=e.data?a.default.fn.select2.amd.require("select2/data/array"):a.default.fn.select2.amd.require("select2/data/select"),t.Extend(n,r),n.prototype.query=function(e,t){var n=[],i=this;e.page||(e.page=1);this.$element.children().each((function(){var t=(0,a.default)(this);if(t.is("option")||t.is("optgroup")){var r=i.item(t),o=i.matches(e,r);null!==o&&n.push(o)}})),t({results:n.slice(20*(e.page-1),20*e.page),pagination:{more:n.length>=20*e.page}})},e.minimumInputLength>0&&(n=t.Decorate(n,a.default.fn.select2.amd.require("select2/data/minimumInputLength"))),e.maximumInputLength>0&&(n=t.Decorate(n,a.default.fn.select2.amd.require("select2/data/maximumInputLength"))),e.maximumSelectionLength>0&&(n=t.Decorate(n,a.default.fn.select2.amd.require("select2/data/maximumSelectionLength"))),e.tags&&(n=t.Decorate(n,a.default.fn.select2.amd.require("select2/data/tags"))),null==e.tokenSeparators&&null==e.tokenizer||(n=t.Decorate(n,a.default.fn.select2.amd.require("select2/data/tokenizer"))),e.dataAdapter=n,i.default.isUndefined(e.ajax)&&(e.ajax={})}return e},n(47042),n(20454);var a=r(n(19755)),i=r(n(81311));function r(e){return e&&e.__esModule?e:{default:e}}},58963:(e,t,n)=>{var a,i;a=[n(19755),n(25750)],void 0===(i=function(e,t){return function(){var n,a=!1,i=!1,r=!1;function o(e,t){a=!0,n.setActiveCell(t.range.start.row,t.range.start.cell)}function s(o,s){if(r&&i)return i=!1,void o.stopPropagation();if(!e(o.target).hasClass("slick-resizable-handle")){a=!0;var l=s.column.pos+1;h(0,l)?_()?n.resetActiveCell():n.setActiveCell(0,g().fromCell):function(e){var a=t.rangeForColumn(n,e),i=n.getSelectionModel().getSelectedRanges();return t.isRangeSelected(i,a)}(l)||n.setActiveCell(0,l)}}function l(){r=!1}function d(){r=!0,i=!1}function c(){i=!0}function u(e,i){if(o=i.cell,"row-header-column"===n.getColumns()[o].id){a=!0;var r=i.row;if(r>=n.getDataLength())return;h(r,1)?_()||0===n.getSelectionModel().getSelectedRanges().length?n.resetActiveCell():n.setActiveCell(g().fromRow,1):function(e){var a=t.rangeForRow(n,e),i=n.getSelectionModel().getSelectedRanges();return t.isRangeSelected(i,a)}(r)||n.setActiveCell(r,1)}var o}function f(e){a&&(a=!1,e.stopPropagation())}function p(e){var t,a;m()&&function(e){return function(e){return e.shiftKey&&!e.ctrlKey&&!e.altKey}(e)&&function(e){return 39===e.which||38===e.which||37===e.which||40===e.which}(e)}(e)&&(t=n.getSelectionModel(),(a=t.getSelectedRanges()).length>1&&t.setSelectedRanges([a.pop()]))}function h(e,t){return m()&&n.getActiveCell().row===e&&n.getActiveCell().cell===t}function _(){return 1===n.getSelectionModel().getSelectedRanges().length}function g(){var e=n.getSelectionModel().getSelectedRanges();return e[e.length-2]}function m(){return!!n.getActiveCell()}e.extend(this,{init:function(e){(n=e).onDragEnd.subscribe(o),n.onHeaderClick.subscribe(s),n.onClick.subscribe(u),n.onActiveCellChanged.subscribe(f),n.onKeyDown.subscribe(p),n.onHeaderMouseEnter.subscribe(d),n.onHeaderMouseLeave.subscribe(l),n.onColumnsResized.subscribe(c)},destroy:function(){n.onDragEnd.unsubscribe(o),n.onHeaderClick.unsubscribe(s),n.onActiveCellChanged.unsubscribe(f),n.onKeyDown.unsubscribe(p),n.onHeaderMouseEnter.unsubscribe(d),n.onHeaderMouseLeave.unsubscribe(l),n.onColumnsResized.unsubscribe(c)}})}}.apply(t,a))||(e.exports=i)},34038:(e,t,n)=>{var a,i;a=[n(91669),n(58307)],void 0===(i=function(e,t){return{copyTextToClipboard:function(n){var a=document.createElement("textarea");a.style.position="fixed",a.style.top=0,a.style.left=0,a.style.width="2em",a.style.height="2em",a.style.padding=0,a.style.border="none",a.style.outline="none",a.style.boxShadow="none",a.style.background="transparent",document.body.appendChild(a),a.textContent=n,a.select();document.addEventListener("copy",(function e(t){document.removeEventListener("copy",e);var a=t.clipboardData||window.clipboardData;a&&(a.setData("text",n),window.parent.window.clipboardData=n,t.preventDefault())}));try{document.execCommand("copy")}catch(n){t.alert(e("Error"),e("Oops, unable to copy to clipboard"))}document.body.removeChild(a)},getTextFromClipboard:function(){return window.parent.window.clipboardData||""}}}.apply(t,a))||(e.exports=i)},14744:(e,t,n)=>{var a,i,r=n(64492);n(24812),n(69826),n(21249),a=[n(19755),n(25750),n(52947)],void 0===(i=function(e,t){return function(){var n=window.Slick,a=new n.EventHandler,i=new n.Event,o=new n.Event,s=function(t,n,a){var r=a.column;if(t.focus(),f(r)){var o=e(n.target);if(u(n)){if(e(n.target).hasClass("slick-resizable-handle"))return;o=e(n.target).parents(".slick-header-column")}o.toggleClass("selected"),o.hasClass("selected")&&i.notify(a,n),n.isPropagationStopped()||n.isImmediatePropagationStopped()||c(t,r.id)}else l(t)},l=function(t){if(e(".copy-with-header").hasClass("visibility-hidden"))e(".slick-header-column").each((function(t,n){e(n).removeClass("selected")}));else{var n=t.getSelectedRows();e(".slick-header-column").each((function(a,i){0==n.length?(e(i).removeClass("selected"),t.getColumns()[a].selected=!1):a>0&&t.getColumns()[a].selectable&&(e(i).addClass("selected"),t.getColumns()[a].selected=!0)}))}}.bind(t),d=function(n,a,i){e(".slick-header-column").each((function(a,r){var o=e(r).find('[data-cell-type="column-header-row"]'),s=n.getColumnIndex(o.data("column-id"));p(n,i,s)?(e(r).addClass("selected"),s&&(n.getColumns()[s].selected=!0)):t.areAllRangesCompleteRows(n,i)||(e(r).removeClass("selected"),s&&(n.getColumns()[s].selected=!1))}))},c=function(e,n){var a,i=e.getSelectionModel(),r=i.getSelectedRanges(),o=e.getColumnIndex(n),s=t.rangeForColumn(e,o);a=t.isRangeSelected(r,s)?t.removeRange(r,s):t.areAllRangesSingleColumns(r,e)?t.addRange(r,s):[s],i.setSelectedRanges(a)},u=function(t){return!e(t.target).hasClass("slick-header-column")},f=function(e){return!1!==e.selectable},p=function(e,n,a){var i=t.areAllRangesCompleteRows(e,n);return h(e,n,a)&&!i},h=function(e,n,a){var i=t.isRangeEntirelyWithinSelectedRanges(n,t.rangeForColumn(e,a)),r=t.isAnyCellOfColumnSelected(n,a);return i||r};e.extend(this,{init:function(e){a.subscribe(e.onHeaderClick,s.bind(null,e)),e.getSelectionModel().onSelectedRangesChanged.subscribe(d.bind(null,e)),o.subscribe((function(e,t){c(t.grid,t.column.id)}))},getColumnDefinitions:function(e){return r.map(e,(function(e){if(f(e)){var t="<span data-cell-type='column-header-row'        data-test='output-column-header'       data-column-id='"+e.id+"'>  <span class='column-description'>    <span class='column-name'>"+e.display_name+"</span>    <span class='column-type'>"+e.column_type+"</span>  </span></span>";return r.extend(e,{name:t})}return e}))},onBeforeColumnSelectAll:i,onColumnSelectAll:o,toggleColumnHeaderForCopyHeader:l})}}.apply(t,a))||(e.exports=i)},82927:(e,t,n)=>{var a,i;n(21249),a=[n(19755),n(81311),n(34038),n(25750),n(26602)],void 0===(i=function(e,t,n,a,i){var r=function(){return!e(".copy-with-header").hasClass("visibility-hidden")},o=function(t,n){t&&(e("#btn-paste-row").prop("disabled",!n),n&&window.parent.$&&window.parent.$(window.parent.document).trigger("pgadmin-sqleditor:rows-copied",r()))};return function(){var e=this||window,t=e.slickgrid,s=t.getColumns(),l=t.getSelectionModel().getSelectedRanges(),d=t.getData(),c=t.getSelectedRows(),u=t.CSVOptions;a.areAllRangesCompleteRows(t,l)?(e.copied_rows=c.map((function(e){return t.getDataItem(e)})),o(e.can_edit,!0)):(e.copied_rows=[],o(e.can_edit,!1));var f=i.rangesToCsv(d.getItems(),s,l,u,r());f&&n.copyTextToClipboard(f)}}.apply(t,a))||(e.exports=i)},18980:(e,t,n)=>{var a,i;n(24812),n(68309),a=[n(19755),n(91669),n(14744),n(18431),n(25750),n(28008)],void 0===(i=function(e,t,n,a,i,r){return function(o){var s=window.Slick,l=new a(o),d=new n(o),c=new s.Event,u=new s.Event,f=d.onBeforeColumnSelectAll,p=d.onColumnSelectAll;function h(t){i.isEntireGridSelected(t)?e("[data-id='select-all']").addClass("selected"):e("[data-id='select-all']").removeClass("selected")}e.extend(this,{init:function(t){this.grid=t,t.onHeaderClick.subscribe((function(n,a){a.column.selectAllOnClick&&!e(n.target).hasClass("slick-resizable-handle")&&function(e,t,n){i.isEntireGridSelected(e)?function(e){e.getSelectionModel().setSelectedRanges([])}(e):(c.notify(n,t),t.isPropagationStopped()||t.isImmediatePropagationStopped()||i.selectAll(e))}(t,n,a)})),t.getSelectionModel().onSelectedRangesChanged.subscribe(h.bind(null,t)),t.registerPlugin(l),t.registerPlugin(d),u.subscribe((function(e,t){i.selectAll(t.grid)}))},getColumnDefinitions:function(e){return e=d.getColumnDefinitions(e),(e=l.getColumnDefinitions(e))[0].selectAllOnClick=!0,e[0].name='<span data-id="select-all" title="'+t("Select/Deselect All")+'"><br>'+e[0].name+'<img class="select-all-icon" src="'+r("static",{filename:"img/select-all-icon.png"})+'"></img></span>',e},onBeforeGridSelectAll:c,onGridSelectAll:u,onBeforeGridColumnSelectAll:f,onGridColumnSelectAll:p})}}.apply(t,a))||(e.exports=i)},26602:(e,t,n)=>{var a,i,r=n(64492);n(2707),n(89554),n(54747),n(24812),n(69600),n(21249),n(74916),n(15306),n(83710),n(41539),n(39714),a=[n(25750),n(28210)],void 0===(i=function(e,t){return{getUnion:function(e){if(r.isEmpty(e))return[];e.sort((function(e,t){return e[0]-t[0]}));var t=[e[0]];return e.forEach((function(e){var n=r.last(t);!function(e,t){return e[0]<=t[1]+1}(e,n)?t.push(e):function(e,t){return e[1]<=t[1]}(e,n)||(n[1]=e[1])})),t},mapDimensionBoundaryUnion:function(e,t){var n=[];return e.forEach((function(e){for(var a=e[0];a<=e[1];a+=1)n.push(t(a))})),n},mapOver2DArray:function(e,t,n,a){var i=this.getUnion(e),r=this.getUnion(t);return this.mapDimensionBoundaryUnion(i,function(e){var t=this.mapDimensionBoundaryUnion(r,(function(t){return n(e,t)}));return a(t)}.bind(this))},getHeaderData:function(e,t){var n=[],a=t.field_separator||"\t",i=t.quote_char||'"';return r.each(e,(function(e){e.display_name&&e.selected&&n.push(i+e.display_name+i)})),n.join(a)},rangesToCsv:function(t,n,a,i,r){var o=a.map((function(e){return[e.fromRow,e.toRow]})),s=a.map((function(e){return[e.fromCell,e.toCell]}));e.isFirstColumnData(n)||(s=this.removeFirstColumn(s));var l=this.mapOver2DArray(o,s,this.csvCell.bind(this,t,n,i),(function(e){var t=i.field_separator||"\t";return e.join(t)}));if(r){return this.getHeaderData(n,i)+"\n"+l.join("\n")}return l.join("\n")},removeFirstColumn:function(e){var t=this.getUnion(e);if(0==t.length)return[];return 0==t[0][0]&&(0==t[0][1]?t.shift():t[0][0]=1),t},csvCell:function(e,n,a,i,o){var s=e[i][n[o].field],l=n[o].cell||"",d=a.quoting||"strings",c=a.quote_char||'"',u=function(e){return'"'==c?e.replace(/\"/g,'""'):e.replace(/\'/g,"''")};return"all"==d?s&&r.isObject(s)?s=c+t.stringify(s)+c:s?s=c+u(s.toString())+c:(r.isNull(s)||r.isUndefined(s))&&(s=""):"strings"==d&&(s&&r.isObject(s)?s=c+t.stringify(s)+c:s&&"number"!=l&&"boolean"!=l?s=c+u(s.toString())+c:"string"==l&&r.isNull(s)?s=null:(r.isNull(s)||r.isUndefined(s))&&(s="")),s}}}.apply(t,a))||(e.exports=i)},25750:(e,t,n)=>{var a,i,r=n(64492);n(57327),n(26541),n(24812),n(89554),n(54747),n(92222),n(34553),a=[n(52947)],void 0===(i=function(){var e=window.Slick,t=function(e,t){return e.fromCell==t.fromCell&&e.toCell==t.toCell&&e.fromRow==t.fromRow&&e.toRow==t.toRow},n=function(t){return new e.Range(0,1,t.getDataLength()-1,t.getColumns().length-1)},a=function(e){return!r.isUndefined(e[0].pos)},i=function(e,t){return t.fromCell==t.toCell&&0==t.fromRow&&t.toRow==e.getDataLength()-1},o=function(e,t){return 0===t.fromRow&&t.toRow===e.getDataLength()-1},s=function(e,t){return t.fromCell===function(e){return r.findIndex(e.getColumns(),(function(e){var t=e.pos;return!r.isUndefined(t)&&l(e)}))}(e)&&t.toCell===function(e){return r.findLastIndex(e.getColumns(),l)}(e)};function l(e){return r.isUndefined(e.selectable)||!0===e.selectable}return{addRange:function(e,t){return e.push(t),e},removeRange:function(e,n){return r.filter(e,(function(e){return!t(e,n)}))},isRangeSelected:function(e,n){return r.any(e,(function(e){return t(e,n)}))},areAllRangesSingleRows:function(e,t){return r.every(e,(function(e){return e.fromRow==e.toRow&&s(t,e)}))},areAllRangesSingleColumns:function(e,t){return r.every(e,i.bind(this,t))},areAllRangesCompleteRows:function(e,t){return r.every(t,(function(t){return s(e,t)}))},areAllRangesCompleteColumns:function(e,t){return r.every(t,(function(t){return o(e,t)}))},rangeForRow:function(t,n){var i=t.getColumns();return a(i)?new e.Range(n,0,n,t.getColumns().length-1):new e.Range(n,1,n,t.getColumns().length-1)},rangeForColumn:function(t,n){return new e.Range(0,n,t.getDataLength()-1,n)},isEntireGridSelected:function(e){var a=e.getSelectionModel().getSelectedRanges();return 1==a.length&&t(a[0],n(e))},getRangeOfWholeGrid:n,isFirstColumnData:a,getIndexesOfCompleteRows:function(e,t){var n=[];return t.forEach((function(t){s(e,t)&&(n=n.concat(r.range(t.fromRow,t.toRow+1)))})),n},selectAll:function(e){var t=n(e);e.getSelectionModel().setSelectedRanges([t])},isRangeAColumn:i,rangeHasCompleteColumns:o,rangeHasCompleteRows:s,isAnyCellOfColumnSelected:function(e,t){return r.any(e,(function(e){return e.fromCell<=t&&e.toCell>=t}))},isRangeEntirelyWithinSelectedRanges:function(e,t){return r.any(e,(function(e){return e.fromCell<=t.fromCell&&e.toCell>=t.toCell&&e.fromRow<=t.fromRow&&e.toRow>=t.toRow}))},isAnyCellOfRowSelected:function(e,t){return r.any(e,(function(e){return e.fromRow<=t&&e.toRow>=t}))}}}.apply(t,a))||(e.exports=i)},18431:(e,t,n)=>{var a,i;n(24812),n(69826),n(91058),a=[n(19755),n(25750),n(14744),n(52947)],void 0===(i=function(e,t,n){return function(){var a=new window.Slick.EventHandler,i=new n,r=function(t,n,a){if("row-header-column"===t.getColumns()[a.cell].id){var r=e(n.target);"row-header-selector"!=r.data("cell-type")&&(r=e(n.target).find('[data-cell-type="row-header-selector"]')),r.parent().toggleClass("selected"),s(t,a.row),i.toggleColumnHeaderForCopyHeader(t)}},o=function(t,n,a){e('[data-cell-type="row-header-selector"]').each((function(n,i){var r=e(i),o=parseInt(r.data("row"));l(t,a,o)?r.parent().addClass("selected"):r.parent().removeClass("selected")}))},s=function(e,n){var a,i=e.getSelectionModel(),r=i.getSelectedRanges(),o=t.rangeForRow(e,n);a=t.isRangeSelected(r,o)?t.removeRange(r,o):t.areAllRangesSingleRows(r,e)?t.addRange(r,o):[o],i.setSelectedRanges(a)},l=function(e,n,a){var i=t.areAllRangesCompleteColumns(e,n);return function(e,n,a){var i=t.isRangeEntirelyWithinSelectedRanges(n,t.rangeForRow(e,a)),r=t.isAnyCellOfRowSelected(n,a);return i||r}(e,n,a)&&!i};e.extend(this,{init:function(e){e.getSelectionModel().onSelectedRangesChanged.subscribe(o.bind(null,e)),a.subscribe(e.onClick,r.bind(null,e))},getColumnDefinitions:function(e){return e.unshift({id:"row-header-column",name:"",selectable:!1,focusable:!1,formatter:function(e){return'<span data-row="'+e+'" data-cell-type="row-header-selector">'+(e+1)+"</span>"},width:30}),e}})}}.apply(t,a))||(e.exports=i)},40904:(e,t,n)=>{var a,i;n(85827),n(69826),n(66992),n(41539),n(33948),a=[n(19755),n(81311),n(25750)],void 0===(i=function(e,t,n){function a(t){e(t).prop("disabled",!0)}function i(t){e(t).prop("disabled",!1)}function r(e,n,a,i){return t.reduce(e,(function(e,r){var o=a.getItem(r);return function(e,n){if(t.isUndefined(e))return!0;return!t.isUndefined(t.find(n,(function(n){return t.isUndefined(e[n])})))}(o,n)||(e[o[i]]=function(e,n){var a={};e&&e.length&&t.each(t.keys(n),(function(i){t.contains(e,i)&&(a[i]=n[i])}));return a}(n,o)),e}),{})}return function(){var e=this;function o(t){e.editor.handler.data_store.staged_rows=t}if(a("#btn-delete-row"),a("#btn-copy-row"),this.selection.getSelectedRanges().length>0&&i("#btn-copy-row"),n.areAllRangesCompleteRows(e.grid,e.selection.getSelectedRanges())){var s=n.getIndexesOfCompleteRows(this.grid,this.selection.getSelectedRanges()),l=function(e,n){var a=e.grid.getData();return r(n,t.keys(e.keys),a,e.client_primary_key)}(e,s);o(l),t.isEmpty(l)&&this.selection.setSelectedRows([]),e.editor.handler.can_edit&&!t.isEmpty(l)&&i("#btn-delete-row")}else o({})}}.apply(t,a))||(e.exports=i)},12436:(e,t,n)=>{var a,i;a=[n(19755),n(81311),n(25750),n(1950),n(52947)],void 0===(i=function(e,t,n,a){return function(i){var r,o,s=window.Slick,l=[],d=this,c=new s.CellRangeSelector({selectionCss:{border:"2px solid black"},offset:{top:0,left:-1,height:2,width:1}}),u={selectActiveCell:!0};function f(e){for(var t=[],n=0;n<e.length;n++){var a=e[n];r.canCellBeSelected(a.fromRow,a.fromCell)&&r.canCellBeSelected(a.toRow,a.toCell)&&t.push(a)}return t}function p(e){(l&&0!==l.length||e&&0!==e.length)&&(l=f(e),d.onSelectedRangesChanged.notify(l))}function h(){return l}function _(e){if(r.getEditorLock().isActive())return e.stopPropagation(),!1}function g(e,t){p([t.range])}function m(e,t){o.selectActiveCell&&null!=t.row&&null!=t.cell&&p([new s.Range(t.row,t.cell)])}function b(e){var t,n,a,i,o,l,d,c,u,_,g,m=r.getActiveCell();function b(t){return e.which===t}if(m&&function(e){return e.shiftKey&&!e.ctrlKey&&!e.altKey&&function(e){return 39==e.which||37==e.which||38==e.which||40==e.which}(e)}(e)){(t=h()).length||t.push(new s.Range(m.row,m.cell)),(n=t.pop()).contains(m.row,m.cell)||(n=new s.Range(m.row,m.cell));var v=(_=m,(g={}).row=(u=n).fromRow===_.row?u.toRow:u.fromRow,g.cell=u.fromCell===_.cell?u.toCell:u.fromCell,g);switch(e.which){case 37:v.cell-=1;break;case 39:v.cell+=1;break;case 38:v.row-=1;break;case 40:v.row+=1}var y=(i=v,o=(a=m).cell<=i.cell?a.cell:i.cell,l=a.cell<=i.cell?i.cell:a.cell,d=a.row<=i.row?a.row:i.row,c=a.row<=i.row?i.row:a.row,new s.Range(d,o,c,l));if(f([y]).length){var w=m.row===y.fromRow?y.toRow:y.fromRow,x=m.cell===y.fromCell?y.toCell:y.fromCell;b(39)||b(37)?r.scrollColumnIntoView(x):(b(38)||b(40))&&r.scrollRowIntoView(w),t.push(y)}else t.push(n);p(t),e.preventDefault(),e.stopPropagation()}}function v(){var e=c.getCurrentRange();t.isUndefined(e)||r.onDragEnd.notify({range:e})}e.extend(this,{getSelectedRanges:h,setSelectedRanges:p,setSelectedRows:function(e){l=[];for(var t=0;t<e.length;t++)l.push(n.rangeForRow(r,e[t]))},init:function(t){o=e.extend(!0,{},u,i),(r=t).onActiveCellChanged.subscribe(m),r.onKeyDown.subscribe(b),t.registerPlugin(c),c.onCellRangeSelected.subscribe(g),c.onBeforeCellRangeSelected.subscribe(_),e(a.default).on("mouseup",v)},destroy:function(){r.onActiveCellChanged.unsubscribe(m),r.onKeyDown.unsubscribe(b),c.onCellRangeSelected.unsubscribe(g),c.onBeforeCellRangeSelected.unsubscribe(_),r.unregisterPlugin(c),e(a.default).off("mouseup",v)},onSelectedRangesChanged:new s.Event})}}.apply(t,a))||(e.exports=i)},73870:(e,t)=>{var n;void 0===(n=function(){return function(e){var t=Math.abs(e),n=0,a=["bytes","kB","MB","GB","TB","PB"];if(t<10240)return t+" "+a[n];do{t/=1024,n+=1}while(t>10239);return Math.round(t)+" "+a[n]}}.apply(t,[]))||(e.exports=n)},79387:(e,t,n)=>{var a,i=n(19755);n(24812),n(69826),(a=i).extend(!0,window,{Slick:{Plugins:{HeaderButtons:function(e){var t,n=this,i=new window.Slick.EventHandler,r={buttonCssClass:"slick-header-button"};function o(t,n){var i=n.column;if(i.header&&i.header.buttons)for(var r=i.header.buttons.length;r--;){var o=i.header.buttons[r],s=a("<div></div>").addClass(e.buttonCssClass).data("column",i).data("button",o);o.content&&s.append(o.content),o.showOnHover&&s.addClass("slick-header-button-hidden"),o.image&&s.css("backgroundImage","url("+o.image+")"),o.cssClass&&s.addClass(o.cssClass),o.tooltip&&s.attr("title",o.tooltip),o.command&&s.data("command",o.command),o.handler&&s.bind("click",o.handler),s.bind("click",l).prependTo(n.node)}}function s(t,n){var i=n.column;i.header&&i.header.buttons&&a(n.node).find("."+e.buttonCssClass).remove()}function l(e){var i=a(this).data("command"),r=a(this).data("column"),o=a(this).data("button");null!=i&&(n.onCommand.notify({grid:t,column:r,command:i,button:o},e,n),t.updateColumnHeader(r.id)),e.preventDefault(),e.stopPropagation()}a.extend(this,{init:function(n){e=a.extend(!0,{},r,e),t=n,i.subscribe(t.onHeaderCellRendered,o).subscribe(t.onBeforeHeaderCellDestroy,s),t.setColumns(t.getColumns())},destroy:function(){i.unsubscribeAll()},onCommand:new window.Slick.Event})}}}})},40370:(e,t,n)=>{var a,i;a=[n(82927),n(25750)],void 0===(i=function(e,t){return function(n,a){var i=n.keyCode,r=n.ctrlKey||n.metaKey,o=this||window;o.slickgrid=a.grid,r&&67==i&&e.apply(o),r&&65==i&&t.selectAll(o.slickgrid)}}.apply(t,a))||(e.exports=i)},5205:(e,t,n)=>{var a,i=n(19755);n(69826),(a=i).extend(!0,window,{Slick:{AutoColumnSize:function(){var e,t,n,i={A:65};function r(e){e.ctrlKey&&e.shiftKey&&e.keyCode===i.A&&o()}function o(n){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.find(".slick-header-column"),o=e.getColumns();r.each((function(t,r){var s=a(r).data("column");if(void 0===s.width||isNaN(s.width)||i){var c=d(r),u=e.getColumnIndex(s.id),f=o[u],p=Math.max(c,l(s,u))+1;void 0!==n&&n>0&&(p=Math.min(n,p)),f.width=p+(s.addWidth||0)}})),e.setColumns(o),e.onColumnsResized.notify()}function s(t){var n=a(t.currentTarget).closest(".slick-header-column"),i=n.data("column");if(i&&i.resizable){t.preventDefault(),t.stopPropagation();var r=d(n[0]),o=e.getColumnIndex(i.id),s=e.getColumns(),c=s[o],u=Math.max(r,l(i,o))+1;u!==c.width&&(c.width=u,e.setColumns(s),e.onColumnsResized.notify())}}function l(i,r){var o=[],s=function(){var e=a('<div class="slick-row"><div class="slick-cell"></div></div>');e.find(".slick-cell").css({visibility:"hidden","text-overflow":"initial","white-space":"nowrap"});var n=t.find(".grid-canvas").first();return a(n).append(e),e}(),l=e.getData();window.Slick.Data&&l instanceof window.Slick.Data.DataView&&(l=l.getItems());for(var d=0;d<l.length;d++)o.push(l[d][i.field]);var c=function(e,t){var n=a(e.find(".slick-cell"));return n.append(t),n.find("*").css("position","relative"),n.outerWidth()+1}(s,function(e,t,i,r,o){var s=0,l=null,d=t.formatter;return a(e).each((function(e,c){var u;d&&(c=(u=a("<span>"+d(e,i,c,t,r[e])+"</span>")).text()||c);var f=c?function(e,t){return n.font=e.css("font-size")+" "+e.css("font-family"),n.measureText(t).width}(o,c):0;f>s&&(s=f,l=u||c)})),l}(o,i,r,l,s));return function(e){a(e).remove()}(s),c}function d(e){var t,n=e.cloneNode(!0);return n.style.cssText="position: absolute; visibility: hidden;right: auto;text-overflow: initial;white-space: nowrap;",e.parentNode.insertBefore(n,e),t=n.offsetWidth,n.parentNode.removeChild(n),t}return{init:function(i){(t=a((e=i).getContainerNode())).on("dblclick.autosize",".slick-resizable-handle",s),t.keydown(r),n=document.createElement("canvas").getContext("2d"),e.resizeAllColumns=o},destroy:function(){t.off()}}}}})},92007:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.calculateQueryRunTime=function(e,t){var n,r,o,s=(0,a.default)(t).diff(e);return n=parseInt(s/1e3),s%=1e3,r=parseInt(n/60),n%=60,o=parseInt(r/60),r%=60,((o>0?o+" "+(0,i.default)("hr")+" ":"")+(r>0?r+" "+(0,i.default)("min")+" ":"")+(o<=0&&n>0?n+" "+(0,i.default)("secs")+" ":"")+(o<=0&&r<=0?s+" "+(0,i.default)("msec")+" ":"")).trim()},n(91058),n(73210);var a=r(n(30381)),i=r(n(91669));function r(e){return e&&e.__esModule?e:{default:e}}},45592:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.callRenderAfterPoll=function(e,t,n){if(e.query_end_time=new Date,e.rows_affected=n.rows_affected,e.has_more_rows=n.has_more_rows,function(e){return null!=e.colinfo}(n))e._render(n);else{e.total_time=(0,i.calculateQueryRunTime)(e.query_start_time,e.query_end_time);var a=(0,r.default)("Query returned successfully in %s.",e.total_time);n.result?n.result+="\n\n"+a:n.result=a,e.update_msg_history(!0,n.result,!1),e.reset_data_store(),function(e){return e.info_notifier_timeout>=0}(e)&&t.success(a,e.info_notifier_timeout),e.enable_disable_download_btn(!0)}(function(e){return e.is_query_tool})(e)&&e.disable_tool_buttons(!1);e.trigger("pgadmin-sqleditor:check_synchronous_db_name_change",n),e.setIsQueryRunning(!1),e.trigger("pgadmin-sqleditor:loading-icon:hide")},n(83710);var a,i=n(92007),r=(a=n(91669))&&a.__esModule?a:{default:a}},65887:(e,t,n)=>{var a=n(64492);n(82526),n(41817),n(41539),n(32165),n(66992),n(78783),n(33948),n(4129),n(38880),n(69070),n(32564),n(83710);var i=p(n(91669)),r=p(n(19755)),o=p(n(28008)),s=p(n(9669)),l=f(n(90865)),d=f(n(20882)),c=f(n(81240));function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}function f(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==h(e)&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var a={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var o=i?Object.getOwnPropertyDescriptor(e,r):null;o&&(o.get||o.set)?Object.defineProperty(a,r,o):a[r]=e[r]}return a.default=e,n&&n.set(e,a),a}function p(e){return e&&e.__esModule?e:{default:e}}function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function m(e,t,n){return t&&g(e.prototype,t),n&&g(e,n),e}var b=function(){function e(t){_(this,e),this.sqlEditor=t}return m(e,[{key:"setMessage",value:function(e){this.sqlEditor.trigger("pgadmin-sqleditor:loading-icon:message",(0,i.default)(e))}},{key:"show",value:function(e){this.sqlEditor.trigger("pgadmin-sqleditor:loading-icon:show",e)}},{key:"hide",value:function(){this.sqlEditor.trigger("pgadmin-sqleditor:loading-icon:hide")}}]),e}(),v=function(){function e(t,n){_(this,e),this.sqlServerObject=t,this.loadingScreen=new b(t),this.userManagement=n}return m(e,[{key:"delayedPoll",value:function(){var e=this;setTimeout((function(){e.poll()}),e.sqlServerObject.POLL_FALLBACK_TIME())}},{key:"execute",value:function(t,n,a){if(t.length<=0)(0,r.default)("#btn-flash").prop("disabled",!1);else{var i=this;i.explainPlan=n;var o=e.prepareAnalyzeSql(t,n);i.initializeExecutionOnSqlEditor(o),s.default.post(this.generateURLReconnectionFlag(a),JSON.stringify(o),{headers:{"Content-Type":"application/json"}}).then((function(t){var n=t.data;i.removeGridViewMarker(),i.updateSqlEditorLastTransactionStatus(n.data.transaction_status),e.isSqlCorrect(n)?(i.loadingScreen.setMessage("Waiting for the query to complete..."),c.disable_connection_dropdown(!0),i.updateSqlEditorStateWithInformationFromServer(n.data),i.delayedPoll()):(i.loadingScreen.hide(),i.enableSQLEditorButtons(),i.disableDownloadButton(),t.data.data.transaction_status==d.TRANSACTION_STATUS_INTRANS||t.data.data.transaction_status==d.TRANSACTION_STATUS_INERROR?i.enableTransactionButtons():i.disableTransactionButtons(),i.sqlServerObject.update_msg_history(!1,n.data.result),"notifies"in n.data&&i.sqlServerObject.update_notifications(n.data.notifies),i.sqlServerObject._highlight_error(n.data.result))})).catch((function(e){i.onExecuteHTTPError(e)}))}}},{key:"generateURLReconnectionFlag",value:function(e){var t=(0,o.default)("sqleditor.query_tool_start",{trans_id:this.sqlServerObject.transId});return e&&(t+="?connect=1"),t}},{key:"poll",value:function(){var t=this,n=this;s.default.get((0,o.default)("sqleditor.poll",{trans_id:n.sqlServerObject.transId})).then((function(a){n.updateSqlEditorLastTransactionStatus(a.data.data.transaction_status),a.data.data.transaction_status==d.TRANSACTION_STATUS_INTRANS||a.data.data.transaction_status==d.TRANSACTION_STATUS_INERROR?n.enableTransactionButtons():n.disableTransactionButtons(),e.isQueryFinished(a)?(t.sqlServerObject.close_on_idle_transaction&&a.data.data.transaction_status==d.TRANSACTION_STATUS_IDLE&&t.sqlServerObject.check_needed_confirmations_before_closing_panel(),n.loadingScreen.setMessage("Loading data from the database server and rendering..."),n.sqlServerObject.call_render_after_poll(a.data.data),"notifies"in a.data.data&&n.sqlServerObject.update_notifications(a.data.data.notifies)):e.isQueryStillRunning(a)?(t.delayedPoll(),n.sqlServerObject.setIsQueryRunning(!0),a.data.data.result&&n.sqlServerObject.update_msg_history(a.data.data.status,a.data.data.result,!1)):e.isConnectionToServerLostWhilePolling(a)?(n.loadingScreen.hide(),n.sqlServerObject.is_query_tool&&n.enableSQLEditorButtons(),n.sqlServerObject.update_msg_history(!1,a.data.data.result,!0)):e.isQueryCancelled(a)&&(n.loadingScreen.hide(),n.sqlServerObject.update_msg_history(!1,"Execution Cancelled!",!0)),n.sqlServerObject.is_query_tool&&!e.isQueryStillRunning(a)&&c.disable_connection_dropdown(!1)})).catch((function(t){if(n.sqlServerObject.resetQueryHistoryObject(n.sqlServerObject),n.loadingScreen.hide(),n.sqlServerObject.setIsQueryRunning(!1),n.sqlServerObject.is_query_tool&&(n.enableSQLEditorButtons(),c.disable_connection_dropdown(!1)),t.response){if(e.wasConnectionLostToPythonServer(t.response))return void n.handleConnectionToServerLost();var a=t.response.data;if(n.userManagement.isPgaLoginRequired(a))return n.userManagement.pgaLogin();var i=e.extractErrorMessage(a);n.sqlServerObject.update_msg_history(!1,i),n.sqlServerObject._highlight_error(i)}else{if(t.request)return void n.handleConnectionToServerLost();console.error(t)}}))}},{key:"initializeExecutionOnSqlEditor",value:function(e){this.loadingScreen.show((0,i.default)("Running query...")),(0,r.default)("#btn-flash").prop("disabled",!0),this.disableDownloadButton(),this.sqlServerObject.query_start_time=new Date,"object"===h(e)?this.sqlServerObject.query=e.sql:this.sqlServerObject.query=e,this.sqlServerObject.rows_affected=0,this.sqlServerObject._init_polling_flags(),this.disableSQLEditorButtons(),this.disableTransactionButtons()}},{key:"onExecuteHTTPError",value:function(t){if(this.loadingScreen.hide(),this.enableSQLEditorButtons(),e.wasConnectionLostToPythonServer(t.response))this.handleConnectionToServerLost();else{if(this.userManagement.isPgaLoginRequired(t.response)&&(this.sqlServerObject.saveState("check_data_changes_to_execute_query",[this.explainPlan]),this.userManagement.pgaLogin()),l.httpResponseRequiresNewTransaction(t.response)&&(this.sqlServerObject.saveState("check_data_changes_to_execute_query",[this.explainPlan]),this.sqlServerObject.initTransaction()),this.wasDatabaseConnectionLost(t)&&(this.sqlServerObject.saveState("check_data_changes_to_execute_query",[this.explainPlan]),this.sqlServerObject.handle_connection_lost(!1,t)),this.isCryptKeyMissing(t))return this.sqlServerObject.saveState("check_data_changes_to_execute_query",[this.explainPlan]),void this.sqlServerObject.handle_cryptkey_missing();var n=t.response.data.errormsg;this.sqlServerObject.update_msg_history(!1,n)}}},{key:"wasDatabaseConnectionLost",value:function(e){return 503===e.response.status&&void 0!==e.response.data.info&&"CONNECTION_LOST"===e.response.data.info}},{key:"isCryptKeyMissing",value:function(e){return 503===e.response.status&&void 0!==e.response.data.info&&"CRYPTKEY_MISSING"===e.response.data.info}},{key:"removeGridViewMarker",value:function(){this.sqlServerObject.gridView.marker&&(this.sqlServerObject.gridView.marker.clear(),delete this.sqlServerObject.gridView.marker,this.sqlServerObject.gridView.marker=null,this.sqlServerObject.gridView.query_tool_obj.removeLineClass(this.sqlServerObject.marked_line_no,"wrap","CodeMirror-activeline-background"))}},{key:"disableDownloadButton",value:function(){this.sqlServerObject.enable_disable_download_btn(!0)}},{key:"enableSQLEditorButtons",value:function(){this.sqlServerObject.disable_tool_buttons(!1)}},{key:"disableSQLEditorButtons",value:function(){this.sqlServerObject.disable_tool_buttons(!0)}},{key:"enableTransactionButtons",value:function(){this.sqlServerObject.disable_transaction_buttons(!1)}},{key:"disableTransactionButtons",value:function(){this.sqlServerObject.special_sql=void 0,this.sqlServerObject.disable_transaction_buttons(!0)}},{key:"handleConnectionToServerLost",value:function(){this.sqlServerObject.update_msg_history(!1,(0,i.default)("Not connected to the server or the connection to the server has been closed."))}},{key:"updateSqlEditorStateWithInformationFromServer",value:function(e){this.sqlServerObject.can_edit=e.can_edit,this.sqlServerObject.can_filter=e.can_filter,this.sqlServerObject.info_notifier_timeout=e.info_notifier_timeout}},{key:"updateSqlEditorLastTransactionStatus",value:function(e){this.sqlServerObject.last_transaction_status=e}}],[{key:"prepareAnalyzeSql",value:function(e,t){return{sql:e,explain_plan:t}}},{key:"wasConnectionLostToPythonServer",value:function(e){return a.isUndefined(e)||a.isUndefined(e.data)}},{key:"isSqlCorrect",value:function(e){return e.data.status}},{key:"extractErrorMessage",value:function(e){var t=e.errormsg;return void 0!==e.responseJSON&&void 0!==e.responseJSON.errormsg&&(t=e.responseJSON.errormsg),t}},{key:"isQueryFinished",value:function(e){return"Success"===e.data.data.status}},{key:"isQueryStillRunning",value:function(e){return"Busy"===e.data.data.status}},{key:"isQueryCancelled",value:function(e){return"Cancel"===e.data.data.status}},{key:"isConnectionToServerLostWhilePolling",value:function(e){return"NotConnected"===e.data.data.status}}]),e}();e.exports={ExecuteQuery:v}},87913:(e,t,n)=>{n(69826),n(68309),n(5735),n(83753),n(32564);var a=f(n(91669)),i=f(n(28008)),r=f(n(19755)),o=f(n(55455)),s=f(n(55112)),l=f(n(12030)),d=f(n(9669)),c=f(n(16240)),u=n(90865);function f(e){return e&&e.__esModule?e:{default:e}}var p=n(94860),h={geturl:function(e,t){var n=(0,i.default)("sqleditor.get_filter_data",{trans_id:e});return t&&(n+="?connect=1"),n},dialog:function(e,t){var n=(0,a.default)("Sort/Filter options");r.default.ajax({url:this.geturl(e.transId,t),headers:{"Cache-Control":"no-cache"}}).done((function(t){var u=t.data.result;o.default.filterDialog&&delete o.default.filterDialog,o.default.dialog("filterDialog",(function(){var t=(0,r.default)("<div class='data_sorting_dialog'></div>");return{main:function(){this.set("title",(0,a.default)("Sort/Filter options"))},build:function(){this.elements.content.appendChild(t.get(0)),o.default.pgDialogBuild.apply(this)},setup:function(){return{buttons:[{text:"",key:112,className:"btn btn-primary-icon pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:(0,a.default)("Help"),"aria-label":(0,a.default)("Help"),url:(0,i.default)("help.static",{filename:"editgrid.html"})}},{text:(0,a.default)("Cancel"),key:27,className:"btn btn-secondary fa fa-times pg-alertify-button","data-btn-name":"cancel"},{text:(0,a.default)("OK"),className:"btn btn-primary fa fa-check pg-alertify-button","data-btn-name":"ok"}],options:{title:n,padding:!1,overflow:!1,model:0,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1,modal:!1,autoReset:!1}}},hooks:{onclose:function(){this.view&&(this.filterCollectionModel.stopSession(),this.view.model.stopSession(),this.view.remove({data:!0,internal:!0,silent:!0}))}},prepare:function(){var e=this;t.html(""),this.__internal.buttons[2].element.disabled=!0,this.statusBar=(0,r.default)('<div class=\'pg-prop-status-bar pg-el-xs-12 d-none\'>  <div class="error-in-footer">     <div class="d-flex px-2 py-1">       <div class="pr-2">         <i class="fa fa-exclamation-triangle text-danger" aria-hidden="true"></i>       </div>       <div class="alert-text" role="alert"></div>     </div>   </div> </div>').appendTo(t),this.showFilterProgress=(0,r.default)('<div id="show_filter_progress" class="pg-sp-container sql-editor-busy-fetching d-none">\n                  <div class="pg-sp-content">\n                      <div class="row"><div class="col-12 pg-sp-icon sql-editor-busy-icon"></div></div>\n                      <div class="row"><div class="col-12 pg-sp-text sql-editor-busy-text">'+(0,a.default)("Loading data...")+"</div></div>\n                  </div>\n              </div>").appendTo(t),(0,r.default)(e.showFilterProgress[0]).removeClass("d-none"),e.filterCollectionModel=(0,c.default)(u);var n=l.default.generateViewSchema(null,e.filterCollectionModel,"create",null,null,!0),i=this.view=new l.default.Dialog({el:"<div></div>",model:e.filterCollectionModel,schema:n});(0,r.default)(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties obj_properties"),t.append(i.render().$el),i.listenTo(i.model,"pgadmin-session:start",(function(){i.listenTo(i.model,"pgadmin-session:invalid",(function(t){e.statusBar.removeClass("d-none"),(0,r.default)(e.statusBar.find(".alert-text")).html(t),e.__internal.buttons[2].element.disabled=!0})),i.listenTo(i.model,"pgadmin-session:valid",(function(){e.statusBar.addClass("d-none"),(0,r.default)(e.statusBar.find(".alert-text")).html(""),e.__internal.buttons[2].element.disabled=!1}))})),i.listenTo(i.model,"pgadmin-session:stop",(function(){i.stopListening(i.model,"pgadmin-session:invalid"),i.stopListening(i.model,"pgadmin-session:valid")})),i.model.startNewSession(),i.model.get("data_sorting").add(u.data_sorting),(0,r.default)(e.showFilterProgress[0]).addClass("d-none")},callback:function(t){var n=this;if("dialog_help"==t.button.element.name)return t.cancel=!0,void s.default.Browser.showHelp(t.button.element.name,t.button.element.getAttribute("url"),null,null);if("ok"===t.button["data-btn-name"]){t.cancel=!0;var l=this.filterCollectionModel.toJSON();(0,r.default)(n.showFilterProgress[0]).removeClass("d-none"),d.default.put((0,i.default)("sqleditor.set_filter_data",{trans_id:e.transId}),l).then((function(t){(0,r.default)(n.showFilterProgress[0]).addClass("d-none");var i=t.data.data;i.status?setTimeout((function(){n.close(),o.default.success((0,a.default)("Filter updated successfully")),p.executeQuery(e)}),10):o.default.alert((0,a.default)("Validation Error"),i.result)})).catch((function(t){(0,r.default)(n.showFilterProgress[0]).addClass("d-none"),e.onExecuteHTTPError(t),setTimeout((function(){o.default.error(t)}),10)}))}else n.close()}}})),o.default.filterDialog(n).resizeTo(s.default.Browser.stdW.md,s.default.Browser.stdH.md)})).fail((function(t){(0,u.handleQueryToolAjaxError)(s.default,e,t,"_show_filter",[],!0)}))}};e.exports=h},16240:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={asc:(0,a.default)("ASC"),desc:(0,a.default)("DESC")},n=r.default.Browser.DataModel.extend({idAttribute:"name",defaults:{name:void 0,order:"asc"},schema:[{id:"name",name:"name",label:(0,a.default)("Column"),cell:"select2",editable:!0,cellHeaderClasses:"width_percent_60",headerCell:o.default.Extension.CustomHeaderCell,disabled:!1,control:"select2",select2:{allowClear:!1},options:function(){return i.default.map(e.column_list,(function(e){return{value:e,label:e}}))}},{id:"order",name:"order",label:(0,a.default)("Order"),control:"select2",cell:"select2",cellHeaderClasses:"width_percent_40",headerCell:o.default.Extension.CustomHeaderCell,editable:!0,deps:["type"],select2:{allowClear:!1},options:function(){return i.default.map(t,(function(e,t){return{value:t,label:e}}))}}],validate:function(){var e=null;return this.errorModel.clear(),i.default.isUndefined(this.get("name"))||i.default.isNull(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(e=(0,a.default)("Please select a column."),this.errorModel.set("name",e),e):i.default.isUndefined(this.get("order"))||i.default.isNull(this.get("order"))||""==String(this.get("order")).replace(/^\s+|\s+$/g,"")?(e=(0,a.default)("Please select the order."),this.errorModel.set("order",e),e):null}});return new(r.default.Browser.DataModel.extend({idAttribute:"sql",defaults:{sql:e.sql||null},schema:[{id:"sql",label:(0,a.default)("SQL Filter"),cell:"string",type:"text",mode:["create"],control:s.default.SqlFieldControl.extend({render:function(){var e=s.default.SqlFieldControl.prototype.render.apply(this,arguments);return setTimeout((function(){e.sqlCtrl.focus()}),1e3),e}}),extraClasses:["custom_height_css_class"]},{id:"data_sorting",name:"data_sorting",label:(0,a.default)("Data Sorting"),model:n,editable:!0,type:"collection",mode:["create"],control:"unique-col-collection",uniqueCol:["name"],canAdd:!0,canEdit:!1,canDelete:!0,visible:!0,version_compatible:!0}],validate:function(){return null}}))},n(21249),n(74916),n(15306),n(32564);var a=l(n(91669)),i=l(n(81311)),r=l(n(55112)),o=l(n(71158)),s=l(n(12030));function l(e){return e&&e.__esModule?e:{default:e}}},74898:(e,t,n)=>{var a=n(64492);n(21249),n(66992),n(41539),n(33948),n(44914),n(32564),n(51532),n(78783),n(26541),n(91058),n(82772),n(69600);var i=s(n(91669)),r=n(48764),o=s(n(19755));function s(e){return e&&e.__esModule?e:{default:e}}var l=null,d=null,c={panel_closed:!0,go_for_render:function(e,t,n,i){var r=this;if(r.map_component||(r.map_component=function(){var e={radius:4,weight:3},t={weight:2},n={closeButton:!1,minWidth:260,maxWidth:300,maxHeight:300},i=(0,o.default)('<div class="geometry-viewer-container"></div>'),r=l.map(i.get(0),{preferCanvas:!0}).setZoom(0);r.attributionControl.setPrefix("");var s=l.geoJSON([],{style:t,pointToLayer:function(t,n){return l.circleMarker(n,e)}});s.addTo(r);var d={Empty:l.tileLayer(""),Street:l.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>'}),Topography:l.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{maxZoom:17,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>, &copy; <a href="http://viewfinderpanoramas.org" target="_blank">SRTM</a>, &copy; <a href="https://opentopomap.org" target="_blank">OpenTopoMap</a>'}),"Gray Style":l.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>, &copy; <a href="http://cartodb.com/attributions" target="_blank">CartoDB</a>',subdomains:"abcd",maxZoom:19}),"Light Color":l.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/rastertiles/voyager/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>, &copy; <a href="http://cartodb.com/attributions" target="_blank">CartoDB</a>',subdomains:"abcd",maxZoom:19}),"Dark Matter":l.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>, &copy; <a href="http://cartodb.com/attributions" target="_blank">CartoDB</a>',subdomains:"abcd",maxZoom:19})},c=l.control.layers(d),u=d.Street,f=a.values(d),p=l.control({position:"topright"});p.onAdd=function(){return this._div=l.DomUtil.create("div","geometry-viewer-info-control"),this._div},p.update=function(e){this._div.innerHTML=e};var h=function(){r.options.crs!==l.CRS.EPSG3857&&(r.options.crs=l.CRS.EPSG3857,c.addTo(r),r.addLayer(u),i.addClass("geometry-viewer-container-plain-background"),r.setMinZoom(0))},_=function(){r.options.crs!==l.CRS.Simple&&(r.options.crs=l.CRS.Simple,c.remove(),a.each(f,(function(e){r.hasLayer(e)&&(u=e,e.remove())})),i.removeClass("geometry-viewer-container-plain-background"))};return _(),h(),{mapContainer:i,clearMap:function(){r.closePopup(),p.remove(),s.clearLayers()},loseFocus:function(){r.fire("blur")},renderMap:function(e){var t=e.geoJSONs,a=e.selectedSRID,i=e.getPopupContent,o=e.infoList,d=!1;0===t.length&&(d=!0);try{s.addData(t)}catch(e){o.push("An error occurred while rendering data."),d=!0}var u=s.getBounds();if(u.isValid()||(d=!0),o.length>0){r.options.crs===l.CRS.EPSG3857?(c.remove(),p.addTo(r),c.addTo(r)):p.addTo(r);var f=function(e){return e.join("<br>")}(o);p.update(f)}if(d)return _(),void r.setView([0,0],r.getZoom());if("function"==typeof i){var g=function(e){e.bindPopup((function(){return i(e.feature.geometry)}),n)};s.eachLayer(g)}u=u.pad(.1);var m=Math.max(u.getNorth()-u.getSouth(),u.getEast()-u.getWest());if(4326===a)h();else if(_(),m>=180){var b=Math.floor(Math.log2(360/m))-2;r.setMinZoom(b)}else r.setMinZoom(0);m>0?r.fitBounds(u):r.setView(u.getCenter(),r.getZoom())},resizeMap:function(){setTimeout((function(){r.invalidateSize()}),10)}}}()),r.panel_closed){var s=window.wcDocker,c=e.gridView.geometry_viewer=e.gridView.docker.addPanel("geometry_viewer",s.DOCK.STACKED,e.gridView.data_output_panel);(0,o.default)("#geometry_viewer_panel")[0].appendChild(r.map_component.mapContainer.get(0)),r.panel_closed=!1,c.on(s.EVENT.CLOSED,(function(){(0,o.default)("#geometry_viewer_panel").empty(),r.map_component.clearMap(),r.panel_closed=!0})),c.on(s.EVENT.RESIZE_ENDED,(function(){c.isVisible()&&r.map_component.resizeMap()})),c.on(s.EVENT.VISIBILITY_CHANGED,(function(e){e?r.map_component.resizeMap():r.map_component.loseFocus()}))}e.gridView.geometry_viewer.focus(),r.map_component.clearMap();var f=u(t,n,i,d);r.map_component.renderMap(f)},render_geometries:function(e,t,a,i){var r=this;n.e(322).then(function(o){l=n(45243),d=n(11011).Geometry,r.go_for_render(e,t,a,i)}.bind(null,n)).catch((function(e){throw e}))},add_header_button:function(e){e.header={buttons:[{cssClass:"div-view-geometry-column",tooltip:"View all geometries in this column",showOnHover:!1,command:"view-geometries",content:'<button class="btn-xs btn-primary"><i class="fa fa-eye" aria-hidden="true"></i></button>'}]}},parse_data:u};function u(e,t,n,o){var s=t[n].field,l=[],d=[],c=[],u=[],f=new Map,p=!1,h=0,_=!1,g=!1;if(0===e.length)return u.push("Empty row."),{geoJSONs:[],selectedSRID:0,getPopupContent:void 0,infoList:u};if(a.every(e,(function(e){try{var t=e[s],n=r.Buffer.from(t,"hex"),a=o.parse(n);if(a.hasZ)l.push(a);else{if((h+=n.byteLength)>20971520)return _=!0,!1;if(d.length>=1e5)return g=!0,!1;a.srid||(a.srid=0),d.push(a),f.set(a,e)}}catch(t){c.push(e)}return!0})),(_||g)&&u.push(d.length+" of "+e.length+" geometries rendered."),l.length>0&&u.push((0,i.default)("3D geometries not rendered.")),c.length>0&&u.push((0,i.default)("Unsupported geometries not rendered.")),0===d.length)return{geoJSONs:[],selectedSRID:0,getPopupContent:void 0,infoList:u};var m=a.groupBy(d,"srid"),b=a.pairs(m);b.length>1&&(p=!0);var v,y=a.max(b,(function(e){return e[1].length})),w=parseInt(y[0]),x=y[1],C=a.map(x,(function(e){return e.toGeoJSON()}));return t.length>=3&&(v=function(e){var i=x[C.indexOf(e)];return function(e,t,n){for(var i='<table class="table table-bordered table-striped view-geometry-property-table"><tbody>',r=1;r<t.length;r++)if(r!==n){var o=t[r];i+="<tr><th>"+o.display_name+"</th>";var s=e[o.field];a.isUndefined(s)&&o.has_default_val?i+='<td class="td-disabled">[default]</td>':a.isUndefined(s)&&o.not_null||a.isUndefined(s)||null===s?i+='<td class="td-disabled">[null]</td>':i+="<td>"+s+"</td>",i+="</tr>"}return i+="</tbody></table>"}(f.get(i),t,n)}),p&&u.push((0,i.default)("Geometries with non-SRID %s not rendered.",w)),{geoJSONs:C,selectedSRID:w,getPopupContent:v,infoList:u}}e.exports=c},16770:(e,t,n)=>{var a=n(64492);function i(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(40561),n(69070);var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.historyList=a.sortBy(t,(function(e){return e.start_time})),this.onAdd((function(){}))}var t,n,r;return t=e,(n=[{key:"length",value:function(){return this.historyList.length}},{key:"add",value:function(e){var t=a.sortedIndex(this.historyList,e,(function(e){return e.start_time}));this.historyList.splice(t,0,e),this.onAddHandler(e)}},{key:"reset",value:function(){this.historyList=[],this.onResetHandler(this.historyList)}},{key:"onAdd",value:function(e){this.onAddHandler=e}},{key:"onReset",value:function(e){this.onResetHandler=e}}])&&i(t.prototype,n),r&&i(t,r),e}();t.default=r},13895:(e,t,n)=>{n(47941),n(82526),n(57327),n(38880),n(89554),n(54747),n(49337),n(33321),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(24812),n(21249),n(69070);var a=l(n(27894)),i=n(1964),r=l(n(33486)),o=l(n(91669)),s=l(n(19755));function l(e){return e&&e.__esModule?e:{default:e}}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var p=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parentNode=t,this.histCollection=n,this.editorPref={},this.onCopyToEditorHandler=function(){},this.histCollection.onAdd(this.onAddEntry.bind(this)),this.histCollection.onReset(this.onResetEntries.bind(this))}var t,n,l;return t=e,(n=[{key:"focus",value:function(){this.queryHistEntries&&this.queryHistEntries.focus()}},{key:"onAddEntry",value:function(e){1==this.histCollection.length()?this.render():this.queryHistEntries&&this.queryHistEntries.addEntry(e)}},{key:"onResetEntries",value:function(){this.isRendered=!1,this.queryHistEntries=null,this.queryHistDetails=null,this.render()}},{key:"onCopyToEditorClick",value:function(e){this.onCopyToEditorHandler=e,this.queryHistDetails&&this.queryHistDetails.onCopyToEditorClick(this.onCopyToEditorHandler)}},{key:"setEditorPref",value:function(e){this.editorPref=c(c({},this.editorPref),e),this.queryHistDetails&&this.queryHistDetails.setEditorPref(this.editorPref)}},{key:"render",value:function(){var e=this;if(0==this.histCollection.length())this.parentNode.empty().removeClass("d-flex").append('<div role="status" class="pg-panel-message">'+(0,o.default)("No history found")+"</div>");else{this.parentNode.empty().addClass("d-flex");var t=(0,s.default)("<div><div>").appendTo(this.parentNode),n=(0,s.default)("<div><div>").appendTo(this.parentNode);(0,r.default)([t[0],n[0]],{gutterSize:1,cursor:"ew-resize"}),this.queryHistDetails=new a.default(n),this.queryHistDetails.setEditorPref(this.editorPref),this.queryHistDetails.onCopyToEditorClick(this.onCopyToEditorHandler),this.queryHistDetails.render(),this.queryHistEntries=new i.QueryHistoryEntries(t),this.queryHistEntries.onSelectedChange(function(t){e.queryHistDetails.setEntry(t)}.bind(this)),this.queryHistEntries.render(),this.histCollection.historyList.map((function(t){e.queryHistEntries.addEntry(t)}))}}}])&&f(t.prototype,n),l&&f(t,l),e}();t.default=p},27894:(e,t,n)=>{n(47941),n(82526),n(57327),n(38880),n(89554),n(54747),n(49337),n(33321),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(74916),n(4723),n(32564),n(92222),n(69826),n(24812),n(69070);var a=l(n(20811)),i=l(n(34038)),r=l(n(91669)),o=l(n(19755)),s=l(n(81311));function l(e){return e&&e.__esModule?e:{default:e}}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parentNode=t,this.isCopied=!1,this.timeout=null,this.isRendered=!1,this.sqlFontSize=null,this.onCopyToEditorHandler=function(){},this.editorPref={sql_font_size:"1em",copy_to_editor:!0}}var t,n,l;return t=e,(n=[{key:"setEntry",value:function(e){this.entry=e,this.isRendered?this.selectiveRender():this.render()}},{key:"setEditorPref",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.editorPref=c(c({},this.editorPref),e),this.query_codemirror&&!s.default.isUndefined(e.sql_font_size)&&((0,o.default)(this.query_codemirror.getWrapperElement()).css("font-size",this.editorPref.sql_font_size),this.query_codemirror.refresh()),this.$copyToEditor&&!s.default.isUndefined(e.copy_to_editor)&&(e.copy_to_editor?this.$copyToEditor.removeClass("d-none"):this.$copyToEditor.addClass("d-none"))}},{key:"parseErrorMessage",value:function(e){return e.match(/ERROR:\s*([^\n\r]*)/i)?e.match(/ERROR:\s*([^\n\r]*)/i)[1]:e}},{key:"formatDate",value:function(e){return e.toLocaleDateString()+" "+e.toLocaleTimeString()}},{key:"copyAllHandler",value:function(){var e=this;i.default.copyTextToClipboard(this.entry.query),this.clearPreviousTimeout(),this.updateCopyButton(!0),this.timeout=setTimeout((function(){e.updateCopyButton(!1)}),1500)}},{key:"onCopyToEditorClick",value:function(e){this.onCopyToEditorHandler=e}},{key:"clearPreviousTimeout",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}},{key:"updateCopyButton",value:function(e){e?(this.$copyBtn.addClass("was-copied").removeClass("copy-all"),this.$copyBtn.text((0,r.default)("Copied!"))):(this.$copyBtn.addClass("copy-all").removeClass("was-copied"),this.$copyBtn.text((0,r.default)("Copy")))}},{key:"updateQueryMetaData",value:function(){var e=function(e,t){return e?"<div class='item'>\n                  <span class='value'>".concat(e,"</span>\n                  <span class='description'>").concat(t,"</span>\n              </div>"):""};this.$metaData.empty().append('<div class="metadata">'+e(this.formatDate(this.entry.start_time),(0,r.default)("Date"))+e(this.entry.row_affected.toLocaleString(),(0,r.default)("Rows Affected"))+e(this.entry.total_time,(0,r.default)("Duration"))+"</div>")}},{key:"updateMessageContent",value:function(){this.$message_content.empty().append("<pre class='content-value'>".concat(s.default.escape(this.entry.message),"</pre>"))}},{key:"updateErrorMessage",value:function(){this.entry.status?(this.$errMsgBlock.addClass("d-none"),this.$errMsgBlock.empty()):(this.$errMsgBlock.removeClass("d-none"),this.$errMsgBlock.empty().append("<div class='history-error-text'>\n            <span>"+(0,r.default)("Error Message")+"</span> ".concat(s.default.escape(this.parseErrorMessage(this.entry.message)),"\n        </div>")))}},{key:"updateInfoMessage",value:function(){this.entry.info?(this.$infoMsgBlock.removeClass("d-none"),this.$infoMsgBlock.empty().append("<div class='history-info-text'>\n            ".concat(this.entry.info,"\n        </div>"))):(this.$infoMsgBlock.addClass("d-none"),this.$infoMsgBlock.empty())}},{key:"selectiveRender",value:function(){this.updateErrorMessage(),this.updateInfoMessage(),this.updateCopyButton(!1),this.updateQueryMetaData(),this.query_codemirror.setValue(this.entry.query),this.updateMessageContent()}},{key:"render",value:function(){var e=this;this.entry&&(this.parentNode.empty().append("<div id='query_detail' class='query-detail'>\n            <div class='error-message-block'></div>\n            <div class='info-message-block'></div>\n            <div class='metadata-block'></div>\n            <div class='query-statement-block'>\n              <div id='history-detail-query'>\n                <button class='btn-copy' tabindex=0 accesskey='y'></button>\n                <button class='btn-copy-editor copy-to-editor' tabindex=0 accesskey='y'>"+(0,r.default)("Copy to Query Editor")+"</button>\n                <div></div>\n              </div>\n            </div>\n            <div>\n              <hr class='block-divider'/>\n            </div>\n            <div class='message-block'>\n              <div class='message'>\n                <div class='message-header'>"+(0,r.default)("Messages")+"</div>\n                <div class='content'></div>\n              </div>\n            </div>\n        </div>"),this.$errMsgBlock=this.parentNode.find(".error-message-block"),this.$infoMsgBlock=this.parentNode.find(".info-message-block"),this.$copyBtn=this.parentNode.find("#history-detail-query .btn-copy"),this.$copyBtn.off("click").on("click",this.copyAllHandler.bind(this)),this.$copyToEditor=this.parentNode.find("#history-detail-query .btn-copy-editor"),this.$copyToEditor.off("click").on("click",(function(){e.onCopyToEditorHandler(e.entry.query)})),this.$copyToEditor.addClass(this.editorPref.copy_to_editor?"":"d-none"),this.$metaData=this.parentNode.find(".metadata-block"),this.query_codemirror=(0,a.default)(this.parentNode.find("#history-detail-query div")[0],{tabindex:-1,mode:"text/x-pgsql",readOnly:!0}),(0,o.default)(this.query_codemirror.getWrapperElement()).css("font-size",this.editorPref.sql_font_size),this.$message_content=this.parentNode.find(".message-block .content"),this.isRendered=!0,this.selectiveRender())}}])&&f(t.prototype,n),l&&f(t,l),e}();t.default=p},1964:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.QueryHistoryEntries=t.QueryHistoryItem=t.QueryHistoryEntryDateGroup=void 0,n(92222),n(69826),n(82772),n(21249),n(24812),n(69070);var a=s(n(30381)),i=s(n(19755)),r=s(n(81311));n(56796);var o=s(n(91669));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function c(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}var u=function(){function e(t,n){l(this,e),this.date=t,this.formatString="MMM DD YYYY",this.groupKey=n}return c(e,[{key:"getDatePrefix",value:function(){var e="";return this.isDaysBefore(0)?e="Today - ":this.isDaysBefore(1)&&(e="Yesterday - "),e}},{key:"getDateFormatted",value:function(e){return e.toLocaleDateString()}},{key:"isDaysBefore",value:function(e){return this.getDateFormatted(this.date)===this.getDateFormatted((0,a.default)().subtract(e,"days").toDate())}},{key:"render",value:function(){return(0,i.default)("<div class='query-group' data-key='".concat(this.groupKey,"'>\n            <div class='date-label'>").concat(this.getDatePrefix()).concat(this.getDateFormatted(this.date),"</div>\n            <ul class='query-entries'></ul>\n        </div>"))}}]),e}();t.QueryHistoryEntryDateGroup=u;var f=function(){function e(t){l(this,e),this.entry=t,this.$el=null,this.onClickHandler=null}return c(e,[{key:"onClick",value:function(e){var t=this;this.onClickHandler=e,this.$el&&this.$el.off("click").on("click",(function(e){t.onClickHandler((0,i.default)(e.currentTarget))}))}},{key:"formatDate",value:function(e){return(0,a.default)(e).format("HH:mm:ss")}},{key:"dataKey",value:function(){return this.formatDate(this.entry.start_time)}},{key:"render",value:function(e){var t=this;this.$el=(0,i.default)("<li class='list-item' tabindex='0' data-key='".concat(this.dataKey(),"'>\n          <div class='entry ").concat(this.entry.status?"":"error",'\'>\n              <div class=\'query\'>\n                  <span id="query_source_icon" class="query-history-icon sql-icon-lg"></span>\n                  ').concat(r.default.escape(this.entry.query),"\n              </div>\n              <div class='other-info'>\n              <div class='timestamp'>").concat(this.formatDate(this.entry.start_time),"</div>\n              </div>\n          </div>\n      </li>")).data("entrydata",this.entry).on("click",(function(e){t.onClickHandler((0,i.default)(e.currentTarget))}));var n=this.entry.query_source;n&&this.$el.find("#query_source_icon").addClass(n.ICON_CSS_CLASS).attr("role","img"),this.entry.is_pgadmin_query&&(this.$el.addClass("pgadmin-query-history-entry"),e||this.$el.addClass("d-none"))}}]),e}();t.QueryHistoryItem=f;var p=function(){function e(t){l(this,e),this.parentNode=t,this.$selectedItem=null,this.groupKeyFormat="YYYY MM DD",this.$el=null,this.is_pgadmin_queries_shown=null}return c(e,[{key:"onSelectedChange",value:function(e){this.onSelectedChangeHandler=e}},{key:"focus",value:function(){this.$selectedItem||this.setSelectedListItem(this.$entriesEl.find(".list-item").first()),this.$selectedItem.trigger("click"),this.$entriesEl.focus()}},{key:"isArrowDown",value:function(e){return 40===(e.keyCode||e.which)}},{key:"isArrowUp",value:function(e){return 38===(e.keyCode||e.which)}},{key:"navigateUpAndDown",value:function(e){var t=[38,40],n=e.keyCode||e.which;return!(t.indexOf(n)>-1)||(e.preventDefault(),this.onKeyDownHandler(e),!1)}},{key:"onKeyDownHandler",value:function(e){if(this.isArrowDown(e))if(this.$selectedItem.next().length>0)this.setSelectedListItem(this.$selectedItem.next());else{var t=this.$selectedItem.closest(".query-group");t.next().length>0&&this.setSelectedListItem(t.next().find(".list-item").first())}else if(this.isArrowUp(e))if(this.$selectedItem.prev().length>0)this.setSelectedListItem(this.$selectedItem.prev());else{var n=this.$selectedItem.closest(".query-group");n.prev().length>0&&this.setSelectedListItem(n.prev().find(".list-item").last())}}},{key:"onSelectListItem",value:function(e){this.setSelectedListItem((0,i.default)(e.currentTarget))}},{key:"dateAsGroupKey",value:function(e){return(0,a.default)(e).format(this.groupKeyFormat)}},{key:"setSelectedListItem",value:function(e){this.$selectedItem&&this.$selectedItem.removeClass("selected"),e.addClass("selected"),this.$selectedItem=e,this.$selectedItem[0].scrollIntoView({block:"center"}),this.onSelectedChangeHandler&&this.onSelectedChangeHandler(this.$selectedItem.data("entrydata"))}},{key:"addEntry",value:function(e){var t=this.$entriesEl.find(".query-group"),n=i.default.map(t,(function(e){return(0,i.default)(e).attr("data-key")})),a=this.dateAsGroupKey(e.start_time),o=r.default.indexOf(n,a),s=null;if(0==t.length)s=new u(e.start_time,a).render(),this.$entriesEl.prepend(s);else if(o<0&&0!=t.length){s=new u(e.start_time,a).render();for(var l=0;l<n.length;){if(a>n[l]){s.insertBefore(t[l]);break}l++}l==n.length&&this.$entriesEl.append(s)}else o>=0&&(s=(0,i.default)(t[o]));var d=new f(e);if(d.onClick(this.setSelectedListItem.bind(this)),d.render(this.is_pgadmin_queries_shown),!r.default.isUndefined(s)){var c=s.find(".query-entries").find(".list-item"),p=0;if(c.length>0)for(;p<c.length;){if(d.$el.attr("data-key")>(0,i.default)(c[p]).attr("data-key")){(0,i.default)(d.$el).insertBefore(c[p]);break}(0,i.default)(d.$el).insertAfter(c[p]),p++}else s.find(".query-entries").append(d.$el)}this.setSelectedListItem(d.$el)}},{key:"toggleGeneratedQueries",value:function(){this.$el.find(".pgadmin-query-history-entry").each((function(){(0,i.default)(this).toggleClass("d-none")})),this.is_pgadmin_queries_shown=!this.is_pgadmin_queries_shown}},{key:"render",value:function(){var e=this;e.$el=(0,i.default)('\n        <div class="toggle-and-history-container">\n            <div class="query-history-toggle">\n                <label class="control-label" for="generated-queries-toggle">\n                    '+(0,o.default)("Show queries generated internally by pgAdmin?")+'\n                </label>\n                <input id="generated-queries-toggle" type="checkbox"\n                  class="pgadmin-controls" data-style="quick"\n                  data-size="mini" data-on="'+(0,o.default)("Yes")+'" data-off="'+(0,o.default)("No")+"\"\n                  data-onstyle=\"success\" data-offstyle=\"ternary\" checked>\n            </div>\n            <div id='query_list' class='query-history' tabindex='0'></div>\n        </div>\n    "),e.$entriesEl=e.$el.find("#query_list"),e.$entriesEl.on("keydown",this.navigateUpAndDown.bind(this)),e.is_pgadmin_queries_shown=!0,e.$el.find("#generated-queries-toggle").bootstrapToggle().change((function(){e.toggleGeneratedQueries()})),e.parentNode.empty().append(e.$el)}}]),e}();t.QueryHistoryEntries=p},67563:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.QuerySources=void 0;t.QuerySources={EXECUTE:{ICON_CSS_CLASS:"fa fa-play"},EXPLAIN:{ICON_CSS_CLASS:"fa fa-hand-pointer"},EXPLAIN_ANALYZE:{ICON_CSS_CLASS:"fa fa-list-alt"},COMMIT:{ICON_CSS_CLASS:"pg-font-icon icon-commit"},ROLLBACK:{ICON_CSS_CLASS:"pg-font-icon icon-rollback"},SAVE_DATA:{ICON_CSS_CLASS:"pg-font-icon icon-save_data_changes"},VIEW_DATA:{ICON_CSS_CLASS:"pg-font-icon picon-view_data"}}},5221:(e,t,n)=>{n(69826),n(68309),n(5735),n(83753),n(32564),n(57327),n(92222);var a=f(n(91669)),i=f(n(28008)),r=f(n(19755)),o=f(n(81311)),s=f(n(55455)),l=f(n(55112)),d=f(n(12030)),c=f(n(48567)),u=f(n(9669));function f(e){return e&&e.__esModule?e:{default:e}}var p={dialog:function(e){var t=(0,a.default)("Manage Macros");s.default.macroDialog&&delete s.default.macroDialog,s.default.dialog("macroDialog",(function(){var n=(0,r.default)("<div class='macro_dialog'></div>");return{main:function(){this.set("title",'<i class="fa fa-scroll sql-icon-lg" aria-hidden="true" role="img"></i> '+(0,a.default)("Manage Macros"))},build:function(){this.elements.content.appendChild(n.get(0)),s.default.pgDialogBuild.apply(this)},setup:function(){return{buttons:[{text:"",key:112,className:"btn btn-primary-icon pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:(0,a.default)("Help"),"aria-label":(0,a.default)("Help"),url:(0,i.default)("help.static",{filename:"query_tool.html"})}},{text:(0,a.default)("Cancel"),key:27,className:"btn btn-secondary fa fa-times pg-alertify-button","data-btn-name":"cancel"},{text:(0,a.default)("Save"),className:"btn btn-primary fa fa-save pg-alertify-button","data-btn-name":"ok"}],focus:{element:function(){return(0,r.default)(this.elements.dialog).find(".header-icon-cell button")[0]},select:!0},options:{title:t,padding:!1,overflow:!1,model:0,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1,modal:!1,autoReset:!1}}},hooks:{onclose:function(){this.view&&(this.macroCollectionModel.stopSession(),this.view.model.stopSession(),this.view.remove({data:!0,internal:!0,silent:!0}))}},prepare:function(){var t=this;n.html(""),this.statusBar=(0,r.default)('<div class=\'pg-prop-status-bar pg-el-xs-12 d-none\'>  <div class="error-in-footer">     <div class="d-flex px-2 py-1">       <div class="pr-2">         <i class="fa fa-exclamation-triangle text-danger" aria-hidden="true"></i>       </div>       <div class="alert-text" role="alert"></div>     </div>   </div> </div>').appendTo(n),this.showFilterProgress=(0,r.default)('<div id="show_filter_progress" class="pg-sp-container sql-editor-busy-fetching d-none">\n              <div class="pg-sp-content">\n                  <div class="row"><div class="col-12 pg-sp-icon sql-editor-busy-icon"></div></div>\n                  <div class="row"><div class="col-12 pg-sp-text sql-editor-busy-text">'+(0,a.default)("Loading data...")+"</div></div>\n              </div>\n          </div>").appendTo(n),t.macroCollectionModel=(0,c.default)(e.transId);var i=d.default.generateViewSchema(null,t.macroCollectionModel,"edit",null,null,!0),s=d.default.Dialog.extend({template:{panel:o.default.template('<div role="tabpanel" tabindex="-1" class="tab-pane <%=label%> <%=tabPanelCodeClass%> pg-el-sm-12 pg-el-md-12 pg-el-lg-12 pg-el-12 fade" id="<%=cId%>"></div>')},render:function(){this.cleanup();var e=this.model,t=this.controls,n=this.template,a=this,i=100*this.tabIndex;this.$el.empty().attr("role","tabpanel").attr("class",o.default.result(this,"tabPanelClassName")),e.panelEl=this.$el;var s=(0,r.default)('<div class="tab-content pg-el-sm-12 pg-el-md-12 pg-el-lg-12 pg-el-12 macro-tab"></div>').appendTo(this.$el);return o.default.each(this.schema,(function(l){if(i++,l.version_compatible&&(d=l.visible,c=l,u=e,o.default.isFunction(d)?d.apply(c,[u]):d)){var d,c,u,f=(0,r.default)(n.panel(o.default.extend(l,{tabIndex:i,tabPanelCodeClass:l.tabPanelCodeClass?l.tabPanelCodeClass:""}))).appendTo(s).removeClass("collapse").addClass("collapse");l.fields.each((function(n){var r=new(n.get("control"))({field:n,model:e,dialog:a,tabIndex:i});f.append(r.render().$el),t.push(r)}))}})),s.find(".tab-pane").first().addClass("active show"),this}}),l=t.view=new s({el:"<div></div>",model:t.macroCollectionModel,schema:i});t.macroCollectionModel.fetch({success:function(){n.append(t.view.render().$el),t.__internal.buttons[2].element.disabled=!0,t.view.listenTo(t.view.model,"pgadmin-session:start",(function(){t.view.listenTo(t.view.model,"pgadmin-session:invalid",(function(e){t.statusBar.removeClass("d-none"),(0,r.default)(t.statusBar.find(".alert-text")).html(e),t.__internal.buttons[2].element.disabled=!0})),l.listenTo(t.view.model,"pgadmin-session:valid",(function(){t.statusBar.addClass("d-none"),(0,r.default)(t.statusBar.find(".alert-text")).html(""),t.__internal.buttons[2].element.disabled=!1}))})),l.listenTo(t.view.model,"pgadmin-session:stop",(function(){l.stopListening(t.view.model,"pgadmin-session:invalid"),l.stopListening(t.view.model,"pgadmin-session:valid")})),t.view.model.startNewSession()}}),(0,r.default)(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties obj_properties")},callback:function(t){var n=this;if("dialog_help"==t.button.element.name)return t.cancel=!0,void l.default.Browser.showHelp(t.button.element.name,t.button.element.getAttribute("url"),null,null);if("ok"===t.button["data-btn-name"]){t.cancel=!0;var d=n.view.model.get("macro").toJSON(!0);if(null==d||null==d)return void n.close();u.default.put((0,i.default)("sqleditor.set_macros",{trans_id:e.transId}),d).then((function(t){(0,r.default)(n.showFilterProgress[0]).addClass("d-none");var i=t;i.status?setTimeout((function(){var t=n.view.model.get("macro").toJSON().filter((function(e){return void 0!==e.name||null!==e.name}));e.macros=t;var i='\n                      <li>\n                          <a class="dropdown-item" id="btn-manage-macros" href="#" tabindex="0">\n                              <span> '.concat((0,a.default)("Manage Macros...")," </span>\n                          </a>\n                      </li>"),l="";o.default.each(t,(function(e){e.name&&(l+='<li>\n                        <a class="dropdown-item btn-macro" data-macro-id="'.concat(e.id,'" href="#" tabindex="0">\n                            <span> ').concat(o.default.escape(e.name)," </span>\n                            <span> (").concat(e.key_label,") </span>\n                        </a>\n                       </li>"))})),l.length>0&&(i+='<li class="dropdown-divider"></li>'+l),(0,r.default)(r.default.find("div.btn-group.mr-1.user_macros ul.dropdown-menu")).html((0,r.default)(i)),n.close(),s.default.success((0,a.default)("Macro updated successfully"))}),10):s.default.alert((0,a.default)("Validation Error"),i.result)})).catch((function(e){(0,r.default)(n.showFilterProgress[0]).addClass("d-none"),setTimeout((function(){s.default.error(e.response.data.errormsg)}),10)}))}else n.close()}}})),s.default.macroDialog(t).resizeTo(l.default.Browser.stdW.calc(l.default.Browser.stdW.lg),l.default.Browser.stdH.calc(l.default.Browser.stdH.lg))}};e.exports=p},48567:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=i.default.Browser.DataModel.extend({idAttribute:"id",defaults:{id:void 0,key:void 0,name:void 0,sql:void 0,key_label:void 0},schema:[{id:"key_label",name:"key_label",label:(0,a.default)("Key"),type:"text",cell:"string",editable:!1,cellHeaderClasses:"width_percent_10",headerCell:o.default.Extension.CustomHeaderCell,disabled:!1},{id:"name",name:"name",label:(0,a.default)("Name"),cell:"string",type:"text",editable:!0,cellHeaderClasses:"width_percent_20",headerCell:o.default.Extension.CustomHeaderCell,disabled:!1},{id:"sql",name:"sql",label:(0,a.default)("SQL"),cell:o.default.Extension.SqlCell,type:"multiline",control:r.default.SqlCodeControl,editable:!0,cellHeaderClasses:"width_percent_70",headerCell:o.default.Extension.CustomHeaderCell,disabled:!1}],validate:function(){var e=null;return this.errorModel.clear(),d.default.isEmpty(this.get("name"))&&!d.default.isEmpty(this.get("sql"))?(e=(0,a.default)("Please enter macro name."),this.errorModel.set("name",e),e):d.default.isEmpty(this.get("sql"))&&!d.default.isEmpty(this.get("name"))?(e=(0,a.default)("Please enter macro sql."),this.errorModel.set("sql",e),e):null}});return new(i.default.Browser.DataModel.extend({defaults:{macro:void 0},urlRoot:(0,s.default)("sqleditor.get_macros",{trans_id:e}),schema:[{id:"macro",name:"macro",label:(0,a.default)("Macros"),model:t,editable:!0,type:"collection",control:r.default.SubNodeCollectionControl.extend({showGridControl:function(e){var t=this,n=(0,l.default)("<div class='pgadmin-control-group backgrid form-group pg-el-12 object subnode'></div>"),s=e.subnode.schema?e.subnode:e.subnode.prototype,u=r.default.generateGridColumnsFromModel(e.node_info,s,this.field.get("mode"),e.columns,e.schema_node);t.grid&&t.grid.remove(),(e.disabled||0==e.canAdd)&&(0,l.default)(n).find("button.add").remove(),u.columns.unshift({name:"pg-backform-clear",label:'<i aria-label="'+(0,a.default)("Clear row")+'" class="fa fa-eraser" title="'+(0,a.default)("Clear row")+'"></i>',cell:o.default.Extension.ClearCell,editable:!1,cell_priority:-1,sortable:!1,headerCell:o.default.Extension.CustomHeaderCell.extend({className:"header-icon-cell",events:{click:"clearrAll"},clearrAll:function(e){e.preventDefault();var t=this;t.collection.toJSON().filter((function(e){return void 0!==e.name&&null!==e.name})).length>0&&c.default.confirm((0,a.default)("Clear All Rows"),(0,a.default)("Are you sure you wish to clear all rows?"),(function(){d.default.each(t.collection.toJSON(),(function(e){t.collection.get(e.id).set({name:null,sql:null})}))}),(function(){return!0}))},render:function(){this.$el.empty();var e=this.column,t=(0,l.default)('<button type="button" title="'+(0,a.default)("Clear row")+'" aria-label="Clear row" aria-expanded="false" tabindex="0">').html(e.get("label")).append("<span class='sort-caret' aria-hidden='true'></span>");return this.$el.append(t),this.$el.addClass(e.get("name")),this.$el.addClass(e.get("direction")),this.$el.attr("role","columnheader"),this.$el.attr("aria-label","columnheader"),this.$el.attr("alt","columnheader"),this.delegateEvents(),this}})});var f=t.model.get(e.name);f||(f=new i.default.Browser.Node.Collection(null,{handler:t.model.handler||t.model,model:e.model,top:t.model.top||t.model,silent:!0}),t.model.set(e.name,f,{silent:!0}));f.on("enteringEditMode",(function(e){var t=this,n=e[0];this.each((function(e){if(n.model!=e){var a=t.indexOf(e);if(a>-1){var i=p.body.rows[a].$el.find(".subnode-edit-in-process").parent();if(i.length>0){var r=new Event("click");i[0].dispatchEvent(r)}}}}))}),f);var p=t.grid=new o.default.Grid({columns:u.columns,collection:f,row:this.row,className:"backgrid table presentation table-bordered table-noouter-border table-hover"}),h=p.render().$el;return n.append(h)}}),columns:["key_label","name","sql"],visible:!0}],validate:function(){return null}}))},n(69826),n(57327),n(5735),n(83753),n(68309),n(82772);var a=u(n(91669)),i=u(n(55112)),r=u(n(12030)),o=u(n(71158)),s=u(n(28008)),l=u(n(19755)),d=u(n(81311)),c=u(n(55455));function u(e){return e&&e.__esModule?e:{default:e}}},11346:(e,t,n)=>{var a=n(64492);n(69826),n(74916),n(15306),n(24603),n(39714),n(68309),n(5735),n(83753),n(89554),n(54747),n(91058),n(32564);var i=u(n(91669)),r=u(n(28008)),o=u(n(19755)),s=u(n(55455)),l=u(n(55112)),d=u(n(12030)),c=u(n(16880));function u(e){return e&&e.__esModule?e:{default:e}}var f={dialog:function(e,t,n){var u=(0,r.default)("sqleditor.get_new_connection_data",{sid:e.url_params.sid,sgid:e.url_params.sgid});t&&(u+="?connect=1");var f=(0,i.default)("Connect to server");o.default.ajax({url:u,headers:{"Cache-Control":"no-cache"}}).done((function(t){var u=t.data.result;u.database_list=[],u.user_list=[],s.default.newConnectionDialog&&delete s.default.newConnectionDialog,s.default.dialog("newConnectionDialog",(function(){var t=(0,o.default)("<div class='new-connection-dialog'></div>");return{main:function(e){this.msg=e},build:function(){this.elements.content.appendChild(t.get(0)),s.default.pgDialogBuild.apply(this)},setup:function(){return{buttons:[{text:"",key:112,className:"btn btn-primary-icon pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:(0,i.default)("Help"),"aria-label":(0,i.default)("Help"),url:(0,r.default)("help.static",{filename:"query_tool.html"})}},{text:(0,i.default)("Cancel"),key:27,className:"btn btn-secondary fa fa-times pg-alertify-button","data-btn-name":"cancel"},{text:(0,i.default)("OK"),key:13,className:"btn btn-primary fa fa-check pg-alertify-button","data-btn-name":"ok"}],focus:{element:function(){return(0,o.default)(this.elements.dialog).find(".new-connection-dialog .nav-link.active.show")},select:!0},options:{title:f,padding:!1,overflow:!1,model:0,resizable:!0,maximizable:!1,pinnable:!1,closableByDimmer:!1,modal:!1,autoReset:!1,closable:!1}}},prepare:function(){var n=this;t.html(""),this.__internal.buttons[2].element.disabled=!0,this.statusBar=(0,o.default)('<div class=\'pg-prop-status-bar pg-el-xs-12 d-none\'>  <div class="error-in-footer">     <div class="d-flex px-2 py-1">       <div class="pr-2">         <i class="fa fa-exclamation-triangle text-danger" aria-hidden="true"></i>       </div>       <div class="alert-text" role="alert"></div>     </div>   </div> </div>').appendTo(t),this.showNewConnectionProgress=(0,o.default)('<div id="show_filter_progress" class="pg-sp-container sql-editor-busy-fetching d-none">\n                <div class="pg-sp-content">\n                    <div class="row"><div class="col-12 pg-sp-icon sql-editor-busy-icon"></div></div>\n                    <div class="row"><div class="col-12 pg-sp-text sql-editor-busy-text">'+(0,i.default)("Loading data...")+"</div></div>\n                </div>\n            </div>").appendTo(t),(0,o.default)(n.showNewConnectionProgress[0]).removeClass("d-none"),n.newConnCollectionModel=(0,c.default)(u,e.url_params.sgid,e.url_params.sid,e,n);var a=d.default.generateViewSchema(null,n.newConnCollectionModel,"create",null,null,!0),r=this.view=new d.default.Dialog({el:"<div></div>",model:n.newConnCollectionModel,schema:a});(0,o.default)(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties obj_properties"),t.append(r.render().$el),r.listenTo(r.model,"pgadmin-session:start",(function(){r.listenTo(r.model,"pgadmin-session:invalid",(function(e){n.statusBar.removeClass("d-none"),(0,o.default)(n.statusBar.find(".alert-text")).html(e),n.__internal&&(n.__internal.buttons[2].element.disabled=!0)})),r.listenTo(r.model,"pgadmin-session:valid",(function(){n.statusBar.addClass("d-none"),(0,o.default)(n.statusBar.find(".alert-text")).html(""),n.__internal&&(n.__internal.buttons[2].element.disabled=!1)}))})),r.listenTo(r.model,"pgadmin-session:stop",(function(){r.stopListening(r.model,"pgadmin-session:invalid"),r.stopListening(r.model,"pgadmin-session:valid")})),r.model.startNewSession(),(0,o.default)(n.showNewConnectionProgress[0]).addClass("d-none")},get_title:function(e,t,n,a){return e=e.replace(new RegExp("%DATABASE%"),t),e=(e=n.role?e.replace(new RegExp("%USERNAME%"),n.role):e.replace(new RegExp("%USERNAME%"),n.user)).replace(new RegExp("%SERVER%"),a.server_name)},callback:function(t){if("dialog_help"==t.button.element.name)return t.cancel=!0,void l.default.Browser.showHelp(t.button.element.name,t.button.element.getAttribute("url"),null,null);if("ok"===t.button["data-btn-name"]){t.cancel=!0;var i=this.newConnCollectionModel.toJSON(),r=null;u.database_list.forEach((function(e){if(i.database==e.value)return r=e.label,!1}));var o,d=n.qt_tab_title_placeholder;o=this.get_title(d,r,i,u);var c=l.default.qt_default_placeholder,f=this.get_title(c,r,i,u);i.role||(i.role=null);var p=!0;if(e.gridView.connection_list.forEach((function(e){if(parseInt(e.server)==i.server&&parseInt(e.database)==i.database&&e.user==i.user&&e.role==i.role)return p=!1,!1})),p){var h={server_group:e.gridView.handler.url_params.sgid,server:i.server,database:i.database,title:a.escape(o),conn_title:a.escape(f),user:i.user,role:i.role,server_name:a.escape(u.server_name),database_name:a.escape(r),password:u.password,is_selected:!1};e.gridView.on_change_connection(h,this)}else{s.default.info("Connection with this configuration already present.")}}else s.default.newConnectionDialog().destroy()}}})),setTimeout((function(){s.default.newConnectionDialog("Connect to server.").resizeTo(l.default.Browser.stdW.md,l.default.Browser.stdH.md)}),500)})).fail((function(){s.default.alert().setting({title:(0,i.default)("Connection lost"),label:(0,i.default)("OK"),message:(0,i.default)("Connection to the server has been lost."),onok:function(){window.close()}}).show()}))}};e.exports=f},16880:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,c,u){var f=s.default.Select2Control.extend({fetchData:function(){var e=this,n=e.field.get("url");n=(0,l.default)(n,{sid:e.model.attributes.server,sgid:t}),r.default.ajax({url:n,headers:{"Cache-Control":"no-cache"}}).done((function(t){var n=e.field.get("transform");if(t.data.status){var a=t.data.result.data;n&&i.default.isFunction(n)?e.field.set("options",n.bind(e,a)):e.field.set("options",a)}else n&&i.default.isFunction(n)?e.field.set("options",n.bind(e,[])):e.field.set("options",[]);s.default.Select2Control.prototype.render.apply(e,arguments)})).fail((function(e){var t="";t=404==e.status?"Unable to find url.":e.responseJSON.errormsg,d.default.error(t)}))},render:function(){return this.fetchData(),s.default.Select2Control.prototype.render.apply(this,arguments)},onChange:function(){s.default.Select2Control.prototype.onChange.apply(this,arguments)}}),p=function(e){if(!e.id)return e.text;var t=(0,r.default)(e.element).data("image");return t?(0,r.default)("<span></span>").append((0,r.default)("<span></span>",{class:"wcTabIcon "+t})).append((0,r.default)("<span></span>").text(e.text)):e.text};return new(o.default.Browser.DataModel.extend({idAttribute:"name",defaults:{server:parseInt(n),database:null,user:null,server_name:"",database_name:""},schema:[{id:"server",name:"server",label:(0,a.default)("Server"),type:"text",editable:!0,disabled:!1,select2:{allowClear:!1,width:"style",templateResult:p,templateSelection:p},events:{"focus select":"clearInvalid","keydown :input":"processTab","select2:select":"onSelect","select2:selecting":"beforeSelect","select2:clear":"onChange"},transform:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({group:n,optval:e[n]});return t},control:s.default.Select2Control.extend({template:i.default.template(["<% if(label == false) {} else {%>",'  <label class="<%=Backform.controlLabelClassName%>"><%=label%></label>',"<% }%>",'<div class="<%=controlsClassName%>">'," <select class=\"<%=Backform.controlClassName%> <%=extraClasses.join(' ')%>\"",'  name="<%=name%>" value="<%-value%>" <%=disabled ? "disabled" : ""%>','  <%=required ? "required" : ""%><%= select2.multiple ? " multiple>" : ">" %>','  <%=select2.first_empty ? " <option></option>" : ""%>',"  <% for (var i=0; i < options.length; i++) {%>","   <% if (options[i].group) { %>","     <% var group = options[i].group; %>","     <% if (options[i].optval) { %> <% var option_length = options[i].optval.length; %>",'      <optgroup label="<%=group%>">',"      <% for (var subindex=0; subindex < option_length; subindex++) {%>","        <% var option = options[i].optval[subindex]; %>","        <option ","        <% if (option.image) { %> data-image=<%=option.image%> <%}%>","        <% if (option.connected) { %> data-connected=connected <%}%>","        value=<%- formatter.fromRaw(option.value) %>",'        <% if (option.selected) {%>selected="selected"<%} else {%>','        <% if (!select2.multiple && option.value === rawValue) {%>selected="selected"<%}%>','        <% if (select2.multiple && rawValue && rawValue.indexOf(option.value) != -1){%>selected="selected" data-index="rawValue.indexOf(option.value)"<%}%>',"        <%}%>",'        <%= disabled ? "disabled" : ""%>><%-option.label%></option>',"      <%}%>","      </optgroup>","     <%}%>","   <%} else {%>","     <% var option = options[i]; %>","     <option ","     <% if (option.image) { %> data-image=<%=option.image%> <%}%>","     <% if (option.connected) { %> data-connected=connected <%}%>","     value=<%- formatter.fromRaw(option.value) %>",'     <% if (option.selected) {%>selected="selected"<%} else {%>','     <% if (!select2.multiple && option.value === rawValue) {%>selected="selected"<%}%>','     <% if (select2.multiple && rawValue && rawValue.indexOf(option.value) != -1){%>selected="selected" data-index="rawValue.indexOf(option.value)"<%}%>',"     <%}%>",'     <%= disabled ? "disabled" : ""%>><%-option.label%></option>',"   <%}%>","  <%}%>"," </select>"," <% if (helpMessage && helpMessage.length) { %>",' <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>'," <% } %>","</div>"].join("\n")),beforeSelect:function(){var e=arguments[0].params.args.data.id;this.field.get("connect")&&"connected"!==this.$el.find('option[value="'+e+'"]').attr("data-connected")?this.field.get("connect").apply(this,[e,this.changeIcon.bind(this)]):((0,r.default)(this.$sel).trigger("change"),setTimeout(function(){this.onChange.apply(this)}.bind(this),200))},changeIcon:function(e){var t=this.$el.find(".select2-selection .select2-selection__rendered span.wcTabIcon"),n=this.$el.find("option:selected");if(t.hasClass("icon-server-not-connected")||t.hasClass("icon-shared-server-not-connected")){var a=e.icon?e.icon:"icon-pg";t.removeClass("icon-server-not-connected"),t.addClass(a),t.attr("data-connected","connected"),n.data().image=a,n.attr("data-connected","connected"),d.default.connectServer().destroy(),this.onChange.apply(this)}else if(t.hasClass("icon-database-not-connected")){var i=e.icon?e.icon:"pg-icon-database";t.removeClass("icon-database-not-connected"),t.addClass(i),t.attr("data-connected","connected"),n.removeClass("icon-database-not-connected"),n.data().image=i,n.attr("data-connected","connected"),d.default.connectServer().destroy(),this.onChange.apply(this)}},connect:function(t){var n=t;d.default.connectServer&&delete d.default.connectServer,d.default.dialog("connectServer",(function(){return{main:function(e,t,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.set("title",e),this.message=t,this.server_id=n,this.submit_password=a,this.connect_server=i},setup:function(){return{buttons:[{text:(0,a.default)("Cancel"),className:"btn btn-secondary fa fa-times pg-alertify-button",key:27},{text:(0,a.default)("OK"),key:13,className:"btn btn-primary fa fa-check pg-alertify-button"}],focus:{element:"#password",select:!0},options:{modal:0,resizable:!1,maximizable:!1,pinnable:!1}}},build:function(){},prepare:function(){this.setContent(this.message)},callback:function(t){var i=(0,r.default)("#show_filter_progress");if(t.button.text==(0,a.default)("OK"))if(this.submit_password){var o=(0,l.default)("sqleditor.connect_server",{sid:this.server_id});i.removeClass("d-none"),r.default.ajax({type:"POST",timeout:3e4,url:o,data:(0,r.default)("#frmPassword").serialize()}).done((function(t){n.model.attributes.database=null,n.changeIcon(t.data),n.model.attributes.user=null,n.model.attributes.role=null,s.default.Select2Control.prototype.onChange.apply(n,arguments),Object.keys(e.server_list).forEach((function(t){e.server_list[t].forEach((function(t){t.value==n.getValueFromDOM()&&(e.server_name=t.label)}))})),i.addClass("d-none"),d.default.connectServer().destroy()})).fail((function(e){i.addClass("d-none"),d.default.connectServer().destroy(),d.default.connectServer("Connect to server",e.responseJSON.result,n.getValueFromDOM())}))}else Object.keys(this.connect_server).length>0?(this.connect_server.password=(0,r.default)("#password").val(),this.connect_server.is_selected=!1,c.gridView.on_change_connection(this.connect_server,u,!1),(i=(0,r.default)("#fetching_data")).addClass("d-none")):(e.password=(0,r.default)("#password").val(),i.addClass("d-none"));else n.model.attributes.database=null,n.model.attributes.user=null,n.model.attributes.role=null,s.default.Select2Control.prototype.onChange.apply(n,arguments),i.addClass("d-none"),d.default.connectServer().destroy();t.close=!0}}}))},render:function(){var t=this;t.connect(t),Object.keys(e.server_list).forEach((function(t){e.server_list[t].forEach((function(t){t.value==parseInt(n)&&(e.server_name=t.label)}))}));var a=t.field.get("transform")||t.defaults.transform;return a&&i.default.isFunction(a)?t.field.set("options",a.bind(t,e.server_list)):t.field.set("options",e.server_list),s.default.Select2Control.prototype.render.apply(t,arguments)},onChange:function(){this.model.attributes.database=null,this.model.attributes.user=null;var t=this;t.connect(t);var n=(0,l.default)("sqleditor.connect_server",{sid:t.getValueFromDOM(),usr:t.model.attributes.user}),a=(0,r.default)("#show_filter_progress");a.removeClass("d-none"),r.default.ajax({url:n,type:"POST",headers:{"Cache-Control":"no-cache"}}).done((function(){s.default.Select2Control.prototype.onChange.apply(t,arguments),Object.keys(e.server_list).forEach((function(n){e.server_list[n].forEach((function(n){n.value==t.getValueFromDOM()&&(e.server_name=n.label)}))})),a.addClass("d-none")})).fail((function(e){a.addClass("d-none"),d.default.connectServer("Connect to server",e.responseJSON.result,t.getValueFromDOM())}))}})},{id:"database",name:"database",label:(0,a.default)("Database"),type:"text",editable:!0,disabled:function(e){var t=this;return!(!i.default.isUndefined(e.get("server"))&&!i.default.isNull(e.get("server"))&&""!==e.get("server"))||(setTimeout((function(){t.options.length&&t.options.forEach((function(t){t.selected&&e.set("database",t.value)}))}),10),!1)},deps:["server"],url:"sqleditor.get_new_connection_database",select2:{allowClear:!1,width:"100%",first_empty:!0,select_first:!1},extraClasses:["new-connection-dialog-style"],control:f,transform:function(t){return e.database_list=t,t}},{id:"user",name:"user",label:(0,a.default)("User"),type:"text",editable:!0,deps:["server"],select2:{allowClear:!1,width:"100%"},control:f,url:"sqleditor.get_new_connection_user",disabled:function(e){var t=this;return!(!i.default.isUndefined(e.get("server"))&&!i.default.isNull(e.get("server"))&&""!==e.get("server"))||(setTimeout((function(){t.options.length&&e.set("user",t.options[0].value)}),10),!1)}},{id:"role",name:"role",label:(0,a.default)("Role"),type:"text",editable:!0,deps:["server"],select2:{allowClear:!1,width:"100%",first_empty:!0},control:f,url:"sqleditor.get_new_connection_role",disabled:!1}],validate:function(){var e=null;return this.errorModel.clear(),i.default.isUndefined(this.get("database"))||i.default.isNull(this.get("database"))?(e=(0,a.default)("Please select database"),this.errorModel.set("database",e),e):i.default.isUndefined(this.get("database"))||i.default.isUndefined(this.get("user"))||i.default.isNull(this.get("user"))?(e=(0,a.default)("Please select user"),this.errorModel.set("user",e),e):null}}))},n(24812),n(91058),n(69600),n(69826),n(32564),n(89554),n(54747),n(47941);var a=c(n(91669)),i=c(n(81311)),r=c(n(19755)),o=c(n(55112)),s=c(n(12030)),l=c(n(28008)),d=c(n(55455));function c(e){return e&&e.__esModule?e:{default:e}}},94860:(e,t,n)=>{n(83710);var a=r(n(19755)),i=r(n(1950));function r(e){return e&&e.__esModule?e:{default:e}}var o={_verbose:function(){return!(0,a.default)(".explain-verbose").hasClass("visibility-hidden")},_costsEnabled:function(){return!(0,a.default)(".explain-costs").hasClass("visibility-hidden")},_buffers:function(){return!(0,a.default)(".explain-buffers").hasClass("visibility-hidden")},_timing:function(){return!(0,a.default)(".explain-timing").hasClass("visibility-hidden")},_summary:function(){return!(0,a.default)(".explain-summary").hasClass("visibility-hidden")},_settings:function(){return!(0,a.default)(".explain-settings").hasClass("visibility-hidden")},_clearMessageTab:function(){(0,a.default)(".sql-editor-message").html("")},executeMacro:function(e,t){this._clearMessageTab(),e.check_data_changes_to_execute_query(null,!1,t)},executeQuery:function(e){this._clearMessageTab(),e.check_data_changes_to_execute_query()},explainAnalyze:function(e){var t={format:"json",analyze:!0,verbose:this._verbose(),costs:this._costsEnabled(),buffers:this._buffers(),timing:this._timing(),summary:this._summary(),settings:this._settings()};this._clearMessageTab(),e.check_data_changes_to_execute_query(t)},explain:function(e){var t={format:"json",analyze:!1,verbose:this._verbose(),costs:this._costsEnabled(),buffers:!1,timing:!1,summary:this._summary(),settings:this._settings()};this._clearMessageTab(),e.check_data_changes_to_execute_query(t)},download:function(e){var t=","===e.preferences.csv_field_separator?".csv":".txt",n="data-"+(new Date).getTime()+t;e.is_query_tool||(n=e.table_name+t),e.trigger_csv_download(n)},commentBlockCode:function(e){var t=e.gridView.query_tool_obj;t.getValue()&&t.toggleComment(t.getCursor(!0),t.getCursor(!1))},commentLineCode:function(e){var t=e.gridView.query_tool_obj;t.getValue()&&t.lineComment(t.getCursor(!0),t.getCursor(!1),{lineComment:"--"})},uncommentLineCode:function(e){var t=e.gridView.query_tool_obj;t.getValue()&&t.uncomment(t.getCursor(!0),t.getCursor(!1),{lineComment:"--"})},formatSql:function(e){e.gridView.on_format_sql()},focusOut:function(){document.activeElement.blur(),i.default.document.activeElement.blur()},toggleCaseOfSelectedText:function(e){var t=e.gridView.query_tool_obj,n=t.getSelection();n&&(n===n.toUpperCase()?t.replaceSelection(n.toLowerCase()):t.replaceSelection(n.toUpperCase()))},executeCommit:function(e){e.special_sql="COMMIT;",this.executeQuery(e)},executeRollback:function(e){e.special_sql="ROLLBACK;",this.executeQuery(e)},saveDataChanges:function(e){e.close_on_save=!1,e.save_data()},openQueryTool:function(e){e.gridView.handler.trigger("pgadmin-sqleditor:button:show_query_tool",e.gridView,e.gridView.handler)}};e.exports=o},90865:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.httpResponseRequiresNewTransaction=r,t.handleLoginRequiredAndTransactionRequired=o,t.handleQueryToolAjaxError=function(e,t,n,a,r,s){if(0===n.readyState)return(0,i.default)("Not connected to the server or the connection to the server has been closed.");o(e,t,n,a,r,s);var l=n.responseText;void 0!==n.responseJSON&&(void 0!==n.responseJSON.errormsg&&(l=n.responseJSON.errormsg),503===n.status&&void 0!==n.responseJSON.info&&"CONNECTION_LOST"==n.responseJSON.info&&(l=null,setTimeout((function(){a&&t.saveState(a,r),t.handle_connection_lost(!1,n)}))));return l},n(32564);var a,i=(a=n(91669))&&a.__esModule?a:{default:a};function r(e){return void 0===e.responseJSON&&void 0!==e.data?404===e.status&&e.data&&e.data.info&&"DATAGRID_TRANSACTION_REQUIRED"===e.data.info:404===e.status&&e.responseJSON&&e.responseJSON.info&&"DATAGRID_TRANSACTION_REQUIRED"===e.responseJSON.info}function o(e,t,n,a,i,o){return i=i&&i.length>0?i:[],e.Browser.UserManagement.isPgaLoginRequired(n)?(a&&t.saveState(a,i),e.Browser.UserManagement.pgaLogin()):o&&r(n)?(a&&t.saveState(a,i),t.initTransaction()):void 0}},28522:(e,t,n)=>{n(69826);var a=s(n(91669)),i=s(n(71158)),r=s(n(72316)),o=s(n(55455));function s(e){return e&&e.__esModule?e:{default:e}}var l=r.default.Model.extend({defaults:{recorded_time:void 0,event:void 0,pid:void 0,payload:void 0},schema:[{id:"recorded_time",label:(0,a.default)("Recorded time"),cell:"string",type:"text",editable:!1,cellHeaderClasses:"width_percent_20",headerCell:i.default.Extension.CustomHeaderCell},{id:"channel",label:(0,a.default)("Event"),cell:"string",type:"text",editable:!1,cellHeaderClasses:"width_percent_20",headerCell:i.default.Extension.CustomHeaderCell},{id:"pid",label:(0,a.default)("Process ID"),cell:"string",type:"text",editable:!1,cellHeaderClasses:"width_percent_20",headerCell:i.default.Extension.CustomHeaderCell},{id:"payload",label:(0,a.default)("Payload"),cell:"string",type:"text",editable:!1,cellHeaderClasses:"width_percent_40",headerCell:i.default.Extension.CustomHeaderCell}]}),d=r.default.Collection.extend({model:l}),c={collection:null,renderNotificationsGrid:function(e){c.collection||(c.collection=new d);var t=[{name:"recorded_time",label:(0,a.default)("Recorded time"),type:"text",editable:!1,cell:"string"},{name:"channel",label:(0,a.default)("Event"),type:"text",editable:!1,cell:"string"},{name:"pid",label:(0,a.default)("Process ID"),type:"text",editable:!1,cell:"string"},{name:"payload",label:(0,a.default)("Payload"),type:"text",editable:!1,cell:"string"}],n=new i.default.Grid({emptyText:(0,a.default)("No data found"),columns:t,collection:c.collection,className:"backgrid presentation table table-bordered table-hover table-noouter-border table-bottom-border"});e&&e.$container.find(".sql-editor-notifications").append(n.render().el)},updateNotifications:function(e){if(null!=e&&e.length>0){for(var t in e){var n="";n=""!=e[t].payload?(0,a.default)('Asynchronous notification "%s" with payload "%s" received from server process with PID %s',e[t].channel,e[t].payload,e[t].pid):(0,a.default)('Asynchronous notification "%s" received from server process with PID %s',e[t].channel,e[t].pid),o.default.info(n)}c.collection.add(e)}}};e.exports=c},72622:(e,t,n)=>{function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(66992),n(41539),n(78783),n(4129),n(33948),n(69070),n(38880),n(82526),n(41817),n(32165),Object.defineProperty(t,"__esModule",{value:!0}),t.updateUIPreferences=function(e){var t=e.$el,n=e.preferences;e.handler.slickgrid&&(e.handler.slickgrid.CSVOptions={quoting:e.preferences.results_grid_quoting,quote_char:e.preferences.results_grid_quote_char,field_separator:e.preferences.results_grid_field_separator});t.find("#btn-load-file").attr("title",(0,i.shortcut_accesskey_title)((0,s.default)("Open File"),n.btn_open_file)).attr("aria-label",(0,i.shortcut_accesskey_title)((0,s.default)("Open File"),n.btn_open_file)).attr("accesskey",(0,i.shortcut_key)(n.btn_open_file)),t.find("#btn-save-file").attr("title",(0,i.shortcut_accesskey_title)((0,s.default)("Save File"),n.btn_save_file)).attr("aria-label",(0,i.shortcut_accesskey_title)((0,s.default)("Save File"),n.btn_save_file)).attr("accesskey",(0,i.shortcut_key)(n.btn_save_file)),t.find("#btn-find-menu-dropdown").attr("title",(0,i.shortcut_accesskey_title)((0,s.default)("Find"),n.btn_find_options)).attr("aria-label",(0,i.shortcut_accesskey_title)((0,s.default)("Find"),n.btn_find_options)).attr("accesskey",(0,i.shortcut_key)(n.btn_find_options)),t.find("#btn-copy-row").attr("title",(0,i.shortcut_accesskey_title)((0,s.default)("Copy"),n.btn_copy_row)).attr("aria-label",(0,i.shortcut_accesskey_title)((0,s.default)("Copy"),n.btn_copy_row)).attr("accesskey",(0,i.shortcut_key)(n.btn_copy_row)),t.find("#btn-paste-row").attr("title",(0,i.shortcut_accesskey_title)((0,s.default)("Paste"),n.btn_paste_row)).attr("aria-label",(0,i.shortcut_accesskey_title)((0,s.default)("Paste"),n.btn_paste_row)).attr("accesskey",(0,i.shortcut_key)(n.btn_paste_row)),t.find("#btn-delete-row").attr("title",(0,i.shortcut_accesskey_title)((0,s.default)("Delete"),n.btn_delete_row)).attr("aria-label",(0,i.shortcut_accesskey_title)((0,s.default)("Delete"),n.btn_delete_row)).attr("accesskey",(0,i.shortcut_key)(n.btn_delete_row)),t.find("#btn-filter").attr("title",(0,i.shortcut_accesskey_title)((0,s.default)("Filter"),n.btn_filter_dialog)).attr("aria-label",(0,i.shortcut_accesskey_title)((0,s.default)("Filter"),n.btn_filter_dialog)).attr("accesskey",(0,i.shortcut_key)(n.btn_filter_dialog)),t.find("#btn-filter-dropdown").attr("title",(0,i.shortcut_accesskey_title)((0,s.default)("Filter options"),n.btn_filter_options)).attr("aria-label",(0,i.shortcut_accesskey_title)((0,s.default)("Filter options"),n.btn_filter_options)).attr("accesskey",(0,i.shortcut_key)(n.btn_filter_options)),t.find("#btn-rows-limit").attr("title",(0,i.shortcut_accesskey_title)((0,s.default)("Rows limit"),n.btn_rows_limit)).attr("aria-label",(0,i.shortcut_accesskey_title)((0,s.default)("Rows limit"),n.btn_rows_limit)).attr("accesskey",(0,i.shortcut_key)(n.btn_rows_limit)),t.find("#btn-query-dropdown").attr("title",(0,i.shortcut_accesskey_title)((0,s.default)("Execute options"),n.btn_execute_options)).attr("aria-label",(0,i.shortcut_accesskey_title)((0,s.default)("Execute options"),n.btn_execute_options)).attr("accesskey",(0,i.shortcut_key)(n.btn_execute_options)),t.find("#btn-cancel-query").attr("title",(0,i.shortcut_accesskey_title)((0,s.default)("Cancel query"),n.btn_cancel_query)).attr("aria-label",(0,i.shortcut_accesskey_title)((0,s.default)("Cancel query"),n.btn_cancel_query)).attr("accesskey",(0,i.shortcut_key)(n.btn_cancel_query)),t.find("#btn-clear-dropdown").attr("title",(0,i.shortcut_accesskey_title)((0,s.default)("Clear"),n.btn_clear_options)).attr("aria-label",(0,i.shortcut_accesskey_title)((0,s.default)("Clear"),n.btn_clear_options)).attr("accesskey",(0,i.shortcut_key)(n.btn_clear_options)),t.find("#btn-conn-status").attr("accesskey",(0,i.shortcut_key)(n.btn_conn_status)).find("i").attr("title",(0,i.shortcut_accesskey_title)((0,s.default)("Connection status (click for details)"),n.btn_conn_status)),t.find("#btn-flash").attr("title",(0,i.shortcut_title)((0,s.default)("Execute/Refresh"),n.execute_query)).attr("aria-label",(0,i.shortcut_title)((0,s.default)("Execute/Refresh"),n.execute_query)),t.find("#btn-explain").attr("title",(0,i.shortcut_title)((0,s.default)("Explain"),n.explain_query)).attr("aria-label",(0,i.shortcut_title)((0,s.default)("Explain"),n.explain_query)),t.find("#btn-explain-analyze").attr("title",(0,i.shortcut_title)((0,s.default)("Explain Analyze"),n.explain_analyze_query)).attr("aria-label",(0,i.shortcut_title)((0,s.default)("Explain Analyze"),n.explain_analyze_query)),t.find("#btn-save-results-to-file").attr("title",(0,i.shortcut_title)((0,s.default)("Save results to file"),n.download_results)).attr("aria-label",(0,i.shortcut_title)((0,s.default)("Save results to file"),n.download_results)),t.find("#btn-save-data").attr("title",(0,i.shortcut_title)((0,s.default)("Save Data Changes"),n.save_data)).attr("aria-label",(0,i.shortcut_title)((0,s.default)("Save Data Changes"),n.save_data)),t.find("#btn-commit").attr("title",(0,i.shortcut_title)((0,s.default)("Commit"),n.commit_transaction)).attr("aria-label",(0,i.shortcut_title)((0,s.default)("Commit"),n.commit_transaction)),t.find("#btn-rollback").attr("title",(0,i.shortcut_title)((0,s.default)("Rollback"),n.rollback_transaction)).attr("aria-label",(0,i.shortcut_title)((0,s.default)("Rollback"),n.rollback_transaction)),t.find("#btn-show-query-tool").attr("title",(0,i.shortcut_title)((0,s.default)("Query tool"),n.show_query_tool)).attr("aria-label",(0,i.shortcut_title)((0,s.default)("Query tool"),n.show_query_tool)),n.explain_verbose?t.find(".explain-verbose").removeClass("visibility-hidden"):t.find(".explain-verbose").addClass("visibility-hidden");n.explain_costs?t.find(".explain-costs").removeClass("visibility-hidden"):t.find(".explain-costs").addClass("visibility-hidden");n.explain_buffers?t.find(".explain-buffers").removeClass("visibility-hidden"):t.find(".explain-buffers").addClass("visibility-hidden");n.explain_timing?t.find(".explain-timing").removeClass("visibility-hidden"):t.find(".explain-timing").addClass("visibility-hidden");n.explain_summary?t.find(".explain-summary").removeClass("visibility-hidden"):t.find(".explain-summary").addClass("visibility-hidden");n.explain_settings?t.find(".explain-settings").removeClass("visibility-hidden"):t.find(".explain-settings").addClass("visibility-hidden");null!=e.connIntervalId&&(clearInterval(e.connIntervalId),e.connIntervalId=null);if(n.connection_status){var a=t.find("#btn-conn-status"),l=a.find("i");a.popover(),a.removeClass("connection-status-hide"),r.fetchConnectionStatus(e.handler,a,l),e.connIntervalId=setInterval(r.fetchConnectionStatus.bind(null,e.handler,a,l),1e3*n.connection_status_fetch_time)}else t.find("#btn-conn-status").addClass("connection-status-hide");var d=r.calcFontSize(n.sql_font_size);(0,o.default)(e.query_tool_obj.getWrapperElement()).css("font-size",d),n.plain_editor_mode?(e.query_tool_obj.setOption("mode","text/plain"),e.query_tool_obj.setOption("foldGutter",!1)):(e.query_tool_obj.setOption("mode","gpdb"===e.handler.server_type?"text/x-gpsql":"text/x-pgsql"),e.query_tool_obj.setOption("foldGutter",n.code_folding));e.query_tool_obj.setOption("foldGutter",n.code_folding),e.query_tool_obj.setOption("indentWithTabs",!n.use_spaces),e.query_tool_obj.setOption("indentUnit",n.use_spaces?n.tab_size:4),e.query_tool_obj.setOption("tabSize",n.use_spaces?n.tab_size:4),e.query_tool_obj.setOption("lineWrapping",n.wrap_code),e.query_tool_obj.setOption("autoCloseBrackets",n.insert_pair_brackets),e.query_tool_obj.setOption("matchBrackets",n.brace_matching),e.query_tool_obj.refresh(),e.historyComponent.setEditorPref({sql_font_size:d})},n(69826),n(32564),n(24812);var i=n(72945),r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}i.default=e,n&&n.set(e,i);return i}(n(81240)),o=l(n(19755)),s=l(n(91669));function l(e){return e&&e.__esModule?e:{default:e}}function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}},20882:e=>{e.exports={TRANSACTION_STATUS_IDLE:0,TRANSACTION_STATUS_ACTIVE:1,TRANSACTION_STATUS_INTRANS:2,TRANSACTION_STATUS_INERROR:3,TRANSACTION_STATUS_UNKNOWN:5}},81240:(e,t,n)=>{var a,i;function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw r}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}n(41539),n(68309),n(91038),n(78783),n(82526),n(41817),n(32165),n(66992),n(33948),n(69600),n(74916),n(15306),n(47042),n(54678),n(9653),n(79753),a=[n(19755),n(81311),n(91669),n(28008),n(55455)],void 0===(i=function(e,t,n,a,i){var o={epicRandomString:function(e){for(var t=[],n="0123456789abcdef",a=0;a<36;a++)t[a]=n.substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]=n.substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-",t.join("").replace(/-/g,"").substr(0,e)},getHash:function(e){for(var t=0,n=e.length,a=0;a<n;a++)t=(t<<5)-t+e.charCodeAt(a),t|=0;return t},calculateColumnWidth:function(t){e("body").append('<span id="pg_text" style="visibility: hidden;">'+t+"</span>");var n=e("#pg_text").width()+23;return e("#pg_text").remove(),n},capitalizeFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},disable_connection_dropdown:function(t){t?(e(".conn-info-dd").prop("disabled",!0),e(".connection-data").css({pointerEvents:"none",cursor:"arrow"})):(e(".conn-info-dd").prop("disabled",!1),e(".connection-data").css({pointerEvents:"auto",cursor:"pointer"}))},previousStatus:null,fetchConnectionStatus:function(t,i,r){var s=a("sqleditor.connection_status",{trans_id:t.transId});if("visible"===document.visibilityState&&"visible"===i.data("panel-visible")&&!r.hasClass("obtaining-conn")){var l=t;e.ajax({url:s,method:"GET"}).done((function(e){if(e&&e.data){var t=e.data.status,a=e.data.message,s=!1;switch(l.update_notifications(e.data.notifies),t){case 1:t!=o.previousStatus||r.hasClass("fa-hourglass-half")||(r.removeClass().addClass("fa fa-hourglass-half"),s=!0);break;case 2:o.previousStatus==t||r.hasClass("fa-clock")||(r.removeClass().addClass("fa fa-clock"),s=!0);break;case 3:o.previousStatus==t||r.hasClass("fa-exclamation-circle")||(r.removeClass().addClass("fa fa-exclamation-circle"),s=!0);break;case 4:o.previousStatus==t||r.hasClass("fa-exclamation-triangle")||(r.removeClass().addClass("fa fa-exclamation-triangle"),s=!0);break;default:o.previousStatus==t||r.hasClass("fa-query_tool_connected")||(r.removeClass().addClass("pg-font-icon icon-connected"),s=!0)}o.previousStatus=t,s&&(i.popover("hide"),i.attr("data-content",a))}else o.previousStatus=-99,a=n("An unexpected error occurred - ensure you are logged into the application."),i.attr("data-content",a),r.hasClass("icon-disconnected")||(i.popover("hide"),r.removeClass().addClass("pg-icon-font icon-disconnected"))})).fail((function(e){o.previousStatus=-1;var t=n("Transaction status check failed.");0==e.readyState?t=n("Not connected to the server or the connection to the server has been closed."):e.responseJSON&&e.responseJSON.errormsg&&(t=e.responseJSON.errormsg),i.attr("data-content",t),r.hasClass("icon-disconnected")||(i.popover("hide"),r.removeClass().addClass("pg-font-icon icon-disconnected"))}))}},updateConnectionStatusFlag:function(t){var n=e(".connection_status");n.data("panel-visible")!=t&&n.data("panel-visible",t)},calcFontSize:function(e){if(e){e=parseFloat(Math.round(parseFloat(e+"e+2"))+"e-2");var t=Number(e);if(t>0)return t+"em"}return"1em"},addEditableIcon:function(e,n){var a={cssClass:"editable-column-header-icon",content:n?'<i class="fa fa-pencil-alt"></i>':'<i class="fa fa-lock"></i>'};t.isUndefined(e.header)||t.isUndefined(e.header.buttons)?e.header={buttons:[a]}:e.header.buttons.push(a)},isModalOpen:function(e){if(Array.isArray(e)){var t,n=r(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;try{if(i.dialog(a)&&i.dialog(a).isOpen())return!0}catch(e){console.warn(e.stack||e)}}}catch(e){n.e(e)}finally{n.f()}}return!1}};return o}.apply(t,a))||(e.exports=i)},82794:(e,t,n)=>{var a=n(64492);function i(e){var t=0,n=0,i={};do{var o=e.getData();if(o._type in this.Nodes&&this.Nodes[o._type].hasId){var s=r(o._type,n);void 0===i[s]&&(i[s]=a.extend({},o,{priority:t}),t-=1)}n+=1,e=e.hasParent()?e.parent():null}while(e);return i}function r(e,t){return"partition"===e&&t>0?"table":e}n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.getTreeNodeHierarchyFromElement=function(e,t){return i.call(e,t)},t.getTreeNodeHierarchyFromIdentifier=function(e){var t=this.treeMenu.translateTreeNodeIdFromACITree(e),n=this.treeMenu.findNode(t);return null===n?null:i.call(this,n)},t.getTreeNodeHierarchy=i},77019:(e,t,n)=>{n(79753),n(82526),n(41817),n(41539),n(32165),n(66992),n(78783),n(33948),n(91038),n(47042),n(68309),n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.browserTreeState=t.pgBrowser=void 0,n(32564),n(69600),n(69826),n(74916),n(64765),n(82772),n(23123),n(40561);var a=l(n(81311)),i=l(n(19755)),r=l(n(28008)),o=l(n(91669)),s=l(n(55112));function l(e){return e&&e.__esModule?e:{default:e}}function d(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var u=s.default.Browser=s.default.Browser||{};t.pgBrowser=u;var f=u.browserTreeState=u.browserTreeState||{};t.browserTreeState=f,a.default.extend(u.browserTreeState,{parent:"server",orig_parent:"server_group",stored_state:{},last_state:{},current_state:{},init:function(){var e=u.get_preference("browser","browser_tree_state_save_interval");a.default.isUndefined(e)||-1===e.value?a.default.isUndefined(e)||i.default.ajax({url:(0,r.default)("settings.reset_tree_state"),type:"DELETE"}).fail((function(e){var t=e.responseText;if(417==e.status||410==e.status||500==e.status)try{t=JSON.parse(e.responseText).errormsg}catch(e){console.warn(e.stack||e)}console.warn((0,o.default)('Error resetting the tree saved state."'),t)})):(setInterval(this.save_state,1e3*e.value),this.fetch_state.apply(this),u.Events.on("pgadmin:browser:tree:expand-from-previous-tree-state",this.expand_from_previous_state,this),u.Events.on("pgadmin:browser:tree:remove-from-tree-state",this.remove_from_cache,this),u.Events.on("pgadmin:browser:tree:update-tree-state",this.update_cache,this))},save_state:function(){var e=u.browserTreeState;e.last_state!=JSON.stringify(e.current_state)&&i.default.ajax({url:(0,r.default)("settings.save_tree_state"),type:"POST",contentType:"application/json",data:JSON.stringify(e.current_state)}).done((function(){e.last_state=JSON.stringify(e.current_state)})).fail((function(e){var t=e.responseText;if(417==e.status||410==e.status||500==e.status)try{t=JSON.parse(e.responseText).errormsg}catch(e){console.warn(e.stack||e)}console.warn((0,o.default)('Error saving the tree state."'),t)}))},fetch_state:function(){var e=this;i.default.ajax({url:(0,r.default)("settings.get_tree_state"),type:"GET",dataType:"json",contentType:"application/json"}).done((function(t){e.stored_state=t})).fail((function(e){var t=e.responseText;if(417==e.status||410==e.status||500==e.status)try{t=JSON.parse(e.responseText).errormsg}catch(e){console.warn(e.stack||e)}console.warn((0,o.default)("Error fetching the tree state."),t)}))},update_cache:function(e){var t,n=e&&u.tree.itemData(e),i=(n&&u.Nodes[n._type]).getTreeNodeHierarchy(e),r=u.tree.pathId(e),o=r.join(),s=[],l=-1;if(u.tree.hasParent(e)&&this.parent in i){if(t=i[this.parent]._id,u.tree.isOpen(e)){r.push(n.id),s=r.join(),t in this.current_state||(this.current_state[t]={paths:[],selected:{},conn_status:{},is_opened:{}});var d=a.default.find(this.current_state[t].paths,(function(e){return-1!==e.search(s)}));a.default.isUndefined(d)&&(a.default.isUndefined(this.current_state[t].paths)?this.current_state[t].paths=[]:l=this.current_state[t].paths.indexOf(o),-1!==l?this.current_state[t].paths[l]=s:this.current_state[t].paths.push(s))}this.update_database_status(e),this.update_current_selected_item(i)}},remove_from_cache:function(e){var t=this,n=t.stored_state||{},i=e&&u.tree.itemData(e),r=i&&u.Nodes[i._type],o=r&&r.getTreeNodeHierarchy(e);if(null!==o&&u.tree.hasParent(e)&&o.hasOwnProperty(t.parent)){var s=o&&o[t.parent]._id,l=o&&o[t.orig_parent].id;if(this.update_database_status(e),i._type!=t.parent&&"database"!=i._type){if(u.tree.isClosed(e)){var d=t.current_state[s].paths,c=void 0;if(o.hasOwnProperty("database")&&(c=o.database.id),!a.default.isUndefined(d)&&!a.default.isUndefined(d.length)){var f=0,p=void 0;a.default.each(d,(function(e){if(!a.default.isUndefined(e)){var n=e.split(",");if(-1!==n.indexOf(i.id)&&(void 0===c||void 0!==c&&-1!==n.indexOf(c))){var r=n.indexOf(i.id);n.splice(r),(p=n.join())==l?t.current_state[s].paths.splice(e,1):t.current_state[s].paths[f]=p}f++}}))}}}else s in n&&"paths"in n[s]&&(n[s].paths=t.current_state[s].paths,t.save_state())}},expand_from_previous_state:function(e){var t=this,n=t.stored_state||{},i=e&&u.tree.itemData(e),r=i&&u.Nodes[i._type],o=r&&r.getTreeNodeHierarchy(e);if(null!==o&&u.tree.hasParent(e)&&o.hasOwnProperty(t.parent)&&(i._type!=t.parent||!1!==u.tree.isOpen(e))){var s=n[o[t.parent]._id];if(!("database"==i._type&&s&&"conn_status"in s&&"is_opened"in s)||0!==s.conn_status[i.id]&&0!==s.is_opened[i.id]&&i.id in s.is_opened){if(!a.default.isUndefined(s)&&"paths"in s&&!a.default.isUndefined(s.paths.length)){var l=d(s.paths),c=void 0;o.hasOwnProperty("database")&&(c=o.database.id),a.default.each(l,(function(r){if(!a.default.isUndefined(r)){var s=r.split(",");if(-1!==s.indexOf(i.id)&&(void 0===c||void 0!==c&&-1!==s.indexOf(c))){var l=s.indexOf(i.id);if(u.tree.toggle(e),l==s.length-1){var d=n[o[t.parent]._id].paths.indexOf(r);n[o[t.parent]._id].paths.splice(d,1)}}}}))}this.select_tree_item(e)}}},update_database_status:function(e){var t=e&&u.tree.itemData(e),n=(t&&u.Nodes[t._type]).getTreeNodeHierarchy(e);if(n.hasOwnProperty("database")){var a=n.database.id,i=n&&n[this.parent]._id;i in this.current_state&&"selected"in this.current_state[i]&&(n.database.connected?this.current_state[i].conn_status[a]=1:this.current_state[i].conn_status[a]=0,"database"==t._type&&(u.tree.isOpen(e)?this.current_state[i].is_opened[a]=1:this.current_state[i].is_opened[a]=0))}},update_current_selected_item:function(e){if(this.parent in e){var t=e&&e[this.parent]._id,n=u.tree.itemData(u.tree.selected()),i=void 0;n=n?n.id:void 0,e.hasOwnProperty("database")&&(i=e.database.id),t in this.current_state&&"selected"in this.current_state[t]&&!a.default.isUndefined(n)&&(this.current_state[t].selected[e[this.parent].id]=n,a.default.isUndefined(i)||(this.current_state[t].selected[i]=n))}},select_tree_item:function(e){var t=this.stored_state||{},n=e&&u.tree.itemData(e),a=n&&u.Nodes[n._type],i=a&&a.getTreeNodeHierarchy(e),r=t[i[this.parent]._id];if(i.hasOwnProperty("database")){var o=i.database.id;r&&"selected"in r&&o in r.selected&&r.selected[o]==n.id&&u.tree.select(e)}}})},79226:(e,t,n)=>{var a=n(64492);n(82526),n(41817),n(32165),n(66992),n(78783),n(33948),n(57327),n(38880),n(49337),n(33321),Object.defineProperty(t,"__esModule",{value:!0}),t.isValidTreeNodeData=t.Tree=t.TreeNode=void 0,n(19601),n(41539),n(88674),n(32564),n(89554),n(54747),n(47941),n(74916),n(23123),n(15306),n(69826),n(69600),n(79753),n(23157),n(24812),n(82772),n(69070);var i=n(44092),r=s(n(19755)),o=s(n(55455));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function h(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}var _=function(){function e(t,n,a,i){f(this,e),this.id=t,this.data=n,this.setParent(i),this.children=[],this.domNode=a}return h(e,[{key:"hasParent",value:function(){return null!==this.parentNode&&void 0!==this.parentNode}},{key:"parent",value:function(){return this.parentNode}},{key:"setParent",value:function(e){this.parentNode=e,this.path=this.id,null!=e&&void 0!==e.path&&(this.path=e.path+"."+this.id)}},{key:"getData",value:function(){if(void 0!==this.data)return null===this.data?null:Object.assign({},this.data)}},{key:"getHtmlIdentifier",value:function(){return this.domNode}},{key:"reload",value:function(e){var t=this;return new Promise((function(n){t.unload(e).then((function(){e.aciTreeApi.setInode(t.domNode),e.aciTreeApi.deselect(t.domNode),setTimeout((function(){e.selectNode(t.domNode)}),0),n()}))}))}},{key:"unload",value:function(e){var t=this;return new Promise((function(n,a){t.children=[],e.aciTreeApi.unload(t.domNode,{success:function(){n(!0)},fail:function(){a()}})}))}},{key:"open",value:function(e,t){var n=this;return new Promise((function(a,i){!t||null!=n.domNode&&void 0!==n.domNode?e.aciTreeApi.isOpen(n.domNode)?a(!0):e.aciTreeApi.open(n.domNode,{success:function(){a(!0)},fail:function(){i(!0)}}):a(!0)}))}},{key:"ancestorNode",value:function(e){for(var t=this;t.hasParent();)if(e(t=t.parent()))return t;return null}},{key:"anyFamilyMember",value:function(e){return!!e(this)||null!==this.ancestorNode(e)}},{key:"anyParent",value:function(e){return null!==this.ancestorNode(e)}}]),e}();t.TreeNode=_;var g=function(){function e(){f(this,e),this.rootNode=new _(void 0,{}),this.aciTreeApi=void 0,this.draggableTypes={}}return h(e,[{key:"registerDraggableType",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;"object"==u(e)?Object.keys(e).forEach((function(n){t.registerDraggableType(n,e[n])})):null!=n&&e.replace(/ +/," ").split(" ").forEach((function(e){t.draggableTypes[e]=n}))}},{key:"getDraggable",value:function(e){return this.draggableTypes[e]?this.draggableTypes[e]:null}},{key:"prepareDraggable",value:function(e,t){var n=this.getDraggable(e._type);null!=n&&t.find(".aciTreeItem").attr("draggable",!0)[0].addEventListener("dragstart",(function(i){var o=n(e,t);if("string"==typeof o?o={text:o,cur:{from:o.length,to:o.length}}:o.cur||(o=d(d({},o),{},{cur:{from:o.text.length,to:o.text.length}})),i.dataTransfer.setData("text",JSON.stringify(o)),i.dataTransfer.dropEffect&&(i.dataTransfer.dropEffect="move"),i.dataTransfer.setDragImage){var s=(0,r.default)('\n              <div class="drag-tree-node">\n                <span>'.concat(a.escape(o.text),"</span>\n              </div>"));(0,r.default)("body .drag-tree-node").remove(),(0,r.default)("body").append(s),i.dataTransfer.setDragImage(s[0],0,0)}}))}},{key:"addNewNode",value:function(e,t,n,a){var i=this.findNode(a);return this.createOrUpdateNode(e,t,i,n)}},{key:"findNode",value:function(e){return null==e||0===e.length?this.rootNode:function(e,t){if(null===t)return e;return function e(n){if(void 0!==n.path&&void 0!==t&&!t.startsWith(n.path))return null;for(var a=0,i=n.children.length;a<i;a++){var r=e(n.children[a]);if(null!==r)return r}return n.path===t?n:null}(e)}(this.rootNode,e.join("."))}},{key:"findNodeWithToggle",value:function(e){var t=this;if(null==e||!Array.isArray(e))return Promise.reject();e=e.join(".");var n=function(t){return void 0!==t&&void 0!==e&&(e.startsWith(t+".")||e===t)};return function a(i){return new Promise((function(r,o){null!=e&&0!==e.length||r(null),void 0===i.path||n(i.path)?i.path===e?r(i):i.open(t,!0).then((function(){for(var e=0,t=i.children.length;e<t;e++){var s=i.children[e];if(n(s.path))return void r(a(s))}o(null)})).catch((function(){o(null)})):o(null)}))}(this.rootNode)}},{key:"findNodeByDomElement",value:function(e){var t=this.translateTreeNodeIdFromACITree(e);if(t&&t[0])return this.findNode(t)}},{key:"selected",value:function(){return this.aciTreeApi.selected()}},{key:"scrollTo",value:function(e){e.scrollIntoView()}},{key:"selectNode",value:function(e,t){this.aciTreeApi.select(e),t&&this.scrollTo(e[0])}},{key:"createOrUpdateNode",value:function(e,t,n,a){var i=[e];null!=n&&(i=[n.path,e]);var r=this.findNode(i);if(null!==r)return r.data=t,r.domNode=a,r;var o=new _(e,t,a,n);return n===this.rootNode&&(o.parentNode=null),null!=n&&n.children.push(o),o}},{key:"unloadNode",value:function(e,t,n,a){var i=[e],r=this.findNode(a);null!=r&&(i=[r.path,e]);var o=this.findNode(i);o&&(o.children=[])}},{key:"register",value:function(e){var t=this;e.on("acitree",function(e,t,n,a){if(t.isItem(n)&&-1!=["added","idset","beforeunload"].indexOf(a)){var i=t.getId(n),r=t.itemData(n),s=this.translateTreeNodeIdFromACITree(t.parent(n));"beforeunload"===a?this.unloadNode(i,r,n,s):("added"===a&&this.prepareDraggable(r,n),this.addNewNode(i,r,n,s)),r.errmsg&&o.default.error(r.errmsg)}}.bind(this)),this.aciTreeApi=e.aciTree("api");var n=function(e){var n=t.aciTreeApi.itemFrom(e.target);n.length&&(e.ctrlKey&&t.aciTreeApi.select(n),(0,r.default)(n).on("contextmenu:visible",(function(){(0,r.default)(n).trigger("blur"),(0,r.default)(n).off("contextmenu:visible")})))};e.off("mousedown",n).on("mousedown",n)}},{key:"translateTreeNodeIdFromACITree",value:function(e){for(var t=e,n=[];null!=t&&t.length>0&&(n.unshift(this.aciTreeApi.getId(t)),this.aciTreeApi.hasParent(t));)t=this.aciTreeApi.parent(t);return n}}]),e}();t.Tree=g;var m=i.isValidData;t.isValidTreeNodeData=m},28008:(e,t,n)=>{var a,i;n(74916),n(15306),a=[n(8012)],void 0===(i=function(e){return function(t,n){var a=e[t],i=a;return a?i=i.replace(/([<])([^:^>]*:)?([^>]+)([>])/g,(function(e,t,a,i){return i in n?n[i]:e})):a}}.apply(t,a))||(e.exports=i)},44092:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.parseShortcutValue=function(e){var t="";e.alt&&(t+="alt+");e.shift&&(t+="shift+");e.control&&(t+="ctrl+");return t+=e.key.char.toLowerCase()},t.handleKeyNavigation=function(e){var t=(0,r.default)(e.currentTarget).find(".wizard-header"),n=(0,r.default)(e.currentTarget).find(".wizard-footer"),a=(0,r.default)(e.currentTarget).find(".select-row-cell:first"),i=(0,r.default)(e.currentTarget).find(".select-row-cell:last"),o=(0,r.default)(t).find("button:enabled:first"),s=(0,r.default)(t).find("button:enabled:last"),l=(0,r.default)(n).find("button:enabled:last"),d=(0,r.default)(n).find("button:enabled:first");e.shiftKey&&9===e.keyCode?o&&(0,r.default)(o).is((0,r.default)(e.target))?l&&((0,r.default)(l).focus(),e.preventDefault(),e.stopPropagation()):(0,r.default)(d).is((0,r.default)(e.target))&&((0,r.default)(a).find(".custom-control-input").is(":visible")?((0,r.default)(i).find(".custom-control-input").focus(),e.preventDefault(),e.stopPropagation()):(0,r.default)(e.currentTarget).find(".wizard-content").find(".CodeMirror-scroll").is(":visible")&&(0,r.default)(s).focus()):9===e.keyCode?l&&(0,r.default)(l).is((0,r.default)(e.target))?((0,r.default)(o).focus(),e.preventDefault(),e.stopPropagation()):"Name"==e.target.innerText?((0,r.default)(a).find(".custom-control-input").is(":visible")?(0,r.default)(a).find(".custom-control-input").focus():(0,r.default)(d).focus(),e.preventDefault(),e.stopPropagation()):"DIV"==e.target.tagName?((0,r.default)(e.currentTarget).find(".custom-control-input:first").trigger("focus"),e.preventDefault(),e.stopPropagation()):"TEXTAREA"==e.target.tagName&&(0,r.default)(d).focus():27===e.keyCode&&(0,r.default)(t).find("button.ajs-close").click()},t.findAndSetFocus=function(e){if(0==e.length)return;setTimeout((function(){var t=e.find("button.fa-plus:first");0==t.length&&(t=e.find("\n          .pgadmin-controls:first .btn:not(.toggle),\n          .pgadmin-controls:first,\n          .ajs-commands:first,\n          .CodeMirror-scroll,\n          .pgadmin-wizard").find('*[tabindex]:not([tabindex="-1"]),input:enabled')),t.length>0?t[0].focus():e[0].focus()}),200)},t.getEpoch=function(e){var t=e||new Date;return parseInt(t.getTime()/1e3)},t.getGCD=function(e){var t=function e(t,n){return 0==t?n:e(n%t,t)},n=e.length;if(n<=2)return t(e[0],e[1]);for(var a=e[0],i=1;i<n;i++)a=t(e[i],a);return a},t.getMod=function(e,t){return(e%t+t)%t},t.parseFuncParams=function(e){var t=[],n="",a="";if(e.endsWith("()"))n=e.substring(0,e.length-2);else if(e.endsWith(")")){if(!e.endsWith("()")&&e.endsWith(")")){var i=0,r=e.length;for(i=e.length-2;i>=0;){if("("==e[i]){r=i;break}if('"'==e[i])for(i--;'"'!=e[i];)i--;i--}n=e.substring(0,r),a=e.substring(r+1,e.length-1);var o=0,s="",l=["IN","OUT","INOUT","VARIADIC"];for(i=0;i<a.length;){if('"'==a[i])for(i++;'"'!=a[i];)i++;else" "==a[i]?(""==s||l.indexOf(s)>-1)&&(s=a.substring(o,i),o=i+1):","==a[i]&&(t.push([s,a.substring(o,i)]),s="",o=i+1);i++}t.push([s,a.substring(o)])}}else n=e;return{func_name:n,param_string:a,params:t}},t.quote_ident=d,t.fully_qualify=function(e,t,n){var a=i.getTreeNodeHierarchyFromIdentifier.call(e,n),r="";void 0!==a.schema?r=d(a.schema._label):void 0!==a.view?r=d(a.view._label):void 0!==a.catalog&&(r=d(a.catalog._label));void 0!==a.package&&"package"!=t._type&&(""==r?r=d(a.package._label):r+="."+d(a.package._label));return""!=r?r+"."+d(t._label):d(t._label)},t.getRandomInt=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e},t.titleize=function(e){return""===e||null===e?e:e.split(" ").map((function(e){return e[0].toUpperCase()+e.substr(1).toLowerCase()})).join(" ")},t.sprintf=function(e){try{var t=arguments;return e.split("%s").map((function(e,n){return n>0?n<t.length?[t[n],e].join(""):["%s",e].join(""):e})).join("")}catch(t){return console.error(t),e}},t.CSVToArray=function(e,t,n){t=t||",",n=n||'"';var a=new RegExp("(\\"+t+"|\\r?\\n|\\r|^)"+('"'==n?'(?:"([^"]*(?:""[^"]*)*)"|':"(?:'([^']*(?:''[^']*)*)'|")+('"'==n?'([^"\\'+t+"\\r\\n]*))":"([^'\\"+t+"\\r\\n]*))"),"gi"),i=[[]],r=null;for(;r=a.exec(e);){var o,s=r[1];s.length&&s!==t&&i.push([]),o=r[2]?r[2].replace(new RegExp(n+n,"g"),n):r[3],i[i.length-1].push(o)}return i},t.hasBinariesConfiguration=function(e,t,n){var i="paths",r="pg_bin_dir",s=(0,o.default)("Please configure the PostgreSQL Binary Path in the Preferences dialog.");(t.type&&"ppas"===t.type||"ppas"===t.server_type)&&(r="ppas_bin_dir",s=(0,o.default)("Please configure the EDB Advanced Server Binary Path in the Preferences dialog."));var l=e.get_preference(i,r);if(!l)return n.alert((0,o.default)("Preferences Error"),(0,o.default)("Failed to load preference %s of module %s",r,i)),!1;if(a.default.isUndefined(l.value)||(d=l.value,c=t.version,u=!1,f=!1,p=JSON.parse(d),a.default.each(p,(function(e){c>=e.version&&c<e.next_major_version&&(a.default.isUndefined(e.binaryPath)||a.default.isNull(e.binaryPath)||""===e.binaryPath.trim()||(f=!0)),e.isDefault&&(u=!0)})),!(f|u)))return n.alert((0,o.default)("Configuration required"),s),!1;var d,c,u,f,p;return!0},t.registerDetachEvent=function(e){e.on(l.EVENT.DETACHED,(function(){(0,r.default)(this.$container[0].ownerDocument).find(".wcIFrameFloating").attr({style:"z-index: 1200"})})),e.on(l.EVENT.ORDER_CHANGED,(function(){(0,r.default)(this.$container[0].ownerDocument).find(".wcIFrameFloating").attr({style:"z-index: 1200"})})),e.on(l.EVENT.ORDER_CHANGED,(function(){var e=this.docker(this._panel).$container.offset(),t=this.$container.offset(),n=this.$container.width(),a=this.$container.height();(0,r.default)(this.$container[0].ownerDocument).find(".wcIFrameFloating").css("top",t.top-e.top),(0,r.default)(this.$container[0].ownerDocument).find(".wcIFrameFloating").css("left",t.left-e.left),(0,r.default)(this.$container[0].ownerDocument).find(".wcIFrameFloating").css("width",n),(0,r.default)(this.$container[0].ownerDocument).find(".wcIFrameFloating").find(".wcIFrameFloating").css("height",a)}))},t.isString=t.isFunction=t.isValidData=void 0,n(69826),n(32564),n(83710),n(91058),n(27852),n(82772),n(74916),n(64765),n(15306),n(69600),n(21249),n(23123),n(24603),n(39714),n(73210);var a=s(n(81311)),i=n(82794),r=s(n(19755)),o=s(n(91669));function s(e){return e&&e.__esModule?e:{default:e}}n(35816);var l=window.wcDocker;t.isValidData=function(e){return!a.default.isUndefined(e)&&!a.default.isNull(e)};t.isFunction=function(e){return a.default.isFunction(e)};function d(e){var t=!1;return isNaN(parseInt(e))||(t=!0),e.search(/[^a-z0-9_]/g)>-1&&(e=e.replace(/"/g,'""'),t=!0),t?'"'.concat(e,'"'):e}t.isString=function(e){return a.default.isString(e)}},1950:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function e(t){return t.opener&&t.opener.pgAdmin?e(t.opener):t},i=function(){var e=null;try{e=window.opener&&window.opener.pgAdmin?a(window.opener):window.parent&&window.parent.pgAdmin?window.parent:window.top&&window.top.pgAdmin?window.top:window}catch(t){e=window}return e}();t.default=i},9807:(e,t,n)=>{var a=n(64492);n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.getDatabaseLabel=d,t.getPanelTitle=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=e.get_preferences_for_module("browser");null==t&&null==a&&(t=e.treeMenu.selected());if(null==a&&c(a=i.getTreeNodeHierarchyFromIdentifier.call(e,t)))return;o||(o=d(a));var u="";u=r?l.qt_default_placeholder:n||s.qt_tab_title_placeholder;var p={database:o,username:a.server.user.name,server:a.server.label,type:"query_tool"},h=f(u,p);return h},t.setQueryToolDockerTitle=function(e,t,n,i){var o="",s="";u(e,i),i||"true"==i?(s=(0,r.default)("File - ")+n,o="fa fa-file-alt"):"false"==t||0==t?(s=(0,r.default)("View/Edit Data - ")+n,o="pg-font-icon icon-view_data"):(s=(0,r.default)("Query Tool - ")+n,o="pg-font-icon icon-query_tool");e.title('<span title="'+a.escape(s)+'">'+a.escape(n)+"</span>"),e.icon(o)},t.set_renamable_option=u,t.generateTitle=f,t.refresh_db_node=function(e,t){o.default.alert().setting({title:(0,r.default)("Database moved/renamed"),label:(0,r.default)("OK"),message:(0,r.default)(e),onok:function(){l.Browser.Nodes.database.callbacks.refresh(void 0,t)}}).show()},n(68309),n(74916),n(15306),n(24603),n(39714);var i=n(82794),r=s(n(91669)),o=s(n(55455));function s(e){return e&&e.__esModule?e:{default:e}}var l=s(n(1950)).default.pgAdmin;function d(e){return e.database?e.database.label:e.server.db}function c(e){return void 0===e.server}function u(e,t){t||"true"==t?e.renamable(!1):e.renamable(!0)}function f(e,t){return"query_tool"==t.type?e=(e=(e=e.replace(new RegExp("%DATABASE%"),a.unescape(t.database))).replace(new RegExp("%USERNAME%"),a.unescape(t.username))).replace(new RegExp("%SERVER%"),a.unescape(t.server)):"datagrid"==t.type?e=(e=(e=(e=(e=e.replace(new RegExp("%DATABASE%"),a.unescape(t.database))).replace(new RegExp("%USERNAME%"),a.unescape(t.username))).replace(new RegExp("%SERVER%"),a.unescape(t.server))).replace(new RegExp("%SCHEMA%"),a.unescape(t.schema))).replace(new RegExp("%TABLE%"),a.unescape(t.table)):"debugger"==t.type?e=(e=(e=(e=e.replace(new RegExp("%FUNCTION%"),a.unescape(t.function_name))).replace(new RegExp("%ARGS%"),a.unescape(t.args))).replace(new RegExp("%SCHEMA%"),a.unescape(t.schema))).replace(new RegExp("%DATABASE%"),a.unescape(t.database)):"psql_tool"==t.type&&(e=(e=(e=e.replace(new RegExp("%DATABASE%"),a.unescape(t.database))).replace(new RegExp("%USERNAME%"),a.unescape(t.username))).replace(new RegExp("%SERVER%"),a.unescape(t.server))),a.escape(e)}},52934:(e,t,n)=>{function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(66992),n(41539),n(78783),n(4129),n(33948),n(69070),n(38880),n(82526),n(41817),n(32165),Object.defineProperty(t,"__esModule",{value:!0}),t.showDataGrid=function(e,t,n,a,s,l){var d=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,f=t.treeMenu.findNodeByDomElement(s);if(void 0===f||!f.getData())return void n.alert((0,i.default)("Data Grid Error"),(0,i.default)("No object selected."));var p=o.getTreeNodeHierarchyFromIdentifier.call(t,s);if(b(p)||!v(p))return;var h=["table","partition","view","mview","foreign_table","catalog_object"];if(-1===h.indexOf(f.getData()._type))return;var w=_(l,a,f.getData(),p),x=y(t,s);if(d){m(n,t);var C=g(f.getData(),p),S=function(t){e.launch_grid(l,w,!1,x,null,t)};c.default.get((0,r.default)("datagrid.filter"),(function(e){n.filterDialog((0,i.default)("Data Filter - %s",x),e,C,u,S).resizeTo(t.stdW.sm,t.stdH.sm)}))}else e.launch_grid(l,w,!1,x)},t.retrieveNameSpaceName=h,t.generateDatagridTitle=y,n(82772),n(69826),n(32564),n(68309);var i=p(n(91669)),r=p(n(28008)),o=n(82794),s=n(9807),l=p(n(20811)),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}i.default=e,n&&n.set(e,i);return i}(n(81240)),c=p(n(19755)),u=p(n(81311));function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}function p(e){return e&&e.__esModule?e:{default:e}}function h(e){return void 0!==e.schema?e.schema.label:void 0!==e.view?e.view.label:void 0!==e.catalog?e.catalog.label:""}function _(e,t,n,a){var i=(0,r.default)("datagrid.panel",{trans_id:e});return i+="?is_query_tool=".concat(!1)+"&cmd_type=".concat(t.mnuid)+"&obj_type=".concat(n._type)+"&obj_id=".concat(n._id)+"&sgid=".concat(a.server_group._id)+"&sid=".concat(a.server._id)+"&did=".concat(a.database._id)+"&server_type=".concat(a.server.server_type)}function g(e,t){var n={sid:t.server._id,did:t.database._id,obj_id:e._id};return(0,r.default)("datagrid.filter_validate",n)}function m(e,t){var n=null;e.filterDialog||e.dialog("filterDialog",(function(){return{main:function(e,t,n,a,i){this.set("title",e),this.message=t,this.validateUrl=n,this.okCallback=i,this.preferences=a},setup:function(){return{buttons:[{text:"",key:112,className:"btn btn-primary-icon pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:(0,i.default)("Data Filter"),"aria-label":(0,i.default)("Help"),url:(0,r.default)("help.static",{filename:"viewdata_filter.html"})}},{text:(0,i.default)("Cancel"),key:27,className:"btn btn-secondary fa fa-times pg-alertify-button"},{text:(0,i.default)("OK"),key:null,className:"btn btn-primary fa fa-check pg-alertify-button"}],options:{modal:0,resizable:!0,maximizable:!1,pinnable:!1,autoReset:!1}}},build:function(){var t=this;e.pgDialogBuild.apply(t),(0,c.default)(t.__internal.buttons[2].element).attr("title",(0,i.default)("Use SHIFT + ENTER to apply filter...")),(0,c.default)(t.elements.body).on("keypress",(function(e){e.shiftKey&&13==e.keyCode&&t.__internal.buttons[2].element.click()}))},prepare:function(){var e=this,a=(0,c.default)(this.message),r=a.find("#sql_filter");(0,c.default)(this.elements.header).attr("data-title",this.get("title")),(0,c.default)(this.elements.body.childNodes[0]).addClass("dataview_filter_dialog"),this.setContent(a.get(0)),e.__internal.buttons[2].element.disabled=!0,n=this.filter_obj=l.default.fromTextArea(r.get(0),{lineNumbers:!0,mode:"text/x-pgsql",extraKeys:t.editor_shortcut_keys,indentWithTabs:!e.preferences.use_spaces,indentUnit:e.preferences.tab_size,tabSize:e.preferences.tab_size,lineWrapping:e.preferences.wrap_code,autoCloseBrackets:e.preferences.insert_pair_brackets,matchBrackets:e.preferences.brace_matching,screenReaderLabel:(0,i.default)("Filter SQL")});var o=d.calcFontSize(e.preferences.sql_font_size);(0,c.default)(this.filter_obj.getWrapperElement()).css("font-size",o),setTimeout((function(){e.filter_obj.refresh(),e.filter_obj.focus()}),500),e.filter_obj.on("change",(function(){""!==e.filter_obj.getValue()?e.__internal.buttons[2].element.disabled=!1:e.__internal.buttons[2].element.disabled=!0}))},callback:function(a){if(a.button.text==(0,i.default)("OK")){var r=this.filter_obj.getValue(),o=this;a.cancel=!0,c.default.ajax({url:o.validateUrl,method:"POST",async:!1,contentType:"application/json",data:JSON.stringify(r)}).done((function(t){t.data.status?(o.okCallback(r),o.close()):e.alert().setting({title:(0,i.default)("Validation Error"),label:(0,i.default)("OK"),message:(0,i.default)(t.data.result),onok:function(){n.focus()}}).show()})).fail((function(n){410===n.status?t.report_error((0,i.default)("Error filtering rows - %s.",n.statusText),n.responseJSON.errormsg):e.alert((0,i.default)("Validation Error"),n)}))}else if(0==a.index)return a.cancel=!0,void t.showHelp(a.button.element.name,a.button.element.getAttribute("url"),null,null)}}}))}function b(e){return void 0===e.server||void 0===e.database}function v(e){return void 0!==e.schema||void 0!==e.view||void 0!==e.catalog}function y(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=e.get_preferences_for_module("browser"),r=o.getTreeNodeHierarchyFromIdentifier.call(e,t),l=h(r),d=!u.default.isUndefined(a)&&null!=a&&a.hasOwnProperty("db_name")?a.db_name:(0,s.getDatabaseLabel)(r),c=e.treeMenu.findNodeByDomElement(t),f="";f=n||i.vw_edt_tab_title_placeholder;var p={database:d,username:r.server.user.name,server:r.server.label,schema:l,table:c.getData().label,type:"datagrid"},_=(0,s.generateTitle)(f,p);return _}},7167:(e,t,n)=>{n(69070),Object.defineProperty(t,"__esModule",{value:!0}),t.showQueryTool=function(e,t,n,i,s,l){var d=i||"",f=function(e,t){return(0,o.getPanelTitle)(e,t)}(t,s);if(void 0===t.treeMenu.findNodeByDomElement(s))return void n.alert((0,a.default)("Query Tool Error"),(0,a.default)("No object selected."));var p=r.getTreeNodeHierarchyFromIdentifier.call(t,s);if(function(e){return void 0===e.server}(p))return;var h=c(l,f,p);u(e,l,h,f,d,n)},t.generateScript=function(e,t,n){var a="".concat(e.database,"/").concat(e.user,"@").concat(e.server),r=(0,s.getRandomInt)(1,9999999),o=(0,i.default)("datagrid.panel",{trans_id:r});o+="?is_query_tool=".concat(!0)+"&sgid=".concat(e.sgid)+"&sid=".concat(e.sid)+"&server_type=".concat(e.stype)+"&did=".concat(e.did),u(t,r,o,a,"",n)},t.showERDSqlTool=function(e,t,n,a,i){var r=(0,s.getRandomInt)(1,9999999);e={server_group:{_id:e.sgid},server:{_id:e.sid,server_type:e.stype},database:{_id:e.did}};var o=c(r,n,e,t);u(a,r,o,n,"",i)},t.launchDataGrid=u,t._set_dynamic_tab=function(e,t){e.docker.findPanels("frm_datagrid").forEach((function(e){t?(0,l.default)("#"+e.$title.index()+" div:first").addClass("wcPanelTab-dynamic"):(0,l.default)("#"+e.$title.index()+" div:first").removeClass("wcPanelTab-dynamic")})),e.docker.findPanels("frm_debugger").forEach((function(e){t?(0,l.default)("#"+e.$title.index()+" div:first").addClass("wcPanelTab-dynamic"):(0,l.default)("#"+e.$title.index()+" div:first").removeClass("wcPanelTab-dynamic")}))},n(92222),n(89554),n(54747);var a=d(n(91669)),i=d(n(28008)),r=n(82794),o=n(9807),s=n(44092),l=d(n(19755));function d(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n,a){var r=(0,i.default)("datagrid.panel",{trans_id:e});return r+="?is_query_tool=".concat(!0)+"&sgid=".concat(n.server_group._id)+"&sid=".concat(n.server._id)+"&server_type=".concat(n.server.server_type),function(e){return e.database}(n)&&(r+="&did=".concat(n.database._id)),a&&(r+="&sql_id=".concat(a)),r}function u(e,t,n,i,r,o){e.launch_grid(t,n,!0,i,r)||o.alert((0,a.default)("Query tool launch error"),(0,a.default)("Please allow pop-ups for this site to perform the desired action. If the main window of pgAdmin is closed then close this window and open a new pgAdmin session."))}},93841:(e,t,n)=>{var a,i;n(69070),n(82526),n(57327),n(38880),n(49337),n(33321),n(89554),n(54747),n(21249),n(69826),n(91058),n(32564),n(92222),n(24812),n(26699),n(32023),n(2707),n(47042),n(74916),n(4723),n(68309),n(73210),n(82772),n(47941),n(66992),n(41539),n(33948),n(40561),n(83710),n(39714),n(64765),n(15306),n(79753),n(94986),n(19601),n(23123),n(3843),n(85827),n(78783),n(60285);var r=n(7167),o=n(52934);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.p=window.resourceBasePath,a=[n(91669),n(28008),n(19755),n(96939),n(40729),n(81311),n(55455),n(55112),n(72316),n(20811),n(44092),n(50654),n(6537),n(18980),n(58963),n(34038),n(82927),n(25750),n(40370),n(12436),n(40904),n(81240),n(65887),n(90865),n(87913),n(11346),n(74898),n(16770),n(13895),n(67563),n(72945),n(94860),n(28522),n(14511),n(23602),n(92007),n(45592),n(72622),n(20882),n(87789),n(9807),n(1950),n(57550),n(5221),n(7361),n(73409),n(58386),n(27528),n(63828),n(5205),n(58894),n(90491)],void 0===(i=function(e,t,n,a,i,s,c,u,f,p,h,_,g,m,b,v,y,w,x,C,S,k,E,T,O,P,q,D,N,j,M,A,R,I,L,B,V,U,H,F,z,$,K,G,Q){if(u.SqlEditor)return u.SqlEditor;var J=window.wcDocker,W=u.Browser,Y=p.default,Z=window.Slick,X=D.default,ee=N.default,te=j.QuerySources;F.setPGCSRFToken(u.csrf_token_header,u.csrf_token);var ne=!1,ae='<div role="status" class="pg-panel-message">'+e("No data output. Execute a query to get output.")+"</div>",ie='<div role="status" class="pg-panel-message">'+e('Use Explain/Explain analyze button to generate the plan for a query. Alternatively, you can also execute "EXPLAIN (FORMAT JSON) [QUERY]".')+"</div>",re=f.View.extend({initialize:function(t){this.$el=t.el,this.handler=t.handler,this.handler.col_size={};var n=$.default.pgAdmin.Browser;this.preferences=n.get_preferences_for_module("sqleditor"),this.browser_preferences=n.get_preferences_for_module("browser"),this.handler.preferences=this.preferences,this.handler.browser_preferences=this.browser_preferences,this.connIntervalId=null,this.layout=t.layout,this.set_server_version(t.server_ver),this.trigger("pgadmin-sqleditor:view:initialised"),this.connection_list=[{server_group:null,server:null,database:null,user:null,role:null,conn_title:"&lt;"+e("New Connection")+"&gt;"}]},events:{"click #btn-show-query-tool":"on_show_query_tool","click .btn-load-file":"on_file_load","click #btn-save-file":"on_save_file","click #btn-file-menu-save":"on_save_file","click #btn-file-menu-save-as":"on_save_as","click #btn-find":"on_find","click #btn-find-menu-find":"on_find","click #btn-find-menu-find-next":"on_find_next","click #btn-find-menu-find-previous":"on_find_previous","click #btn-find-menu-replace":"on_replace","click #btn-find-menu-replace-all":"on_replace_all","click #btn-find-menu-find-persistent":"on_find_persistent","click #btn-find-menu-jump":"on_jump","click #btn-delete-row":"on_delete","click #btn-save-data":"on_save_data","click #btn-filter":"on_show_filter","click #btn-filter-menu":"on_show_filter","click #btn-include-filter":"on_include_filter","click #btn-exclude-filter":"on_exclude_filter","click #btn-remove-filter":"on_remove_filter","click #btn-cancel":"on_cancel","click #btn-copy-row":"on_copy_row","click #btn-copy-with-header":"on_copy_row_with_header","click #btn-paste-row":"on_paste_row","click #btn-flash":"on_flash","click #btn-flash-menu":"on_flash","click #btn-cancel-query":"on_cancel_query","click #btn-save-results-to-file":"on_download","click #btn-clear":"on_clear","click #btn-auto-commit":"on_auto_commit","click #btn-auto-rollback":"on_auto_rollback","click #btn-clear-history":"on_clear_history","click .noclose":"do_not_close_menu","click #btn-explain":"on_explain","click #btn-explain-analyze":"on_explain_analyze","click #btn-explain-verbose":"on_explain_verbose","click #btn-explain-costs":"on_explain_costs","click #btn-explain-buffers":"on_explain_buffers","click #btn-explain-timing":"on_explain_timing","click #btn-explain-summary":"on_explain_summary","click #btn-explain-settings":"on_explain_settings","change .limit":"on_limit_change",keydown:"keyAction","click #btn-comment-code":"on_toggle_comment_block_code","click #btn-toggle-comment-block":"on_toggle_comment_block_code","click #btn-comment-line":"on_comment_line_code","click #btn-uncomment-line":"on_uncomment_line_code","click #btn-indent-code":"on_indent_code","click #btn-unindent-code":"on_unindent_code","click #btn-format-sql":"on_format_sql","click #btn-commit":"on_commit_transaction","click #btn-rollback":"on_rollback_transaction","click #btn-manage-macros":"on_manage_macros","click .btn-macro":"on_execute_macro"},render_connection:function(e){if(this.handler.is_query_tool){document.getElementById("connections-list").innerHTML="",e.forEach((function(e,t){var a="";a="is_selected"in e&&e.is_selected?'<li class="connection-list-item selected-connection" data-index='+t+'><a class="dropdown-item" href="#" tabindex="0">'+e.conn_title+"</a></li>":'<li class="connection-list-item" data-index='+t+'><a class="dropdown-item" href="#" tabindex="0">'+e.conn_title+"</a></li>",n("#connections-list").append(a)}));var t=this;n(".connection-list-item").click((function(){t.get_connection_data(this)}))}else n(".conn-info-dd").hide(),n(".connection-data").css({pointerEvents:"none",cursor:"arrow"})},get_connection_data:function(e){var t=n(e).attr("data-index"),a=this.connection_list[t];a.server_group?this.on_change_connection(a):this.on_new_connection()},reflectPreferences:function(){var e=this,t=$.default.pgAdmin.Browser,n=t.get_preferences_for_module("browser");W.preference_version()<t.preference_version()&&(W.preference_version(t.preference_version()),e.preferences=t.get_preferences_for_module("sqleditor"),e.preferences.show_query_tool=n.sub_menu_query_tool,e.handler.preferences=e.preferences,U.updateUIPreferences(e))},buildDefaultLayout:function(e){var t=e.addPanel("sql_panel",J.DOCK.TOP);e.addPanel("scratch",J.DOCK.RIGHT,t),e.addPanel("history",J.DOCK.STACKED,t);var n=e.addPanel("data_output",J.DOCK.BOTTOM);e.addPanel("explain",J.DOCK.STACKED,n),e.addPanel("messages",J.DOCK.STACKED,n),e.addPanel("notifications",J.DOCK.STACKED,n)},set_server_version:function(e){var t=this;t.server_ver=e,this.$el.find("*[data-min-ver]").map((function(){var e=n(this);parseInt(e.attr("data-min-ver"))>t.server_ver?e.addClass("d-none"):e.removeClass("d-none")}))},set_editor_title:function(e){this.$el.find(".editor-title").text(s.unescape(e)),this.render_connection(this.connection_list)},render:function(){var a=this;a.gain_focus=function(){setTimeout((function(){k.updateConnectionStatusFlag("visible")}),100)},a.lost_focus=function(){setTimeout((function(){k.updateConnectionStatusFlag("hidden")}),100)},a.docker=new J("#editor-panel",{allowContextMenu:!0,allowCollapse:!1,loadingClass:"pg-sp-icon",themePath:t("static",{filename:"css"}),theme:"webcabin.overrides.css"});var i=new u.Browser.Panel({name:"sql_panel",title:e("Query Editor"),width:"75%",height:"33%",isCloseable:!1,isPrivate:!0}),r=new u.Browser.Panel({name:"data_output",title:e("Data Output"),width:"100%",height:"100%",isCloseable:!1,isPrivate:!0,extraClasses:"hide-vertical-scrollbar",content:'<div class="data-output-container">\n          <div id="fetching_data" class="pg-sp-container sql-editor-busy-fetching">\n              <div class="pg-sp-content">\n                  <div class="row">\n                      <div class="col-12 pg-sp-icon sql-editor-busy-icon"></div>\n                  </div>\n                  <div class="row"><div class="col-12 pg-sp-text sql-editor-busy-text">'.concat(e("Loading..."),'</div></div>\n              </div>\n          </div>\n          <div id ="datagrid" class="sql-editor-grid-container text-12" tabindex="0">').concat(ae,"</div>\n        </div>")}),o=new u.Browser.Panel({name:"explain",title:e("Explain"),width:"100%",height:"100%",isCloseable:!1,isPrivate:!0,content:'<div class="sql-editor-explain pg-el-container" tabindex="0">'.concat(ie,"</div>")}),d=new u.Browser.Panel({name:"messages",title:e("Messages"),width:"100%",height:"100%",isCloseable:!1,isPrivate:!0,content:'<div role="status" class="sql-editor-message" tabindex="0"></div>'}),f=new u.Browser.Panel({name:"history",title:e("Query History"),width:"100%",height:"33%",isCloseable:!1,isPrivate:!0,content:'<div id ="history_grid" class="sql-editor-history-container" tabindex="0"></div>'}),p=new u.Browser.Panel({name:"scratch",title:e("Scratch Pad"),width:"25%",height:"33%",isCloseable:!0,isPrivate:!1,content:'<div class="sql-scratch"><textarea wrap="off" tabindex="0"></textarea></div>'}),h=new u.Browser.Panel({name:"notifications",title:e("Notifications"),width:"100%",height:"100%",isCloseable:!1,isPrivate:!0,content:'<div id ="notification_grid" class="sql-editor-notifications" tabindex="0"></div>'}),_=new u.Browser.Panel({name:"geometry_viewer",title:e("Geometry Viewer"),width:"100%",height:"100%",isCloseable:!0,isPrivate:!0,isLayoutMember:!1,content:'<div id ="geometry_viewer_panel" class="sql-editor-geometry-viewer" tabindex="0"></div>'});i.load(a.docker),r.load(a.docker),o.load(a.docker),d.load(a.docker),f.load(a.docker),p.load(a.docker),h.load(a.docker),_.load(a.docker),W.restore_layout(a.docker,this.layout,this.buildDefaultLayout.bind(this)),a.docker.on(J.EVENT.LAYOUT_CHANGED,(function(){W.save_current_layout("SQLEditor/Layout",a.docker)})),a.sql_panel_obj=a.docker.findPanels("sql_panel")[0],a.history_panel=a.docker.findPanels("history")[0],a.data_output_panel=a.docker.findPanels("data_output")[0],a.explain_panel=a.docker.findPanels("explain")[0],a.messages_panel=a.docker.findPanels("messages")[0],a.notifications_panel=a.docker.findPanels("notifications")[0],(s.isUndefined(a.sql_panel_obj)||s.isUndefined(a.history_panel)||s.isUndefined(a.data_output_panel)||s.isUndefined(a.explain_panel)||s.isUndefined(a.messages_panel)||s.isUndefined(a.notifications_panel))&&c.alert(e("Panel Loading Error"),e("Something went wrong while loading the panels. Please make sure to reset the layout (File > Reset Layout) for the better user experience.")),a.sql_panel_obj.on(J.EVENT.RESIZE_ENDED,(function(){setTimeout((function(){a&&a.query_tool_obj&&a.query_tool_obj.refresh()}),200)})),a.render_history_grid(),W.Events.on("pgadmin:query_tool:connected:"+a.handler.transId,(function(){a.fetch_query_history()})),a.handler.on("pgadmin-sqleditor:check_synchronous_db_name_change",(function(e){a.handler.check_db_name_change(e)})),R.renderNotificationsGrid(a.notifications_panel);var g=n('<textarea id="sql_query_tool" tabindex="-1"></textarea>'),m=n('<label for="sql_query_tool" class="sr-only">SQL Editor</label><div id="output-panel" tabindex="0"></div>').append(g);a.sql_panel_obj.$container.find(".pg-panel-content").append(m),a.query_tool_obj=Y.fromTextArea(g.get(0),{tabindex:"0",lineNumbers:!0,styleSelectedText:!0,mode:"gpdb"===a.handler.server_type?"text/x-gpsql":"text/x-pgsql",foldOptions:{widget:""},foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],extraKeys:W.editor_shortcut_keys,scrollbarStyle:"simple",dragDrop:!1,screenReaderLabel:e("SQL editor")}),a.handler.is_query_tool&&(a.query_tool_obj.setOption("dragDrop",!0),a.query_tool_obj.on("drop",(function(e,t){var n=null;try{n=JSON.parse(t.dataTransfer.getData("text")),t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()}catch(e){return}var a=e.coordsChar({left:t.x,top:t.y});e.replaceRange(n.text,a),e.focus(),e.setSelection(l(l({},a),{},{ch:a.ch+n.cur.from}),l(l({},a),{},{ch:a.ch+n.cur.to}))}))),W.Events.on("pgadmin:query_tool:sql_panel:focus",(function(){a.query_tool_obj.focus()})),W.Events.on("pgadmin:query_tool:explain:focus",(function(){setTimeout((function(){n(".sql-editor-explain .backform-tab .nav-link.active").focus()}),200)})),n("#datagrid").bind("dragover drop",(function(e){e.stopPropagation(),e.preventDefault()}));var b=a.browser_preferences.new_browser_tab_open;(s.isNull(b)||s.isUndefined(b)||!b.includes("qt"))&&(s.each($.default.pgAdmin.Browser.docker.findPanels("frm_datagrid"),(function(e){e.trans_id==a.transId&&(a.currentPanel=e,e.on(J.EVENT.CLOSING,(function(){return a.handler.check_needed_confirmations_before_closing_panel(!0)})),e.on(J.EVENT.GAIN_FOCUS,(function(){var e=n(this.$container),t=a.handler.transId;if(!e.hasClass("wcPanelTabContentHidden")){k.isModalOpen(["fileSelectionDlg","createModeDlg","confirm","alert","confirmSave","newConnectionDialog","macroDialog"])||(setTimeout((function(){a.handler.gridView.query_tool_obj.focus()}),200),W.Events.trigger("pgadmin:query_tool:panel:gain_focus:"+t))}})),e.on(J.EVENT.LOST_FOCUS,(function(){var e=n(this.$container),t=a.handler.transId;e.hasClass("wcPanelTabContentHidden")&&W.Events.trigger("pgadmin:query_tool:panel:lost_focus:"+t)})))})),W.Events.on("pgadmin:query_tool:panel:gain_focus:"+a.handler.transId,a.gain_focus,a),W.Events.on("pgadmin:query_tool:panel:lost_focus:"+a.handler.transId,a.lost_focus,a)),setTimeout((function(){a.query_tool_obj.focus()}),500),Y.registerHelper("hint","sql",(function(e){var i=[],r=e.getDoc(),o=r.getCursor(),l=o.ch,d={editor:e,url:t("sqleditor.autocomplete",{trans_id:a.transId}),data:i,current_line:o.line,hint_render:function(e,t,n){var a=document.createElement("span");switch(n.type){case"database":a.className="sqleditor-hint pg-icon-"+n.type;break;case"datatype":a.className="sqleditor-hint icon-type";break;case"keyword":a.className="fa fa-key";break;case"table alias":a.className="fa fa-at";break;default:a.className="sqleditor-hint icon-"+n.type}a.appendChild(document.createTextNode(n.text)),e.appendChild(a)}};return i.push(r.getValue()),i.push(r.getRange({line:0,ch:0},{line:d.current_line,ch:l})),{then:function(e){var t=this;n.ajax({url:t.url,method:"POST",contentType:"application/json",data:JSON.stringify(t.data)}).done((function(n){var a=[];s.each(n.data.result,(function(e,n){a.push({text:n,type:e.object_type,render:t.hint_render})})),a.sort((function(e,t){var n=e.text.toLowerCase(),a=t.text.toLowerCase();return n<a?-1:n>a?1:0}));var i,r,l,d=t.editor.getTokenAt(o);d.end>o.ch&&(d.end=o.ch,d.string=d.string.slice(0,o.ch-d.start)),d.string.match(/^[.`\w@]\w*$/)?(l=d.string,i=d.start,r=d.end):(i=r=o.ch,l=""),"."!=l.charAt(0)&&"``"!=l.charAt(0)||(i+=1),e({list:a,from:{line:t.current_line,ch:i},to:{line:t.current_line,ch:r}})})).fail((function(e){return T.handleLoginRequiredAndTransactionRequired(u,t,e,null,[],!1)}))}.bind(d)}})),n(".dropdown-submenu").on("mouseenter",(function(){var e=n(this).find("ul.dropdown-menu");if(n(e).offset().left+e.width()>n(window).width()){var t=-n(e).width();e.css("left",t)}})).on("mouseleave",(function(){n(this).find("ul.dropdown-menu").css("left","")})),a.reflectPreferences(),a.preferences.auto_commit?n(".auto-commit").removeClass("visibility-hidden"):n(".auto-commit").addClass("visibility-hidden"),a.preferences.auto_rollback?n(".auto-rollback").removeClass("visibility-hidden"):n(".auto-rollback").addClass("visibility-hidden"),$.default.pgAdmin.Browser.onPreferencesChange("sqleditor",(function(){a.reflectPreferences()}));var v=a.browser_preferences.new_browser_tab_open;v&&v.includes("qt")&&(W.bind_beforeunload(),setInterval((function(){$.default.pgAdmin&&a.reflectPreferences()}),1e3)),W.register_to_activity_listener(document,(function(){c.alert(e("Timeout"),e("Your session has timed out due to inactivity. Please close the window and login again."))})),a.render_connection(a.connection_list)},render_grid:function(t,a,i,r,o){var l=this;l.handler.numberOfModifiedCells=0,l.handler.reset_data_store(),l.handler.rows_to_disable=new Array,l.handler.temp_new_rows=new Array,l.handler.primary_keys_data={},l.client_primary_key=r,l.client_primary_key_counter=0,l.handler.slickgrid&&l.handler.slickgrid.destroy(),s.isArray(t)&&s.size(t)||(t=[]);var u,f=[],p=l.handler.col_size,h=l.handler.query,_=h.match(/select.*from\s+\w+\.*(\w+)/i);u=_?_[1]:k.getHash(h),l.handler.table_name=u,p[u]=p[u]||{},(s.isUndefined(l.auto_resize_column_based_on_data)||l.auto_resize_column_based_on_data!==l.preferences.column_data_auto_resize)&&(l.auto_resize_column_based_on_data=l.preferences.column_data_auto_resize,p[u]={}),l.max_width_changed=!1,(s.isUndefined(l.old_column_data_max_width)||l.old_column_data_max_width!=l.preferences.column_data_max_width)&&(l.old_column_data_max_width=l.preferences.column_data_max_width,l.max_width_changed=!0),s.each(a,(function(t){t.display_name=s.escape(t.display_name),t.column_type=s.escape(t.column_type);var a={id:s.escape(t.name),pos:t.pos,field:t.name,nonative_field:'"'.concat(t.name,'"'),name:t.label,display_name:t.display_name,column_type:t.column_type,column_type_internal:t.column_type_internal,cell:t.cell,not_null:t.not_null,has_default_val:t.has_default_val,is_array:t.is_array,can_edit:t.can_edit},i=t.column_type.trim(),r=t.name.length>i.length?s.escape(t.display_name):i,o=0;if("geometry"!=t.cell&&"geography"!=t.cell||(o+=28),s.isUndefined(t.can_edit)||(o+=12),s.isUndefined(p[u][a.nonative_field])?"by_data"===l.preferences.column_data_auto_resize?(a.addWidth=o,a.width=NaN):(a.width=k.calculateColumnWidth(r),a.width+=o,p[u][t.nonative_field]=a.width):a.width=p[u][a.nonative_field],"oid"==t.cell&&"oid"==t.name?a.editor=null:"Json"==t.cell?(a.editor=t.can_edit?Z.Editors.JsonText:Z.Editors.ReadOnlyJsonText,a.formatter=Z.Formatters.JsonString):"number"==t.cell||"oid"==t.cell||-1!==n.inArray(t.type,["xid","real"])?(a.editor=t.can_edit?Z.Editors.CustomNumber:Z.Editors.ReadOnlyText,a.formatter=Z.Formatters.Numbers):"boolean"==t.cell?(a.editor=t.can_edit?Z.Editors.Checkbox:Z.Editors.ReadOnlyCheckbox,a.formatter=Z.Formatters.Checkmark):"binary"==t.cell?a.formatter=Z.Formatters.Binary:"geometry"==t.cell||"geography"==t.cell?a.can_edit=!1:(a.editor=t.can_edit?Z.Editors.pgText:Z.Editors.ReadOnlypgText,a.formatter=Z.Formatters.Text),!s.isUndefined(t.can_edit)){var d="";d=t.can_edit?e("Editable column"):e("Read-only column"),a.toolTip=d}f.push(a)}));var g=new m;f=l.grid_columns=g.getColumnDefinitions(f),s.each(f,(function(e){"geometry"!=e.column_type_internal&&"geography"!=e.column_type_internal||q.add_header_button(e),s.isUndefined(e.can_edit)||k.addEditableIcon(e,e.can_edit)})),o&&(f[0].width=k.calculateColumnWidth(o));var v={editable:!0,enableAddRow:i,enableCellNavigation:!0,enableColumnReorder:!1,asyncEditorLoading:!1,autoEdit:!1},y=n("#datagrid"),w=n(this.data_output_panel.$container.parent().parent()).height()-35;y.height(w);var E=l.dataView=new Z.Data.DataView,T=l.grid=new Z.Grid(y,E,f,v);E.getItemMetadata=function(e){var t="",n=l.handler.data_store;return s.has(l.handler,"data_store")&&(e in n.added_index&&n.added_index[e]in n.added?(t="new_row",n.added[n.added_index[e]].err&&(t+=" error")):e in n.updated_index&&e in n.updated&&(t="updated_row",n.updated[n.updated_index[e]].err&&(t+=" error"))),!s.isUndefined(l.handler.rows_to_disable)&&l.handler.rows_to_disable.length>0&&-1!==s.indexOf(l.handler.rows_to_disable,e)&&(t+=" disabled_row"),{cssClasses:t}},T.registerPlugin(new Z.AutoTooltips({enableForHeaderCells:!1})),T.registerPlugin(new b),T.setSelectionModel(new C),T.registerPlugin(g),T.registerPlugin(new Z.AutoColumnSize);var O=new Z.Plugins.HeaderButtons;O.onCommand.subscribe((function(e,t){if("view-geometries"===t.command){var n=t.grid.getColumns(),a=n.indexOf(t.column),i=t.grid.getSelectedRows();if(0===i.length)if(l.handler.has_more_rows)l.fetch_next_all((function(){g.onGridSelectAll.notify(t,new Z.EventData);var e=t.grid.getData().getItems();q.render_geometries(l.handler,e,n,a)}));else{g.onGridSelectAll.notify(t,new Z.EventData);var r=t.grid.getData().getItems();q.render_geometries(l.handler,r,n,a)}else{var o=t.grid.getData().getItems(),d=s.map(i,(function(e){return o[e]}));q.render_geometries(l.handler,d,n,a)}}})),T.registerPlugin(O);var P={keys:s.isEmpty(l.handler.primary_keys)&&l.handler.has_oids?l.handler.oids:l.handler.primary_keys,vals:t,columns:a,grid:T,selection:T.getSelectionModel(),editor:l,client_primary_key:l.client_primary_key,has_oids:l.handler.has_oids};l.handler.slickgrid=T,l.handler.slickgrid.onScroll.subscribe((function(){setTimeout((function(){var e=l.handler.gridView.grid.getSelectionModel(),t=e.getSelectedRanges();t.length>1&&e.setSelectedRanges(t)}),100),Object.keys(l.handler.data_store.deleted).length>0&&setTimeout((function(){n(l.handler.gridView.grid.getCanvasNode()).find("div.selected").removeClass("strikeout"),n(l.handler.gridView.grid.getCanvasNode()).find("div.selected").addClass("strikeout")}),100)})),l.handler.slickgrid.CSVOptions={quoting:l.preferences.results_grid_quoting,quote_char:l.preferences.results_grid_quote_char,field_separator:l.preferences.results_grid_field_separator},P.selection&&P.selection.onSelectedRangesChanged.subscribe(S.bind(P)),T.onColumnsResized.subscribe(function(){var e=this.getColumns();s.each(e,(function(e){l.handler.col_size[l.handler.table_name][e.nonative_field]=e.width}))}.bind(T)),g.onBeforeGridSelectAll.subscribe((function(e,t){l.handler.has_more_rows&&(e.stopImmediatePropagation(),l.fetch_next_all((function(){g.onGridSelectAll.notify(t,new Z.EventData)})))})),g.onBeforeGridColumnSelectAll.subscribe((function(e,t){l.handler.has_more_rows&&(e.stopImmediatePropagation(),l.fetch_next_all((function(){g.onGridColumnSelectAll.notify(t,new Z.EventData)})))})),E.onRowCountChanged.subscribe((function(){T.updateRowCount(),T.render()})),E.onRowsChanged.subscribe((function(e,t){T.invalidateRows(t.rows),T.render(),"by_data"===l.preferences.column_data_auto_resize&&T.resizeAllColumns&&T.resizeAllColumns(l.preferences.column_data_max_width,l.max_width_changed)})),T.onBeforeEditCell.subscribe((function(e,t){if("bytea"==t.column.column_type_internal||"bytea[]"==t.column.column_type_internal)return!1;var n=t.item;if(l.handler.rows_to_disable&&s.contains(l.handler.rows_to_disable,t.row))return!1;if(l.handler.can_edit&&n&&l.client_primary_key in n){var a=n[l.client_primary_key],i=l.handler.primary_keys,r={};if(a in l.handler.primary_keys_data)return;s.each(i,(function(e,t){r[t]=n[t]})),l.handler.primary_keys_data[a]=r}})),T.onKeyDown.subscribe((function(e,t){var n=e.keyCode;(e.ctrlKey||e.metaKey)&&65==n&&l.handler.has_more_rows?l.fetch_next_all((function(){x(e,t)})):x(e,t)})),n(".slick-viewport").on("blur","input.editor-text",(function(){window.setTimeout((function(){Z.GlobalEditorLock.isActive()&&Z.GlobalEditorLock.commitCurrentEdit()}))})),T.onCellChange.subscribe(function(e,t){var a=t.grid.getColumns()[t.cell].field,i=t.item[a],r=t.item[l.client_primary_key]||null,o={};l.handler.numberOfModifiedCells++,t.grid.addCellCssStyles(l.handler.numberOfModifiedCells,d({},t.row,d({},a,"highlighted_grid_cells")));var c=t.grid.getDataItem(t.row);if(l.primary_keys&&s.all(s.values(s.pick(c,l.primary_keys)),(function(e){return null!=e}))&&l.handler.temp_new_rows){var u=l.handler.temp_new_rows.indexOf(t.row);u>-1&&l.handler.temp_new_rows.splice(u,1)}o[a]=i,r&&(r in l.handler.data_store.added?(s.extend(l.handler.data_store.added[r].data,o),l.handler.data_store.added[r].err=!1):r in l.handler.data_store.updated?(s.extend(l.handler.data_store.updated[r].data,o),l.handler.data_store.updated[r].err=!1):(l.handler.data_store.updated[r]={err:!1,data:o,primary_keys:l.handler.primary_keys_data[r]},l.handler.data_store.updated_index[t.row]=r)),n("#btn-save-data").prop("disabled",!1)}.bind(P)),T.onAddNewRow.subscribe(function(e,t){var a=t.column,i=t.item,r=this.grid.getDataLength(),o=(l.client_primary_key_counter++).toString(),c=this.grid.getData();s.isUndefined(i[0])&&l.handler.temp_new_rows.push(r),i&&(i[l.client_primary_key]=o),s.each(t.grid.getColumns(),(function(e){K(i[e.field])&&(i[e.field]=void 0)})),c.addItem(i),l.handler.data_store.added[o]={err:!1,data:i},l.handler.data_store.added_index[r]=o;({})[a.name]=s.where(this.columns,{pos:a.pos})[0].type,T.updateRowCount(),T.render();var u=c.getRowByItem(i);l.handler.numberOfModifiedCells++,t.grid.addCellCssStyles(l.handler.numberOfModifiedCells,d({},u,d({},a.field,"highlighted_grid_cells"))),n("#btn-save-data").prop("disabled",!1)}.bind(P)),T.onViewportChanged.subscribe((function(e,t){var n=t.grid.getRenderedRange(),a=t.grid.getDataLength();l.handler.has_more_rows&&!l.handler.fetching_rows&&n.bottom>a-100&&setTimeout(l.fetch_next.bind(l))})),T.onValidationError.subscribe((function(e,t){c.error(t.validationResults.msg)})),n(window).resize((function(){l.data_output_panel.isVisible()&&l.grid_resize(T)})),l.data_output_panel.on(J.EVENT.RESIZE_ENDED,(function(){l.data_output_panel.isVisible()&&l.grid_resize(T)})),l.data_output_panel.on(J.EVENT.RESIZED,(function(){l.data_output_panel.isVisible()&&("by_data"===l.preferences.column_data_auto_resize?T.resizeAllColumns&&T.resizeAllColumns(l.preferences.column_data_max_width,l.max_width_changed):l.grid.resizeAllColumns&&l.grid.resizeAllColumns())})),l.data_output_panel.on(J.EVENT.VISIBILITY_CHANGED,(function(){l.data_output_panel.isVisible()&&l.grid_resize(T)}));for(var D=0;D<t.length;D++){for(var N={},j=1;j<f.length;j++)N[f[j].field]=t[D][f[j].pos];N[l.client_primary_key]=(l.client_primary_key_counter++).toString(),t[D]=N}E.setItems(t,l.client_primary_key),0===t.length&&"by_data"===l.preferences.column_data_auto_resize&&l.grid.resizeAllColumns&&l.grid.resizeAllColumns()},fetch_next_all:function(e){this.fetch_next(!0,e)},fetch_next:function(a,i){var r=this,o="";r.handler.fetching_rows=!0,n("#btn-flash").prop("disabled",!0),n("#btn-save-results-to-file").prop("disabled",!0),a?(r.handler.trigger("pgadmin-sqleditor:loading-icon:show",e("Fetching all records...")),o=t("sqleditor.fetch_all",{trans_id:r.transId,fetch_all:1})):o=t("sqleditor.fetch",{trans_id:r.transId}),n.ajax({url:o,method:"GET"}).done((function(e){r.handler.has_more_rows=e.data.has_more_rows,setTimeout((function(){n("#btn-flash").prop("disabled",!1)}),700),n("#btn-save-results-to-file").prop("disabled",!1),r.handler.trigger("pgadmin-sqleditor:loading-icon:hide"),r.update_grid_data(e.data.result),r.handler.fetching_rows=!1,"function"==typeof i&&i()})).fail((function(e){n("#btn-flash").prop("disabled",!1),n("#btn-save-results-to-file").prop("disabled",!1),r.handler.trigger("pgadmin-sqleditor:loading-icon:hide"),r.handler.has_more_rows=!1,r.handler.fetching_rows=!1,"function"==typeof i&&i();var t=T.handleQueryToolAjaxError(u,r,e,null,[],!1);t&&r.update_msg_history(!1,t)}))},update_grid_data:function(e){this.dataView.beginUpdate();for(var t=0;t<e.length;t++){for(var n={},a=1;a<this.grid_columns.length;a++)n[this.grid_columns[a].field]=e[t][this.grid_columns[a].pos];n[this.client_primary_key]=(this.client_primary_key_counter++).toString(),this.dataView.addItem(n)}this.dataView.endUpdate()},grid_resize:function(e){var t=n("#datagrid").height(),a=n(this.data_output_panel.$container.parent().parent()).height()-35,i=e.getViewport(),r=e.getRenderedRange(),o=e.getActiveCell();t!=a&&n("#datagrid").css({height:a+"px"}),e.resizeCanvas(),o&&e.scrollCellIntoView(o.row,o.cell),i.top!=r.top&&(i.bottom-2==r.bottom?e.scrollRowIntoView(i.bottom):e.scrollRowIntoView(i.bottom-2))},fetch_query_history:function(){var e=this;n.ajax({url:t("sqleditor.get_query_history",{trans_id:e.handler.transId}),method:"GET",contentType:"application/json"}).done((function(t){t.data.result.map((function(t){var n=JSON.parse(t);n.start_time=new Date(n.start_time),e.history_collection.add(n)}))})).fail((function(){}))},render_history_grid:function(){var e=this;e.history_collection||(e.history_collection=new X([])),e.historyComponent||(e.historyComponent=new ee(n("#history_grid"),e.history_collection),e.historyComponent.onCopyToEditorClick((function(t){e.query_tool_obj.setValue(t),e.sql_panel_obj.focus(),setTimeout((function(){e.query_tool_obj.focus(),e.query_tool_obj.setCursor(e.query_tool_obj.lineCount(),0)}),100)})),e.historyComponent.render(),e.history_panel.off(J.EVENT.VISIBILITY_CHANGED),e.history_panel.on(J.EVENT.VISIBILITY_CHANGED,(function(){e.history_panel.isVisible()&&setTimeout((function(){e.historyComponent.focus()}),100)}))),e.handler.is_query_tool||e.historyComponent.setEditorPref({copy_to_editor:!1})},on_delete:function(){var e=this;e.handler.trigger("pgadmin-sqleditor:button:deleterow",e,e.handler)},_stopEventPropogation:function(e){(e=e||window.event).cancelBubble=!0,e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault()},_closeDropDown:function(e){var t=e&&(e.currentTarget||e.target);t&&n(t).closest(".editor-toolbar").find(".show").removeClass("show")},on_save_file:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.handler.close_on_save=!1,this.handler.trigger("pgadmin-sqleditor:button:save_file")},on_save_as:function(e){var t=this;this._stopEventPropogation(e),this._closeDropDown(e),t.handler.close_on_save=!1,t.handler.trigger("pgadmin-sqleditor:button:save_file",t,t.handler,!0)},on_find:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.query_tool_obj.execCommand("find")},on_find_next:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.query_tool_obj.execCommand("findNext")},on_find_previous:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.query_tool_obj.execCommand("findPrev")},on_replace:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.query_tool_obj.execCommand("replace")},on_replace_all:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.query_tool_obj.execCommand("replaceAll")},on_find_persistent:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.query_tool_obj.execCommand("findPersistent")},on_jump:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.query_tool_obj.execCommand("jumpToLine")},on_show_filter:function(){var e=this;e.handler.trigger("pgadmin-sqleditor:button:show_filter",e,e.handler)},on_new_connection:function(){var e=this;e.handler.trigger("pgadmin-sqleditor:button:show_new_connection",e,e.handler)},on_include_filter:function(e){var t=this;this._stopEventPropogation(e),this._closeDropDown(e),t.handler.trigger("pgadmin-sqleditor:button:include_filter",t,t.handler)},on_exclude_filter:function(e){var t=this;this._stopEventPropogation(e),this._closeDropDown(e),t.handler.trigger("pgadmin-sqleditor:button:exclude_filter",t,t.handler)},on_remove_filter:function(e){var t=this;this._stopEventPropogation(e),this._closeDropDown(e),t.handler.trigger("pgadmin-sqleditor:button:remove_filter",t,t.handler)},on_cancel:function(){n("#filter").addClass("d-none"),n("#editor-panel").removeClass("sql-editor-busy-fetching")},on_copy_row:function(){var e=this;e.handler.trigger("pgadmin-sqleditor:button:copy_row",e,e.handler)},on_copy_row_with_header:function(e){var t=this;this._stopEventPropogation(e),t.handler.trigger("pgadmin-sqleditor:button:copy_row_with_header",t,t.handler)},on_paste_row:function(){var e=this;e.handler.trigger("pgadmin-sqleditor:button:paste_row",e,e.handler)},on_limit_change:function(){var e=this;e.handler.trigger("pgadmin-sqleditor:button:limit",e,e.handler)},on_save_data:function(){this.handler.history_query_source=te.SAVE_DATA,A.saveDataChanges(this.handler)},on_flash:function(){n("#btn-flash").prop("disabled",!0);var e=n("#btn-flash").attr("data-click-counter");e=(parseInt(e)+1)%10,n("#btn-flash").attr("data-click-counter",e),this.handler.history_query_source=te.EXECUTE,A.executeQuery(this.handler)},on_cancel_query:function(){var e=this;e.handler.trigger("pgadmin-sqleditor:button:cancel-query",e,e.handler)},on_comment_line_code:function(){A.commentLineCode(this.handler)},on_uncomment_line_code:function(){A.uncommentLineCode(this.handler)},on_toggle_comment_block_code:function(){A.commentBlockCode(this.handler)},on_indent_code:function(){var e=this;e.handler.trigger("pgadmin-sqleditor:indent_selected_code",e,e.handler)},on_unindent_code:function(){var e=this;e.handler.trigger("pgadmin-sqleditor:unindent_selected_code",e,e.handler)},on_format_sql:function(){var e=this;e.handler.trigger("pgadmin-sqleditor:format_sql",e,e.handler)},on_clear:function(t){var n=this;this._stopEventPropogation(t),this._closeDropDown(t),n.handler.is_query_changed?c.confirm(e("Unsaved changes"),e("Are you sure you wish to discard the current changes?"),(function(){n.query_tool_obj.setValue(""),setTimeout((function(){n.query_tool_obj.focus()}),200)}),(function(){return!0})).set("labels",{ok:e("Yes"),cancel:e("No")}):n.query_tool_obj.setValue("")},on_clear_history:function(a){var i=this;this._stopEventPropogation(a),this._closeDropDown(a),i.history_collection.length()&&c.confirm(e("Clear history"),e("Are you sure you wish to clear the history?")+"</br>"+e("This will remove all of your query history from this and other sessions for this database."),(function(){i.history_collection&&i.history_collection.reset(),i.handler.is_query_tool&&n.ajax({url:t("sqleditor.clear_query_history",{trans_id:i.handler.transId}),method:"DELETE",contentType:"application/json"}).done((function(){})).fail((function(){})),setTimeout((function(){i.query_tool_obj.focus()}),200)}),(function(){return!0})).set("labels",{ok:e("Yes"),cancel:e("No")})},on_auto_commit:function(e){var t=this;this._stopEventPropogation(e),t.handler.trigger("pgadmin-sqleditor:button:auto_commit",t,t.handler)},on_auto_rollback:function(e){var t=this;this._stopEventPropogation(e),t.handler.trigger("pgadmin-sqleditor:button:auto_rollback",t,t.handler)},on_explain:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.handler.history_query_source=te.EXPLAIN,A.explain(this.handler)},on_explain_analyze:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.handler.history_query_source=te.EXPLAIN_ANALYZE,A.explainAnalyze(this.handler)},on_explain_verbose:function(e){var t=this;this._stopEventPropogation(e),t.handler.trigger("pgadmin-sqleditor:button:explain-verbose",t,t.handler)},on_explain_costs:function(e){var t=this;this._stopEventPropogation(e),t.handler.trigger("pgadmin-sqleditor:button:explain-costs",t,t.handler)},on_explain_buffers:function(e){var t=this;this._stopEventPropogation(e),t.handler.trigger("pgadmin-sqleditor:button:explain-buffers",t,t.handler)},on_explain_timing:function(e){var t=this;this._stopEventPropogation(e),t.handler.trigger("pgadmin-sqleditor:button:explain-timing",t,t.handler)},on_explain_summary:function(e){var t=this;this._stopEventPropogation(e),t.handler.trigger("pgadmin-sqleditor:button:explain-summary",t,t.handler)},on_explain_settings:function(e){var t=this;this._stopEventPropogation(e),t.handler.trigger("pgadmin-sqleditor:button:explain-settings",t,t.handler)},do_not_close_menu:function(e){e.stopPropagation()},on_show_query_tool:function(e){var t=this;this._stopEventPropogation(e),this._closeDropDown(e),t.handler.trigger("pgadmin-sqleditor:button:show_query_tool",t,t.handler)},on_file_load:function(e){var t=this;this._stopEventPropogation(e),this._closeDropDown(e),t.handler.trigger("pgadmin-sqleditor:button:load_file",t,t.handler)},on_download:function(){A.download(this.handler)},keyAction:function(e){var t;t=M.processEventQueryTool(this.handler,A,e,this.docker),s.isNull(t)||s.isUndefined(t)||""==t||setTimeout((function(){W.Events.trigger("pgadmin:query_tool:".concat(t,":focus"))}),100)},on_commit_transaction:function(){this.handler.close_on_idle_transaction=!1,this.handler.history_query_source=te.COMMIT,A.executeCommit(this.handler)},on_rollback_transaction:function(){this.handler.close_on_idle_transaction=!1,this.handler.history_query_source=te.ROLLBACK,A.executeRollback(this.handler)},on_manage_macros:function(){var e=this;e.handler.trigger("pgadmin-sqleditor:button:manage_macros",e,e.handler)},on_execute_macro:function(e){var t=n(e.currentTarget).data("macro-id");this.handler.history_query_source=te.EXECUTE,A.executeMacro(this.handler,t)},set_selected_option:function(e){this.connection_list.forEach((function(t){t.server==e.server&&t.database==e.database&&t.user==e.user&&t.role==e.role?e.is_selected=!0:t.is_selected=!1}))},on_change_connection:function(t,a){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t.is_selected){var r=this;i?c.confirm(e("Change connection"),e("By changing the connection you will lose all your unsaved data for the current connection. <br> Do you want to continue?"),(function(){r.change_connection(t,a,!0)}),(function(){return n("#main_loader").addClass("d-none"),c.newConnectionDialog().destroy(),!0})).set("labels",{ok:e("Yes"),cancel:e("No")}):r.change_connection(t,a,!1)}},change_connection:function(e,a,i){var r=this,o=null;a?((o=n("#show_filter_progress")).removeClass("d-none"),o.find(".sql-editor-busy-text").text("Connecting to database...")):(o=n("#main_loader")).removeClass("d-none"),r.set_selected_option(e),n.ajax({url:t("datagrid.update_query_tool_connection",{trans_id:r.transId,sgid:e.server_group,sid:e.server,did:e.database}),method:"POST",contentType:"application/json",data:JSON.stringify(e)}).done((function(t){if(t.success){delete e.password,r.transId=t.data.tran_id,r.handler.transId=t.data.tran_id,r.handler.url_params={did:e.database,is_query_tool:r.handler.url_params.is_query_tool,server_type:r.handler.url_params.server_type,sgid:e.server_group,sid:e.server,title:e.title},r.set_editor_title(s.unescape(e.conn_title)),r.handler.setTitle(s.unescape(r.handler.url_params.title));var n=e.server_name+"/"+e.database_name+"- Database connected";if(c.success(n),a){var l={server_group:r.handler.url_params.sgid,server:e.server,database:e.database,user:e.user,title:e.title,conn_title:e.conn_title,role:e.role,is_allow_new_connection:!0,database_name:e.database_name,server_name:e.server_name,is_selected:!0};delete l.password,i&&r.connection_list.unshift(l),r.render_connection(r.connection_list),o.addClass("d-none"),c.newConnectionDialog().destroy(),c.connectServer().destroy()}else o.addClass("d-none"),c.connectServer().destroy()}return!0})).fail((function(t){if(428==t.status){var n=e;a&&(n={}),c.connectServer("Connect to server",t.responseJSON.result,e.server,!1,n)}else c.error(t.responseJSON.errormsg)}))}}),oe=function(){this.initialize.apply(this,arguments)},se=function(){($.default&&$.default.closed||$.default.pgAdmin&&$.default.pgAdmin.Browser&&$.default.pgAdmin.Browser.preference_version()<=0)&&c.alert().setting({title:e("Connection lost"),label:e("Close"),message:e("The pgAdmin browser window has been closed and the connection to the server is lost. Please close this window and open a new pgAdmin session."),onok:function(){window.close()}}).show()};return s.extend(oe.prototype,f.Events,{initialize:function(t){var a=this;this.container=t,this.state={},this.csrf_token=u.csrf_token,se(),L.modifyAlertifyAnimation(),c.dlgGetServerPass||c.dialog("dlgGetServerPass",(function(){return{main:function(e,t){this.set("title",e),this.setting("message",t)},setup:function(){return{buttons:[{text:e("OK"),key:13,className:"btn btn-primary"},{text:e("Cancel"),key:27,className:"btn btn-danger"}],focus:{element:"#password",select:!0},options:{modal:0,resizable:!1,maximizable:!1,pinnable:!1}}},build:function(){},settings:{message:null},prepare:function(){this.setContent(this.setting("message"))},callback:function(t){if(t.button.text==e("OK")){var i=n(this.elements.content).find("#frmPassword").serialize();a.init_connection(!1,i)}}}})),this.on("pgadmin-datagrid:transaction:created",(function(e){a.transId=e.gridTransId,a.warn_before_continue()})),W.Events.on("pgadmin:user:logged-in",(function(){a.initTransaction()}))},saveState:function(e,t){this.state=e?{fn:e,args:t}:{}},initTransaction:function(){var a,i=this;i.is_query_tool?(a="datagrid.initialize_query_tool",i.url_params.did&&(a="datagrid.initialize_query_tool_with_did")):a="datagrid.initialize_datagrid";var r=t(a,l(l({},i.url_params),{},{trans_id:i.transId}));n.ajax({url:r,type:"POST",data:i.is_query_tool?null:JSON.stringify(i.url_params.sql_filter),contentType:"application/json"}).done((function(e){W.Events.trigger("pgadmin:query_tool:connected:"+i.transId,e.data)})).fail((function(t,n,a){if(410===t.status){var r=i.browser_preferences.new_browser_tab_open;r&&r.includes("qt")?W.report_error(e("Error fetching rows - %s.",t.statusText),t.responseJSON.errormsg,void 0,window.close):W.report_error(e("Error fetching rows - %s.",t.statusText),t.responseJSON.errormsg,void 0,i.close.bind(i))}else{if(-1!==t.responseText.search("Ticket expired"))Q.fetch_ticket().then((function(){i.initTransaction()}),(function(e){W.Events.trigger("pgadmin:query_tool:connected_fail:"+i.transId,t,e)}));else W.Events.trigger("pgadmin:query_tool:connected_fail:"+i.transId,t,a)}}))},handle_connection_lost:function(e,t){void 0!==t.responseJSON&&t.responseJSON.data&&!t.responseJSON.data.conn_id||void 0!==t.data&&t.data.data&&!t.data.data.conn_id?this.init_connection(e):this.warn_before_continue()},handle_cryptkey_missing:function(){var e=this;W.set_master_password("",(function(){e.warn_before_continue()}))},warn_before_continue:function(){var t=this;c.confirm(e("Connection Warning"),'<p style="float:left"><span class="fa fa-exclamation-triangle warn-icon" aria-hidden="true" role="img"></span></p><p style="display: inline-block;"><span class="warn-header">'+e("The application has lost the database connection:")+'</span><br><span class="warn-body">'+e(" If the connection was idle it may have been forcibly disconnected.")+"<br>"+e(" The application server or database server may have been restarted.")+"<br>"+e(" The user session may have timed out.")+'</span><br><span class="warn-footer">'+e("Do you want to continue and establish a new session?")+"</span></p>",(function(){if("fn"in t.state){var e=t.state.fn,n=t.state.args;t.saveState(),-1==n.indexOf("connect")&&n.push("connect"),e in t?t[e].apply(t,n):console.warn("The callback is not valid for this context")}}),(function(){t.saveState()})).set({labels:{ok:e("Continue"),cancel:e("Cancel")}})},init_connection:function(a,i){var r=this;n.post(t("NODE-server.connect_id",{gid:this.url_params.sgid,sid:this.url_params.sid}),i).done((function(e){if(1==e.success)if(c.success(e.info),a)r.initTransaction();else if("fn"in r.state){var t=r.state.fn,n=r.state.args;r.saveState(),r[t].apply(r,n)}})).fail((function(t){var n=T.handleQueryToolAjaxError(u,r,t,null,[],!1);n&&c.dlgGetServerPass(e("Connect to Server"),n)}))},start:function(t,a,i,r){var o=this;if(o.is_query_tool="true"===a.is_query_tool,o.rows_affected=0,o.marked_line_no=0,o.has_more_rows=!1,o.fetching_rows=!1,o.close_on_save=!1,o.close_on_idle_transaction=!1,o.last_transaction_status=-1,o.server_type=a.server_type,o.url_params=a,o.is_transaction_buttons_disabled=!0,o.is_save_results_to_file_disabled=!0,!o.gridView){o.gridView=new re({el:o.container,handler:o,layout:i}),o.transId=o.gridView.transId=t,o.macros=o.gridView.macros=r,o.gridView.current_file=void 0,o.gridView.render();var l=o.gridView.data_output_panel.$container.find("#fetching_data"),d=l.find(".sql-editor-busy-text"),f=n(".sql-editor-busy-text-status");o.on("pgadmin-sqleditor:loading-icon:message",(function(e){d.text(e),f.text(e)})).on("pgadmin-sqleditor:loading-icon:show",(function(e){l.removeClass("d-none"),f.removeClass("d-none"),d.text(e),f.text(e)})).on("pgadmin-sqleditor:loading-icon:hide",(function(){l.addClass("d-none"),f.addClass("d-none")})),n("#main_loader").addClass("d-none"),o.trigger("pgadmin-sqleditor:loading-icon:hide"),o.gridView.set_editor_title("("+e("Obtaining connection...")+" ".concat(s.unescape(a.title)));var p=function(){(o.is_query_tool?["#btn-flash","#btn-explain","#btn-explain-analyze"]:["#btn-flash"]).forEach((function(e){n(e).prop("disabled",!1)})),n("#btn-conn-status i").removeClass("obtaining-conn");var e=$.default.pgAdmin.Browser.treeMenu.translateTreeNodeIdFromACITree($.default.pgAdmin.Browser.treeMenu.selected()),t=$.default.pgAdmin.Browser.treeMenu.findNode(e.slice(0,2)),i=$.default.pgAdmin.Browser.treeMenu.findNode(e.slice(0,4)),r=e.slice(0,3);r.push("database/"+a.did);var l=$.default.pgAdmin.Browser.treeMenu.findNode(r).data.label,d=z.getPanelTitle($.default.pgAdmin.Browser,null,null,null,!0,l);o.gridView.set_editor_title(s.unescape(d));var c={server_group:o.gridView.handler.url_params.sgid,server:o.gridView.handler.url_params.sid,database:o.gridView.handler.url_params.did,user:t.data.user.name,role:null,title:s.unescape(a.title),conn_title:s.unescape(d),is_allow_new_connection:!1,database_name:s.unescape(i.data.label),server_name:s.unescape(t.data.label),is_selected:!0};delete c.password,o.gridView.connection_list.unshift(c),o.gridView.render_connection(o.gridView.connection_list)};if(W.Events.on("pgadmin:query_tool:connected:"+t,p),W.Events.on("pgadmin:query_tool:connected_fail:"+t,p),W.Events.on("pgadmin:query_tool:connected:"+t,(function(e){o.gridView.set_server_version(e.serverVersion)})),W.Events.on("pgadmin:query_tool:connected_fail:"+t,(function(e,t){c.pgRespErrorNotify(e,t)})),o.initTransaction(),n(window).on("keydown",(function(e){0===n(".sql-editor").find(e.target).length&&e.target!=n("body.wcDesktop")[0]||!o.gridView.keyAction||o.gridView.keyAction(e)})),o.init_events(),o.is_query_tool){if(a.query_url)n.ajax({url:a.query_url,type:"GET"}).done((function(e){o.gridView.query_tool_obj.refresh(),e&&o.gridView.query_tool_obj.setValue(e)})).fail((function(t){if(T.handleQueryToolAjaxError(u,o,t,null,[],!1)){var n=o.browser_preferences.new_browser_tab_open;n&&n.includes("qt")?W.report_error(e("Error fetching SQL for script - %s.",t.statusText),t.responseJSON.errormsg,void 0,window.close):W.report_error(e("Error fetching SQL for script - %s.",t.statusText),t.responseJSON.errormsg,void 0,o.close.bind(o))}}));else if(a.sql_id){var h=localStorage.getItem(a.sql_id);localStorage.removeItem(a.sql_id),h&&o.gridView.query_tool_obj.setValue(h)}}else{o.gridView.query_tool_obj.setOption("readOnly",!0);var _=o.gridView.query_tool_obj.getWrapperElement();_&&(_.className+=" bg-gray-lighter opacity-5 hide-cursor-workaround"),o.disable_tool_buttons(!0),W.Events.on("pgadmin:query_tool:connected:"+t,(function(){o.check_data_changes_to_execute_query()}))}}},set_value_to_editor:function(e){this.gridView&&this.gridView.query_tool_obj&&!s.isUndefined(e)&&""!=e&&this.gridView.query_tool_obj.setValue(e)},init_events:function(){var e=this;u.Browser.Events.on("pgadmin-storage:finish_btn:select_file",e._select_file_handler,e),u.Browser.Events.on("pgadmin-storage:finish_btn:create_file",e._save_file_handler,e),e.is_query_tool&&e.gridView.query_tool_obj.on("change",e._on_query_change.bind(e)),e.on("pgadmin-sqleditor:button:load_file",e._load_file,e),e.on("pgadmin-sqleditor:button:save_file",e._save_file,e),e.on("pgadmin-sqleditor:button:deleterow",e._delete,e),e.on("pgadmin-sqleditor:button:show_filter",e._show_filter,e),e.on("pgadmin-sqleditor:button:show_new_connection",e._show_new_connection,e),e.on("pgadmin-sqleditor:button:include_filter",e._include_filter,e),e.on("pgadmin-sqleditor:button:exclude_filter",e._exclude_filter,e),e.on("pgadmin-sqleditor:button:remove_filter",e._remove_filter,e),e.on("pgadmin-sqleditor:button:copy_row",e._copy_row,e),e.on("pgadmin-sqleditor:button:copy_row_with_header",e._copy_row_with_header,e),e.on("pgadmin-sqleditor:button:paste_row",e._paste_row,e),e.on("pgadmin-sqleditor:button:limit",e._set_limit,e),e.on("pgadmin-sqleditor:button:cancel-query",e._cancel_query,e),e.on("pgadmin-sqleditor:button:auto_rollback",e._auto_rollback,e),e.on("pgadmin-sqleditor:button:auto_commit",e._auto_commit,e),e.on("pgadmin-sqleditor:button:explain-verbose",e._explain_verbose,e),e.on("pgadmin-sqleditor:button:explain-costs",e._explain_costs,e),e.on("pgadmin-sqleditor:button:explain-buffers",e._explain_buffers,e),e.on("pgadmin-sqleditor:button:explain-timing",e._explain_timing,e),e.on("pgadmin-sqleditor:button:explain-summary",e._explain_summary,e),e.on("pgadmin-sqleditor:button:explain-settings",e._explain_settings,e),e.on("pgadmin-sqleditor:button:show_query_tool",e._show_query_tool,e),e.on("pgadmin-sqleditor:indent_selected_code",e._indent_selected_code,e),e.on("pgadmin-sqleditor:unindent_selected_code",e._unindent_selected_code,e),e.on("pgadmin-sqleditor:format_sql",e._format_sql,e),e.on("pgadmin-sqleditor:button:manage_macros",e._manage_macros,e),e.on("pgadmin-sqleditor:button:execute_macro",e._execute_macro,e),window.parent.$(window.parent.document).on("pgadmin-sqleditor:rows-copied",e._copied_in_other_session)},check_data_changes_to_execute_query:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=this;s.has(i,"data_store")&&(s.size(i.data_store.added)||s.size(i.data_store.updated)||s.size(i.data_store.deleted))?c.confirm(e("Unsaved changes"),e("The data has been modified, but not saved. Are you sure you wish to discard the changes?"),(function(){void 0!==a?i._execute_macro_query(t,n,a):i.is_query_tool?i._execute_sql_query(t,n):i._execute_view_data_query()}),(function(){return!0})).set("labels",{ok:e("Yes"),cancel:e("No")}):void 0!==a?i._execute_macro_query(t,n,a):i.is_query_tool?i._execute_sql_query(t,n):i._execute_view_data_query()},_execute_view_data_query:function(){var a=this,i=t("sqleditor.view_data_start",{trans_id:a.transId});a.query_start_time=new Date,a.rows_affected=0,a._init_polling_flags(),a.has_more_rows=!1,a.fetching_rows=!1,a.trigger("pgadmin-sqleditor:loading-icon:show",e("Running query...")),n("#btn-flash").prop("disabled",!0),a.enable_disable_download_btn(!0),a.trigger("pgadmin-sqleditor:loading-icon:message",e("Waiting for the query to complete...")),arguments.length>0&&"connect"==arguments[arguments.length-1]&&(i+="?connect=1"),n.ajax({url:i,method:"GET"}).done((function(e){e.data.status?(a.can_edit=e.data.can_edit,a.can_filter=e.data.can_filter,a.info_notifier_timeout=e.data.info_notifier_timeout,a.gridView.query_tool_obj.setValue(e.data.sql),a.query=e.data.sql,a.can_filter&&e.data.filter_applied?(n("#btn-filter").removeClass("btn-secondary"),n("#btn-filter-dropdown").removeClass("btn-secondary"),n("#btn-filter").addClass("btn-primary"),n("#btn-filter-dropdown").addClass("btn-primary")):(n("#btn-filter").removeClass("btn-primary"),n("#btn-filter-dropdown").removeClass("btn-primary"),n("#btn-filter").addClass("btn-secondary"),n("#btn-filter-dropdown").addClass("btn-secondary")),n("#btn-copy-row").prop("disabled",!0),n("#btn-paste-row").prop("disabled",!0),n(".limit").val(e.data.limit),a._poll()):(a.trigger("pgadmin-sqleditor:loading-icon:hide"),a.update_msg_history(!1,e.data.result))})).fail((function(e){a.trigger("pgadmin-sqleditor:loading-icon:hide");var t=T.handleQueryToolAjaxError(u,a,e,"_execute_view_data_query",[],!0);t&&a.update_msg_history(!1,t)}))},_execute_macro_query:function(e,a,i){var r=this;r.has_more_rows=!1,r.fetching_rows=!1,n.ajax({url:t("sqleditor.get_macro",{macro_id:i,trans_id:r.transId}),method:"GET",contentType:"application/json",dataType:"json"}).done((function(t){if(t){var n=t.sql.replace(/\$SELECTION\$/gi,r.gridView.query_tool_obj.getSelection()),i=new E.ExecuteQuery(r,u.Browser.UserManagement);i.poll=W.override_activity_event_decorator(i.poll).bind(i),i.execute(n,e,a)}})).fail((function(){}))},_execute_sql_query:function(e,t){var n=this,a="";if(n.has_more_rows=!1,n.fetching_rows=!1,s.isUndefined(n.special_sql)){var i=n.gridView.query_tool_obj.getSelection();a=i.length>0?i:n.gridView.query_tool_obj.getValue()}else a=n.special_sql;var r=new E.ExecuteQuery(this,u.Browser.UserManagement);r.poll=W.override_activity_event_decorator(r.poll).bind(r),r.execute(a,e,t)},call_render_after_poll:function(e){V.callRenderAfterPoll(this,c,e)},_poll:function(){new E.ExecuteQuery(this,u.Browser.UserManagement).delayedPoll(this)},_render:function(t){var a=this;a.colinfo=t.colinfo,a.primary_keys=s.isEmpty(t.primary_keys)&&t.has_oids?t.oids:t.primary_keys,a.client_primary_key=t.client_primary_key,a.cell_selected=!1,a.selected_model=null,a.changedModels=[],a.has_oids=t.has_oids,a.oids=t.oids,n(".sql-editor-explain").html(ie),a.explain_plan=!1,null!==a.primary_keys&&void 0!==a.primary_keys&&0!==s.size(a.primary_keys)||0!=a.has_oids?a.can_edit=!0:a.can_edit=!1,a.can_filter&&(n(".limit").prop("disabled",!1),n(".limit").addClass("limit-enabled"),n("#btn-filter").prop("disabled",!1),n("#btn-filter-dropdown").prop("disabled",!1)),n("#btn-save-data").prop("disabled",!0),n("#btn-delete-row").prop("disabled",!0),a.can_edit||(n("#btn-delete-row").prop("disabled",!0),n("#btn-copy-row").prop("disabled",!0),n("#btn-paste-row").prop("disabled",!0)),a._fetch_column_metadata.call(a,t,function(){var i=this;i.trigger("pgadmin-sqleditor:loading-icon:message",e("Loading data from the database server and rendering..."),i),i.total_time=B.calculateQueryRunTime(i.query_start_time,i.query_end_time);var r=e("Successfully run. Total query runtime: %s.",i.total_time),o=e("%s rows affected.",i.rows_affected);i.info_notifier_timeout>=0&&c.success(r+" "+o,i.info_notifier_timeout);var l=r+"\n"+o;s.isNull(t.additional_messages)||s.isUndefined(t.additional_messages)||(l=t.additional_messages+"\n"+l),i.update_msg_history(!0,l,!1);var d=[],u=null;if(t.result&&!s.isEmpty(i.colinfo)&&"QUERY PLAN"==i.colinfo[0].name&&!s.isEmpty(t.types)&&t.types[0]&&"json"===t.types[0].typname&&(u=JSON.parse(t.result[0][0])),u&&u[0]&&u[0].hasOwnProperty("Plan")&&s.isObject(u[0].Plan)){var f=[JSON.stringify(u,null,2)];d.push(f),i.gridView.data_output_panel.focus(),setTimeout((function(){i.gridView.render_grid(d,i.columns,i.can_edit,i.client_primary_key,0),i.gridView.explain_panel.focus(),_.DrawJSONPlan(n(".sql-editor-explain"),u)}),10)}else i.gridView.data_output_panel.focus(),setTimeout((function(){i.gridView.render_grid(t.result,i.columns,i.can_edit,i.client_primary_key,t.rows_affected)}),10);i.trigger("pgadmin-sqleditor:loading-icon:hide"),!s.isUndefined(t)&&Array.isArray(t.result)&&t.result.length>0?a.enable_disable_download_btn(!1):a.enable_disable_download_btn(!0)}.bind(a))},_fetch_column_metadata:function(e,t){var n=e.colinfo,a=e.primary_keys,i=[],r=this,o=new Array;s.each(e.types,(function(e){o[e.oid]=[e.typname]})),s.each(n,(function(e){var t=!1,n=r.can_edit&&(!r.is_query_tool||e.is_editable);n&&s.size(a)>0&&s.each(a,(function(n,a){a===e.name&&(t=!0)}));var l,d,c="",u=o[e.type_code]?o[e.type_code][0]:o[o.length-1][0]?o[o.length-1][0]:"unknown";switch(c+=t?"[PK] "+u:u,e.precision&&e.precision>=0&&65535!=e.precision&&(c+=" ("+e.precision,c+=e.scale&&65535!=e.scale?","+e.scale+")":")"),u){case"oid":d="oid";break;case"json":case"json[]":case"jsonb":case"jsonb[]":d="Json";break;case"smallint":case"smallint[]":case"integer":case"integer[]":case"bigint":case"bigint[]":case"decimal":case"decimal[]":case"numeric":case"numeric[]":case"real":case"real[]":case"double precision":case"double precision[]":d="number";break;case"boolean":d="boolean";break;case"character":case"character[]":case'"char"':case'"char"[]':case"character varying":case"character varying[]":e.internal_size&&e.internal_size>=0&&65535!=e.internal_size&&(c+=" ("+e.internal_size+")"),d="string";break;case"bytea":case"bytea[]":d="binary";break;case"geometry":d="geometry";break;case"geography":d="geography";break;default:d="string"}l=e.display_name+"<br>"+c;var f=u.lastIndexOf("[]"),p={name:e.name,display_name:e.display_name,column_type:c,column_type_internal:u,pos:e.pos,label:l,cell:d,can_edit:"oid"!=e.name&&n,type:u,not_null:e.not_null,has_default_val:e.has_default_val,is_array:f>-1&&f+2==u.length};i.push(p)})),r.columns=i,t&&"function"==typeof t&&t()},resetQueryHistoryObject:function(e){e.total_time="-"},set_sql_message:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t?n(".sql-editor-message").append(e):n(".sql-editor-message").text(e),setTimeout((function(){n(".sql-editor-message").scrollTop(n(".sql-editor-message")[0].scrollHeight)}),10)},update_msg_history:function(t,a,i){var r=this;if(void 0===i&&(i=!0),r.gridView.messages_panel.focus(),i?(r.gridView.handler.slickgrid&&r.gridView.handler.slickgrid.destroy(),r.columns=void 0,r.collection=void 0,r.set_sql_message(a)):r.set_sql_message(s.escape(a),!0),"Busy"!=t){setTimeout((function(){n("#btn-flash").prop("disabled",!1)}),400),r.trigger("pgadmin-sqleditor:loading-icon:hide"),r.total_time||(r.total_time=B.calculateQueryRunTime(r.query_start_time,new Date)),s.isUndefined(r.history_query_source)&&(r.history_query_source=te.VIEW_DATA);var o={status:t,start_time:r.query_start_time,query:r.query,row_affected:r.rows_affected,total_time:r.total_time,message:a,query_source:r.history_query_source,is_pgadmin_query:!r.is_query_tool};if(!r.is_query_tool){var l=e('This query was generated by pgAdmin as part of a "View/Edit Data" operation');o.info=l}r.add_to_history(o)}},add_to_history:function(e){n.ajax({url:t("sqleditor.add_query_history",{trans_id:this.transId}),method:"POST",contentType:"application/json",data:JSON.stringify(e)}).done((function(){})).fail((function(){})),this.gridView.history_collection.add(e)},is_editable:function(e){return!(e instanceof f.Collection)&&this.get("can_edit")},enable_disable_download_btn:function(e){this.is_save_results_to_file_disabled=e,n("#btn-save-results-to-file").prop("disabled",e)},rows_to_delete:function(e){var t=this,n=t.primary_keys;t.temp_new_rows=[],e.forEach((function(e,a){var i=s.pick(e,s.keys(n));Object.keys(i).length>0||t.temp_new_rows.push(a)})),t.rows_to_disable=s.clone(t.temp_new_rows)},_delete:function(){var t=this,a=[],i=s.size(t.data_store.added),r=s.size(t.data_store.updated);if(i&&s.each(t.data_store.added,(function(e,n){n in t.data_store.staged_rows&&a.push(n)})),s.size(t.data_store.staged_rows)>0&&s.size(t.data_store.staged_rows)===s.size(a)){var o=t.slickgrid,l=o.getData();o.resetActiveCell(),l.beginUpdate();for(var d=0;d<a.length;d++)delete t.data_store.staged_rows[a[d]],delete t.data_store.added[a[d]],delete t.data_store.added_index[a[d]],l.deleteItem(a[d]);l.endUpdate(),t.rows_to_delete.apply(t,[l.getItems()]),o.resetActiveCell(),o.setSelectedRows([]),o.invalidate(),n("#btn-delete-row").prop("disabled",!0),n("#btn-copy-row").prop("disabled",!0),s.size(t.data_store.added)||r?n("#btn-save-data").prop("disabled",!1):n("#btn-save-data").prop("disabled",!0),c.success(e("Row(s) deleted."))}else{var u=!0;s.each(s.keys(t.data_store.staged_rows),(function(e){e in t.data_store.deleted&&(u=!1)})),u?(t.data_store.deleted=Object.assign({},t.data_store.deleted,t.data_store.staged_rows),n(t.gridView.grid.getCanvasNode()).find("div.selected").addClass("strikeout")):(n(t.gridView.grid.getCanvasNode()).find("div.selected").removeClass("strikeout"),s.each(s.keys(t.data_store.staged_rows),(function(e){e in t.data_store.deleted&&delete t.data_store.deleted[e]}))),s.size(t.data_store.added)||r||s.size(t.data_store.deleted)?n("#btn-save-data").prop("disabled",!1):n("#btn-save-data").prop("disabled",!0)}},_save_file:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.gridView.current_file;if(s.isUndefined(n)||e){var a={supported_types:["*","sql"],dialog_type:"create_file",dialog_title:"Save File",btn_primary:"Save"};u.FileManager.init(),u.FileManager.show_dialog(a)}else t._save_file_handler(n)},save_data:function(){var a=this;if(a.can_edit){var i=s.size(a.data_store.added),r=s.size(a.data_store.updated),o=s.size(a.data_store.deleted);if(i||r||o){a.trigger("pgadmin-sqleditor:loading-icon:show",e("Saving the updated data...")),a.is_query_tool&&a.disable_tool_buttons(!0,!0);var l=a.data_store,d=a.gridView;l.columns=d?d.handler.columns:a.columns;var f=!1,p=new Date;n.ajax({url:t("sqleditor.save",{trans_id:a.transId}),method:"POST",contentType:"application/json",data:JSON.stringify(l)}).done((function(t){var r=a.slickgrid,d=r.getData(),u=d.getLength(),h=[],_=t.data.transaction_status;a.last_transaction_status=_;var g=_>0;if(g?a.disable_transaction_buttons(!1):a.disable_transaction_buttons(!0),a.is_query_tool&&a.disable_tool_buttons(!1),t.data.status){n("#btn-save-data").prop("disabled",!0),f=!0;for(var m=1;m<=a.numberOfModifiedCells;m++)r.removeCellCssStyles(m);if(a.numberOfModifiedCells=0,i&&(d.beginUpdate(),s.each(t.data.query_results,(function(e){if(!s.isNull(e.row_added)){var t=Object.keys(e.row_added)[0];s.each(l.added_index,(function(n,a){if(n==t){var i=r.getDataItem(a);s.extend(i,e.row_added[t])}}))}})),d.endUpdate()),s.each(h,(function(e){e.is_row_copied&&delete e.is_row_copied})),r.copied_rows&&delete r.copied_rows,o){var b=s.keys(a.data_store.deleted);if(u==b.length)h=[],d.setItems(h,a.client_primary_key);else{d.beginUpdate();for(var v=0;v<b.length;v++){var y=r.getData().getItemById(b[v]);h.push(y),d.deleteItem(y[a.client_primary_key])}d.endUpdate()}a.rows_to_delete.apply(a,[h])}r.setSelectedRows([]),a.reset_data_store(),a.primary_keys_data={},a.set_sql_message(""),c.success(e("Data saved successfully.")),g&&c.info(e("Auto-commit is off. You still need to commit changes to the database."))}else{a.set_sql_message(t.data.result);var w=e("%s.",t.data.result);if(c.error(w,20),0!=_&&c.info(e("Saving data changes was rolled back but the current transaction is still active; previous queries are unaffected.")),r.setSelectedRows([]),s.has(t.data,"_rowid")&&(!s.isUndefined(t.data._rowid)||!s.isNull(t.data._rowid))){var x=a._find_rowindex(t.data._rowid);if(x in a.data_store.added_index){var C=a.handler.temp_new_rows.indexOf(t.data._rowid);C>-1&&a.handler.temp_new_rows.splice(C,1),a.data_store.added[a.data_store.added_index[x]].err=!0}else x in a.data_store.updated_index&&(a.data_store.updated[a.data_store.updated_index[x]].err=!0)}r.gotoCell(x,1)}var S=e('This query was generated by pgAdmin as part of a "Save Data" operation');s.each(t.data.query_results,(function(e){var t={status:e.status,start_time:p,query:e.sql,row_affected:e.rows_affected,total_time:null,message:e.result,query_source:te.SAVE_DATA,is_pgadmin_query:!0,info:S};a.add_to_history(t)})),a.trigger("pgadmin-sqleditor:loading-icon:hide"),r.invalidate(),a.close_on_save&&(f?a.check_needed_confirmations_before_closing_panel():a.close_on_save=!1)})).fail((function(e){var t=[d],n=T.handleQueryToolAjaxError(u,a,e,"save_data",t,!0);a.is_query_tool&&a.disable_tool_buttons(!1),n&&a.update_msg_history(!1,n)}))}}},reset_data_store:function(){this.data_store={updated:{},added:{},staged_rows:{},deleted:{},updated_index:{},added_index:{}}},_find_rowindex:function(e){var t,n=this.slickgrid.getData().getItems(),a=0,i=-1;if(s.isObject(e))t=e;else{if(!s.isString(e))return i;(e={})[this.client_primary_key]=e,t=e}return s.find(n,(function(e){var n=[];if(n.push(e),s.findWhere(n,t))return i=a,!0;a++})),i},_save_as:function(){return this._save_file(!0)},setTitle:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this,i=a.browser_preferences.new_browser_tab_open;i&&i.includes("qt")?window.document.title=e:s.each($.default.pgAdmin.Browser.docker.findPanels("frm_datagrid"),(function(i){i.isVisible()&&(n&&(i.is_dirty_editor=!0),z.setQueryToolDockerTitle(i,a.is_query_tool,e,t))}))},_load_file:function(){var t=this;t.is_query_changed?c.confirm(e("Unsaved changes"),e("Are you sure you wish to discard the current changes?"),(function(){t._open_select_file_manager()}),(function(){return!0})).set("labels",{ok:e("Yes"),cancel:e("No")}):t._open_select_file_manager()},_open_select_file_manager:function(){u.FileManager.init(),u.FileManager.show_dialog({supported_types:["*","sql"],dialog_type:"select_file"})},_select_file_handler:function(a){var i=this,r=a,o={file_name:decodeURI(a)};i.trigger("pgadmin-sqleditor:loading-icon:show",e("Loading the file..."));var s=n(".sql-editor-busy-fetching");s.addClass("show_progress"),n.ajax({url:t("sqleditor.load_file"),method:"POST",contentType:"application/json",data:JSON.stringify(o)}).done((function(e){i.gridView.query_tool_obj.setValue(e),i.gridView.current_file=a,i.gridView.query_tool_obj.file_data=e,i.setTitle(i.gridView.current_file.split("\\").pop().split("/").pop(),!0),i.trigger("pgadmin-sqleditor:loading-icon:hide"),s.removeClass("show_progress"),n("#btn-save-file").prop("disabled",!0),n("#btn-file-menu-save").css("display","none"),i.is_query_changed=!1,setTimeout((function(){i.gridView.query_tool_obj.focus()}),200)})).fail((function(e){i.trigger("pgadmin-sqleditor:loading-icon:hide");var t=[r],n=T.handleQueryToolAjaxError(u,i,e,"_select_file_handler",t,!1);n&&c.error(n),s.removeClass("show_progress")}))},_save_file_handler:function(a){var i=this,r=a,o={file_name:decodeURI(a),file_content:i.gridView.query_tool_obj.getValue()},s=i.gridView.query_tool_obj.getValue();i.trigger("pgadmin-sqleditor:loading-icon:show",e("Saving the queries in the file...")),n.ajax({url:t("sqleditor.save_file"),method:"POST",contentType:"application/json",data:JSON.stringify(o)}).done((function(t){t.data.status&&(c.success(e("File saved successfully.")),i.gridView.current_file=a,i.setTitle(i.gridView.current_file.replace(/^.*[\\\/]/g,""),!0),i.gridView.query_tool_obj.file_data=s,n("#btn-save-file").prop("disabled",!0),n("#btn-file-menu-save").css("display","none"),i.is_query_changed=!1,setTimeout((function(){i.gridView.query_tool_obj.focus()}),200)),i.trigger("pgadmin-sqleditor:loading-icon:hide"),i.close_on_save&&i.check_needed_confirmations_before_closing_panel()})).fail((function(e){i.trigger("pgadmin-sqleditor:loading-icon:hide");var t=[r],n=T.handleQueryToolAjaxError(u,i,e,"_save_file_handler",t,!1);n&&c.error(n)}))},_on_query_change:function(){var e=this;if(e.is_query_changed)e.gridView.current_file&&(e.gridView.query_tool_obj.file_data==e.gridView.query_tool_obj.getValue()?(t=e.gridView.current_file.replace(/^.*[\\\/]/g,""),i=!1):(t=e.gridView.current_file.replace(/^.*[\\\/]/g,"")+" *",i=!0),e.setTitle(t,!0,i));else{if(e.is_query_changed=!0,e.gridView.current_file){var t=e.gridView.current_file.replace(/^.*[\\\/]/g,"")+" *";e.setTitle(t,!0)}else{var a=e.browser_preferences.new_browser_tab_open,i=!1;a&&a.includes("qt")?t=window.document.title+" *":(s.each($.default.pgAdmin.Browser.docker.findPanels("frm_datagrid"),(function(t){t.isVisible()&&(e.gridView.panel_title=n(t._title).text())})),t=e.gridView.panel_title+" *",i=!0),e.setTitle(t,!1,i)}n("#btn-save-file").prop("disabled",!1),n("#btn-file-menu-save").css("display","block"),n("#btn-file-menu-dropdown").prop("disabled",!1)}},_init_polling_flags:function(){var e=this;e.POLL_FALLBACK_TIME=function(){var t=parseInt((Date.now()-e.query_start_time.getTime())/1e3);return t>=10&&t<30?500:t>=30&&t<60?1e3:t>=60&&t<90?2e3:t>=90?5e3:1}},_show_filter:function(){var e=this,t=!1;arguments.length>0&&"connect"==arguments[arguments.length-1]&&(t=!0),O.dialog(e,t)},_show_new_connection:function(){var e=this,t=!1;arguments.length>0&&"connect"==arguments[arguments.length-1]&&(t=!0),P.dialog(e,t,e.browser_preferences)},_include_filter:function(){var a,i,r,o,l=this,d={};i=(a=l.slickgrid).getActiveCell(),s.isNull(i)||s.isUndefined(i)||(r=a.getColumns()[i.cell],o=a.getDataItem(i.row,i.cell),s.isNull(o)||s.isUndefined(o)||(d[r.field]=s.isUndefined(o[r.field])?"":o[r.field],l.trigger("pgadmin-sqleditor:loading-icon:show",e("Applying the new filter...")),n.ajax({url:t("sqleditor.inclusive_filter",{trans_id:l.transId}),method:"POST",contentType:"application/json",data:JSON.stringify(d)}).done((function(t){l.trigger("pgadmin-sqleditor:loading-icon:hide"),setTimeout((function(){t.data.status?A.executeQuery(l):c.alert(e("Filter By Selection Error"),t.data.result)}))})).fail((function(t){l.trigger("pgadmin-sqleditor:loading-icon:hide");var n=T.handleQueryToolAjaxError(u,l,t,"_include_filter",[],!0);n&&c.alert(e("Filter By Selection Error"),n)}))))},_exclude_filter:function(){var a,i,r,o,l=this,d={};i=(a=l.slickgrid).getActiveCell(),s.isNull(i)||s.isUndefined(i)||(r=a.getColumns()[i.cell],o=a.getDataItem(i.row,i.cell),s.isNull(o)||s.isUndefined(o)||(d[r.field]=s.isUndefined(o[r.field])?"":o[r.field],l.trigger("pgadmin-sqleditor:loading-icon:show",e("Applying the new filter...")),n.ajax({url:t("sqleditor.exclusive_filter",{trans_id:l.transId}),method:"POST",contentType:"application/json",data:JSON.stringify(d)}).done((function(t){l.trigger("pgadmin-sqleditor:loading-icon:hide"),setTimeout((function(){t.data.status?A.executeQuery(l):c.alert(e("Filter Exclude Selection Error"),t.data.result)}),10)})).fail((function(t){l.trigger("pgadmin-sqleditor:loading-icon:hide");var n=T.handleQueryToolAjaxError(u,l,t,"_exclude_filter",[],!0);n&&c.alert(e("Filter Exclude Selection Error"),n)}))))},_remove_filter:function(){var a=this;a.trigger("pgadmin-sqleditor:loading-icon:show",e("Removing the filter...")),n.ajax({url:t("sqleditor.remove_filter",{trans_id:a.transId}),method:"POST"}).done((function(t){a.trigger("pgadmin-sqleditor:loading-icon:hide"),setTimeout((function(){t.data.status?A.executeQuery(a):c.alert(e("Remove Filter Error"),t.data.result)}))})).fail((function(t){a.trigger("pgadmin-sqleditor:loading-icon:hide");var n=T.handleQueryToolAjaxError(u,a,t,"_remove_filter",[],!0);n&&c.alert(e("Remove Filter Error"),n)}))},_copy_row:y,_copy_row_with_header:function(){n(".copy-with-header").toggleClass("visibility-hidden")},_copied_in_other_session:function(e,t){u.SqlEditor.copiedInOtherSessionWithHeaders=t,n("#btn-paste-row").prop("disabled",!1)},_paste_row:function(){var e=this,t=v.getTextFromClipboard(),a=h.CSVToArray(t,e.preferences.results_grid_field_separator,e.preferences.results_grid_quote_char);u.SqlEditor.copiedInOtherSessionWithHeaders&&(a=a.slice(1));var i=0;if((a=a.reduce((function(t,n){var a={};for(var r in e.columns){var o=n[r];""===o&&(o=e.columns[r].has_default_val?void 0:null===e.copied_rows[i][e.columns[r].display_name]?null:""),"boolean"===e.columns[r].cell&&(o="true"==o||"false"!=o&&null),a[e.columns[r].name]=o}return t.push(a),i++,t}),[])).length>0){n("#btn-save-data").prop("disabled",!1);var r=e.slickgrid,o=r.getData(),l=o.getLength(),d=[];for(var c in e.columns)e.columns[c].is_array&&d.push(e.columns[c].name);o.beginUpdate(),s.each(a,(function(t){var n,a,i=(n=t,a={},s.each(n,(function(e,t){void 0!==n[t]&&(s.isObject(n[t])&&-1==d.indexOf(t)?a[String(t)]=JSON.stringify(n[t]):a[String(t)]=n[t])})),a),r=(e.gridView.client_primary_key_counter++).toString();i.is_row_copied=!0,e.temp_new_rows.push(l),i[e.client_primary_key]=r,e.has_oids&&i.oid&&(i.oid=null),o.addItem(i),e.data_store.added[r]={err:!1,data:i},e.data_store.added_index[l]=r,l++})),o.endUpdate(),r.invalidateRow(r.getSelectedRows()),r.updateRowCount(),r.render(),r.scrollRowIntoView(o.getLength()),r.setSelectedRows([])}},_set_limit:function(){var a=this,i=parseInt(n(".limit").val());a.trigger("pgadmin-sqleditor:loading-icon:show",e("Setting the limit on the result...")),n.ajax({url:t("sqleditor.set_limit",{trans_id:a.transId}),method:"POST",contentType:"application/json",data:JSON.stringify(i)}).done((function(t){a.trigger("pgadmin-sqleditor:loading-icon:hide"),setTimeout((function(){t.data.status?A.executeQuery(a):c.alert(e("Change limit Error"),t.data.result)}),10)})).fail((function(t){a.trigger("pgadmin-sqleditor:loading-icon:hide");var n=T.handleQueryToolAjaxError(u,a,t,"_set_limit",[],!0);n&&c.alert(e("Change limit Error"),n)}))},disable_tool_buttons:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=e;this.is_query_tool||(a=!0),n("#btn-explain").prop("disabled",a),n("#btn-explain-analyze").prop("disabled",a),n("#btn-explain-options-dropdown").prop("disabled",a),n("#btn-edit-dropdown").prop("disabled",a),n("#btn-load-file").prop("disabled",a),this.gridView.current_file?this.gridView.query_tool_obj.file_data!=this.gridView.query_tool_obj.getValue()&&n("#btn-save-file").prop("disabled",a):n("#btn-save-file").prop("disabled",a),n("#btn-file-menu-dropdown").prop("disabled",a),n("#btn-find").prop("disabled",a),n("#btn-find-menu-dropdown").prop("disabled",a),n("#btn-macro-dropdown").prop("disabled",a),this.is_query_tool?(null!==t?n("#btn-cancel-query").prop("disabled",t):n("#btn-cancel-query").prop("disabled",!e),this.is_transaction_buttons_disabled?n("#btn-query-dropdown").prop("disabled",e):n("#btn-query-dropdown").prop("disabled",!0)):n("#btn-query-dropdown").prop("disabled",a)},disable_transaction_buttons:function(e){this.is_transaction_buttons_disabled=e,this.is_query_tool&&(n("#btn-commit").prop("disabled",e),n("#btn-rollback").prop("disabled",e))},_highlight_error:function(e){var t=this,n=0,a=0,i=0,r=0;t.gridView.query_tool_obj.removeLineClass(t.marked_line_no,"wrap","CodeMirror-activeline-background"),t.gridView.query_tool_obj.getSelection().length>0&&(r=t.gridView.query_tool_obj.getCursor(!0).line);var o=/LINE (\d+)/.exec(e),l=/Character: (\d+)/.exec(e);if(null!=o&&null!=l){n=t.marked_line_no=parseInt(o[1])-1+r;for(var d=parseInt(l[1])-1,c=0,u=r>0?r:0;u<n;u++)c+=t.gridView.query_tool_obj.getLine(u).length+1;a=d-c;var f=t.gridView.query_tool_obj.getLine(n);if(s.isUndefined(f))return;(i=f.indexOf(" ",a))<0&&(i=f.length),t.gridView.marker=t.gridView.query_tool_obj.markText({line:n,ch:a},{line:n,ch:i},{className:"sql-editor-mark"}),t.gridView.query_tool_obj.addLineClass(t.marked_line_no,"wrap","CodeMirror-activeline-background")}},_cancel_query:function(){var a=this;n.ajax({url:t("sqleditor.cancel_transaction",{trans_id:a.transId}),method:"POST",contentType:"application/json"}).done((function(t){t.data.status||c.alert(e("Cancel Query Error"),t.data.result),a.disable_tool_buttons(!1),ne=!1,s.isUndefined(a.download_results_obj)||(a.download_results_obj.abort(),n("#btn-flash").prop("disabled",!1),a.trigger("pgadmin-sqleditor:loading-icon:hide")),setTimeout((function(){a.gridView.query_tool_obj.focus()}),200)})).fail((function(t){a.disable_tool_buttons(!1);var n=T.handleQueryToolAjaxError(u,a,t,"_cancel_query",[],!1);n&&c.alert(e("Cancel Query Error"),n)}))},trigger_csv_download:function(a){var i=this,r=t("sqleditor.query_tool_download",{trans_id:i.transId}),o={filename:a};n("#btn-flash").prop("disabled",!0),i.enable_disable_download_btn(!0),i.disable_tool_buttons(!0),i.set_sql_message(""),i.trigger("pgadmin-sqleditor:loading-icon:show",e("Downloading Results...")),i.download_results_obj=n.ajax({type:"POST",url:r,data:o,cache:!1}).done((function(e){if(s.isUndefined(e.data)){var t=new Blob([e],{type:"text/csv"}),r=(window.URL||window.webkitURL).createObjectURL(t),o=u.Browser.get_browser(),l=document.createElement("a");document.body.appendChild(l),"IE"===o.name&&window.navigator.msSaveBlob?window.navigator.msSaveBlob(t,a):(l.setAttribute("href",r),l.setAttribute("download",a),l.click()),document.body.removeChild(l),i.download_results_obj=void 0}else e.status||(i._highlight_error(e.data.result),i.set_sql_message(e.data.result));n("#btn-flash").prop("disabled",!1),i.enable_disable_download_btn(!1),i.disable_tool_buttons(!1),i.trigger("pgadmin-sqleditor:loading-icon:hide")})).fail((function(t){var a="";n("#btn-flash").prop("disabled",!1),i.enable_disable_download_btn(!1),i.disable_tool_buttons(!1),i.trigger("pgadmin-sqleditor:loading-icon:hide"),(a="abort"==t.statusText?e("CSV Download cancelled."):T.handleQueryToolAjaxError(u,i,t,"trigger_csv_download",[],!0))&&c.alert(e("Download CSV error"),a)}))},call_cache_preferences:function(){$.default.pgAdmin.Browser.cache_preferences("sqleditor"),W.preference_version(W.generate_preference_version())},_auto_rollback:function(){var a=this,i=!0;!0===n(".auto-rollback").hasClass("visibility-hidden")?n(".auto-rollback").removeClass("visibility-hidden"):(n(".auto-rollback").addClass("visibility-hidden"),i=!1),n.ajax({url:t("sqleditor.auto_rollback",{trans_id:a.transId}),method:"POST",contentType:"application/json",data:JSON.stringify(i)}).done((function(t){t.data.status||c.alert(e("Auto Rollback Error"),t.data.result)})).fail((function(t){var n=T.handleQueryToolAjaxError(u,a,t,"_auto_rollback",[],!0);n&&c.alert(e("Auto Rollback Error"),n)}))},_auto_commit:function(){var a=this,i=!0;!0===n(".auto-commit").hasClass("visibility-hidden")?n(".auto-commit").removeClass("visibility-hidden"):(n(".auto-commit").addClass("visibility-hidden"),i=!1),n.ajax({url:t("sqleditor.auto_commit",{trans_id:a.transId}),method:"POST",contentType:"application/json",data:JSON.stringify(i)}).done((function(t){t.data.status||c.alert(e("Auto Commit Error"),t.data.result)})).fail((function(t){var n=T.handleQueryToolAjaxError(u,a,t,"_auto_commit",[],!0);n&&c.alert(e("Auto Commit Error"),n)}))},_toggle_explain_option:function(e){var t=".explain-".concat(e);n(t).toggleClass("visibility-hidden")},_explain_verbose:function(){this._toggle_explain_option("verbose")},_explain_costs:function(){this._toggle_explain_option("costs")},_explain_buffers:function(){this._toggle_explain_option("buffers")},_explain_timing:function(){this._toggle_explain_option("timing")},_explain_summary:function(){this._toggle_explain_option("summary")},_explain_settings:function(){this._toggle_explain_option("settings")},_show_query_tool:function(){var e=this.browser_preferences.new_browser_tab_open;e&&e.includes("qt")&&se(),this._open_query_tool(this)},_open_query_tool:function(e){var n=h.getRandomInt(1,9999999),a=t("datagrid.panel",{trans_id:n});a+="?is_query_tool=".concat(!0)+"&sgid=".concat(e.url_params.sgid)+"&sid=".concat(e.url_params.sid)+"&server_type=".concat(e.url_params.server_type),e.url_params.did&&(a+="&did=".concat(e.url_params.did));var i=e.url_params.title;if("false"==e.url_params.is_query_tool){var o=e.url_params.title.split("/");o.length>2&&(i=o[o.length-2]+"/"+o[o.length-1])}(0,r.launchDataGrid)($.default.pgAdmin.DataGrid,n,a,i,"",c)},_indent_selected_code:function(){this.gridView.query_tool_obj.execCommand("indentMore")},_unindent_selected_code:function(){this.gridView.query_tool_obj.execCommand("indentLess")},_format_sql:function(){var e=this.gridView.query_tool_obj,a=!0,i="";""==(i=e.getSelection())&&(i=e.getValue(),a=!1),n.ajax({url:t("sql.format"),data:JSON.stringify({sql:i}),method:"POST",contentType:"application/json",dataType:"json"}).done((function(t){!0===a?e.replaceSelection(t.data.sql,"around"):e.setValue(t.data.sql)})).fail((function(){}))},_manage_macros:function(){G.dialog(this)},_execute_macro:function(){A.executeMacro(this.handler)},isQueryRunning:function(){return ne},setIsQueryRunning:function(e){ne=e},check_needed_confirmations_before_closing_panel:function(){var t,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=this;a.ignore_on_close&&!n||(a.ignore_on_close={unsaved_data:!1,unsaved_query:!1});var i=a.ignore_on_close.unsaved_data,r=a.ignore_on_close.unsaved_query;if(!i&&a.can_edit&&a.preferences.prompt_save_data_changes&&a.data_store&&(s.size(a.data_store.added)||s.size(a.data_store.updated)||s.size(a.data_store.deleted)))t=e("The data has changed. Do you want to save changes?"),a.unsaved_changes_user_confirmation(t,!0);else if(!r&&a.is_query_tool&&a.is_query_changed&&a.preferences.prompt_save_query_changes)t=e("The query text has changed. Do you want to save changes?"),a.unsaved_changes_user_confirmation(t,!1);else if(!a.preferences.prompt_commit_transaction||a.last_transaction_status!==H.TRANSACTION_STATUS_INTRANS&&a.last_transaction_status!==H.TRANSACTION_STATUS_INERROR)a.ignore_on_close=void 0,a.close();else{var o=a.last_transaction_status==H.TRANSACTION_STATUS_INERROR;a.uncommitted_transaction_user_confirmation(o)}return!1},uncommitted_transaction_user_confirmation:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this;c.confirmCommit||c.dialog("confirmCommit",(function(){return{main:function(e,t,n){this.is_commit_disabled=n,this.setHeader(e),this.setContent(t)},setup:function(){return{buttons:[{text:e("Cancel"),key:27,invokeOnClose:!0,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button"},{text:e("Rollback"),className:"btn btn-primary fa fa-lg pg-alertify-button"},{text:e("Commit"),className:"btn btn-primary fa fa-lg pg-alertify-button"}],focus:{element:0,select:!1},options:{maximizable:!1,resizable:!1}}},prepare:function(){this.is_commit_disabled?this.__internal.buttons[2].element.disabled=!0:this.__internal.buttons[2].element.disabled=!1},callback:function(e){switch(e.index){case 0:break;case 1:n.close_on_idle_transaction=!0,A.executeRollback(n);break;case 2:n.close_on_idle_transaction=!0,A.executeCommit(n)}}}}));var a=e("The current transaction is not commited to the database. Do you want to commit or rollback the transaction?");c.confirmCommit(e("Commit transaction?"),a,t)},unsaved_changes_user_confirmation:function(a,i){var r=this;c.confirmSave||c.dialog("confirmSave",(function(){return{main:function(e,t,n){this.is_unsaved_data=n,this.setHeader(e),this.setContent(t)},setup:function(){return{buttons:[{text:e("Cancel"),key:27,invokeOnClose:!0,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button"},{text:e("Don't save"),className:"btn btn-secondary fa fa-lg fa-trash-alt pg-alertify-button"},{text:e("Save"),className:"btn btn-primary fa fa-lg fa-save pg-alertify-button"}],focus:{element:0,select:!1},options:{maximizable:!1,resizable:!1}}},callback:function(a){switch(a.index){case 0:break;case 1:r.close_on_save=!1,r.is_unsaved_data=this.is_unsaved_data,n.ajax({url:t("sqleditor._check_server_connection_status",{sid:r.url_params.sid,sgid:r.url_params.sgid}),headers:{"Cache-Control":"no-cache"}}).done((function(t){t.data.result.server?(a.cancel=!0,r.is_unsaved_data?r.ignore_on_close.unsaved_data=!0:r.ignore_on_close.unsaved_query=!0,r.check_needed_confirmations_before_closing_panel()||(a.cancel=!0)):c.confirm(e("Warning"),e("The current transaction has been rolled back because the server was disconnected."),(function(){setTimeout((function(){r.close()}),200)}),(function(){return!0})).set("labels",{ok:e("OK")})})).fail((function(){}));break;case 2:r.close_on_save=!0,this.is_unsaved_data?r.save_data():r._save_file()}}}})),c.confirmSave(e("Save changes?"),a,i)},close:function(){var e=this;W.Events.off("pgadmin:user:logged-in",this.initTransaction),window.onbeforeunload=null,e.gridView.currentPanel.off(J.EVENT.CLOSING),s.isUndefined(e.col_size)||delete e.col_size,$.default.pgAdmin.Browser.docker.removePanel(e.gridView.currentPanel)},update_notifications:function(e){R.updateNotifications(e)},set_title_and_render_connection:function(e,t){var n=this;n.gridView.set_editor_title(s.unescape(e)),n.gridView.handler.setTitle(s.unescape(e)),n.gridView.connection_list.forEach((function(a){if(t==a.database_name)return a.database_name=t,a.title=e,"is_selected"in a&&a.is_selected&&n.gridView.$el.find("ul#connections-list li.selected-connection > a").text(e),!0}))},check_db_name_change:function(e){var t=this,n=$.default.pgAdmin.Browser.treeMenu.selected(),a=$.default.pgAdmin.Browser.treeMenu.translateTreeNodeIdFromACITree(n),i=$.default.pgAdmin.Browser.treeMenu.findNode(a.slice(0,2)),r=$.default.pgAdmin.Browser.treeMenu.findNode(a.slice(0,4)),l=r.data.label,d=r.data._id;if(e.data_obj.db_id==d&&!s.isEqual(l,e.data_obj.db_name)){var c="Current database has been moved or renamed to ".concat(e.data_obj.db_name,". Click on the OK button to refresh the database name."),u=t.url_params.title;if(t.is_query_tool){var f=t.gridView.browser_preferences.qt_tab_title_placeholder,p={database:e.data_obj.db_name,username:i.data.user.name,server:i.data.label,type:"query_tool"};u=z.generateTitle(f,p)}else u=(0,o.generateDatagridTitle)($.default.pgAdmin.Browser,n,null,e.data_obj);z.refresh_db_node(c,r.domNode),t.set_title_and_render_connection(u,r.data.label)}}}),u.SqlEditor={create:function(e){return new oe(e)},jquery:n},u.SqlEditor}.apply(t,a))||(e.exports=i)},90491:(e,t,n)=>{var a,i;function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var a,i,r=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(r.push(a.value),!t||r.length!==t);o=!0);}catch(e){s=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return r}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}n(47042),n(91038),n(78783),n(82526),n(41817),n(32165),n(79753),n(26699),n(32023),n(32564),n(68309),n(82772),n(83710),n(41539),n(39714),n(74916),n(15306),n(24812),n(5735),n(83753),n(69600),n(69826),n(66992),n(33948),a=[n(91669),n(28008),n(19755),n(81311),n(55455),n(58894),n(72316),n(83879),n(95283),n(88941),n(12030),n(6537),n(44092),n(92026),n(14753),n(63790)],void 0===(i=function(e,t,n,a,i,s,l,d,c,u,f,p,h,_){if(s.UserManagement)return s.UserManagement;var g=t("user_management.users"),m=t("user_management.roles"),b=t("user_management.auth_sources"),v=_.INTERNAL,y=_.LDAP,w=_.KERBEROS,x=_.OAUTH2,C=!(1!=p.auth_sources.length||!p.auth_sources.includes(v)),S=d.Extension.PasswordDepCell=d.Extension.PasswordCell.extend({initialize:function(){d.Extension.PasswordCell.prototype.initialize.apply(this,arguments),d.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){this.$el.empty(),this.render();var e=this.model,t=this.column,n=this.column.get("editable");return(a.isFunction(n)?!!n.apply(t,[e]):!!n)?this.$el.addClass("editable"):this.$el.removeClass("editable"),this.delegateEvents(),this},render:function(){d.NumberCell.prototype.render.apply(this,arguments);var e=this.model,t=this.column,n=this.column.get("editable"),i=a.isFunction(n)?!!n.apply(t,[e]):!!n;return i?this.$el.addClass("editable"):this.$el.removeClass("editable"),this},remove:d.Extension.DependentCell.prototype.remove});return s.UserManagement={init:function(){if(!this.initialized)return this.initialized=!0,this},change_password:function(n){var a=e("Change Password");i.ChangePassword||i.dialog("ChangePassword",(function(){return{main:function(e,t){this.set({title:e,url:t})},build:function(){i.pgDialogBuild.apply(this)},settings:{url:void 0},setup:function(){return{buttons:[{text:"",key:112,className:"btn btn-primary-icon pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:e("Change Password"),url:t("help.static",{filename:"change_user_password.html"})}},{text:e("Close"),key:27,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button",attrs:{name:"close",type:"button"}}],options:{padding:!1,overflow:!1,modal:!1,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1,closable:!1}}},hooks:{onclose:function(){return setTimeout((function(){return i.ChangePassword().destroy()}),500)}},prepare:function(){var e=document.createElement("iframe");e.frameBorder="no",e.width="100%",e.height="100%",e.src=this.setting("url"),this.elements.content.appendChild(e)},callback:function(e){if("dialog_help"==e.button.element.name)return e.cancel=!0,void s.showHelp(e.button.element.name,e.button.element.getAttribute("url"),null,null)}}})),i.ChangePassword(a,n).resizeTo(s.stdW.lg,s.stdH.md)},isPgaLoginRequired:function(e){return void 0===e.responseJSON&&void 0!==e.data?401===e.status&&e.data&&e.data.info&&"PGADMIN_LOGIN_REQUIRED"===e.data.info:401===e.status&&e.responseJSON&&e.responseJSON.info&&"PGADMIN_LOGIN_REQUIRED"===e.responseJSON.info},pgaLogin:function(n){var a=e("pgAdmin 4 login");n=n||t("security.login"),i.PgaLogin||i.dialog("PgaLogin",(function(){return{main:function(e,t){this.set({title:e,url:t})},build:function(){i.pgDialogBuild.apply(this)},settings:{url:void 0},setup:function(){return{buttons:[{text:e("Close"),key:27,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button",attrs:{name:"close",type:"button"}}],options:{padding:!1,overflow:!1,modal:!0,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1,closable:!1}}},hooks:{onclose:function(){return setTimeout((function(){return i.PgaLogin().destroy()}))}},prepare:function(){var e=this,t=document.createElement("iframe"),n=this.setting("url");t.onload=function(){-1==(this.contentDocument||this.contentWindow.document).location.href.indexOf(n)&&(this.contentWindow.stop(),this.onload=null,e.close(),s.Events.trigger("pgadmin:user:logged-in"))},t.frameBorder="no",t.width="100%",t.height="100%",t.src=n,e.elements.content.appendChild(t)}}})),i.PgaLogin(a,n).resizeTo(s.stdW.md,s.stdH.md)},show_users:function(){if(p.is_admin){var u=[],_=[],k=s.Node.Model.extend({idAttribute:"id",urlRoot:g,defaults:{id:void 0,username:void 0,email:void 0,active:!0,role:"2",newPassword:void 0,confirmPassword:void 0,auth_source:v,authOnlyInternal:C},schema:[{id:"auth_source",label:e("Authentication source"),type:"text",control:"Select2",url:t("user_management.auth_sources"),cellHeaderClasses:"width_percent_30",visible:function(e){return!e.get("authOnlyInternal")},disabled:!1,cell:"Select2",select2:{allowClear:!1,openOnEnter:!1,first_empty:!1},options:function(){return _},editable:function(e){return e instanceof l.Collection||e.isNew()&&!e.get("authOnlyInternal")}},{id:"username",label:e("Username"),type:"text",cell:d.Extension.StringDepCell,cellHeaderClasses:"width_percent_30",deps:["auth_source"],editable:function(e){return!e.get("authOnlyInternal")&&e.get("auth_source")!=v||(e.isNew()&&null!=e.get("username")&&""!=e.get("username")&&setTimeout((function(){e.set("username",void 0)}),10),!1)},disabled:!1},{id:"email",label:e("Email"),type:"text",cell:d.Extension.StringDepCell,cellHeaderClasses:"width_percent_30",deps:["id"],editable:function(e){return!e.get("authOnlyInternal")||!(e instanceof l.Collection)&&!!e.isNew()}},{id:"role",label:e("Role"),type:"text",control:"Select2",cellHeaderClasses:"width_percent_20",cell:"select2",select2:{allowClear:!1,openOnEnter:!1,first_empty:!1},options:function(e){var t=[];return e instanceof c.Control?a.each(u,(function(e){t.push({label:e.name,value:e.id.toString()})})):a.each(u,(function(e){t.push([e.name,e.id.toString()])})),t},editable:function(e){return e instanceof l.Collection||e.get("id")!=p.id}},{id:"active",label:e("Active"),type:"switch",cell:"switch",cellHeaderClasses:"width_percent_10",sortable:!1,editable:function(e){return e instanceof l.Collection||e.get("id")!=p.id}},{id:"newPassword",label:e("New password"),type:"password",disabled:!1,control:"input",cell:S,cellHeaderClasses:"width_percent_20",deps:["auth_source"],sortable:!1,editable:function(e){return e.get("auth_source")==v}},{id:"confirmPassword",label:e("Confirm password"),type:"password",disabled:!1,control:"input",cell:S,cellHeaderClasses:"width_percent_20",deps:["auth_source"],sortable:!1,editable:function(e){return e.get("auth_source")==v}},{id:"locked",label:e("Locked"),type:"switch",cell:"switch",disabled:!1,sortable:!1,editable:function(e){return e.get("id")!=p.id}}],validate:function(){var t=null,n=this.changed||{};if(this.get("auth_source")==v&&("email"in n||!this.isNew())&&(a.isUndefined(this.get("email"))||a.isNull(this.get("email"))||""==String(this.get("email")).replace(/^\s+|\s+$/g,"")))return t=e("Email address cannot be empty."),this.errorModel.set("email",t),t;if(this.get("email")&&!/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(this.get("email")))return t=e("Invalid email address: %s.",this.get("email")),this.errorModel.set("email",t),t;if(this.get("email")&&this.collection.nonFilter.where({email:this.get("email"),auth_source:v}).length>1)return t=e("The email address %s already exists.",this.get("email")),this.errorModel.set("email",t),t;if(this.errorModel.unset("email"),"role"in n&&(a.isUndefined(this.get("role"))||a.isNull(this.get("role"))||""==String(this.get("role")).replace(/^\s+|\s+$/g,"")))return t=e("Role cannot be empty for user %s.",this.get("email")||""),this.errorModel.set("role",t),t;if(this.errorModel.unset("role"),this.get("auth_source")==v)if(this.isNew()){if("newPassword"in n&&(a.isUndefined(this.get("newPassword"))||a.isNull(this.get("newPassword"))||""==this.get("newPassword")))return t=e("Password cannot be empty for user %s.",this.get("email")||""),this.errorModel.set("newPassword",t),t;if(!a.isUndefined(this.get("newPassword"))&&!a.isNull(this.get("newPassword"))&&this.get("newPassword").length<6)return t=e("Password must be at least 6 characters for user %s.",this.get("email")||""),this.errorModel.set("newPassword",t),t;if(this.errorModel.unset("newPassword"),"confirmPassword"in n&&(a.isUndefined(this.get("confirmPassword"))||a.isNull(this.get("confirmPassword"))||""==this.get("confirmPassword")))return t=e("Confirm Password cannot be empty for user %s.",this.get("email")||""),this.errorModel.set("confirmPassword",t),t;if(this.errorModel.unset("confirmPassword"),this.get("newPassword")&&this.get("confirmPassword")&&this.get("newPassword")!=this.get("confirmPassword"))return t=e("Passwords do not match for user %s.",this.get("email")||""),this.errorModel.set("confirmPassword",t),t;this.errorModel.unset("confirmPassword")}else if((a.isUndefined(this.get("newPassword"))||a.isNull(this.get("newPassword"))||""==this.get("newPassword"))&&(a.isUndefined(this.get("confirmPassword"))||a.isNull(this.get("confirmPassword"))||""==this.get("confirmPassword")))this.errorModel.unset("newPassword"),""==this.get("newPassword")&&this.set({newPassword:void 0}),this.errorModel.unset("confirmPassword"),""==this.get("confirmPassword")&&this.set({confirmPassword:void 0});else{if(!a.isUndefined(this.get("newPassword"))&&!a.isNull(this.get("newPassword"))&&""==!this.get("newPassword")&&this.get("newPassword").length<6)return t=e("Password must be at least 6 characters for user %s.",this.get("email")||""),this.errorModel.set("newPassword",t),t;if(a.isUndefined(this.get("confirmPassword"))||a.isNull(this.get("confirmPassword"))||""==this.get("confirmPassword"))return t=e("Confirm Password cannot be empty for user %s.",this.get("email")||""),this.errorModel.set("confirmPassword",t),t;if(this.get("newPassword")&&this.get("confirmPassword")&&this.get("newPassword")!=this.get("confirmPassword"))return t=e("Passwords do not match for user %s.",this.get("email")||""),this.errorModel.set("confirmPassword",t),t;this.errorModel.unset("newPassword"),this.errorModel.unset("confirmPassword")}else{if(this.get("username")&&this.collection.nonFilter.where({username:this.get("username"),auth_source:y}).length>1)return t=e("The username %s already exists.",this.get("username")),this.errorModel.set("username",t),t;if(this.get("username")&&this.collection.nonFilter.where({username:this.get("username"),auth_source:w}).length>1)return t=e("The username %s already exists.",this.get("username")),this.errorModel.set("username",t),t;if(this.get("username")&&this.collection.nonFilter.where({username:this.get("username"),auth_source:x}).length>1)return t=e("The username %s already exists.",this.get("username")),this.errorModel.set("username",t),t}return null}}),E=c.generateGridColumnsFromModel(null,k,"edit"),T=d.Extension.DeleteCell.extend({changeOwnership:function(r,o){var l=this,d=c.Select2Control.extend({fetchData:function(){var e=this,r=e.field.get("url");r=t(r,{uid:o}),n.ajax({url:r,headers:{"Cache-Control":"no-cache"}}).done((function(t){var n=e.field.get("transform");if(t.data.status){var i=t.data.result.data;n&&a.isFunction(n)?e.field.set("options",n.bind(e,i)):e.field.set("options",i)}else n&&a.isFunction(n)?e.field.set("options",n.bind(e,[])):e.field.set("options",[]);c.Select2Control.prototype.render.apply(e,arguments)})).fail((function(e){var t="";t=404==e.status?"Unable to find url.":e.responseJSON.errormsg,i.error(t)}))},render:function(){return this.fetchData(),c.Select2Control.prototype.render.apply(this,arguments)},onChange:function(){c.Select2Control.prototype.onChange.apply(this,arguments)}}),u=s.DataModel.extend({schema:[{id:"note_text_ch_owner",control:c.NoteControl,text:"Select the user that will take ownership of the shared servers created by <b>"+l.model.get("username")+"</b>. <b>"+r.data.shared_servers+"</b> shared servers are currently owned by this user.",group:e("General")},{id:"user",name:"user",label:e("User"),type:"text",editable:!0,select2:{allowClear:!0,width:"100%",first_empty:!0},control:d,url:"user_management.admin_users",helpMessage:e("Note: If no user is selected, the shared servers will be deleted.")}]});i.changeOwnershipDialog||i.dialog("changeOwnershipDialog",(function(){var t=n("<div class='change-ownership'></div>");return{main:function(e){this.msg=e},build:function(){this.elements.content.appendChild(t.get(0)),i.pgDialogBuild.apply(this)},setup:function(){return{buttons:[{text:e("Cancel"),key:27,className:"btn btn-secondary fa fa-times pg-alertify-button","data-btn-name":"cancel"},{text:e("OK"),key:13,className:"btn btn-primary fa fa-check pg-alertify-button","data-btn-name":"ok"}],options:{title:"Change ownership",padding:!1,overflow:!1,model:0,resizable:!0,maximizable:!1,pinnable:!1,closableByDimmer:!1,modal:!1,autoReset:!1,closable:!0}}},prepare:function(){var e=this;t.html(""),e.ownershipModel=new u;var n=f.generateViewSchema(null,e.ownershipModel,"create",null,null,!0,null),a=this.view=new f.Dialog({el:"<div></div>",model:e.ownershipModel,schema:n});t.append(a.render().$el[0])},callback:function(t){if("ok"===t.button["data-btn-name"]){t.cancel=!0;var n=this.ownershipModel.toJSON();""==n.user||null==n.user?i.confirm(e("Delete user?"),e("The shared servers owned by <b>"+l.model.get("username")+"</b> will be deleted. Do you wish to continue?"),(function(){l.model.destroy({wait:!0,success:function(){i.success(e("User deleted.")),i.changeOwnershipDialog().destroy(),i.UserManagement().destroy()},error:function(){i.error(e("Error during deleting user."))}}),i.changeOwnershipDialog().destroy()}),(function(){return!0})):l.changeOwner(n.user,o)}else i.changeOwnershipDialog().destroy()}}})),i.changeOwnershipDialog("Change ownership").resizeTo(s.stdW.md,s.stdH.md)},changeOwner:function(a,r){n.ajax({url:t("user_management.change_owner"),method:"POST",data:{new_owner:a,old_owner:r}}).done((function(t){i.changeOwnershipDialog().destroy(),i.UserManagement().destroy(),i.success(e(t.info))})).fail((function(){i.error(e("Unable to change owner."))}))},deleteUser:function(){var t=this;i.confirm(e("Delete user?"),e("Are you sure you wish to delete this user?"),(function(){t.model.destroy({wait:!0,success:function(){i.success(e("User deleted."))},error:function(){i.error(e("Error during deleting user."))}})}),(function(){return!0}))},deleteRow:function(r){var o=this;if(r.preventDefault(),o.model.get("id")==p.id)return i.alert(e("Cannot delete user."),e("Cannot delete currently logged in user."),(function(){return!0})),!0;!(!a.isUndefined(this.column.get("canDeleteRow"))&&a.isFunction(this.column.get("canDeleteRow")))||d.callByNeed(this.column.get("canDeleteRow"),this.column,this.model)?o.model.isNew()?o.model.destroy():1==o.model.get("role")?n.ajax({url:t("user_management.shared_servers",{uid:o.model.get("id")}),method:"GET",async:!1}).done((function(e){e.data.shared_servers>0?o.changeOwnership(e,o.model.get("id")):o.deleteUser()})).fail((function(){o.deleteUser()})):o.deleteUser():i.alert(e("Error"),e("This user cannot be deleted."),(function(){return!0}))}});E.columns.unshift({name:"pg-backform-delete",label:"",cell:T,editable:!1,cell_priority:-1,canDeleteRow:!0}),i.UserManagement||i.dialog("UserManagement",(function(){return{main:function(e){this.set("title",e)},build:function(){i.pgDialogBuild.apply(this)},setup:function(){return{buttons:[{text:"",key:112,className:"btn btn-primary-icon pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:e("Users"),url:t("help.static",{filename:"user_management.html"})}},{text:e("Close"),key:27,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button user_management_pg-alertify-button",attrs:{name:"close",type:"button"}}],options:{title:e("User Management"),padding:!1,overflow:!1,modal:!1,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1,closable:!1}}},hooks:{onclose:function(){this.view&&(this.view.remove({data:!0,internal:!0,silent:!0}),this.$content.remove())}},prepare:function(){var t=a.template(['<div class="pg-prop-footer" style="visibility:hidden;">',' <div class="pg-prop-status-bar">','    <div class="error-in-footer"> ','      <div class="d-flex px-2 py-1"> ','        <div class="pr-2"> ','          <i class="fa fa-exclamation-triangle text-danger" aria-hidden="true"></i> ',"        </div> ",'        <div class="alert-text" role="status"></div> ','        <div class="ml-auto close-error-bar"> ','          <a class="close-error fa fa-times text-danger"></a> ',"        </div> ","      </div> ","    </div> "," </div>","</div>"].join("\n")),s=n(t()),c=d.Row.extend({userInvalidClass:"bg-user-invalid",initialize:function(){d.Row.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"pgadmin:user:invalid",this.userInvalid),this.listenTo(this.model,"pgadmin:user:valid",this.userValid)},userInvalid:function(){n(this.el).removeClass("new"),n(this.el).addClass(this.userInvalidClass)},userValid:function(){n(this.el).removeClass(this.userInvalidClass)}}),f=l.Collection.extend({model:k,url:g,initialize:function(){l.Collection.prototype.initialize.apply(this,arguments);var e=this;e.changedUser=null,e.invalidUsers={},e.nonFilter=this,e.on("add",e.onModelAdd),e.on("remove",e.onModelRemove),e.on("pgadmin-session:model:invalid",(function(t,n){e.invalidUsers[n.cid]=t,n.trigger("pgadmin:user:invalid",n),s.find(".alert-text").html(t),s.css("visibility","visible")})),e.on("pgadmin-session:model:valid",(function(t){delete e.invalidUsers[t.cid],t.trigger("pgadmin:user:valid",t),this.updateErrorMsg(),this.saveUser(t)}))},onModelAdd:function(e){e.startNewSession()},onModelRemove:function(e){delete this.invalidUsers[e.cid],this.updateErrorMsg()},updateErrorMsg:function(){var e=null;for(var t in this.invalidUsers)if(e=this.invalidUsers[t])break;e?(s.find(".alert-text").html(e),s.css("visibility","visible")):(s.find(".alert-text").empty(),s.css("visibility","hidden"))},saveUser:function(t){var n=t.toJSON(!0);if(t.isNew()&&(t.get("auth_source")==y||t.get("auth_source")==w||t.get("auth_source")==x)&&(!t.get("username")||!t.get("auth_source")||!t.get("role"))||t.isNew()&&t.get("auth_source")==v&&(!t.get("email")||!t.get("role")||!t.get("newPassword")||!t.get("confirmPassword")||t.get("newPassword")!=t.get("confirmPassword"))||!t.isNew()&&t.get("newPassword")!=t.get("confirmPassword"))return!1;t.sessChanged()&&n&&!a.isEmpty(n)&&(t.stopSession(),t.save({},{attrs:n,wait:!0,success:function(){var n=t.get("auth_source");t.set({newPassword:void 0,confirmPassword:void 0,auth_source:void 0}),t.set({auth_source:n}),t.startNewSession(),i.success(e("User '%s' saved.",t.get("username")))},error:function(n,a){t.startNewSession(),i.error(e("Error saving user: '%s'",a.responseJSON.errormsg))}}))}}),p=this.userCollection=new f,C='<div class="navtab-inline-controls pgadmin-controls">\n                    <div class="input-group">\n                      <div class="input-group-prepend">\n                        <span class="input-group-text fa fa-search" id="labelSearch"></span>\n                        </div>\n                          <input type="search" class="form-control" id="txtGridSearch" placeholder="'+e("Search")+'" aria-label="'+e("Search")+'" aria-describedby="labelSearch" />\n                        </div>\n                        <button id="btn_add" type="button" class="btn btn-secondary btn-navtab-inline add" title="'+e("Add")+'">\n                          <span class="fa fa-plus "></span>\n                        </button>\n                      </div>\n                    </div>\n                  </div>',S=a.template(C),T={canAdd:!0,add_title:e("Add new user")},O=n("<div></div>",{class:"user_container flex-grow-1"});n.ajax({url:m,method:"GET",async:!1}).done((function(e){u=e})).fail((function(){setTimeout((function(){i.alert(e("Error"),e("Cannot load user roles."))}),100)})),n.ajax({url:b,method:"GET",async:!1}).done((function(e){_=e})).fail((function(){setTimeout((function(){i.alert(e("Error"),e("Cannot load user Sources."))}),100)}));var P,q=this.view=new d.Grid({row:c,columns:E.columns,collection:p,className:"backgrid table table-bordered table-noouter-border table-bottom-border table-hover"});O.append(q.render().$el[0]),this.$content=n("<div class='user_management object subnode subnode-noouter-border d-flex flex-column'></div>").append(S(T)).append(O).append(s),this.elements.content.appendChild(this.$content[0]),p.nonFilter=(P=p,new d.Extension.ClientSideFilter({collection:P,placeholder:e("Filter by email"),wait:150})).setCustomSearchBox(n("#txtGridSearch")).shadowCollection,p.fetch(),this.$content.find("a.close-error").on("click",(function(){s.find(".alert-text").empty(),s.css("visibility","hidden")})),this.$content.find("button.add").first().on("click",(function(e){e.preventDefault();var t,a=!1,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw r}}}}(p.models.entries());try{for(i.s();!(t=i.n()).done;){var s=r(t.value,2),l=s[0];if(s[1].isNew()){var d=q.body.rows[l].$el;d.addClass("new"),n(d).pgMakeVisible("backgrid"),n(d).find(".email").trigger("click"),a=!0}}}catch(e){i.e(e)}finally{i.f()}if(!a){n(q.body.$el.find(n("tr.new"))).removeClass("new");var c=new k(null,{handler:p,top:p,collection:p});p.add(c);var u=q.body.rows[p.indexOf(c)].$el;u.addClass("new"),n(u).pgMakeVisible("backgrid"),n(u).find(".email").trigger("click")}return!1})),h.findAndSetFocus(this.$content)},callback:function(t){if("dialog_help"==t.button.element.name)return t.cancel=!0,void s.showHelp(t.button.element.name,t.button.element.getAttribute("url"),null,null);if("close"==t.button.element.name){var n=this;a.all(this.userCollection.pluck("id"))&&a.isEmpty(this.userCollection.invalidUsers)||(t.cancel=!0,i.confirm(e("Discard unsaved changes?"),e("Are you sure you want to close the dialog? Any unsaved changes will be lost."),(function(){return n.close(),!0}),(function(){return!0})))}}}})),i.UserManagement(!0).resizeTo(s.stdW.lg,s.stdH.md)}}},s.UserManagement}.apply(t,a))||(e.exports=i)},92026:t=>{t.exports=e},8012:e=>{e.exports=t},1506:e=>{e.exports=n},96481:e=>{e.exports=a},34622:e=>{e.exports=i},6537:e=>{e.exports=r},52536:e=>{e.exports=o}},c={};function u(e){var t=c[e];if(void 0!==t)return t.exports;var n=c[e]={id:e,loaded:!1,exports:{}};return d[e].call(n.exports,n,n.exports,u),n.loaded=!0,n.exports}u.m=d,s=[],u.O=(e,t,n,a)=>{if(!t){var i=1/0;for(l=0;l<s.length;l++){for(var[t,n,a]=s[l],r=!0,o=0;o<t.length;o++)(!1&a||i>=a)&&Object.keys(u.O).every((e=>u.O[e](t[o])))?t.splice(o--,1):(r=!1,a<i&&(i=a));r&&(s.splice(l--,1),e=n())}return e}a=a||0;for(var l=s.length;l>0&&s[l-1][2]>a;l--)s[l]=s[l-1];s[l]=[t,n,a]},u.d=(e,t)=>{for(var n in t)u.o(t,n)&&!u.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},u.f={},u.e=e=>Promise.all(Object.keys(u.f).reduce(((t,n)=>(u.f[n](e,t),t)),[])),u.u=e=>({92:"snapsvg",322:"geometry",708:"jsoneditorchunk"}[e]+".chunk.js?id="+{92:"c17f70d63237ab6d8403",322:"40df42cab98c61dd3248",708:"026f436282b5836224b4"}[e]),u.miniCssF=e=>{},u.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l={},u.l=(e,t,n,a)=>{if(l[e])l[e].push(t);else{var i,r;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var d=o[s];if(d.getAttribute("src")==e){i=d;break}}i||(r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,u.nc&&i.setAttribute("nonce",u.nc),i.src=e),l[e]=[t];var c=(t,n)=>{i.onerror=i.onload=null,clearTimeout(f);var a=l[e];if(delete l[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach((e=>e(n))),t)return t(n)},f=setTimeout(c.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=c.bind(null,i.onerror),i.onload=c.bind(null,i.onload),r&&document.head.appendChild(i)}},u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),u.j=255,u.p="",(()=>{var e={255:0,528:0,602:0};u.f.j=(t,n)=>{var a=u.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise(((n,i)=>a=e[t]=[n,i]));n.push(a[2]=i);var r=u.p+u.u(t),o=new Error;u.l(r,(n=>{if(u.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}}),"chunk-"+t,t)}},u.O.j=t=>0===e[t];var t=(t,n)=>{var a,i,[r,o,s]=n,l=0;for(a in o)u.o(o,a)&&(u.m[a]=o[a]);if(s)var d=s(u);for(t&&t(n);l<r.length;l++)i=r[l],u.o(e,i)&&e[i]&&e[i][0](),e[r[l]]=0;return u.O(d)},n=self.webpackChunk=self.webpackChunk||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var f=u.O(void 0,[688,160,196,619],(()=>u(93841)));return f=(f=u.O(f)).default})()));
//# sourceMappingURL=sqleditor.js.map